<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Mans√£o do Job - Galeria Responsiva (Modo Configura√ß√£o)</title>

    <!-- Fontes do Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Sistema de Localiza√ß√£o - CSS -->
    <link rel="stylesheet" href="css/location-styles.css" />
    
    <!-- Header Reutiliz√°vel - Carregar primeiro -->
    <script src="js/load-header.js" defer></script>

    <style>
/* Estilos Globais e Reset */
body {
  font-family: "Roboto", Arial, sans-serif;
  line-height: 1.6;
  background: #f5f5f5;
  margin: 0;
  padding: 0;
  padding-top: 120px;
}


@keyframes pulse {
  0% { opacity: 0.8; }
  50% { opacity: 1; }
  100% { opacity: 0.8; }
}

/* Cores e Padr√µes */
:root {
  --primary-color: #e25352;
  --primary-light: #ffeaea;
  --text-dark: #333;
  --text-medium: #555;
  --bg-white: #fff;
  --border-light: #eee;
}

.content-section {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0.5rem 1rem 2rem 1rem;
  margin-top: 0;
}

/* ================================== */
/* ======== HEADER E MENU FIXO ======== */
/* ================================== */
.main-header {
  background: var(--bg-white);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  position: fixed;
  width: 100%;
  top: 0;
  z-index: 1000;
  height: 70px;
  /* Garantir que o header sempre fique vis√≠vel */
  opacity: 1 !important;
  visibility: visible !important;
  overflow: visible !important;
}

.header-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0.5rem 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 100%;
  position: relative;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.logo-text {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary-color);
  margin: 0;
}

/* Menu Hamb√∫rguer */
.menu-toggle {
  display: none;
  background: none;
  border: none;
  font-size: 1.5rem;
  color: var(--text-dark);
  cursor: pointer;
  padding: 0.5rem;
  position: relative;
  z-index: 1002;
}

/* Bot√£o de login mobile - oculto em desktop */
.header-login-mobile {
  display: none;
}


.header-right {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  transition: transform 0.3s ease-in-out;
  list-style: none;
}

.header-right a,
.header-right > a {
  text-decoration: none;
  color: var(--text-medium);
  font-weight: 500;
  font-size: 22px;
  transition: color 0.2s;
}

.header-right a:hover,
.header-right > a:hover {
  color: var(--primary-color);
}

/* ================================== */
/* ======== MENU DROPDOWN BRASIL ======== */
/* ================================== */
.dropdown-menu-item {
  position: relative;
  display: inline-block;
}

.dropdown-menu-item > a {
  display: flex;
  align-items: center;
  gap: 6px;
  text-decoration: none;
  color: var(--text-medium);
  font-weight: 500;
  font-size: 22px;
  transition: color 0.2s;
}

/* Bot√£o de localiza√ß√£o independente */
.location-btn {
  background: none;
  border: none;
  color: var(--primary-color);
  font-size: 20px;
  cursor: pointer;
  padding: 0;
  margin-right: 2px;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.location-btn:hover {
  color: #c44544;
  transform: scale(1.1);
}

.location-btn:active {
  transform: scale(0.95);
}

.dropdown-menu-item > a:hover {
  color: var(--primary-color);
}

.dropdown-menu-item .fa-caret-down {
  font-size: 10px;
  transition: transform 0.3s ease;
}

.dropdown-menu-item.active .fa-caret-down,
.dropdown-menu-item:hover .fa-caret-down {
  transform: rotate(180deg);
}

.dropdown-submenu {
  position: absolute;
  top: calc(100% + 10px);
  left: 0;
  background: white;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  min-width: 220px;
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: max-height 0.4s ease, opacity 0.3s ease, padding 0.3s ease;
  padding: 0;
  border-radius: 8px;
  z-index: 1000;
  list-style: none;
  margin: 0;
}

.dropdown-menu-item.active .dropdown-submenu,
.dropdown-menu-item:hover .dropdown-submenu {
  max-height: 70vh;
  overflow-y: auto;
  overflow-x: hidden;
  opacity: 1;
  padding: 8px 0;
}

.dropdown-submenu .submenu {
  list-style: none;
  padding: 0;
}

.dropdown-submenu .submenu a {
  display: block;
  padding: 10px 20px;
  color: #555;
  text-decoration: none;
  transition: background-color 0.2s ease, color 0.2s ease, padding-left 0.2s ease;
  font-size: 14px;
  font-weight: 400;
}

.dropdown-submenu .submenu a:hover {
  background-color: #f8f8f8;
  color: #e25352;
  padding-left: 25px;
}

/* Ajuste para mobile */
@media (max-width: 768px) {
  .dropdown-menu-item {
    width: 100%;
  }
  
  .dropdown-submenu {
    position: static;
    box-shadow: none;
    border-radius: 0;
    border-top: 1px solid #eee;
    margin-top: 5px;
    max-height: 0;
    overflow: hidden;
  }
  
  .dropdown-menu-item.active .dropdown-submenu,
  .dropdown-menu-item:hover .dropdown-submenu {
    max-height: 50vh;
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    padding: 8px 0;
    opacity: 1;
  }
}

/* Estiliza√ß√£o da barra de scroll */
.dropdown-submenu::-webkit-scrollbar {
  width: 6px;
}

.dropdown-submenu::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

.dropdown-submenu::-webkit-scrollbar-thumb {
  background: var(--primary-color);
  border-radius: 10px;
}

.dropdown-submenu::-webkit-scrollbar-thumb:hover {
  background: #c44544;
}

/* ================================== */
/* ======== BOT√ïES DE CADASTRO E LOGIN ======== */
/* ================================== */
.header-buttons {
  display: flex;
  align-items: center;
  gap: 10px;
}

.sign-button {
  position: relative;
  display: inline-block;
}

.sign-button__action {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border: none;
  background: none;
  cursor: pointer;
  color: #e25352;
  font-size: 18px;
  transition: all 0.3s ease;
}

.sign-button__title {
  margin: 0;
  font-weight: 500;
  font-size: 22px;
}

.sign-button__tooltip {
  position: absolute;
  top: 100%;
  left: 0;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  padding: 0.5rem;
  display: none;
  min-width: 200px;
  z-index: 1000;
}

.sign-button:hover .sign-button__tooltip {
  display: block;
}

.sign-button__link {
  display: block;
  padding: 0.8rem 1rem;
  color: #333;
  text-decoration: none;
  transition: background 0.3s ease;
  border-radius: 4px;
  font-size: 14px;
}

.sign-button__link:hover {
  background: #f5f5f5;
}

.btn-login {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: none;
  border: none;
  color: #333;
  text-decoration: none;
  font-size: 14px;
  transition: color 0.3s ease;
}

.btn-login:hover {
  color: var(--primary-color);
}

.btn-login i {
  font-size: 1.2rem;
}

/* Container do login com dropdown */
.login-container {
  position: relative;
  display: inline-block;
}

.login-container-mobile {
  position: relative;
  display: inline-block;
}

/* Dropdown do usu√°rio logado */
.login-dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 10px;
  background: white;
  border-radius: 10px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.15);
  min-width: 200px;
  z-index: 1000;
  overflow: hidden;
  animation: slideDown 0.3s ease;
}

.login-dropdown-mobile {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 10px;
  background: white;
  border-radius: 10px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.15);
  min-width: 200px;
  z-index: 1000;
  overflow: hidden;
  animation: slideDown 0.3s ease;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.dropdown-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 20px;
  color: #333;
  text-decoration: none;
  transition: all 0.3s ease;
  border-bottom: 1px solid #f0f0f0;
}

.dropdown-item:last-child {
  border-bottom: none;
}

.dropdown-item:hover {
  background: #f8f9fa;
  color: var(--primary-color);
}

.dropdown-item i {
  width: 20px;
  text-align: center;
  color: var(--primary-color);
}

/* Overlay para fechar dropdown ao clicar fora */
.dropdown-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 999;
  display: none;
}

/* ================================== */
/* ======== MODAL DE LOGIN ======== */
/* ================================== */
.modal {
  display: none;
  position: fixed;
  z-index: 10000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(5px);
}

.modal.show {
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-dialog {
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  max-width: 500px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
}

.modal-content {
  border-radius: 12px;
  overflow: hidden;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1.5rem;
  border-bottom: 1px solid #eee;
  background: #f8f9fa;
}

.modal-title {
  margin: 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: #333;
}

.close {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: #666;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 50%;
  transition: all 0.3s ease;
}

.close:hover {
  background: #e9ecef;
  color: #333;
}

.modal-body {
  padding: 2rem;
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-control-label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
  color: #333;
}

.position-relative {
  position: relative;
}

.input-prepend {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #666;
  z-index: 2;
}

.form-control {
  width: 100%;
  padding: 12px 12px 12px 40px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 16px;
  transition: border-color 0.3s ease;
}

.form-control:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(226, 83, 82, 0.1);
}

.btn {
  display: inline-block;
  padding: 12px 24px;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  font-weight: 500;
  text-align: center;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.3s ease;
}

.btn-primary {
  background: var(--primary-color);
  color: white;
}

.btn-primary:hover {
  background: #c44241;
  transform: translateY(-1px);
}

.btn-default {
  background: #f8f9fa;
  color: #333;
  border: 1px solid #ddd;
}

.btn-default:hover {
  background: #e9ecef;
}

.btn-xl {
  padding: 14px 28px;
  font-size: 18px;
}

.w-full {
  width: 100%;
}

.btn-outline {
  background: transparent;
  border: 2px solid #ddd;
}

.btn-outline:hover {
  background: #f8f9fa;
  border-color: var(--primary-color);
  color: var(--primary-color);
}

.btn-circle {
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Responsividade do Modal */
@media (max-width: 768px) {
  .modal-dialog {
    width: 95%;
    margin: 1rem;
  }
  
  .modal-header {
    padding: 1rem;
  }
  
  .modal-body {
    padding: 1.5rem;
  }
  
  .modal-title {
    font-size: 1.25rem;
  }
}

/* --- INDICADOR DE FONTE DE DADOS --- */
.data-source-indicator {
  background: linear-gradient(135deg, #e25352, #ff6b6b);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  text-align: center;
  margin-bottom: 1rem;
  font-size: 0.9rem;
  font-weight: 500;
  box-shadow: 0 2px 10px rgba(226, 83, 82, 0.3);
  animation: pulse 2s infinite;
}

.data-source-indicator.success {
  background: linear-gradient(135deg, #28a745, #20c997);
  box-shadow: 0 2px 10px rgba(40, 167, 69, 0.3);
}

.data-source-indicator.error {
  background: linear-gradient(135deg, #dc3545, #fd7e14);
  box-shadow: 0 2px 10px rgba(220, 53, 69, 0.3);
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

/* Menu Mobile */
@media (max-width: 768px) {
  .menu-toggle {
    display: block;
  }
  
  /* Bot√£o de login sempre vis√≠vel ao lado do menu-toggle em mobile */
  .header-login-mobile {
    display: flex !important;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: none;
    border: none;
    color: var(--text-dark);
    font-weight: 500;
    cursor: pointer;
    font-size: 0.85rem;
    margin-right: 8px;
    z-index: 1003;
    white-space: nowrap;
  }
  
  .header-login-mobile i {
    font-size: 1rem;
  }
  
  .header-login-mobile:hover {
    color: var(--primary-color);
  }
  
  .header-login-mobile span {
    display: inline;
  }
  
  /* Container do header em mobile - permite posicionamento do login ao lado do menu-toggle */
  .header-container {
    position: relative;
  }

  .header-right {
    position: fixed;
    top: 70px;
    right: -100%;
    width: 80%;
    max-width: 300px;
    height: calc(100vh - 70px);
    background: var(--bg-white);
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 2rem 1rem;
    transition: right 0.3s ease;
    z-index: 1001;
    overflow-y: auto;
  }

  .header-right.open {
    right: 0;
  }

  .location-btn {
    margin-right: 0;
    margin-bottom: 0.5rem;
    padding: 0.5rem;
    font-size: 18px;
  }

  .header-right a,
  .header-right > a {
    display: block;
    padding: 1rem;
    text-decoration: none;
    color: var(--text-dark);
    border-bottom: 1px solid var(--border-light);
    font-weight: 500;
  }

  .header-right a:hover {
    background: var(--primary-light);
    color: var(--primary-color);
  }

  .header-buttons {
    flex-direction: column;
    gap: 0.5rem;
    width: 100%;
    margin-top: 1rem;
  }

  .sign-button {
    width: 100%;
  }

  .btn-login {
    width: 100%;
    text-align: center;
    padding: 0.75rem;
    font-size: 16px;
  }

  /* Overlay escuro quando menu est√° aberto */
  .menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }

  .menu-overlay.active {
    opacity: 1;
    visibility: visible;
  }
}

/* Categories Container */
.categories-container {
  position: fixed;
  top: 70px;
  left: 0;
  width: 100%;
  background: var(--bg-white);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px;
  box-sizing: border-box;
  padding: 10px 0;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 999;
  transition: all 0.3s ease-in-out;
  transform: translateY(0);
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  display: flex;
  justify-content: center;
  align-items: center;
}

.category-link {
  text-decoration: none;
  color: var(--text-medium);
  font-size: 1rem;
  padding: 6px 12px;
  border-radius: 20px;
  transition: all 0.3s ease;
  white-space: nowrap;
  text-align: center;
  display: inline-block;
  min-width: 80px;
}

.category-link:hover {
  background: var(--primary-light);
  color: var(--primary-color);
}

.category-link.active {
  background: var(--primary-color);
  color: var(--bg-white);
  border-radius: 20px;
}

/* Estilos para link "Sexo Virtual" bloqueado (Em Breve) */
.category-link.coming-soon {
  background: #808080 !important;
  color: #ffffff !important;
  opacity: 0.6;
  cursor: not-allowed !important;
  position: relative;
  overflow: visible;
  pointer-events: none;
}

.category-link.coming-soon:hover {
  background: #808080 !important;
  color: #ffffff !important;
}

/* Faixa diagonal vermelha com "Em Breve!" */
.category-link.coming-soon::before {
  content: 'Em Breve!';
  position: absolute;
  top: 8px;
  left: 10px;
  width: 120px;
  height: 25px;
  background: linear-gradient(135deg, rgba(220, 53, 69, 0.7) 0%, rgba(200, 35, 51, 0.7) 100%);
  color: white;
  font-weight: bold;
  font-size: 0.7rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transform: rotate(-25deg);
  transform-origin: center;
  z-index: 100;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
  letter-spacing: 1px;
  pointer-events: none;
  backdrop-filter: blur(2px);
}

@media (max-width: 768px) {
  .category-link.coming-soon::before {
    top: 6px;
    left: 8px;
    width: 100px;
    height: 22px;
    font-size: 0.65rem;
  }
}

@media (max-width: 480px) {
  .category-link.coming-soon::before {
    top: 5px;
    left: 6px;
    width: 90px;
    height: 20px;
    font-size: 0.6rem;
  }
}


/* üì± Ajuste responsivo para telas menores */
@media (max-width: 768px) {
  .categories-container {
    gap: 2px;
    padding: 6px 2px;
    flex-wrap: nowrap;
    justify-content: space-around;
    overflow: hidden;
  }

  .category-link {
    font-size: 0.7rem;
    padding: 3px 6px;
    min-width: auto;
    flex: 1 1 auto;
    white-space: nowrap;
    text-align: center;
    max-width: 100%;
  }
  
  /* Reordenar em mobile: Sexo Virtual ap√≥s Massagistas */
  .category-link[data-order="1"] { order: 1; } /* Mulheres */
  .category-link[data-order="2"] { order: 2; } /* Massagistas */
  .category-link[data-order="3"] { order: 3; } /* Sexo Virtual */
}

@media (max-width: 480px) {
  .categories-container {
    gap: 1px;
    padding: 5px 1px;
    flex-wrap: nowrap;
    justify-content: space-around;
    overflow: hidden;
  }

  .category-link {
    font-size: 0.65rem;
    padding: 2px 4px;
    min-width: auto;
    flex: 1 1 auto;
    white-space: nowrap;
    text-align: center;
    max-width: 100%;
  }
  
  /* Reordenar em mobile: Sexo Virtual ap√≥s Massagistas */
  .category-link[data-order="1"] { order: 1; } /* Mulheres */
  .category-link[data-order="2"] { order: 2; } /* Massagistas */
  .category-link[data-order="3"] { order: 3; } /* Sexo Virtual */
}

/* ================================== */
/* ======== BARRA DE LAYOUTS (SCROLL-HIDE) ======== */
/* ================================== */
#layout-switcher-bar {
  position: sticky;
  top: 120px;
  width: 100%;
  background: var(--bg-white);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 998;
  padding: 10px 0;
  display: none;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  box-sizing: border-box;
  transition: transform 0.3s ease-out;
}

#layout-switcher-bar.hidden-on-scroll {
  transform: translateY(-100%);
}

/* Vis√≠vel em mobile e tablet */
@media (max-width: 1024px) {
  #layout-switcher-bar {
    display: flex;
  }
}

/* Escondido em desktop */
@media (min-width: 1025px) {
  #layout-switcher-bar {
    display: none !important;
  }
}

#layout_anuncios {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

.layout-icon {
  font-size: 22px;
  padding: 8px;
  cursor: pointer;
  border-radius: 8px;
  color: var(--text-medium);
  transition: all 0.3s ease;
}

.layout-icon.active {
  color: var(--primary-color);
  background-color: #e0e0e0;
}

/* Responsividade */
@media (max-width: 768px) {
  #layout-switcher-bar {
    flex-direction: column;
    padding: 8px;
  }

  #layout_anuncios {
    gap: 6px;
  }

  .layout-icon {
    font-size: 20px;
    padding: 6px;
  }

  /* Layout N7 - Lista (1 card por tela) */
  .layout-n7 {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem;
    /* REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna) */
    max-height: none; /* Permite rolagem da p√°gina */
    overflow-y: visible; /* Permite rolagem da p√°gina */
  }

  .layout-n7 .acompanhante-card {
    width: 100%;
    height: calc(100vh - 250px);
    min-height: 400px;
    display: flex;
    flex-direction: column;
    margin-bottom: 0;
    padding: 0;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    overflow: hidden;
    flex-shrink: 0;
  }

  .layout-n7 .card-image-wrapper {
    width: 100%;
    height: 70%;
    flex-shrink: 0;
    display: flex;
    align-items: stretch;
  }

  .layout-n7 .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
    display: block;
  }

  .layout-n7 .card-info {
    height: 30%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 1.5rem;
    text-align: center;
  }

  .layout-n7 .card-name {
    display: none;
  }

  .layout-n7 .card-phrase {
    font-size: 1.2rem;
    font-weight: bold;
    color: #e25352;
    margin-bottom: 1rem;
    line-height: 1.4;
  }

  .layout-n7 .px-item-localhorario {
    font-size: 1rem;
    color: #333;
    font-weight: 500;
  }

  /* Layout N1 - Destaque (estilo Skokka) */
  .layout-n1 {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem;
    /* REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna) */
    max-height: none; /* Permite rolagem da p√°gina */
    overflow-y: visible; /* Permite rolagem da p√°gina */
  }

  .layout-n1 .acompanhante-card {
    width: 100%;
    height: calc(100vh - 250px);
    min-height: 400px;
    display: flex;
    flex-direction: column;
    margin-bottom: 0;
    padding: 0;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    overflow: hidden;
    flex-shrink: 0;
  }

  .layout-n1 .card-image-wrapper {
    width: 100%;
    height: 70%;
    flex-shrink: 0;
    display: flex;
    align-items: stretch;
  }

  .layout-n1 .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
    display: block;
  }

  .layout-n1 .card-info {
    height: 30%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 1.5rem;
    text-align: center;
  }

  .layout-n1 .card-name {
    font-size: 1.4rem;
    font-weight: bold;
    margin-bottom: 0.8rem;
    color: #333;
  }

  .layout-n1 .card-phrase {
    font-size: 1.2rem;
    font-weight: bold;
    color: #e25352;
    margin-bottom: 1rem;
    line-height: 1.4;
  }

  .layout-n1 .px-item-localhorario {
    font-size: 1rem;
    color: #333;
    font-weight: 500;
  }

  /* Layouts N2, N3 - padr√£o linear */
  .layout-n2, .layout-n3 {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem;
    /* REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna) */
    max-height: none; /* Permite rolagem da p√°gina */
    overflow-y: visible; /* Permite rolagem da p√°gina */
  }

  .layout-n2 .acompanhante-card,
  .layout-n3 .acompanhante-card {
    width: 100%;
    height: calc((100vh - 250px) / 3);
    min-height: 150px;
    max-height: 200px;
    display: flex;
    flex-direction: row;
    margin-bottom: 0;
    padding: 0;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
    flex-shrink: 0;
  }

  .layout-n2 .card-image-wrapper,
  .layout-n3 .card-image-wrapper {
    width: 140px;
    height: 100%;
    flex-shrink: 0;
    margin-right: 0;
    display: flex;
    align-items: stretch;
  }

  .layout-n2 .card-image,
  .layout-n3 .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
    display: block;
  }

  .layout-n2 .card-info,
  .layout-n3 .card-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 1rem;
  }

  .layout-n2 .card-name,
  .layout-n3 .card-name {
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
    color: #333;
  }

  .layout-n2 .card-phrase,
  .layout-n3 .card-phrase {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 0.5rem;
    line-height: 1.4;
  }

  .layout-n2 .px-item-localhorario,
  .layout-n3 .px-item-localhorario {
    font-size: 0.8rem;
    color: #888;
  }

  /* Esconder t√≠tulo da galeria em mobile */
  #gallery-title {
    display: none !important;
  }

  /* Esconder se√ß√£o de stories em mobile */
  .stories-section {
    display: none !important;
  }

  /* === MOBILE LAYOUTS === */
  #layout-switcher-bar {
    display: flex !important;
  }

  #gallery-grid {
    display: block !important;
    gap: 0;
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Override para layout N2 - FOR√áAR FLEXBOX */
  #gallery-grid.layout-n2-gallery {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 10px !important;
    justify-content: flex-start !important;
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important;
    box-sizing: border-box !important;
    min-height: auto !important;
    height: auto !important;
    /* REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna) */
    max-height: none !important; /* Permite rolagem da p√°gina */
    overflow-y: visible !important; /* Permite rolagem da p√°gina */
    overflow-x: hidden !important;
  }

  /* Layout espec√≠fico para N2 - 2 colunas (fallback com :has) */
  #gallery-grid:has(.mobile-layout-2),
  #gallery-grid:has(.mobile-layout-2-gallery) {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 10px !important;
    justify-content: flex-start !important;
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important;
    box-sizing: border-box !important;
    min-height: auto !important;
    height: auto !important;
    /* REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna) */
    max-height: none !important; /* Permite rolagem da p√°gina */
    overflow-y: visible !important; /* Permite rolagem da p√°gina */
    overflow-x: hidden !important;
  }

  #gallery-grid.layout-n2-gallery .mobile-layout-2-gallery,
  #gallery-grid:has(.mobile-layout-2) .mobile-layout-2,
  #gallery-grid:has(.mobile-layout-2-gallery) .mobile-layout-2-gallery {
    width: calc((100% - 10px) / 2) !important;
    max-width: calc((100% - 10px) / 2) !important;
    flex: 0 0 calc((100% - 10px) / 2) !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Layout espec√≠fico para N3 - 3 colunas */
  #gallery-grid.layout-n3-gallery,
  #gallery-grid:has(.mobile-layout-3-gallery) {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 10px !important;
    justify-content: flex-start !important;
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important;
    box-sizing: border-box !important;
    min-height: auto !important;
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
  }

  #gallery-grid.layout-n3-gallery .mobile-layout-3-gallery,
  #gallery-grid:has(.mobile-layout-3-gallery) .mobile-layout-3-gallery {
    width: calc((100% - 20px) / 3) !important;
    max-width: calc((100% - 20px) / 3) !important;
    flex: 0 0 calc((100% - 20px) / 3) !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Layout 1: um por linha (lista) */
  /* Layout Preview (N7) - Estilo similar ao formul√°rio de cadastro */
  .mobile-layout-preview {
    width: 100%;
    margin: 0;
    margin-bottom: 2px; /* Espa√ßamento m√≠nimo entre cards */
    background: white;
    border-radius: 0; /* Sem bordas arredondadas para ocupar toda a largura */
    box-shadow: none; /* Sem sombra para ocupar todo o espa√ßo */
    overflow: hidden;
    display: block;
  }

  .card-preview-wrapper-mobile {
    position: relative;
    width: 100%;
    padding-bottom: 150%; /* Aspect ratio 2:3 (similar ao preview do cadastro) */
    height: 0;
    overflow: visible;
  }

  .card-preview-image-mobile {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .card-preview-overlay-mobile {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    padding: 1.5rem;
    border-radius: 0 0 15px 15px;
  }

  .card-preview-name-mobile {
    color: white;
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0 0 0.3rem 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .card-preview-location-mobile {
    color: white;
    font-size: 1rem;
    font-weight: 500;
    margin: 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    text-align: center;
  }

  /* Layout 1: horizontal (mantido para outros layouts) */
  .mobile-layout-1 {
    display: flex !important;
    flex-direction: row;
    width: 100%;
    height: 120px;
    margin-bottom: 10px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
  }

  .mobile-layout-1 .card-image-wrapper {
    width: 120px;
    height: 100%;
    flex-shrink: 0;
  }

  .mobile-layout-1 .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .mobile-layout-1 .card-info {
    flex: 1;
    padding: 10px;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .mobile-layout-1 .card-name {
    font-size: 1.1rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #333;
  }

  .mobile-layout-1 .card-phrase {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 5px;
    line-height: 1.3;
  }

  .mobile-layout-1 .px-item-localhorario {
    font-size: 0.8rem;
    color: #888;
  }

  /* Layout N1: Destaque - 1 card por linha, 3 cards vis√≠veis, foto √† esquerda (1/3) e informa√ß√µes √† direita (2/3) */
  .mobile-layout-1-featured {
    width: 100% !important;
    height: calc((100vh - 200px) / 3) !important;
    min-height: calc((100vh - 200px) / 3) !important;
    max-height: calc((100vh - 200px) / 3) !important;
    margin: 0 !important;
    margin-bottom: 10px !important;
    padding: 0 !important;
    box-sizing: border-box !important;
    display: flex !important;
    flex-direction: row !important;
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    background: white;
  }

  /* Container da imagem - ocupa 1/3 da largura */
  .mobile-layout-1-featured .card-featured-image-wrapper {
    width: 33.333% !important;
    flex: 0 0 33.333% !important;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  .mobile-layout-1-featured .card-featured-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
  }


  /* Container das informa√ß√µes - ocupa 2/3 da largura */
  .mobile-layout-1-featured .card-featured-info-wrapper {
    width: 66.667% !important;
    flex: 1 1 66.667% !important;
    height: 100%;
    display: flex;
    align-items: flex-start; /* Alinhar no topo */
    padding: 12px 20px; /* Padding reduzido no topo */
    background: white;
    box-sizing: border-box;
  }

  .mobile-layout-1-featured .card-featured-info {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 0; /* Sem margem no topo */
  }

  .mobile-layout-1-featured .card-featured-phrase {
    color: #333;
    font-size: 1.1rem;
    font-weight: 700;
    margin: 0;
    margin-bottom: 4px; /* Espa√ßamento m√≠nimo abaixo */
    line-height: 1.3;
    text-transform: uppercase; /* Frase de efeito em caixa alta */
  }

  .mobile-layout-1-featured .card-featured-description {
    color: #666;
    font-size: 0.9rem;
    font-weight: 400;
    margin: 0;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    text-transform: none; /* Garantir que a descri√ß√£o n√£o fique em caixa alta */
  }

  .mobile-layout-1-featured .card-featured-details {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 4px;
    flex-wrap: wrap;
  }

  .mobile-layout-1-featured .card-featured-age {
    color: #555;
    font-size: 0.85rem;
    font-weight: 500;
  }

  .mobile-layout-1-featured .card-featured-location {
    color: #555;
    font-size: 0.85rem;
    font-weight: 500;
  }

  /* Layout espec√≠fico para N1 - container */
  #gallery-grid.layout-n1-featured {
    display: flex !important;
    flex-direction: column !important;
    gap: 10px !important;
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important;
    box-sizing: border-box !important;
    /* REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna) */
    max-height: none !important; /* Permite rolagem da p√°gina */
    overflow-y: visible !important; /* Permite rolagem da p√°gina */
  }

  /* Layout 2: dois por linha */
  /* Layout N2: Galeria 2 colunas (estilo pub-book) */
  .mobile-layout-2-gallery {
    width: calc((100% - 10px) / 2) !important;
    max-width: calc((100% - 10px) / 2) !important;
    min-width: calc((100% - 10px) / 2) !important;
    flex: 0 0 calc((100% - 10px) / 2) !important;
    margin: 0 !important;
    margin-bottom: 10px !important;
    padding: 0 !important;
    box-sizing: border-box !important;
    overflow: visible !important; /* Garantir que nome e cidade apare√ßam */
    display: flex !important;
    flex-direction: column !important;
  }
  
  /* Garantir que em mobile o layout N2 funcione corretamente */
  @media (max-width: 768px) {
    #gallery-grid.layout-n2-gallery .mobile-layout-2-gallery {
      width: calc((100% - 10px) / 2) !important;
      max-width: calc((100% - 10px) / 2) !important;
      min-width: calc((100% - 10px) / 2) !important;
      flex: 0 0 calc((100% - 10px) / 2) !important;
    }
    
    /* Garantir que em mobile o layout N3 funcione corretamente */
    #gallery-grid.layout-n3-gallery .mobile-layout-3-gallery {
      width: calc((100% - 20px) / 3) !important;
      max-width: calc((100% - 20px) / 3) !important;
      min-width: calc((100% - 20px) / 3) !important;
      flex: 0 0 calc((100% - 20px) / 3) !important;
    }
  }

  .mobile-layout-2-gallery .gallery-item,
  .mobile-layout-3-gallery .gallery-item {
    position: relative;
    overflow: visible;
  }
  
  .mobile-layout-2-gallery .gallery-item {
    width: 100%;
    position: relative;
    overflow: visible;
    border-radius: 8px 8px 0 0; /* Bordas arredondadas apenas no topo */
    background: #f0f0f0;
    /* Garantir que o container acompanhe a altura aumentada da imagem (25% maior) */
    aspect-ratio: 1 / 1.25;
    flex: 0 0 auto; /* N√£o permitir que cres√ßa al√©m da imagem */
  }
  
  /* Garantir que o link dentro do card mostre todas as informa√ß√µes */
  .mobile-layout-2-gallery > a {
    display: flex !important;
    flex-direction: column !important;
    height: 100%;
    text-decoration: none;
    color: inherit;
    overflow: visible !important;
  }
  
  /* Layout N3: container do gallery-item com altura aumentada */
  .mobile-layout-3-gallery .gallery-item {
    width: 100%;
    position: relative;
    overflow: visible;
    border-radius: 8px 8px 0 0;
    background: #f0f0f0;
    /* Garantir que o container acompanhe a altura aumentada da imagem (35% maior) */
    aspect-ratio: 1 / 1.35;
    flex: 0 0 auto; /* N√£o permitir que cres√ßa al√©m da imagem */
  }

  .mobile-layout-2-gallery .pub-book-img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
    aspect-ratio: 1 / 1.25; /* Altura 25% maior que a largura */
    transition: transform 0.3s ease;
  }
  
  /* Layout N3: altura aumentada para dar mais espa√ßo √† foto */
  .mobile-layout-3-gallery .pub-book-img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
    aspect-ratio: 1 / 1.35; /* Altura 35% maior que a largura (aumentado para compensar espa√ßo dos nomes) */
    transition: transform 0.3s ease;
  }
  
  /* Layout N3: Galeria 3 colunas (estilo pub-book) */
  .mobile-layout-3-gallery {
    width: calc((100% - 20px) / 3) !important;
    max-width: calc((100% - 20px) / 3) !important;
    min-width: calc((100% - 20px) / 3) !important;
    flex: 0 0 calc((100% - 20px) / 3) !important;
    margin: 0 !important;
    margin-bottom: 10px !important;
    padding: 0 !important;
    box-sizing: border-box !important;
    display: flex !important;
    flex-direction: column !important;
    background: white !important;
    border-radius: 8px;
    overflow: visible !important; /* Permitir que as informa√ß√µes apare√ßam */
  }
  
  /* Estilos para informa√ß√µes do card (nome e cidade/UF) no layout N3 */
  .mobile-layout-3-gallery .card_title {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    padding: 4px 6px 2px; /* Reduzido padding vertical (menos espa√ßo) */
    font-size: 0.85rem;
    font-weight: 600;
    color: #333; /* Texto escuro para contraste */
    text-align: center;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    background: #e2e8f0; /* Cor levemente mais escura (cinza claro) */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin: 0;
    line-height: 1.2; /* Linha mais compacta */
  }

  .mobile-layout-3-gallery .card_resume {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    padding: 2px 6px 6px; /* Reduzido padding vertical (menos espa√ßo) */
    font-size: 0.7rem;
    font-weight: 500;
    color: #1a202c; /* Texto escuro para contraste */
    text-align: center;
    background: #cbd5e0; /* Cor mais escura para contraste (cinza m√©dio) */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin: 0;
    margin-top: -2px; /* Reduzir espa√ßo entre nome e cidade */
    line-height: 1.2; /* Linha mais compacta */
  }
  
  /* Garantir que o link n√£o quebre o layout */
  .mobile-layout-3-gallery > a {
    display: flex !important;
    flex-direction: column !important;
    height: 100%;
    text-decoration: none;
    color: inherit;
  }

  .mobile-layout-2-gallery .gallery-item:hover .pub-book-img {
    transform: scale(1.05);
  }

  /* Estilos para informa√ß√µes do card (nome e cidade) no layout N2 */
  .mobile-layout-2-gallery .card-info-n2 {
    padding: 8px 4px;
    background: white;
    text-align: center;
    display: block !important;
    visibility: visible !important;
    overflow: visible !important;
    min-height: auto !important;
  }

  .mobile-layout-2-gallery .card-name-n2 {
    font-size: 0.9rem;
    font-weight: bold;
    color: #333;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .mobile-layout-2-gallery .card-city-n2 {
    font-size: 0.75rem;
    color: #666;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Estilos antigos mantidos para compatibilidade */
  .mobile-layout-2 {
    width: calc(50% - 5px);
    display: inline-block;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
    margin-bottom: 10px;
    vertical-align: top;
  }

  .mobile-layout-2 .card-image-wrapper {
    width: 100%;
    height: 150px;
  }

  .mobile-layout-2 .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .mobile-layout-2 .card-info {
    padding: 10px;
    text-align: center;
  }

  .mobile-layout-2 .card-name {
    font-size: 1rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #333;
  }

  .mobile-layout-2 .card-phrase {
    font-size: 0.8rem;
    color: #666;
    margin-bottom: 5px;
    line-height: 1.3;
  }

  .mobile-layout-2 .px-item-localhorario {
    font-size: 0.7rem;
    color: #888;
  }

  /* Layout 3: tr√™s por linha */
  .mobile-layout-3 {
    width: calc(33.333% - 7px);
    display: inline-block;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
    margin-bottom: 10px;
  }

  .mobile-layout-3 .card-image-wrapper {
    width: 100%;
    height: 120px;
  }

  .mobile-layout-3 .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .mobile-layout-3 .card-info {
    padding: 8px;
    text-align: center;
  }

  .mobile-layout-3 .card-name {
    font-size: 0.9rem;
    font-weight: bold;
    margin-bottom: 3px;
    color: #333;
  }

  .mobile-layout-3 .card-phrase {
    font-size: 0.7rem;
    color: #666;
    margin-bottom: 3px;
    line-height: 1.2;
  }

  .mobile-layout-3 .px-item-localhorario {
    font-size: 0.6rem;
    color: #888;
  }

  /* Estilo jornal (newspaper) */
  .mobile-layout-news {
    display: flex !important;
    flex-direction: row;
    align-items: flex-start;
    width: 100%;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
    margin-bottom: 15px;
    padding: 15px;
    gap: 15px;
  }

  .mobile-layout-news .card-image-wrapper {
    width: 140px;
    height: 195px;
    flex-shrink: 0;
  }

  .mobile-layout-news .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
  }

  .mobile-layout-news .card-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
  }

  .mobile-layout-news .card-name {
    font-size: 1.4rem;
    font-weight: bold;
    margin-bottom: 8px;
    color: #333;
  }

  .mobile-layout-news .card-phrase {
    font-size: 1.2rem;
    font-weight: bold;
    color: #e25352;
    margin-bottom: 10px;
    line-height: 1.4;
  }

  .mobile-layout-news .card-description {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 10px;
    line-height: 1.4;
  }

  .mobile-layout-news .px-item-localhorario {
    font-size: 1rem;
    color: #333;
    font-weight: 500;
  }
}

/* ================================== */
/* ======== STORIES SECTION ======== */
/* ================================== */
.stories-section {
  padding: 1rem 1rem 0.5rem 1rem;
  max-width: 1200px;
  margin: 0 auto;
  margin-bottom: 0;
}

.stories-section h2 {
  color: var(--text-dark);
  margin-bottom: 0.5rem;
  margin-top: 0;
  font-size: 1.5rem;
}

.stories-scroll {
  display: flex;
  gap: 1rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  cursor: pointer;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.stories-scroll::-webkit-scrollbar {
  display: none;
}

.story-item {
  width: 80px;
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.story-ring {
  width: 70px;
  height: 70px;
}

.story-thumb {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.story-name {
  font-size: 0.85rem;
  color: #333;
}

/* Carrossel de Stories */
.stories-carousel-container {
  position: relative;
  overflow: hidden;
  border-radius: 10px;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  padding: 10px 0;
}

.stories-carousel-container:hover {
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.stories-track {
  display: flex;
  align-items: center;
  min-height: 100px;
}

.stories-carousel-container .story-item {
  transition: all 0.3s ease;
  border-radius: 10px;
  padding: 5px;
}

.stories-carousel-container .story-item:hover {
  background: rgba(255, 255, 255, 0.8);
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.stories-carousel-container .story-ring {
  border: 3px solid #dc3545;
  box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
  transition: all 0.3s ease;
}

.stories-carousel-container .story-item:hover .story-ring {
  border-color: #c82333;
  box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
  transform: scale(1.1);
}

.stories-carousel-container .story-name {
  font-weight: 600;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.stories-carousel-container .story-item:hover .story-name {
  color: #dc3545;
  transform: translateY(-2px);
}

/* Indicadores de navega√ß√£o */
.stories-carousel-container::before,
.stories-carousel-container::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 30px;
  z-index: 2;
  pointer-events: none;
}

.stories-carousel-container::before {
  left: 0;
  background: linear-gradient(to right, rgba(248, 249, 250, 0.9), transparent);
}

.stories-carousel-container::after {
  right: 0;
  background: linear-gradient(to left, rgba(248, 249, 250, 0.9), transparent);
}

/* Responsivo */
@media (max-width: 576px) {
  .stories-scroll {
    gap: 0.5rem;
  }
  
  .story-item {
    width: 60px;
  }
  .story-ring {
    width: 50px;
    height: 50px;
  }
  .story-name {
    font-size: 0.75rem;
  }
}

/* ================================== */
/* ======== GALERIA DE CONTE√öDO (GRID) ======== */
/* ================================== */

#gallery-grid {
  display: grid;
  gap: 1rem;
  width: 100%;
  margin-top: 1rem;
}

/* Base Card Style */
.acompanhante-card {
  display: flex;
  flex-direction: row;
  background: var(--bg-white);
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  overflow: hidden;
  text-decoration: none;
  color: var(--text-dark);
  transition: box-shadow 0.2s;
  height: auto;
}

.acompanhante-card:hover {
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.card-image-wrapper {
  width: 120px;
  height: 120px;
  flex-shrink: 0;
  overflow: visible;
  position: relative;
}

.card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Fita "Apenas Virtual" para cards de sexo virtual */
.virtual-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 140px;
  height: 28px;
  background: linear-gradient(135deg, rgba(220, 53, 69, 0.75) 0%, rgba(200, 35, 51, 0.75) 100%);
  color: white;
  font-weight: bold;
  font-size: clamp(0.7rem, 1.2vw, 0.85rem);
  display: flex;
  align-items: center;
  justify-content: center;
  transform: rotate(-25deg);
  transform-origin: center;
  z-index: 100;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
  letter-spacing: 1px;
  pointer-events: none;
  backdrop-filter: blur(2px);
}

/* Ajustes para diferentes layouts */
.layout-n1 .card-image-wrapper,
.layout-n2 .card-image-wrapper,
.layout-n3 .card-image-wrapper,
.layout-n7 .card-image-wrapper {
  overflow: visible;
  position: relative;
}

@media (max-width: 768px) {
  .virtual-badge {
    top: 8px;
    left: 8px;
    width: 120px;
    height: 24px;
    font-size: 0.65rem;
  }
}

@media (max-width: 480px) {
  .virtual-badge {
    top: 6px;
    left: 6px;
    width: 110px;
    height: 22px;
    font-size: 0.6rem;
  }
}

.card-info {
  padding: 1rem;
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.card-name {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0 0 0.5rem 0;
  color: var(--text-dark);
}

.card-phrase {
  font-size: 0.9rem;
  color: var(--text-medium);
  margin: 0;
  font-style: italic;
}

/* --- Estilo Base: GRID (Para N2 e N3) --- */
#gallery-grid.layout-n3 .acompanhante-card,
#gallery-grid.layout-n2 .acompanhante-card {
  flex-direction: column;
}

#gallery-grid.layout-n3 .card-image-wrapper,
#gallery-grid.layout-n2 .card-image-wrapper {
  width: 100%;
  padding-bottom: 120%;
  height: 0;
  position: relative;
}

#gallery-grid.layout-n3 .card-image,
#gallery-grid.layout-n2 .card-image {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

#gallery-grid.layout-n3 .card-info,
#gallery-grid.layout-n2 .card-info {
  padding: 0.8rem;
}

/* --- ESTILO N3 - BASEADO NO A_01__index_clean.html --- */
.gallery-grid.layout-n3 .acompanhante-card {
  background: white;
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  overflow: hidden;
  transition: transform 0.3s ease;
  text-decoration: none;
  color: inherit;
  display: block;
}

.gallery-grid.layout-n3 .acompanhante-card:hover {
  transform: translateY(-5px);
}

.gallery-grid.layout-n3 .card-image-wrapper {
  width: 100%;
  height: 350px;
  position: relative;
  padding-bottom: 0;
}

.gallery-grid.layout-n3 .card-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  position: static;
}

/* Fotos em paisagem no N3 - usar cover para preencher melhor */
.gallery-grid.layout-n3 .card-image.landscape-photo {
  object-fit: cover;
}

/* Layout especial N3 - foto ocupa todo o espa√ßo */
.gallery-grid.layout-n3 .card-image-wrapper.n3-full-image {
  height: 100%;
  position: relative;
  padding-bottom: 0;
}

.gallery-grid.layout-n3 .card-image-wrapper.n3-full-image .card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 15px;
}

/* Nome sobreposto na foto N3 */
.gallery-grid.layout-n3 .card-name-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
  padding: 20px 15px 15px;
  border-radius: 0 0 15px 15px;
}

/* Estilos para o Bot√£o Painel de Controle */
.boton_dashboard {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  background: linear-gradient(135deg, #e25352 0%, #c44544 100%);
  color: white;
  border-radius: 8px;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(226, 83, 82, 0.3);
  font-weight: 600;
  font-size: 1rem;
  border: none;
}

.boton_dashboard:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(226, 83, 82, 0.4);
  background: linear-gradient(135deg, #c44544 0%, #b33534 100%);
}

.boton_dashboard img {
  width: 24px;
  height: 24px;
  object-fit: contain;
}

.boton_dashboard span {
  font-weight: 600;
  font-size: 1rem;
}

/* Responsividade para o bot√£o */
@media (max-width: 768px) {
  .boton_dashboard {
    padding: 0.6rem 1.2rem;
    font-size: 0.9rem;
  }
  
  .boton_dashboard img {
    width: 20px;
    height: 20px;
  }
  
  .boton_dashboard span {
    font-size: 0.9rem;
  }
}

.gallery-grid.layout-n3 .card-name-overlay .card-name {
  color: white;
  font-size: 1.2rem;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
  margin: 0;
  text-align: center;
}

/* Remover padding do card-info no N3 */
.gallery-grid.layout-n3 .card-info {
  display: none; /* Esconder completamente o card-info no N3 */
}

/* --- LAYOUT N7 - FOTO NO TOPO, DADOS NA BASE --- */
.gallery-grid.layout-n7 .acompanhante-card {
  display: flex;
  flex-direction: column;
  height: 100%;
  margin: 0; /* Remover margens */
  padding: 0; /* Remover padding */
  width: 100%; /* Garantir largura total */
}

.gallery-grid.layout-n7 .card-image-wrapper.n7-top {
  flex: 1;
  height: 300px; /* Altura aumentada em 50% (200px + 100px) */
  overflow: hidden;
  border-radius: 10px 10px 0 0;
  width: 100%; /* Garantir largura total */
  margin: 0; /* Remover margens */
  padding: 0; /* Remover padding */
}

.gallery-grid.layout-n7 .card-image-wrapper.n7-top .card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.gallery-grid.layout-n7 .card-info.n7-bottom {
  flex: 0 0 auto; /* N√£o cresce, apenas o tamanho necess√°rio */
  padding: 15px; /* Padding aumentado para manter propor√ß√£o */
  background: white;
  border-radius: 0 0 10px 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  width: 100%; /* Garantir largura total */
  margin: 0; /* Remover margens */
  box-sizing: border-box; /* Incluir padding na largura total */
}

.gallery-grid.layout-n7 .card-info.n7-bottom .card-name {
  font-size: 1rem; /* Fonte ligeiramente maior */
  font-weight: 600;
  color: #333;
  margin: 0 0 8px 0; /* Margem aumentada */
  text-align: center;
}

.gallery-grid.layout-n7 .card-info.n7-bottom .card-phrase {
  font-size: 0.8rem; /* Fonte ligeiramente maior */
  color: #666;
  margin: 0;
  text-align: center;
  line-height: 1.4; /* Line-height aumentado */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.gallery-grid.layout-n3 .card-name {
  margin: 10px 0 5px;
  color: #222;
  font-size: 1.1rem;
  font-weight: 600;
}

.gallery-grid.layout-n3 .px-item-localhorario {
  margin: 2px 0;
  color: #666;
  font-size: 0.9rem;
}

.gallery-grid.layout-n3 .card-phrase {
  margin: 2px 0;
  color: #666;
  font-size: 0.85rem;
}

/* Estilos para overlay na se√ß√£o N3 (Destaques) */
.gallery-grid.layout-n3 .card-image-wrapper {
  position: relative;
}

.gallery-grid.layout-n3 .card-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
  padding: 0.8rem;
  border-radius: 0 0 15px 15px;
}

.gallery-grid.layout-n3 .card-name-overlay {
  color: white;
  font-size: 1.2rem;
  font-weight: 700;
  margin: 0 0 0.1rem 0;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.gallery-grid.layout-n3 .card-location-overlay {
  color: white;
  font-size: 0.8rem;
  margin: 0;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
  text-align: center;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* --- N√çVEL 7 (Grid 7 Colunas) --- */
#gallery-grid.layout-n7,
.gallery-grid.layout-n7 {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 0.5rem;
  padding: 1rem;
}

/* Garantir que os cards N7 ocupem toda a largura dispon√≠vel */
.gallery-grid.layout-n7 .acompanhante-card {
  box-sizing: border-box;
  border: none;
  outline: none;
}
@media (max-width: 1200px) {
  #gallery-grid.layout-n7,
  .gallery-grid.layout-n7 {
    grid-template-columns: repeat(5, 1fr);
  }
}
@media (max-width: 768px) {
  #gallery-grid.layout-n7,
  .gallery-grid.layout-n7 {
    grid-template-columns: repeat(3, 1fr);
  }
}
@media (max-width: 480px) {
  #gallery-grid.layout-n7,
  .gallery-grid.layout-n7 {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* --- N√çVEL 3 (3 Colunas) --- */
#gallery-grid.layout-n3,
.gallery-grid.layout-n3 {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  padding: 1rem;
}
@media (max-width: 768px) {
  #gallery-grid.layout-n3,
  .gallery-grid.layout-n3 {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* --- N√çVEL 2 (2 Colunas) --- */
#gallery-grid.layout-n2 {
  grid-template-columns: repeat(2, 1fr);
}

/* --- N√çVEL 1 (Full Width Article - Destaque Premium) --- */
#gallery-grid.layout-n1 {
  grid-template-columns: 1fr;
}

.gallery-grid.layout-n1 .acompanhante-card {
  display: block;
  padding: 0;
}

.gallery-grid.layout-n1 .card-image-wrapper {
  width: 100%;
  height: 200px;
  padding-bottom: 0;
  position: relative;
}

.gallery-grid.layout-n1 .card-image {
  position: static;
  height: 100%;
}

.gallery-grid.layout-n1 .card-info {
  padding: 1.5rem;
}

/* Layout N1 - Grade 6x6 (Propor√ß√£o Original) */
.layout-n1-grid {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 1rem;
  margin: 2rem 0;
}

.layout-n1-grid .acompanhante-card {
  background: white;
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  overflow: hidden;
  transition: transform 0.3s ease;
  text-decoration: none;
  color: inherit;
  display: block;
  padding: 0;
  margin: 0;
}

.layout-n1-grid .acompanhante-card:hover {
  transform: translateY(-5px);
}

.layout-n1-grid .card-image-wrapper {
  width: 100%;
  height: 350px; /* Propor√ß√£o original do N3 */
  position: relative;
  padding-bottom: 0;
}

.layout-n1-grid .card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  position: static;
  border-radius: 15px;
}

.layout-n1-grid .card-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
  padding: 1rem;
  border-radius: 0 0 15px 15px;
}

.layout-n1-grid .card-name-overlay {
  color: white;
  font-size: 1.4rem;
  font-weight: 700;
  margin: 0 0 0.1rem 0;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.layout-n1-grid .card-location-overlay {
  color: white;
  font-size: 0.9rem;
  margin: 0;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
  text-align: center;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Responsividade para N1 Grid */
@media (max-width: 1200px) {
  .layout-n1-grid {
    grid-template-columns: repeat(5, 1fr);
  }
}

@media (max-width: 992px) {
  .layout-n1-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 768px) {
  .layout-n1-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 576px) {
  .layout-n1-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

.px-item-localhorario {
  color: var(--text-dark);
  font-weight: 500;
  margin: 0.5rem 0;
  font-size: 0.9rem;
}



/* ================================== */
/* ========== JANELA DE PERFIL (MODAL) ========== */
/* ================================== */

#profile-window {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 600px;
  max-height: 90vh;
  overflow-y: auto;
  background: var(--bg-white);
  border-radius: 10px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  z-index: 2000;
  padding: 1.5rem;
}

#profile-window.show {
  display: block;
}

#profile-window header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  border-bottom: 1px solid var(--border-light);
  padding-bottom: 1rem;
}

#profile-window h3 {
  color: var(--primary-color);
  margin: 0;
  font-size: 1.5rem;
}

#profile-window .close-btn {
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--text-dark);
}

#profile-window .profile-image {
  width: 100%;
  height: 300px;
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 1rem;
}

#profile-window .profile-phrase {
  color: var(--text-medium);
  text-align: center;
  font-style: italic;
  margin-bottom: 1rem;
}

/* Carrossel de Fotos */
.carousel-container {
  position: relative;
  width: 100%;
  margin-bottom: 1rem;
}

.carousel {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
}

.carousel::-webkit-scrollbar {
  display: none;
}

.carousel-item {
  flex: 0 0 auto;
  width: 100%;
  scroll-snap-align: start;
}

.carousel-item img {
  width: 100%;
  height: 300px;
  object-fit: cover;
  border-radius: 8px;
}

.carousel-nav {
  display: flex;
  justify-content: center;
  margin-top: 0.5rem;
  gap: 0.5rem;
}

.carousel-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #ccc;
  cursor: pointer;
  transition: background 0.3s;
}

.carousel-dot.active {
  background: var(--primary-color);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  #profile-window {
    padding: 1rem;
  }
}

/* ================================== */
/* ======== RESPONSIVE ADJUSTMENTS ======== */
/* ================================== */
/* Padding para a barra de navega√ß√£o fixa em todas as resolu√ß√µes */
body {
  padding-bottom: 60px;
}

/* Ajustes responsivos para telas menores */
@media (max-width: 768px) {
  .content-section {
    padding: 1rem 0.5rem 2rem 0.5rem;
  }

  .stories-section {
    padding: 0.75rem 0.5rem 0.25rem 0.5rem;
    margin-bottom: 0;
  }

  .card-info {
    padding: 0.8rem;
  }

  .card-name {
    font-size: 1rem;
  }

  .card-phrase {
    font-size: 0.8rem;
  }
}

/* ================================== */
/* ======== MOBILE NAVBAR ======== */
/* ================================== */
.mobile-navbar {
  display: block;
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: var(--bg-white);
  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
  z-index: 1000;
}

.mobile-navbar-container {
  display: flex;
  justify-content: space-around;
  align-items: center;
  list-style: none;
  padding: 0;
  margin: 0;
  height: 60px;
}

.mobile-navbar .nav-item {
  flex-grow: 1;
  text-align: center;
}

.mobile-navbar .nav-link {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  color: var(--text-medium);
  font-size: 0.7rem;
  font-weight: 500;
  height: 60px;
  padding: 5px 0;
  transition: color 0.2s;
}

.mobile-navbar .nav-link i {
  font-size: 1.2rem;
  margin-bottom: 2px;
}

.mobile-navbar .nav-item.active .nav-link {
  color: var(--primary-color);
  border-top: 3px solid var(--primary-color);
  margin-top: -3px;
}

/* Barra de navega√ß√£o sempre vis√≠vel em todas as resolu√ß√µes */

/* ================================== */
/* ========== CONTAINER DE CATEGORIAS AUTO-HIDE ========== */
/* ================================== */

.categories-container.hidden {
  transform: translateY(-100%);
  opacity: 0;
  pointer-events: none;
  display: none !important;
}

.categories-container.fade-out {
  animation: fadeOutUp 0.3s ease-in-out forwards;
  display: flex !important;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  overflow: hidden;
}

@keyframes fadeOutUp {
  from {
    transform: translateY(0);
    opacity: 1;
    display: flex;
  }
  to {
    transform: translateY(-100%);
    opacity: 0;
    display: flex;
  }
}

@keyframes fadeInDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
    display: flex;
  }
  to {
    transform: translateY(0);
    opacity: 1;
    display: flex;
  }
}

.categories-container.show {
  animation: fadeInDown 0.3s ease-in-out forwards;
  display: flex !important;
}

/* ================================== */
/* ========== LAYOUT SWITCHER AUTO-HIDE ========== */
/* ================================== */

#layout-switcher-bar {
  transition: all 0.3s ease-in-out;
  transform: translateY(0);
  opacity: 1;
}

#layout-switcher-bar.hidden {
  display: none !important;
  height: 0;
  padding: 0;
  margin: 0;
  transform: translateY(-100%);
  opacity: 0;
  pointer-events: none;
}

#layout-switcher-bar.fade-out {
  animation: fadeOutUp 0.3s ease-in-out forwards;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  overflow: hidden;
}

#layout-switcher-bar.show {
  animation: fadeInDown 0.3s ease-in-out forwards;
}

/* ================================== */
/* ========== HEADER LEFT STYLES ========== */
/* ================================== */

.home-btn {
  background: none;
  border: none;
  color: var(--primary-color);
  font-size: 1.2rem;
  cursor: pointer;
  padding: 8px;
  border-radius: 50%;
  transition: all 0.3s ease;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.home-btn:hover {
  background: rgba(255, 107, 107, 0.1);
  transform: scale(1.1);
}



/* ================================== */
/* ========== HEADER TRANSPARENTE NO SCROLL ========== */
/* ================================== */

/* Header transparente quando rolar */
/* REMOVIDO: CSS que escondia o header - header deve sempre ficar vis√≠vel
.main-header.scrolled {
  background: transparent !important;
  backdrop-filter: none;
  transition: all 0.3s ease;
  height: 0;
  overflow: hidden;
}

.main-header.scrolled .header-left {
  opacity: 0;
  transform: translateY(-100%);
  transition: all 0.3s ease;
}

.main-header.scrolled .header-right {
  opacity: 0;
  transform: translateY(-100%);
  transition: all 0.3s ease;
}
*/

/* Menu sandu√≠che flutuante */
.floating-menu-toggle {
  position: fixed;
  top: 15px;
  right: 15px;
  width: 50px;
  height: 50px;
  background: var(--primary-color);
  border: none;
  border-radius: 50%;
  color: white;
  font-size: 1.2rem;
  cursor: pointer;
  z-index: 10001;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  transition: all 0.3s ease;
  opacity: 0;
  transform: scale(0.8);
  pointer-events: none;
  display: none; /* Oculto por padr√£o (desktop) */
}

/* Mostrar apenas em tablets e celulares */
@media (max-width: 1024px) {
  .floating-menu-toggle {
    display: block;
  }
}

.floating-menu-toggle.show {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto;
}

.floating-menu-toggle:hover {
  background: #c94040;
  transform: scale(1.1);
}

/* Menu flutuante expandido */
.floating-menu {
  position: fixed;
  top: 80px;
  right: 15px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
  z-index: 10000;
  opacity: 0;
  transform: translateY(-20px) scale(0.9);
  transition: all 0.3s ease;
  pointer-events: none;
  min-width: 200px;
}

.floating-menu.show {
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

.floating-menu a {
  display: block;
  padding: 15px 20px;
  color: var(--text-dark);
  text-decoration: none;
  border-bottom: 1px solid #f0f0f0;
  transition: all 0.3s ease;
}

.floating-menu a:last-child {
  border-bottom: none;
  border-radius: 0 0 15px 15px;
}

.floating-menu a:first-child {
  border-radius: 15px 15px 0 0;
}

.floating-menu a:hover {
  background: var(--primary-light);
  color: var(--primary-color);
}

/* Ajustar padding do body quando header est√° transparente */
body.header-transparent {
  padding-top: 0 !important;
}

/* Garantir que n√£o haja espa√ßo em branco no topo */
.main-header.scrolled {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  /* Garantir que o header sempre fique vis√≠vel mesmo com classe scrolled */
  height: 70px !important;
  opacity: 1 !important;
  visibility: visible !important;
  overflow: visible !important;
}

.main-header.scrolled .header-left,
.main-header.scrolled .header-right {
  opacity: 1 !important;
  transform: none !important;
  visibility: visible !important;
}

/* Ajustar posi√ß√£o das categorias quando header est√° transparente */
.categories-container.header-transparent {
  top: 0;
}


/* ================================== */
/* ========== POPUP DE CADASTRO ========== */
/* ================================== */

.cadastro-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  backdrop-filter: blur(5px);
}

.cadastro-popup.show {
  display: flex;
}

.cadastro-popup__content {
  background: white;
  border-radius: 20px;
  padding: 0;
  max-width: 400px;
  width: 90%;
  max-height: 80vh;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  animation: popupSlideIn 0.3s ease-out;
}

@keyframes popupSlideIn {
  from {
    opacity: 0;
    transform: scale(0.8) translateY(-50px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.cadastro-popup__header {
  background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
  color: white;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.cadastro-popup__header h3 {
  margin: 0;
  font-size: 1.3rem;
  font-weight: 600;
}

.cadastro-popup__close {
  background: none;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 5px;
  border-radius: 50%;
  transition: background-color 0.3s ease;
}

.cadastro-popup__close:hover {
  background: rgba(255, 255, 255, 0.2);
}

.cadastro-popup__options {
  padding: 20px;
}

.cadastro-option {
  display: flex;
  align-items: center;
  padding: 20px;
  margin-bottom: 15px;
  background: #f8f9fa;
  border-radius: 15px;
  text-decoration: none;
  color: #333;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.cadastro-option:hover {
  background: #e9ecef;
  border-color: #ff6b6b;
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255, 107, 107, 0.2);
}

.cadastro-option:last-child {
  margin-bottom: 0;
}

.cadastro-option__icon {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  color: white;
  font-size: 1.2rem;
}

.cadastro-option__text h4 {
  margin: 0 0 5px 0;
  font-size: 1.1rem;
  font-weight: 600;
  color: #333;
}

.cadastro-option__text p {
  margin: 0;
  font-size: 0.9rem;
  color: #666;
}

/* Responsivo para telas muito pequenas */
@media (max-width: 480px) {
  .cadastro-popup__content {
    width: 95%;
    margin: 10px;
  }
  
  .cadastro-popup__header {
    padding: 15px;
  }
  
  .cadastro-popup__header h3 {
    font-size: 1.1rem;
  }
  
  .cadastro-popup__options {
    padding: 15px;
  }
  
  .cadastro-option {
    padding: 15px;
  }
  
  .cadastro-option__icon {
    width: 40px;
    height: 40px;
    font-size: 1rem;
  }
  
  .cadastro-option__text h4 {
    font-size: 1rem;
  }
  
  .cadastro-option__text p {
    font-size: 0.8rem;
  }
}

/* ===== CARROSSEL PREMIUM - ESTILO ELEMENTOR ===== */
.premium-swiper-container {
  width: 100%;
  margin-bottom: 2rem;
  position: relative;
}

.premium-swiper {
  width: 100%;
  padding: 30px 0;
}

.premium-swiper .swiper-slide {
  background: #000;
  border-radius: 20px;
  overflow: hidden;
  position: relative;
  transition: transform 0.3s ease;
  height: 400px;
}

.premium-swiper .swiper-slide:hover {
  transform: scale(1.05);
  z-index: 10;
}

.premium-swiper .premium-card-link {
  display: block;
  width: 100%;
  height: 100%;
  text-decoration: none;
  color: inherit;
}

.premium-swiper .card-image-wrapper {
  width: 100%;
  height: 100%;
  position: relative;
}

.premium-swiper .card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: all 0.4s ease;
}

.premium-swiper .swiper-slide:hover .card-image {
  transform: scale(1.1);
}

.premium-swiper .card-info {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  padding: 20px 15px;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
  text-align: center;
}

.premium-swiper .card-name {
  font-size: 1.3rem;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
  margin: 0;
}

/* Setas de navega√ß√£o */
.premium-swiper .swiper-button-prev,
.premium-swiper .swiper-button-next {
  color: #fff;
  transition: 0.3s;
}

.premium-swiper .swiper-button-prev:hover,
.premium-swiper .swiper-button-next:hover {
  color: #ff2e88;
  transform: scale(1.2);
}

/* Responsividade */
@media (max-width: 1024px) {
  .premium-swiper {
    width: 95%;
  }
  
  .premium-swiper .swiper-slide {
    height: 350px;
  }
}

@media (max-width: 768px) {
  .premium-swiper .swiper-slide {
    height: 300px;
  }
  
  .premium-swiper .card-name {
    font-size: 1rem;
  }
  
  .premium-swiper .card-info {
    padding: 15px 12px;
  }
}

@media (max-width: 480px) {
  .premium-swiper .swiper-slide {
    height: 280px;
  }
  
  .premium-swiper .card-name {
    font-size: 0.9rem;
  }
  
  .premium-swiper .card-info {
    padding: 12px 10px;
  }
}

/* === DESTAQUE LILIPOP === */
.lilipop-highlight {
  position: relative;
  border: 3px solid #ffd700 !important;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.5) !important;
  animation: lilipopPulse 2s infinite;
}

.lilipop-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  background: linear-gradient(45deg, #ff6b6b, #ffd700);
  color: white;
  padding: 5px 10px;
  border-radius: 15px;
  font-size: 12px;
  font-weight: bold;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  z-index: 10;
}

@keyframes lilipopPulse {
  0% { 
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    transform: scale(1);
  }
  50% { 
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
    transform: scale(1.02);
  }
  100% { 
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    transform: scale(1);
  }
}

/* Destaque especial para o card lilipop */
.lilipop-highlight .card-image-wrapper {
  position: relative;
  overflow: hidden;
}

.lilipop-highlight .card-image-wrapper::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent 30%, rgba(255, 215, 0, 0.1) 50%, transparent 70%);
  animation: lilipopShine 3s infinite;
  z-index: 1;
}

@keyframes lilipopShine {
  0% { transform: translateX(-100%); }
  50% { transform: translateX(100%); }
  100% { transform: translateX(100%); }
}

</style>
  </head>
  <body>

  <!-- Indicador de Localiza√ß√£o -->
  <div id="location-indicator" style="display: none;"></div>

  <!-- Header ser√° carregado dinamicamente via load-header.js -->
  <div id="header-placeholder"></div>

  <!-- Menu de Categorias -->
  <div class="categories-container">
    <a href="A_02__premium_copy.html" class="category-link">Mulheres</a>
    <a href="A_02__premium_massagistas_copy.html" class="category-link">Massagistas</a>
    <a href="A_02__premium_sexo-virtual_copy.html" class="category-link active">Sexo Virtual</a>
  </div>

  <!-- Barra de Layouts (Mobile) -->
  <div id="layout-switcher-bar">
    <div id="layout_anuncios">
      <i class="fas fa-list layout-icon active" data-layout="n7" title="Lista"></i>
      <i class="fas fa-th-large layout-icon" data-layout="n2" title="2 Colunas"></i>
      <i class="fas fa-th layout-icon" data-layout="n3" title="3 Colunas"></i>
      <i class="fas fa-newspaper layout-icon" data-layout="n1" title="Destaque"></i>
    </div>
  </div>

  <!-- Menu Flutuante para Mobile/Tablet -->
  <button class="floating-menu-toggle" id="floatingMenuToggle">
    <i class="fas fa-bars"></i>
  </button>
  
  <div class="floating-menu" id="floatingMenu">
    <a href="index.html">In√≠cio</a>
    <a href="premium.html">An√∫ncios</a>
    <a href="#">Favoritos</a>
    <a href="#">Contato</a>
  </div>

  <!-- Stories Section -->
  <section class="stories-section">
    <h2>Stories em Destaque</h2>
    <div class="stories-scroll" id="stories-wrapper">
      <!-- Stories ser√£o inseridos aqui via JavaScript -->
    </div>
  </section>

  <!-- Conte√∫do Principal -->
  <div class="content-section">
    
    <!-- Indicador de Fonte de Dados -->
    <div id="data-source-indicator" class="data-source-indicator" style="display: none;">
      <span id="data-source-text">Carregando dados do Firebase...</span>
    </div>
    
    <!-- Galeria de An√∫ncios -->
    <div id="gallery-grid" class="layout-n7">
      <!-- Cards ser√£o inseridos aqui via JavaScript -->
    </div>


  </div>

  <!-- Mobile Navbar -->
  <nav class="mobile-navbar">
    <ul class="mobile-navbar-container">
      <li class="nav-item active">
        <a href="A_01__index.html" class="nav-link">
          <i class="fas fa-home"></i>
          <span>In√≠cio</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="fas fa-search"></i>
          <span>Buscar</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="fas fa-heart"></i>
          <span>Favoritos</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link" onclick="openCadastroPopup(); return false;">
          <i class="fas fa-user"></i>
          <span>Cadastrar</span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Modal de Perfil -->
  <div id="profile-window">
    <header>
      <h3 id="profile-name">Nome do Perfil</h3>
      <button class="close-btn" onclick="closeProfileModal()">
        <i class="fas fa-times"></i>
      </button>
    </header>
    
    <div class="carousel-container">
      <div class="carousel" id="profile-carousel">
        <!-- Fotos do perfil ser√£o inseridas aqui -->
      </div>
      <div class="carousel-nav" id="carousel-nav">
        <!-- Navega√ß√£o do carrossel ser√° inserida aqui -->
      </div>
    </div>
    
    <p class="profile-phrase" id="profile-phrase">Frase do perfil</p>
  </div>

  <!-- Popup de Cadastro -->
  <div id="cadastro-popup" class="cadastro-popup">
    <div class="cadastro-popup__content">
      <div class="cadastro-popup__header">
        <h3>Escolha o tipo de cadastro</h3>
        <button class="cadastro-popup__close" onclick="closeCadastroPopup()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="cadastro-popup__options">
        <a href="register.html" class="cadastro-option">
          <div class="cadastro-option__icon">
            <i class="fas fa-user-plus"></i>
          </div>
          <div class="cadastro-option__text">
            <h4>Cadastrar Cliente</h4>
            <p>Para quem procura servi√ßos</p>
          </div>
        </a>
        <a href="cadastro_simples_copy.html" class="cadastro-option">
          <div class="cadastro-option__icon">
            <i class="fas fa-star"></i>
          </div>
          <div class="cadastro-option__text">
            <h4>Cadastro de Acompanhante</h4>
            <p>Para quem oferece servi√ßos</p>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- Overlay para menu mobile -->
  <div class="menu-overlay" id="menu-overlay"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="firebase-config.js"></script>

  <script>
// --- DADOS DOS PERFIS (Carregados do Firebase) ---
let PROFILES_DATA = [];

// Inicializar Firebase
let db = null;
let auth = null;

// Aguardar Firebase e configura√ß√£o estarem prontos
document.addEventListener('DOMContentLoaded', function() {
  if (typeof firebase !== 'undefined' && window.firebaseConfig) {
    firebase.initializeApp(firebaseConfig);
    db = firebase.firestore();
    auth = firebase.auth();
    console.log('‚úÖ Firebase inicializado com sucesso');
    
    // Verificar autentica√ß√£o e atualizar bot√£o de login
    auth.onAuthStateChanged((user) => {
      updateLoginButton(user);
    });
  } else {
    console.error('‚ùå Firebase n√£o configurado. Verifique firebase-config.js');
  }
});

// Atualizar bot√£o de login baseado no estado de autentica√ß√£o
function updateLoginButton(user) {
  const btnLogin = document.getElementById('btnLogin');
  const loginText = document.getElementById('loginText');
  const loginTextMobile = document.getElementById('loginTextMobile');
  const loginDropdown = document.getElementById('loginDropdown');
  const loginDropdownMobile = document.getElementById('loginDropdownMobile');
  
  if (user) {
    // Usu√°rio logado - mostrar dropdown
    if (loginText) loginText.textContent = user.email || 'Minha Conta';
    if (loginTextMobile) loginTextMobile.textContent = user.email || 'Conta';
    if (btnLogin) {
      btnLogin.onclick = (e) => toggleLoginDropdown(e);
    }
  } else {
    // Usu√°rio n√£o logado - mostrar modal de login
    if (loginText) loginText.textContent = 'Login';
    if (loginTextMobile) loginTextMobile.textContent = 'Login';
    if (btnLogin) {
      btnLogin.onclick = () => document.getElementById('loginModal').classList.add('show');
    }
    if (loginDropdown) loginDropdown.style.display = 'none';
    if (loginDropdownMobile) loginDropdownMobile.style.display = 'none';
  }
}

// Toggle dropdown do login (desktop)
function toggleLoginDropdown(event) {
  event.preventDefault();
  event.stopPropagation();
  
  const user = auth?.currentUser;
  if (!user) {
    // Se n√£o estiver logado, abrir modal de login
    document.getElementById('loginModal').classList.add('show');
    return;
  }
  
  const dropdown = document.getElementById('loginDropdown');
  const isVisible = dropdown.style.display === 'block';
  
  if (isVisible) {
    dropdown.style.display = 'none';
    document.removeEventListener('click', closeDropdownOnClickOutside);
  } else {
    dropdown.style.display = 'block';
    // Fechar ao clicar fora
    setTimeout(() => {
      document.addEventListener('click', closeDropdownOnClickOutside);
    }, 100);
  }
}

// Toggle dropdown do login (mobile)
function toggleLoginDropdownMobile(event) {
  event.preventDefault();
  event.stopPropagation();
  
  const user = auth?.currentUser;
  if (!user) {
    // Se n√£o estiver logado, abrir modal de login
    document.getElementById('loginModal').classList.add('show');
    return;
  }
  
  const dropdown = document.getElementById('loginDropdownMobile');
  const isVisible = dropdown.style.display === 'block';
  
  if (isVisible) {
    dropdown.style.display = 'none';
    document.removeEventListener('click', closeDropdownOnClickOutsideMobile);
  } else {
    dropdown.style.display = 'block';
    // Fechar ao clicar fora
    setTimeout(() => {
      document.addEventListener('click', closeDropdownOnClickOutsideMobile);
    }, 100);
  }
}

// Fechar dropdown ao clicar fora (desktop)
function closeDropdownOnClickOutside(event) {
  const dropdown = document.getElementById('loginDropdown');
  const container = document.getElementById('loginContainer');
  
  if (dropdown && container && !container.contains(event.target)) {
    dropdown.style.display = 'none';
    document.removeEventListener('click', closeDropdownOnClickOutside);
  }
}

// Fechar dropdown ao clicar fora (mobile)
function closeDropdownOnClickOutsideMobile(event) {
  const dropdown = document.getElementById('loginDropdownMobile');
  const container = document.getElementById('loginContainerMobile');
  
  if (dropdown && container && !container.contains(event.target)) {
    dropdown.style.display = 'none';
    document.removeEventListener('click', closeDropdownOnClickOutsideMobile);
  }
}

// Fun√ß√£o de logout
async function handleLogout(event) {
  event.preventDefault();
  
  try {
    if (auth) {
      await auth.signOut();
      console.log('‚úÖ Logout realizado com sucesso');
      
      // Fechar dropdowns
      const dropdown = document.getElementById('loginDropdown');
      const dropdownMobile = document.getElementById('loginDropdownMobile');
      if (dropdown) dropdown.style.display = 'none';
      if (dropdownMobile) dropdownMobile.style.display = 'none';
      
      // Atualizar bot√£o de login
      updateLoginButton(null);
      
      // Recarregar p√°gina
      window.location.reload();
    }
  } catch (error) {
    console.error('‚ùå Erro ao fazer logout:', error);
    alert('Erro ao fazer logout. Tente novamente.');
  }
}

// Fun√ß√£o de Login com Firebase Auth
async function handleLogin(event) {
  event.preventDefault();
  
  const email = document.getElementById('user_email')?.value;
  const password = document.getElementById('user_password')?.value;
  
  if (!email || !password) {
    alert('Por favor, preencha todos os campos (email e senha).');
    return;
  }

  try {
    console.log('üîê Tentando fazer login com Firebase Auth:', email);
    
    if (!auth) {
      alert('Firebase n√£o inicializado. Aguarde e tente novamente.');
      return;
    }
    
    const userCredential = await auth.signInWithEmailAndPassword(email, password);
    const user = userCredential.user;
    
    console.log('‚úÖ Login realizado com sucesso:', user.email);
    
    const loginModal = document.getElementById('loginModal');
    if (loginModal) loginModal.classList.remove('show');
    
    document.getElementById('user_email').value = '';
    document.getElementById('user_password').value = '';
    
    updateLoginButton(user);
    alert('Login realizado com sucesso! Bem-vindo(a), ' + (user.displayName || user.email));
    
  } catch (error) {
    console.error('‚ùå Erro ao fazer login:', error);
    let mensagem = 'Erro ao fazer login. ';
    switch (error.code) {
      case 'auth/user-not-found': mensagem += 'Usu√°rio n√£o encontrado.'; break;
      case 'auth/wrong-password': mensagem += 'Senha incorreta.'; break;
      case 'auth/invalid-email': mensagem += 'Email inv√°lido.'; break;
      case 'auth/user-disabled': mensagem += 'Conta desativada.'; break;
      case 'auth/too-many-requests': mensagem += 'Muitas tentativas. Aguarde.'; break;
      case 'auth/invalid-credential': mensagem += 'Email ou senha incorretos.'; break;
      default: mensagem += error.message;
    }
    alert(mensagem);
  }
}

// Fun√ß√£o loadStaticProfiles() removida - n√£o utilizada (c√≥digo morto ~1450 linhas)
// Os dados agora v√™m exclusivamente do Firebase via loadProfilesFromFirebase()

// Fun√ß√£o para carregar perfis diretamente do Firebase Firestore
async function loadProfilesFromFirebase() {
  try {
    console.log("üî• Carregando perfis diretamente do Firebase Firestore...");
    
    // Mostrar indicador de carregamento
    showDataSourceIndicator("Carregando dados do Firebase...", "loading");
    
    // Aguardar Firebase estar inicializado
    let attempts = 0;
    while (!db && attempts < 10) {
      await new Promise(resolve => setTimeout(resolve, 100));
      attempts++;
      if (typeof firebase !== 'undefined' && window.firebaseConfig && !db) {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        auth = firebase.auth();
      }
    }
    
    // Verificar se Firebase est√° inicializado
    if (!db) {
      throw new Error("Firebase n√£o inicializado. Verifique firebase-config.js");
    }
    
    console.log("‚úÖ Firebase Firestore inicializado:", {
      db: !!db,
      app: db.app?.name || 'n√£o definido',
      type: typeof db.collection
    });
    
    // Buscar an√∫ncios diretamente do Firestore
    // Tentar cole√ß√£o 'anuncios' primeiro, depois 'advertisements'
    // MODO TESTE: Buscar TODOS os an√∫ncios (ativo, aguardando_verificacao, etc.)
    let snapshot = null;
    let collectionName = null;
    
    console.log("üîç Verificando cole√ß√µes dispon√≠veis...");
    console.log("üîç db:", db);
    console.log("üîç db.collection:", typeof db.collection);
    
    // CORRE√á√ÉO: Buscar em AMBAS as cole√ß√µes e combinar resultados
    let snapshotAnuncios = null;
    let snapshotAdvertisements = null;
    
    try {
      // Buscar na cole√ß√£o 'anuncios'
      console.log("üîç Tentando buscar na cole√ß√£o 'anuncios'...");
      const anunciosRef = db.collection('anuncios');
      snapshotAnuncios = await anunciosRef.get();
      console.log("‚úÖ Snapshot obtido da cole√ß√£o 'anuncios'");
      console.log("üìä anuncios.size:", snapshotAnuncios.size);
      
      // DEBUG: Mostrar primeiros documentos encontrados
      if (snapshotAnuncios.size > 0) {
        console.log("üìÑ Primeiros 3 documentos da cole√ß√£o 'anuncios':");
        snapshotAnuncios.docs.slice(0, 3).forEach((doc, idx) => {
          const data = doc.data();
          console.log(`   Documento ${idx + 1} (ID: ${doc.id}):`, {
            nome: data.nome || data.name || 'sem nome',
            categoria: data.categoria || data.category || 'sem categoria',
            genero: data.genero || data.gender || 'sem genero',
            status: data.status || 'sem status',
            email: data.email || 'sem email',
            campos: Object.keys(data)
          });
        });
      }
    } catch (e) {
      console.warn("‚ö†Ô∏è Erro ao buscar na cole√ß√£o 'anuncios':", e);
      console.error("‚ùå Detalhes do erro:", e.message, e.code);
      snapshotAnuncios = { docs: [], empty: true, size: 0 };
    }
    
    try {
      // Buscar na cole√ß√£o 'advertisements' tamb√©m
      console.log("üîç Tentando buscar na cole√ß√£o 'advertisements'...");
      const advertisementsRef = db.collection('advertisements');
      snapshotAdvertisements = await advertisementsRef.get();
      console.log("‚úÖ Snapshot obtido da cole√ß√£o 'advertisements'");
      console.log("üìä advertisements.size:", snapshotAdvertisements.size);
      
      // DEBUG: Mostrar primeiros documentos encontrados
      if (snapshotAdvertisements.size > 0) {
        console.log("üìÑ Primeiros 3 documentos da cole√ß√£o 'advertisements':");
        snapshotAdvertisements.docs.slice(0, 3).forEach((doc, idx) => {
          const data = doc.data();
          console.log(`   Documento ${idx + 1} (ID: ${doc.id}):`, {
            nome: data.nome || data.name || 'sem nome',
            categoria: data.categoria || data.category || 'sem categoria',
            genero: data.genero || data.gender || 'sem genero',
            status: data.status || 'sem status',
            email: data.email || 'sem email',
            campos: Object.keys(data)
          });
        });
      }
    } catch (e) {
      console.warn("‚ö†Ô∏è Erro ao buscar na cole√ß√£o 'advertisements':", e);
      console.error("‚ùå Detalhes do erro:", e.message, e.code);
      snapshotAdvertisements = { docs: [], empty: true, size: 0 };
    }
    
    // Combinar documentos de ambas as cole√ß√µes
    const allDocs = [];
    snapshotAnuncios.docs.forEach(doc => {
      allDocs.push({ ...doc.data(), id: doc.id, _collection: 'anuncios' });
    });
    snapshotAdvertisements.docs.forEach(doc => {
      allDocs.push({ ...doc.data(), id: doc.id, _collection: 'advertisements' });
    });
    
    // Criar um snapshot simulado para compatibilidade
    snapshot = {
      docs: allDocs.map((data, idx) => ({
        id: data.id,
        data: () => {
          const { id, _collection, ...rest } = data;
          return rest;
        }
      })),
      empty: allDocs.length === 0,
      size: allDocs.length,
      forEach: function(callback) {
        this.docs.forEach((doc, idx) => {
          callback({
            id: doc.id,
            data: doc.data
          });
        });
      }
    };
    
    console.log(`üìä ${snapshot.size} documentos encontrados no total (${snapshotAnuncios.size} de 'anuncios' + ${snapshotAdvertisements.size} de 'advertisements')`);
    
    if (snapshot.empty) {
      console.warn("‚ö†Ô∏è Nenhum an√∫ncio encontrado nas cole√ß√µes 'anuncios' ou 'advertisements'");
      PROFILES_DATA = [];
      showDataSourceIndicator("‚ö†Ô∏è Nenhum an√∫ncio encontrado", "warning");
      return PROFILES_DATA;
    }
    
    // Converter documentos para formato de perfil
    let advertisements = [];
    
    // Usar o m√©todo forEach do snapshot simulado
    if (snapshot && !snapshot.empty && snapshot.size > 0) {
      // Usar o m√©todo forEach do snapshot simulado
      snapshot.forEach((doc) => {
        const data = doc.data();
        console.log(`üìÑ Processando documento ${doc.id}:`, {
          id: doc.id,
          nome: data.nome || data.name || 'sem nome',
          categoria: data.categoria || data.category || 'sem categoria',
          genero: data.genero || data.gender || 'sem genero',
          status: data.status || 'sem status',
          colecao: data._collection || 'desconhecida',
          temTodosCampos: Object.keys(data).length
        });
        advertisements.push({
          id: doc.id,
          _id: doc.id, // Compatibilidade
          ...data
        });
      });
    } else if (allDocs && allDocs.length > 0) {
      // Fallback: usar allDocs diretamente se o snapshot n√£o funcionar
      console.log("‚ö†Ô∏è Usando fallback: processando allDocs diretamente");
      allDocs.forEach((data) => {
        const { _collection, ...restData } = data;
        advertisements.push({
          id: data.id,
          _id: data.id,
          ...restData
        });
      });
    } else {
      console.warn("‚ö†Ô∏è Snapshot est√° vazio ou n√£o existe!");
      console.warn("‚ö†Ô∏è Poss√≠veis causas:");
      console.warn("   1. Regras de seguran√ßa do Firestore podem estar bloqueando a leitura");
      console.warn("   2. A cole√ß√£o 'anuncios' pode estar vazia");
      console.warn("   3. O an√∫ncio pode estar em outra cole√ß√£o");
      console.warn("   4. Verifique no console do Firebase se h√° documentos na cole√ß√£o 'anuncios'");
      
      // Tentar verificar se conseguimos acessar a cole√ß√£o (mesmo que vazia)
      try {
        const testRef = db.collection('anuncios');
        const testSnapshot = await testRef.limit(1).get();
        console.log("üîç Teste de acesso √† cole√ß√£o:", {
          conseguiuAcessar: true,
          snapshotEmpty: testSnapshot.empty,
          snapshotSize: testSnapshot.size,
          erro: null
        });
      } catch (testError) {
        console.error("‚ùå ERRO ao tentar acessar a cole√ß√£o 'anuncios':", testError);
        console.error("‚ùå Isso pode indicar um problema com as regras de seguran√ßa do Firestore");
      }
    }
    
    // Log detalhado dos an√∫ncios encontrados para debug
    console.log(`üìã ${advertisements.length} an√∫ncios processados do snapshot`);
    
    if (advertisements.length === 0) {
      console.log("üìã Dados completos de TODOS os an√∫ncios antes do filtro:", advertisements.map(ad => ({
        id: ad.id,
        nome: ad.nome || ad.name,
        categoria: ad.categoria || ad.category,
        genero: ad.genero || ad.gender,
        status: ad.status,
        test: ad.test,
        todosCampos: Object.keys(ad)
      })));
    }
    
    // Log ANTES do filtro para debug
    console.log(`üìä ANTES DO FILTRO: ${advertisements.length} an√∫ncios`);
    console.log("üìã Primeiros 3 an√∫ncios antes do filtro:", advertisements.slice(0, 3).map(ad => ({
      id: ad.id,
      nome: ad.nome || ad.name || 'sem nome',
      categoria: ad.categoria || ad.category || 'sem categoria',
      genero: ad.genero || ad.gender || 'sem genero',
      status: ad.status || 'sem status',
      test: ad.test
    })));
    
    // FILTRO PARA P√ÅGINA DE SEXO VIRTUAL (MULHERES)
    // Esta p√°gina deve mostrar APENAS an√∫ncios de Sexo Virtual cadastrados por MULHERES
    console.log("üîç Aplicando filtro para p√°gina de Sexo Virtual (apenas mulheres)");
    const antesFiltro = advertisements.length;
    
    advertisements = advertisements.filter(ad => {
      // Ignorar an√∫ncios de teste
      if (ad.test === true) {
        console.log(`üö´ An√∫ncio de teste ignorado: ${ad.nome || ad.id}`);
        return false;
      }
      
      // Normalizar categoria (pode estar em categoria ou category)
      const categoria = (ad.categoria || ad.category || ad.tipo || '').toLowerCase().trim();
      
      // Normalizar g√™nero (pode estar em genero, gender, ou sexo)
      const genero = (ad.gender || ad.genero || ad.sexo || '').toLowerCase().trim();
      
      // Verificar se √© mulher (pode estar em genero, gender, ou ser mulher-luxo)
      const isMulher = genero === 'mulher' || 
                       genero === 'mulher-luxo' || 
                       genero === 'mulher de luxo' ||
                       categoria === 'mulher' ||
                       categoria === 'mulher-luxo' ||
                       categoria === 'mulher de luxo';
      
      // Verificar se √© Sexo Virtual
      // Pode ser identificado por:
      // - categoria contendo "sexo-virtual" ou "sexo virtual" ou "virtual"
      // - categoria sendo "sexo-virtual"
      // - combina√ß√£o de g√™nero mulher + categoria virtual
      const isSexoVirtual = categoria.includes('sexo-virtual') || 
                            categoria.includes('sexo virtual') ||
                            categoria === 'sexo-virtual' ||
                            categoria === 'virtual' ||
                            (categoria.includes('virtual') && isMulher);
      
      // EXCLUIR an√∫ncios que n√£o s√£o de Sexo Virtual
      if (!isSexoVirtual) {
        console.log(`üö´ An√∫ncio n√£o √© de Sexo Virtual: ${ad.nome || ad.id}`, { categoria, genero });
        return false;
      }
      
      // EXCLUIR an√∫ncios que n√£o s√£o de mulheres
      if (!isMulher) {
        console.log(`üö´ An√∫ncio de Sexo Virtual n√£o √© de mulher (exclu√≠do): ${ad.nome || ad.id}`, { categoria, genero });
        return false;
      }
      
      // Verificar status (ativo ou aguardando verifica√ß√£o)
      const status = (ad.status || '').toLowerCase().trim();
      const statusOk = status === 'ativo' || 
                       status === 'active' || 
                       status === 'aguardando_verificacao' ||
                       status === 'aguardando verificacao' ||
                       status === ''; // Aceitar sem status definido
      
      // Aplicar filtros: deve ser Sexo Virtual + Mulher + Status OK
      const passou = isSexoVirtual && isMulher && statusOk;
      
      if (!passou) {
        console.log(`üö´ An√∫ncio filtrado: ${ad.nome || ad.id || ad.advertiserId}`, {
          categoria,
          genero: genero || '(n√£o definido)',
          isSexoVirtual,
          isMulher,
          status: status || '(n√£o definido)',
          statusOk,
          motivo: !isSexoVirtual ? 'n√£o √© Sexo Virtual' :
                  !isMulher ? 'n√£o √© mulher' : 
                  !statusOk ? 'status inv√°lido' : 'desconhecido'
        });
      } else {
        console.log(`‚úÖ An√∫ncio aceito: ${ad.nome || ad.id || ad.advertiserId}`, {
          categoria,
          genero: genero || '(n√£o definido, assumido mulher)',
          status: status || '(n√£o definido)'
        });
      }
      
      return passou;
    });
    
    console.log(`üìä DEPOIS DO FILTRO: ${advertisements.length} an√∫ncios (${antesFiltro - advertisements.length} foram filtrados)`);
    
    console.log("üìã TODOS os an√∫ncios que passaram no filtro:", advertisements.map(ad => ({
      id: ad.id,
      nome: ad.nome || ad.name,
      categoria: ad.categoria || ad.category,
      genero: ad.genero || ad.gender,
      status: ad.status,
      plano: ad.plano || ad.nivel
    })));
    
    // Converter para formato PROFILES_DATA
    PROFILES_DATA = advertisements.map((ad, index) => {
      // Determinar imagem principal
      const mainImage = 
        ad.foto_capa_url ||           // URL da foto de capa (prioridade)
        ad.foto_capa ||               // Foto de capa do Firebase
        ad.foto_banner_url ||         // URL da foto de banner
        ad.foto_banner ||             // Foto de banner do Firebase
        ad.coverImage ||              // Imagem de capa alternativa
        ad.fotoPerfil ||              // Foto de perfil do Firebase
        ad.mediaFiles?.foto_capa ||   // Foto de capa do Firebase
        ad.mediaFiles?.galeria?.[0] || // Primeira foto da galeria
        "https://picsum.photos/300/400?random=" + Math.random();
      
      // Usar plano do banco de dados (plano ou nivel como fallback para compatibilidade)
      // MODO TESTE: Todos os an√∫ncios sem plano definido ser√£o considerados PLUS
      let plano = ad.plano || ad.nivel || 'plus'; // Default mudado para 'plus'
      
      // Normalizar planos
      if (plano && typeof plano === 'string') {
        plano = plano.toLowerCase().trim();
        // Mapear n√≠veis antigos para planos novos (compatibilidade)
        if (plano.includes('n1') || plano.includes('camarote')) {
          plano = 'camarote';
        } else if (plano.includes('n3') || plano.includes('especial')) {
          plano = 'especial';
        } else if (plano.includes('n7') || plano.includes('plus')) {
          plano = 'plus';
        } else if (!['basico', 'plus', 'especial', 'camarote', 'vip'].includes(plano)) {
          plano = 'plus'; // Default mudado para 'plus' (modo teste)
        }
      } else {
        plano = 'plus'; // Default para 'plus' se n√£o houver plano definido
      }
      
      return {
        id: ad.id || ad._id || `temp-${index}`,
        name: ad.nome || ad.name || ad.nomeAnuncio || ad.nomeCompleto || 'An√¥nimo',
        nome: ad.nome || ad.name || ad.nomeAnuncio || ad.nomeCompleto || 'An√¥nimo',
        phrase: ad.descricao || ad.description || ad.frase || ad.phrase || '',
        image: mainImage,
        cidade: ad.cidade || ad.city || '',
        estado: ad.estado || ad.state || '',
        preco_1h: ad.preco_1h || ad.preco || ad.price || '',
        status: ad.status || 'ativo',
        plano: plano,
        nivel: plano, // Compatibilidade
        destaque: ad.destaque || plano === 'camarote',
        premium: true,
        foto_stories: ad.foto_stories || mainImage,
        originalData: ad // Manter dados originais para refer√™ncia
      };
    });
    
    console.log(`üìä ${PROFILES_DATA.length} perfis convertidos e prontos para exibi√ß√£o`);
    console.log("üìã Resumo dos perfis:", {
      total: PROFILES_DATA.length,
      porPlano: {
        camarote: PROFILES_DATA.filter(p => p.plano === 'camarote').length,
        especial: PROFILES_DATA.filter(p => p.plano === 'especial').length,
        plus: PROFILES_DATA.filter(p => p.plano === 'plus').length,
        basico: PROFILES_DATA.filter(p => p.plano === 'basico').length,
        vip: PROFILES_DATA.filter(p => p.plano === 'vip').length
      },
      perfis: PROFILES_DATA.map(p => ({
        id: p.id,
        name: p.name,
        plano: p.plano,
        status: p.status
      }))
    });
    
    // Mostrar indicador de sucesso
    console.log(`‚úÖ Total de perfis carregados: ${PROFILES_DATA.length}`);
    showDataSourceIndicator(`‚úÖ ${PROFILES_DATA.length} perfis carregados do Firebase`, "success");
    
    // Se n√£o houver perfis, mostrar mensagem de debug
    if (PROFILES_DATA.length === 0) {
      console.warn("‚ö†Ô∏è ATEN√á√ÉO: Nenhum perfil foi carregado!");
      console.warn("‚ö†Ô∏è Verifique:");
      console.warn("   1. Se h√° documentos nas cole√ß√µes 'anuncios' ou 'advertisements'");
      console.warn("   2. Se os documentos t√™m os campos 'categoria' e 'status' corretos");
      console.warn("   3. Se as regras de seguran√ßa do Firestore permitem leitura");
      console.warn("   4. Abra o console do navegador (F12) para ver logs detalhados");
    }
    
    return PROFILES_DATA;
  } catch (error) {
    console.error("‚ùå Erro ao carregar perfis do Firebase:", error);
    console.error("‚ùå Stack trace:", error.stack);
    
    // Mensagem de erro mais detalhada
    let errorMessage = "‚ùå Erro ao carregar dados do Firebase";
    if (error.code === 'permission-denied' || error.message.includes('permission')) {
      errorMessage = "‚ùå PERMISS√ÉO NEGADA: Configure as regras do Firestore no console do Firebase";
      console.error("üî¥ SOLU√á√ÉO:");
      console.error("   1. Acesse: https://console.firebase.google.com/");
      console.error("   2. Selecione o projeto: mansao-do-job");
      console.error("   3. V√° em Firestore Database ‚Üí Regras");
      console.error("   4. Cole as regras do arquivo: firestore.rules");
      console.error("   5. Clique em 'Publicar'");
      
      // Mostrar alerta visual na p√°gina
      const errorDiv = document.createElement('div');
      errorDiv.style.cssText = `
        position: fixed;
        top: 120px;
        left: 50%;
        transform: translateX(-50%);
        background: #ff4444;
        color: white;
        padding: 20px 30px;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        z-index: 10000;
        max-width: 600px;
        text-align: center;
        font-size: 14px;
        line-height: 1.6;
      `;
      errorDiv.innerHTML = `
        <h3 style="margin: 0 0 10px 0; font-size: 18px;">‚ö†Ô∏è Erro de Permiss√£o do Firestore</h3>
        <p style="margin: 0 0 15px 0;">As regras de seguran√ßa est√£o bloqueando a leitura dos dados.</p>
        <p style="margin: 0 0 10px 0; font-weight: bold; font-size: 16px;">üîß Solu√ß√£o R√°pida:</p>
        <ol style="text-align: left; margin: 0 0 15px 0; padding-left: 20px; font-size: 13px;">
          <li>Acesse: <a href="https://console.firebase.google.com/project/mansao-do-job/firestore/rules" target="_blank" style="color: #fff; text-decoration: underline; font-weight: bold;">Console Firebase ‚Üí Regras</a></li>
          <li>Cole o c√≥digo abaixo no editor de regras</li>
          <li>Clique em <strong style="background: white; color: #ff4444; padding: 2px 8px; border-radius: 3px;">Publicar</strong></li>
          <li>Recarregue esta p√°gina</li>
        </ol>
        <details style="text-align: left; margin: 15px 0; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 5px;">
          <summary style="cursor: pointer; font-weight: bold; margin-bottom: 10px;">üìã C√≥digo das Regras (Clique para ver)</summary>
          <pre style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; overflow-x: auto; font-size: 11px; margin: 10px 0 0 0; white-space: pre-wrap; word-wrap: break-word;">rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /anuncios/{anuncioId} {
      allow read: if true;
      allow create, update, delete: if request.auth != null;
    }
    match /advertisements/{advertisementId} {
      allow read: if true;
      allow create, update, delete: if request.auth != null;
    }
    match /users/{userId} {
      allow read: if request.auth != null && request.auth.uid == userId;
      allow create, update: if request.auth != null && request.auth.uid == userId;
      allow delete: if false;
    }
    match /payments/{paymentId} {
      allow read: if request.auth != null && resource.data.userId == request.auth.uid;
      allow create: if request.auth != null;
      allow update, delete: if false;
    }
    match /{document=**} {
      allow read, write: if false;
    }
  }
}</pre>
          <button onclick="navigator.clipboard.writeText(this.previousElementSibling.textContent.trim()).then(() => { this.textContent = '‚úÖ Copiado!'; setTimeout(() => this.textContent = 'üìã Copiar Regras', 2000); })" style="
            background: white;
            color: #ff4444;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            margin-top: 10px;
          ">üìã Copiar Regras</button>
        </details>
        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
          <a href="https://console.firebase.google.com/project/mansao-do-job/firestore/rules" target="_blank" style="
            display: inline-block;
            background: white;
            color: #ff4444;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin-right: 10px;
          ">üöÄ Abrir Console Firebase</a>
          <button onclick="this.closest('div').remove()" style="
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
          ">Fechar</button>
        </div>
      `;
      document.body.appendChild(errorDiv);
    }
    
    showDataSourceIndicator(errorMessage, "error");
    PROFILES_DATA = [];
    return PROFILES_DATA;
  }
}

function formatLocation(estado, cidade) {
  if (!estado && !cidade) return '';
  if (!estado) return cidade;
  if (!cidade) return estado;
  return `${cidade}, ${estado}`;
}

// Fun√ß√£o auxiliar para determinar a p√°gina correta baseada na categoria do an√∫ncio
function getProfilePageUrl(anuncioId, anuncioNome, categoria, genero) {
  // Normalizar categoria e g√™nero
  const cat = (categoria || '').toLowerCase().trim();
  const gen = (genero || '').toLowerCase().trim();
  
  // Obter a p√°gina de origem atual para adicionar como par√¢metro returnPage
  const currentPage = window.location.pathname.split('/').pop() || 'A_02__premium_sexo-virtual_copy.html';
  const returnPageParam = `&returnPage=${encodeURIComponent(currentPage)}`;
  
  // Verificar se √© an√∫ncio de Sexo Virtual + Mulher
  // Apenas an√∫ncios de Mulher + Sexo Virtual devem usar a p√°gina espec√≠fica
  // Pode ser identificado por:
  // - categoria contendo "sexo-virtual" ou "sexo virtual" ou "virtual"
  // - categoria sendo "sexo-virtual"
  // - combina√ß√£o de g√™nero mulher/mulher de luxo + categoria virtual
  const isSexoVirtual = cat.includes('sexo-virtual') || 
                        cat.includes('sexo virtual') ||
                        cat === 'sexo-virtual' ||
                        cat === 'virtual' ||
                        cat.includes('virtual');
  
  const isMulher = gen.includes('mulher') || gen.includes('luxo');
  
  // Se for Sexo Virtual + Mulher, usar a p√°gina espec√≠fica
  if (isSexoVirtual && isMulher) {
    console.log(`üîç An√∫ncio de Sexo Virtual + Mulher detectado:`, { categoria: cat, genero: gen, anuncioId });
    return `A_02__premium-Perfil-Sexo_Virtual.html?id=${anuncioId}&name=${encodeURIComponent(anuncioNome)}${returnPageParam}`;
  }
  
  // Se for massagistas, usar a p√°gina espec√≠fica
  if (cat === 'massagistas' || cat === 'massagista') {
    return `A_02__premium_Anuncio_modelo_01_Massagistas.html?id=${anuncioId}&name=${encodeURIComponent(anuncioNome)}${returnPageParam}`;
  }
  
  // Para outras categorias, usar a p√°gina padr√£o
  return `A_02__premium_Anuncio_modelo_01.html?id=${anuncioId}&name=${encodeURIComponent(anuncioNome)}${returnPageParam}`;
}

function generateGridCards(level, profiles) {
  console.log(`üé® generateGridCards chamado:`, {
    level: level,
    profilesCount: profiles?.length || 0,
    profiles: profiles?.map(p => ({ id: p.id, name: p.name, plano: p.plano })) || []
  });
  
  if (!profiles || profiles.length === 0) {
    console.warn('‚ö†Ô∏è generateGridCards chamado sem perfis');
    return '';
  }
  
  let html = '';
  profiles.forEach((profile, index) => {
    // Criar link para p√°gina de perfil com par√¢metros ANTES de criar o card
    // Usar o ID do documento do Firebase (pode estar em originalData.id ou profile.id)
    const anuncioId = profile.originalData?.id || profile.originalData?._id || profile.id || profile._id;
    const anuncioNome = profile.name || profile.nome || 'An√¥nimo';
    // Obter categoria do an√∫ncio (pode estar em categoria ou category)
    const categoria = profile.categoria || profile.category || profile.originalData?.categoria || profile.originalData?.category || '';
    // Obter g√™nero do an√∫ncio (pode estar em genero, gender, ou sexo)
    const genero = profile.genero || profile.gender || profile.sexo || profile.originalData?.genero || profile.originalData?.gender || profile.originalData?.sexo || '';
    
    if (!anuncioId) {
      console.warn(`‚ö†Ô∏è An√∫ncio sem ID:`, profile);
    }
    
    const profileUrl = getProfilePageUrl(anuncioId, anuncioNome, categoria, genero);
    
    let cardContent;
    if (level === 'n1') {
      // Layout N1: Full Width Article (Camarote) - localiza√ß√£o removida para sexo virtual
      cardContent = `
        <article class="acompanhante-card">
          <div class="card-image-wrapper">
            <span class="virtual-badge">Apenas Virtual</span>
            <img loading="lazy" src="${profile.image}" alt="${profile.name}" class="card-image">
            <div class="card-overlay">
              <h3 class="card-name-overlay">${profile.nome || profile.name}</h3>
            </div>
          </div>
        </article>
      `;
    } else {
      // Layouts N2, N3 e N7 (Grid/Lista)
      // Detectar se √© foto em paisagem
      const isLandscape = profile.image.includes('|landscape');
      const imageUrl = profile.image.replace('|landscape', '');
      const landscapeClass = isLandscape ? 'landscape-photo' : '';
      
      // Layout especial para N3 - localiza√ß√£o removida para sexo virtual
      if (level === 'n3') {
        cardContent = `
          <div class="card-image-wrapper n3-full-image">
            <span class="virtual-badge">Apenas Virtual</span>
            <img src="${imageUrl}" alt="${profile.name}" class="card-image ${landscapeClass}">
            <div class="card-overlay n3-overlay">
              <h3 class="card-name-overlay">${profile.nome || profile.name}</h3>
            </div>
          </div>
        `;
      } else {
        // Layout normal para N2 e N7
        if (level === 'n7') {
          // Layout N7 - foto no topo, dados na base
          cardContent = `
            <div class="card-image-wrapper n7-top">
              <span class="virtual-badge">Apenas Virtual</span>
              <img src="${imageUrl}" alt="${profile.name}" class="card-image ${landscapeClass}">
            </div>
            <div class="card-info n7-bottom">
              <h3 class="card-name">${profile.name}</h3>
              <p class="card-phrase">${profile.phrase}</p>
            </div>
          `;
        } else {
          // Layout N2 - layout padr√£o
          cardContent = `
            <div class="card-image-wrapper">
              <span class="virtual-badge">Apenas Virtual</span>
              <img src="${imageUrl}" alt="${profile.name}" class="card-image ${landscapeClass}">
            </div>
            <div class="card-info">
              <h3 class="card-name">${profile.name}</h3>
              <p class="card-phrase">${profile.phrase}</p>
            </div>
          `;
        }
      }
    }
    
    // Adiciona atributos de localiza√ß√£o para filtros
    const stateCode = profile.estado || 'N/A';
    const cityName = profile.cidade || 'N/A';
    
    // IMPORTANTE: Envolver TODO o card em um link <a> para navegar para a p√°gina de detalhes
    // Hierarquia: A_02__premium_copy.html ‚Üí A_02__premium_Anuncio_modelo_01.html?id=ID_DO_FIREBASE
    html += `<a href="${profileUrl}" class="acompanhante-card-link" data-state="${stateCode}" data-city="${cityName}" data-anuncio-id="${anuncioId}" style="text-decoration: none; color: inherit; display: block;">${cardContent}</a>`;
  });
  
  console.log(`‚úÖ generateGridCards conclu√≠do:`, {
    level: level,
    cardsGerados: profiles.length,
    htmlLength: html.length,
    htmlPreview: html.substring(0, 300) + '...'
  });
  
  return html;
}

// ============================================
// FUN√á√ïES DE ORGANIZA√á√ÉO POR PLANOS
// ============================================

// Fun√ß√£o para obter identificador √∫nico do visitante (simulado por IP f√≠sico)
function getVisitorId() {
  // Usar uma combina√ß√£o de caracter√≠sticas para simular IP f√≠sico
  let visitorId = localStorage.getItem('visitor_id');
  if (!visitorId) {
    // Criar ID √∫nico baseado em caracter√≠sticas do navegador
    visitorId = 'visitor_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    localStorage.setItem('visitor_id', visitorId);
  }
  return visitorId;
}

// Fun√ß√£o para rota√ß√£o do Camarote baseada em IP f√≠sico (simulado)
function rotateCamaroteQueue(profiles) {
  if (!profiles || profiles.length === 0) {
    console.warn('‚ö†Ô∏è rotateCamaroteQueue: Nenhum perfil fornecido');
    return [];
  }
  
  console.log(`üîÑ rotateCamaroteQueue recebeu ${profiles.length} perfis`);
  
  // Separar por plano: Camarote > Especial > Plus > B√°sico
  const camarote = profiles.filter(p => p.plano === 'camarote');
  const especial = profiles.filter(p => p.plano === 'especial');
  const plus = profiles.filter(p => p.plano === 'plus');
  const basico = profiles.filter(p => p.plano === 'basico');
  
  console.log(`üìä Separa√ß√£o por plano:`, {
    camarote: camarote.length,
    especial: especial.length,
    plus: plus.length,
    basico: basico.length,
    total: profiles.length
  });
  
  // Ordenar cada grupo por data de entrada (mais antigos primeiro)
  const sortByDate = (a, b) => {
    try {
      const dateA = a.originalData?.createdAt?.toDate ? a.originalData.createdAt.toDate() : 
                    (a.originalData?.createdAt ? new Date(a.originalData.createdAt) : 
                     (a.createdAt ? new Date(a.createdAt) : new Date(0)));
      const dateB = b.originalData?.createdAt?.toDate ? b.originalData.createdAt.toDate() : 
                    (b.originalData?.createdAt ? new Date(b.originalData.createdAt) : 
                     (b.createdAt ? new Date(b.createdAt) : new Date(0)));
      return dateA - dateB;
    } catch (e) {
      return 0;
    }
  };
  
  camarote.sort(sortByDate);
  especial.sort(sortByDate);
  plus.sort(sortByDate);
  basico.sort(sortByDate);
  
  // Intercalar: alternar entre Camarote, Especial, Plus, B√°sico
  const intercalado = [];
  const maxLength = Math.max(camarote.length, especial.length, plus.length, basico.length);
  
  for (let i = 0; i < maxLength; i++) {
    if (i < camarote.length) intercalado.push(camarote[i]);
    if (i < especial.length) intercalado.push(especial[i]);
    if (i < plus.length) intercalado.push(plus[i]);
    if (i < basico.length) intercalado.push(basico[i]);
  }
  
  console.log(`üîÄ Intercalado criado: ${intercalado.length} an√∫ncios`);
  
  // Obter identificador do visitante e √≠ndice de rota√ß√£o global
  const rotationKey = 'camarote_global_rotation';
  let globalRotationIndex = parseInt(localStorage.getItem(rotationKey)) || 0;
  
  // Incrementar √≠ndice global (simula cada visita de IP diferente)
  globalRotationIndex++;
  localStorage.setItem(rotationKey, globalRotationIndex.toString());
  
  // Rotacionar baseado no √≠ndice global (primeira pessoa = 0, segunda = 1, etc.)
  const startIndex = intercalado.length > 0 ? (globalRotationIndex - 1) % intercalado.length : 0;
  const rotated = intercalado.length > 0 ? [
    ...intercalado.slice(startIndex),
    ...intercalado.slice(0, startIndex)
  ] : [];
  
  // Limitar a 18 cards (3 linhas x 6 colunas)
  const camaroteFinal = rotated.slice(0, 18);
  
  console.log(`üîÑ Camarote Rota√ß√£o Global: ${globalRotationIndex}, In√≠cio: ${startIndex}, Total Final: ${camaroteFinal.length}`);
  console.log(`üìä Camarote Final: ${camarote.length} Camarote, ${especial.length} Especial, ${plus.length} Plus, ${basico.length} B√°sico`);
  
  if (camaroteFinal.length > 0) {
    console.log(`‚úÖ Primeiros 3 an√∫ncios do Camarote:`, camaroteFinal.slice(0, 3).map(p => ({
      plano: p.plano,
    })));
  } else {
    console.warn('‚ö†Ô∏è Nenhum an√∫ncio no Camarote Final!');
  }
  
  return camaroteFinal;
}

// Fun√ß√£o para ordenar √Årea VIP por likes e visualiza√ß√µes
function sortVIPByEngagement(profiles) {
  if (!profiles || profiles.length === 0) return [];
  
  return [...profiles].sort((a, b) => {
    // Primeiro: ordenar por likes (curtidas)
    const likesA = a.likes || 0;
    const likesB = b.likes || 0;
    if (likesB !== likesA) {
      return likesB - likesA;
    }
    
    // Segundo: ordenar por visualiza√ß√µes
    const viewsA = a.visualizacoes || 0;
    const viewsB = b.visualizacoes || 0;
    return viewsB - viewsA;
  });
}

// Fun√ß√£o para organizar "Todas as Acompanhantes" com rota√ß√£o de planos
function organizeAllAcompanhantes(profiles, camaroteIds = new Set()) {
  if (!profiles || profiles.length === 0) return [];
  
  // PRIMEIRO: Remover TODOS os an√∫ncios que apareceram no Camarote para evitar duplicatas
  const profilesSemCamarote = profiles.filter(p => !camaroteIds.has(p.id));
  
  console.log(`üîç Removendo an√∫ncios do Camarote: ${profiles.length} ‚Üí ${profilesSemCamarote.length} (${camaroteIds.size} removidos)`);
  
  // Separar por plano (ap√≥s remover os do Camarote)
  const especial = profilesSemCamarote.filter(p => p.plano === 'especial');
  const plus = profilesSemCamarote.filter(p => p.plano === 'plus');
  const basico = profilesSemCamarote.filter(p => p.plano === 'basico');
  
  console.log(`üìä An√∫ncios ap√≥s remover Camarote:`, {
    especial: especial.length,
    plus: plus.length,
    basico: basico.length,
    total: profilesSemCamarote.length
  });
  
  // Obter √≠ndice de rota√ß√£o global
  const rotationKey = 'todas_global_rotacao';
  let rotationIndex = parseInt(localStorage.getItem(rotationKey)) || 0;
  rotationIndex++;
  localStorage.setItem(rotationKey, rotationIndex.toString());
  
  // Definir ordem rotativa: Plus, B√°sico, Especial (primeira linha)
  // Depois: B√°sico, Plus, Especial (segunda linha)
  // Depois: Especial, Plus, B√°sico (terceira linha)
  const orders = [
    { primeiro: plus, segundo: basico, terceiro: especial },
    { primeiro: basico, segundo: plus, terceiro: especial },
    { primeiro: especial, segundo: plus, terceiro: basico }
  ];
  
  const currentOrder = orders[rotationIndex % orders.length];
  
  // Especiais: usar todos os que n√£o est√£o no Camarote (j√° filtrados acima)
  const especialFinal = especial;
  
  // Montar resultado: primeira linha, segunda linha, terceira linha
  // Se uma linha n√£o for completa com o plano, completar com o pr√≥ximo
  const resultado = [];
  const cardsPorLinha = 7; // Grid de 7 colunas
  
  // Primeira linha (j√° filtrados, sem an√∫ncios do Camarote)
  const primeiraLinha = currentOrder.primeiro.slice(0, cardsPorLinha);
  if (primeiraLinha.length < cardsPorLinha) {
    primeiraLinha.push(...currentOrder.segundo.slice(0, cardsPorLinha - primeiraLinha.length));
  }
  
  // Segunda linha (j√° filtrados, sem an√∫ncios do Camarote)
  const segundaLinha = currentOrder.segundo.slice(0, cardsPorLinha);
  if (segundaLinha.length < cardsPorLinha) {
    segundaLinha.push(...currentOrder.terceiro.slice(0, cardsPorLinha - segundaLinha.length));
  }
  
  // Terceira linha (Especiais - j√° filtrados, sem an√∫ncios do Camarote)
  const terceiraLinha = especialFinal.slice(0, cardsPorLinha);
  
  // Remover duplicatas finais do resultado (por ID)
  const todosCards = [...primeiraLinha, ...segundaLinha, ...terceiraLinha];
  const resultadoSemDuplicatas = [...new Map(todosCards.map(item => [item.id, item])).values()];
  
  const removidosDuplicatas = todosCards.length - resultadoSemDuplicatas.length;
  
  resultado.push(...resultadoSemDuplicatas);
  
  console.log(`üîÑ Todas as Acompanhantes - Rota√ß√£o ${rotationIndex}:`, {
    primeira: primeiraLinha.length,
    segunda: segundaLinha.length,
    terceira: terceiraLinha.length,
    total: resultado.length,
    removidosDuplicatas: removidosDuplicatas
  });
  
  return resultado;
}

// 2. Modo: Tiered Grid (Desktop) - NOVO SISTEMA DE PLANOS
function generateTieredGrid() {
  console.log('üé® Iniciando generateTieredGrid...');
  
  // Usar window.PROFILES_DATA se existir (filtrado), sen√£o usar PROFILES_DATA local
  // Priorizar window.PROFILES_DATA porque pode conter dados filtrados pelo sistema de filtro
  let dadosParaRenderizar;
  if (typeof window.PROFILES_DATA !== 'undefined' && window.PROFILES_DATA !== null && Array.isArray(window.PROFILES_DATA)) {
    dadosParaRenderizar = window.PROFILES_DATA;
    console.log(`‚úÖ Usando window.PROFILES_DATA (filtrado): ${dadosParaRenderizar.length} an√∫ncios`);
  } else {
    dadosParaRenderizar = PROFILES_DATA;
    console.log(`‚úÖ Usando PROFILES_DATA local: ${dadosParaRenderizar.length} an√∫ncios`);
  }
  
  console.log(`üìä Dados para renderizar: ${dadosParaRenderizar.length} an√∫ncios`);
  console.log(`üìã Primeiros 3 an√∫ncios:`, dadosParaRenderizar.slice(0, 3).map(a => ({
    nome: a.nome || a.name,
    estado: a.estado || a.state || a.originalData?.estado || a.originalData?.state
  })));
  
  // Obter refer√™ncia ao galleryGrid
  const galleryGrid = document.getElementById('gallery-grid');
  if (!galleryGrid) {
    console.error('‚ùå galleryGrid n√£o encontrado!');
    return;
  }
  
  galleryGrid.innerHTML = '';
  
  // Separar an√∫ncios por plano usando dados filtrados
  const camaroteAnuncios = dadosParaRenderizar.filter(p => p.plano === 'camarote');
  const especialAnuncios = dadosParaRenderizar.filter(p => p.plano === 'especial');
  const plusAnuncios = dadosParaRenderizar.filter(p => p.plano === 'plus');
  const basicoAnuncios = dadosParaRenderizar.filter(p => p.plano === 'basico');
  const vipAnuncios = dadosParaRenderizar.filter(p => p.plano === 'vip' || p.plano === 'especial');
  
  // Todas as acompanhantes: todos os planos exceto VIP
  // MODIFICA√á√ÉO: Se n√£o tiver plano definido, incluir em todas as categorias
  const todasAnuncios = dadosParaRenderizar.filter(p => {
    const plano = p.plano || 'plus'; // Default para plus se n√£o tiver plano
    return (plano === 'basico' || plano === 'plus' || plano === 'especial' || plano === 'camarote' || !p.plano);
  });
  
  console.log(`üìä An√∫ncios separados por plano:`, {
    camarote: camaroteAnuncios.length,
    especial: especialAnuncios.length,
    plus: plusAnuncios.length,
    basico: basicoAnuncios.length,
    todas: todasAnuncios.length,
    total: dadosParaRenderizar.length,
    detalhes: dadosParaRenderizar.map(p => ({
      plano: p.plano || 'n√£o definido'
    }))
  });
  
  // ========== SE√á√ÉO CAMAROTE ==========
  // Buscar an√∫ncios para Camarote: Camarote > Especial > Plus > B√°sico
  // MODO TESTE: Se s√≥ tiver an√∫ncios PLUS ou sem plano, mostrar todos no Camarote
  let candidatosCamarote = [...camaroteAnuncios];
  
  // Se n√£o tiver an√∫ncios com plano 'camarote', buscar de Especial > Plus > B√°sico
  // MODIFICA√á√ÉO: Se n√£o tiver nenhum an√∫ncio com plano definido, usar todos os an√∫ncios
  if (candidatosCamarote.length === 0 && dadosParaRenderizar.length > 0) {
    // Se n√£o h√° an√∫ncios com plano definido, usar todos
    const anunciosSemPlano = dadosParaRenderizar.filter(p => !p.plano || p.plano === 'plus' || p.plano === '');
    if (anunciosSemPlano.length > 0) {
      candidatosCamarote = [...anunciosSemPlano];
      console.log(`‚úÖ Usando ${anunciosSemPlano.length} an√∫ncios sem plano definido para Camarote`);
    }
  }
  
  if (candidatosCamarote.length < 18) {
    // Prioridade: Especial > Plus > B√°sico
    if (candidatosCamarote.length < 18 && especialAnuncios.length > 0) {
      const faltam = 18 - candidatosCamarote.length;
      candidatosCamarote.push(...especialAnuncios.slice(0, Math.min(faltam, especialAnuncios.length)));
    }
    
    if (candidatosCamarote.length < 18 && plusAnuncios.length > 0) {
      const faltam = 18 - candidatosCamarote.length;
      candidatosCamarote.push(...plusAnuncios.slice(0, Math.min(faltam, plusAnuncios.length)));
      console.log(`‚úÖ Adicionados ${Math.min(faltam, plusAnuncios.length)} an√∫ncios PLUS ao Camarote`);
    }
    
    if (candidatosCamarote.length < 18 && basicoAnuncios.length > 0) {
      const faltam = 18 - candidatosCamarote.length;
      candidatosCamarote.push(...basicoAnuncios.slice(0, Math.min(faltam, basicoAnuncios.length)));
    }
  }
  
  console.log(`üìã Candidatos para Camarote: ${candidatosCamarote.length} an√∫ncios`);
  console.log(`üìã Detalhes dos candidatos:`, candidatosCamarote.map(c => ({
    plano: c.plano
  })));
  
  // Aplicar rota√ß√£o baseada em IP f√≠sico
  const camaroteFinal = rotateCamaroteQueue(candidatosCamarote);
  
  console.log(`üé≠ Camarote Final: ${camaroteFinal.length} an√∫ncios ap√≥s rota√ß√£o`);
  console.log(`üé≠ Detalhes do Camarote Final:`, camaroteFinal.map(c => ({
    plano: c.plano
  })));
  
  if (camaroteFinal.length > 0) {
    // CORRE√á√ÉO: Remover duplicatas do Camarote tamb√©m
    const camaroteSemDuplicatas = [...new Map(camaroteFinal.map(item => [item.id, item])).values()];
    console.log(`üîç Camarote: removendo duplicatas ${camaroteFinal.length} ‚Üí ${camaroteSemDuplicatas.length}`);
    
    const camaroteTitle = document.createElement('h3');
    camaroteTitle.className = 'section-title';
    camaroteTitle.textContent = 'üåü Camarote';
    camaroteTitle.style.cssText = 'color: #e25352; font-size: 2.2rem; margin: 3rem 0 2rem 0; text-align: left; font-weight: bold; border-bottom: 3px solid #e25352; padding-bottom: 1rem;';
    galleryGrid.appendChild(camaroteTitle);
    
    const camaroteContainer = document.createElement('div');
    camaroteContainer.className = 'gallery-grid layout-n1-grid';
    camaroteContainer.style.cssText = 'display: grid; grid-template-columns: repeat(6, 1fr); gap: 1rem; margin: 3rem 0;';
    camaroteContainer.innerHTML = generateGridCards('n1', camaroteSemDuplicatas);
    galleryGrid.appendChild(camaroteContainer);
  }
  
  // ========== SE√á√ÉO √ÅREA VIP ==========
  const vipSorted = sortVIPByEngagement(vipAnuncios);
  
  if (vipSorted.length > 0) {
    const vipTitle = document.createElement('h3');
    vipTitle.className = 'section-title';
    vipTitle.textContent = '‚≠ê √Årea VIP';
    vipTitle.style.cssText = 'color: #e25352; font-size: 2.2rem; margin: 4rem 0 2rem 0; text-align: left; font-weight: bold; border-bottom: 3px solid #e25352; padding-bottom: 1rem;';
    galleryGrid.appendChild(vipTitle);
    
    const vipContainer = document.createElement('div');
    vipContainer.className = 'gallery-grid layout-n3';
    vipContainer.style.cssText = 'display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 3rem 0;';
    vipContainer.innerHTML = generateGridCards('n3', vipSorted);
    galleryGrid.appendChild(vipContainer);
  }
  
  // ========== SE√á√ÉO TODAS AS ACOMPANHANTES ==========
  // Armazenar IDs dos an√∫ncios que apareceram no Camarote para usar na organiza√ß√£o
  const camaroteIds = new Set(camaroteFinal.map(p => p.id));
  
  console.log(`üìã Organizando "Todas as Acompanhantes":`, {
    totalAnuncios: todasAnuncios.length,
    camaroteIds: Array.from(camaroteIds),
    anunciosAntes: todasAnuncios.map(a => ({ id: a.id, name: a.name }))
  });
  
  const todasOrganizadas = organizeAllAcompanhantes(todasAnuncios, camaroteIds);
  
  console.log(`üìã "Todas as Acompanhantes" ap√≥s organiza√ß√£o:`, {
    total: todasOrganizadas.length,
    anuncios: todasOrganizadas.map(a => ({ id: a.id, name: a.name }))
  });
  
  // MODIFICA√á√ÉO: Se n√£o houver an√∫ncios organizados mas houver an√∫ncios em todasAnuncios, usar todos
  // CORRE√á√ÉO: Remover duplicatas por ID antes de exibir
  const todasParaExibirTemp = todasOrganizadas.length > 0 ? todasOrganizadas : todasAnuncios;
  
  // Remover duplicatas por ID (caso algum an√∫ncio apare√ßa em m√∫ltiplas se√ß√µes)
  const todasParaExibir = [...new Map(todasParaExibirTemp.map(item => [item.id, item])).values()];
  
  console.log(`üîç Removendo duplicatas: ${todasParaExibirTemp.length} ‚Üí ${todasParaExibir.length}`);
  
  if (todasParaExibir.length > 0) {
    const todasTitle = document.createElement('h3');
    todasTitle.className = 'section-title';
    todasTitle.textContent = 'üìã Todas as Acompanhantes';
    todasTitle.style.cssText = 'color: #e25352; font-size: 2.2rem; margin: 4rem 0 2rem 0; text-align: left; font-weight: bold; border-bottom: 3px solid #e25352; padding-bottom: 1rem;';
    galleryGrid.appendChild(todasTitle);
    
    const todasContainer = document.createElement('div');
    todasContainer.className = 'gallery-grid layout-n7';
    todasContainer.style.cssText = 'display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.5rem; margin: 3rem 0;';
    const cardsHTML = generateGridCards('n7', todasParaExibir);
    console.log(`üé® HTML gerado para "Todas as Acompanhantes":`, cardsHTML.substring(0, 200) + '...');
    todasContainer.innerHTML = cardsHTML;
    galleryGrid.appendChild(todasContainer);
  } else {
    console.warn('‚ö†Ô∏è Nenhum an√∫ncio para exibir em "Todas as Acompanhantes"');
  }
 
  // Ajusta o cont√™iner principal
  galleryGrid.style.display = 'block';
  galleryGrid.className = '';
  
  // Garantir que todos os cards est√£o vis√≠veis
  setTimeout(() => {
    const allCards = document.querySelectorAll('.acompanhante-card');
    allCards.forEach(card => {
      card.style.display = 'block';
      card.style.visibility = 'visible';
      card.style.opacity = '1';
    });
    console.log(`‚úÖ ${allCards.length} an√∫ncios exibidos`);
    console.log(`üìã IDs dos cards exibidos:`, Array.from(allCards).map(card => {
      const link = card.closest('a') || card;
      return {
        href: link.href || 'sem href',
        text: card.textContent?.substring(0, 50) || 'sem texto',
        display: window.getComputedStyle(card).display,
        visibility: window.getComputedStyle(card).visibility
      };
    }));
    
    // Se n√£o houver cards, verificar se h√° dados
    if (allCards.length === 0) {
      console.error('‚ùå NENHUM CARD FOI RENDERIZADO!');
      console.error('‚ùå PROFILES_DATA:', PROFILES_DATA);
      console.error('‚ùå galleryGrid:', galleryGrid);
      console.error('‚ùå galleryGrid.innerHTML length:', galleryGrid?.innerHTML?.length || 0);
    }
  }, 100);
  
  setTimeout(() => {
    initPremiumSwiper();
  }, 100);
}

// Fun√ß√£o para inicializar o Swiper Premium
function initPremiumSwiper() {
  if (typeof Swiper === 'undefined') {
    console.warn('Swiper n√£o carregado. Carregando...');
    loadSwiperLibrary();
    return;
  }
  
  // === EMBARALHAR SLIDES ANTES DE INICIALIZAR ===
  const wrapper = document.querySelector(".premium-swiper .swiper-wrapper");
  if (wrapper) {
    const slides = Array.from(wrapper.children);
    
    // Embaralha os elementos (Fisher-Yates shuffle)
    for (let i = slides.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [slides[i], slides[j]] = [slides[j], slides[i]];
    }

    // Remove os slides atuais e reinsere na nova ordem
    slides.forEach(slide => wrapper.appendChild(slide));
    console.log('üé≤ Slides embaralhados aleatoriamente!');
  }
  
  // === INICIALIZA√á√ÉO DO SWIPER ===
  const swiper = new Swiper('.premium-swiper', {
    slidesPerView: 6,
    spaceBetween: 15,
    loop: true,
    centeredSlides: false,
    autoplay: {
      delay: 3000,
      disableOnInteraction: false,
    },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    breakpoints: {
      1024: { slidesPerView: 6 },
      768: { slidesPerView: 4 },
      480: { slidesPerView: 2 },
    },
  });
  
  console.log('‚úÖ Swiper Premium (Elementor Style) inicializado com sucesso!');
}

// Fun√ß√£o para rota√ß√£o circular da fila N3
function rotateCircularQueue(profiles) {
  if (!profiles || profiles.length === 0) return profiles;
  
  // Obter ou criar contador de rota√ß√£o no localStorage
  const rotationKey = 'n3_rotation_counter';
  let rotationCount = parseInt(localStorage.getItem(rotationKey)) || 0;
  
  // Incrementar contador
  rotationCount++;
  localStorage.setItem(rotationKey, rotationCount.toString());
  
  // Calcular posi√ß√£o de in√≠cio da rota√ß√£o
  const startIndex = rotationCount % profiles.length;
  
  // Rotacionar array
  const rotated = [
    ...profiles.slice(startIndex),
    ...profiles.slice(0, startIndex)
  ];
  
  console.log(`üîÑ N3 Fila Circular: Rota√ß√£o ${rotationCount}, In√≠cio: ${startIndex}`);
  console.log(`üìã Ordem atual: ${rotated.map(p => p.name).join(' ‚Üí ')}`);
  
  return rotated;
}

// Fun√ß√£o para carregar a biblioteca Swiper
function loadSwiperLibrary() {
  // CSS do Swiper
  const swiperCSS = document.createElement('link');
  swiperCSS.rel = 'stylesheet';
  swiperCSS.href = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css';
  document.head.appendChild(swiperCSS);
  
  // JS do Swiper
  const swiperJS = document.createElement('script');
  swiperJS.src = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js';
  swiperJS.onload = () => {
    console.log('‚úÖ Swiper carregado! Inicializando...');
    setTimeout(() => {
      initPremiumSwiper();
    }, 100);
  };
  document.head.appendChild(swiperJS);
}

// 3. Modo: Manual Grid (Mobile)
async function handleManualLayoutSwitch(level) {
  console.log('üé® handleManualLayoutSwitch called with level:', level);
  
  const container = document.querySelector("#gallery-grid");
  if (!container) return;

  // Detecta se √© mobile/tablet (consistente com isMobileDevice)
  const isMobile = window.innerWidth <= 768;
  
  // Verificar se PROFILES_DATA est√° vazio ou n√£o carregado
  let profiles = PROFILES_DATA || [];
  if (!profiles || profiles.length === 0) {
    console.log('‚ö†Ô∏è PROFILES_DATA vazio, recarregando do Firebase...');
    profiles = await loadProfilesFromFirebase();
    if (!profiles || profiles.length === 0) {
      console.error('‚ùå N√£o foi poss√≠vel carregar perfis do Firebase');
      return;
    }
  }
  
  // Esta p√°gina j√° filtra apenas Sexo Virtual de mulheres no loadProfilesFromFirebase
  // N√£o precisa de filtro adicional por URL aqui

  // limpa conte√∫do atual
  container.innerHTML = "";

  // Se for mobile/tablet ‚Üí layout baseado nos √≠cones
  if (isMobile) {
    let html = "";

    if (level === "n7") {
      // Layout preview: imagem grande com overlay no bottom (como no formul√°rio de cadastro)
      profiles.forEach((p) => {
        // Obter ID do an√∫ncio (mesmo m√©todo usado em generateGridCards)
        const anuncioId = p.originalData?.id || p.originalData?._id || p.id || p._id;
        const anuncioNome = p.name || p.nome || 'An√¥nimo';
        const categoria = p.categoria || p.category || p.originalData?.categoria || p.originalData?.category || '';
        const genero = p.genero || p.gender || p.sexo || p.originalData?.genero || p.originalData?.gender || p.originalData?.sexo || '';
        const imageUrl = p.photo && p.photo !== 'undefined' ? p.photo : (p.image || `https://picsum.photos/400/600?random=${anuncioId || Math.random()}`);
        // Localiza√ß√£o removida para sexo virtual (n√£o necess√°rio)
        const profileUrl = getProfilePageUrl(anuncioId, anuncioNome, categoria, genero);
        html += `
          <a href="${profileUrl}" class="acompanhante-card mobile-layout-preview" style="text-decoration: none; color: inherit; display: block;">
            <div class="card-preview-wrapper-mobile">
              <span class="virtual-badge">Apenas Virtual</span>
              <img src="${imageUrl}" alt="${anuncioNome}" class="card-preview-image-mobile">
              <div class="card-preview-overlay-mobile">
                <div class="card-preview-name-mobile">${anuncioNome}</div>
              </div>
            </div>
          </a>`;
      });
    }

    if (level === "n2") {
      // Layout de galeria 2 colunas (estilo pub-book)
      console.log(`üì∏ Renderizando ${profiles.length} perfis no layout N2`);
      profiles.forEach((p, index) => {
        const anuncioId = p.originalData?.id || p.originalData?._id || p.id || p._id;
        const anuncioNome = p.name || p.nome || 'An√¥nimo';
        const categoria = p.categoria || p.category || p.originalData?.categoria || p.originalData?.category || '';
        const genero = p.genero || p.gender || p.sexo || p.originalData?.genero || p.originalData?.gender || p.originalData?.sexo || '';
        const imageUrl = p.photo && p.photo !== 'undefined' ? p.photo : (p.image || `https://picsum.photos/400/400?random=${anuncioId || Math.random()}`);
        // Localiza√ß√£o removida para sexo virtual (n√£o necess√°rio)
        const profileUrl = getProfilePageUrl(anuncioId, anuncioNome, categoria, genero);
        html += `
          <div class="pub-book-item mobile-layout-2-gallery" data-media_id="${index + 1}" data-media_type="photo">
            <a href="${profileUrl}" style="text-decoration: none; color: inherit; display: block;">
              <div class="gallery-item" data-photo-index="${index}" style="cursor: pointer; position: relative;">
                <span class="virtual-badge">Apenas Virtual</span>
                <img loading="lazy" src="${imageUrl}" data-fallback="${imageUrl}" class="pub-book-img lazyload" alt="${anuncioNome}" onerror="this.src='${imageUrl}';">
              </div>
              <div class="card-info-n2">
                <div class="card-name-n2">${anuncioNome}</div>
              </div>
            </a>
          </div>`;
      });
      console.log(`‚úÖ HTML gerado para ${profiles.length} perfis no layout N2`);
    }

    if (level === "n3") {
      // Layout de galeria 3 colunas (estilo pub-book)
      console.log(`üì∏ Renderizando ${profiles.length} perfis no layout N3`);
      
      // Array de cores s√≥lidas com varia√ß√µes claro/escuro para os cards
      const cardColors = [
        { title: '#e2e8f0', resume: '#cbd5e0' }, // Cinza claro / Cinza escuro
        { title: '#c6f6d5', resume: '#9ae6b4' }, // Verde claro / Verde mais escuro
        { title: '#bee3f8', resume: '#90cdf4' }, // Azul claro / Azul mais escuro
        { title: '#fef3c7', resume: '#fde68a' }, // Amarelo claro / Amarelo mais escuro
        { title: '#fce7f3', resume: '#fbcfe8' }, // Rosa claro / Rosa mais escuro
        { title: '#e9d5ff', resume: '#d8b4fe' }, // Roxo claro / Roxo mais escuro
        { title: '#fed7aa', resume: '#fdba74' }, // Laranja claro / Laranja mais escuro
        { title: '#cffafe', resume: '#a5f3fc' }, // Ciano claro / Ciano mais escuro
        { title: '#d1fae5', resume: '#a7f3d0' }, // Verde-√°gua claro / Verde-√°gua mais escuro
        { title: '#f3e8ff', resume: '#e9d5ff' }, // Lavanda claro / Lavanda mais escuro
        { title: '#ffe4e6', resume: '#fecdd3' }, // Rosa p√°lido / Rosa mais escuro
        { title: '#e0f2fe', resume: '#bae6fd' }, // Azul c√©u claro / Azul c√©u mais escuro
        { title: '#f0fdf4', resume: '#dcfce7' }, // Verde menta claro / Verde menta mais escuro
        { title: '#fef2f2', resume: '#fee2e2' }, // Vermelho claro / Vermelho mais escuro
        { title: '#f0f9ff', resume: '#e0f2fe' }, // Azul gelo claro / Azul gelo mais escuro
      ];
      
      profiles.forEach((p, index) => {
        const anuncioId = p.originalData?.id || p.originalData?._id || p.id || p._id;
        const anuncioNome = p.name || p.nome || 'An√¥nimo';
        const categoria = p.categoria || p.category || p.originalData?.categoria || p.originalData?.category || '';
        const imageUrl = p.photo && p.photo !== 'undefined' ? p.photo : (p.image || `https://picsum.photos/400/400?random=${anuncioId || Math.random()}`);
        
        // Localiza√ß√£o removida para sexo virtual (n√£o necess√°rio)
        // Selecionar cor baseada no √≠ndice (rota√ß√£o circular)
        const colorIndex = index % cardColors.length;
        const colors = cardColors[colorIndex];
        
        const genero = p.genero || p.gender || p.sexo || p.originalData?.genero || p.originalData?.gender || p.originalData?.sexo || '';
        const profileUrl = getProfilePageUrl(anuncioId, anuncioNome, categoria, genero);
        html += `
          <div class="pub-book-item mobile-layout-3-gallery" data-media_id="${index + 1}" data-media_type="photo">
            <a href="${profileUrl}" style="text-decoration: none; color: inherit; display: block;">
              <div class="gallery-item" data-photo-index="${index}" style="cursor: pointer; position: relative;">
                <span class="virtual-badge">Apenas Virtual</span>
                <img loading="lazy" src="${imageUrl}" data-fallback="${imageUrl}" class="pub-book-img lazyload" alt="${anuncioNome}" onerror="this.src='${imageUrl}';">
              </div>
              <div class="card_title" style="display: block !important; visibility: visible !important; background: ${colors.title} !important; color: #1a202c !important;">${anuncioNome}</div>
            </a>
          </div>`;
      });
      console.log(`‚úÖ HTML gerado para ${profiles.length} perfis no layout N3`);
    }

    if (level === "n1") {
      // Layout Destaque: 1 card por linha, 3 cards vis√≠veis na tela, informa√ß√µes sobrepostas (estilo Skokka)
      console.log(`üì∏ Renderizando ${profiles.length} perfis no layout N1`);
      profiles.forEach((p, index) => {
        const anuncioId = p.originalData?.id || p.originalData?._id || p.id || p._id;
        const anuncioNome = p.name || p.nome || 'An√¥nimo';
        const imageUrl = p.photo && p.photo !== 'undefined' ? p.photo : (p.image || `https://picsum.photos/400/600?random=${anuncioId || Math.random()}`);
        
        // Obter dados do perfil
        let phrase = p.phrase || p.originalData?.frase || 'Frase de efeito n√£o dispon√≠vel';
        // Limitar frase de efeito a 50 caracteres
        phrase = phrase.length > 50 ? phrase.substring(0, 50) + '...' : phrase;
        const description = p.description || p.originalData?.descricao || p.originalData?.description || '';
        // Resumir descri√ß√£o se for muito longa (m√°ximo 200 caracteres)
        const shortDescription = description.length > 200 ? description.substring(0, 200) + '...' : description;
        const idade = p.age || p.originalData?.idade || p.idade || 'N/A';
        // Localiza√ß√£o removida para sexo virtual (n√£o necess√°rio)
        const categoria = p.categoria || p.category || p.originalData?.categoria || p.originalData?.category || '';
        const genero = p.genero || p.gender || p.sexo || p.originalData?.genero || p.originalData?.gender || p.originalData?.sexo || '';
        
        const profileUrl = getProfilePageUrl(anuncioId, anuncioNome, categoria, genero);
        html += `
          <a href="${profileUrl}" class="acompanhante-card mobile-layout-1-featured" style="text-decoration: none; color: inherit; display: flex;">
            <div class="card-featured-image-wrapper">
              <img src="${imageUrl}" alt="${anuncioNome}" class="card-featured-image">
            </div>
            <div class="card-featured-info-wrapper">
              <div class="card-featured-info">
                <p class="card-featured-phrase">${phrase}</p>
                ${shortDescription ? `<p class="card-featured-description">${shortDescription}</p>` : ''}
                <div class="card-featured-details">
                  <span class="card-featured-age">${idade} anos</span>
                </div>
              </div>
            </div>
          </a>`;
      });
      console.log(`‚úÖ HTML gerado para ${profiles.length} perfis no layout N1`);
    }

    container.innerHTML = html;
    
    // Remover todas as classes de layout anteriores
    container.classList.remove('layout-n1', 'layout-n2', 'layout-n3', 'layout-n7', 'layout-n2-gallery', 'layout-n3-gallery', 'layout-n1-featured');
    
    // Resetar todos os estilos inline antes de aplicar novos
    container.style.cssText = '';
    
    // Garantir que barra de layout e categorias estejam sempre vis√≠veis (comportamento padr√£o)
    // Independente do layout ativo (n7, n2, n3, n1)
    const layoutSwitcherBar = document.getElementById('layout-switcher-bar');
    const categoriesContainer = document.querySelector('.categories-container');
    const scrollY = window.scrollY;
    const isMobile = window.innerWidth <= 1024;
    
    // Se estiver no topo (scroll <= 10px), garantir que elementos estejam vis√≠veis (igual ao N7)
    if (scrollY <= 10 && isMobile) {
      if (layoutSwitcherBar) {
        layoutSwitcherBar.style.display = 'flex';
      }
      if (categoriesContainer) {
        categoriesContainer.classList.remove('hidden');
        categoriesContainer.style.display = 'flex';
      }
    }
    
    // Ajustar display baseado no layout
    if (level === 'n1') {
      // Adicionar classe espec√≠fica para o layout N1
      container.classList.add('layout-n1-featured');
      container.style.display = 'flex';
      container.style.flexDirection = 'column';
      container.style.gap = '10px';
      container.style.width = '100%';
      container.style.padding = '0';
      container.style.margin = '0';
      container.style.boxSizing = 'border-box';
      // REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna)
      container.style.maxHeight = 'none'; // Permite rolagem da p√°gina
      container.style.overflowY = 'visible'; // Permite rolagem da p√°gina
      
      // Aplicar estilos diretamente nos itens
      const items = container.querySelectorAll('.mobile-layout-1-featured');
      console.log(`üìê Aplicando estilos N1 em ${items.length} itens`);
      items.forEach((item, index) => {
        // Cada card ocupa aproximadamente 1/3 da altura da viewport (ajustado para 3 cards vis√≠veis)
        item.style.width = '100%';
        item.style.height = 'calc((100vh - 200px) / 3)';
        item.style.minHeight = 'calc((100vh - 200px) / 3)';
        item.style.maxHeight = 'calc((100vh - 200px) / 3)';
        item.style.margin = '0';
        item.style.padding = '0';
        item.style.boxSizing = 'border-box';
        item.style.display = 'flex'; // Flex para permitir foto √† esquerda e info √† direita
        item.style.flexDirection = 'row'; // Dire√ß√£o horizontal
        item.style.position = 'relative';
        item.style.overflow = 'hidden';
      });
      
      // Log do container ap√≥s aplicar estilos
      console.log(`üìê Container ap√≥s aplicar N1:`, {
        display: window.getComputedStyle(container).display,
        flexDirection: window.getComputedStyle(container).flexDirection,
        maxHeight: window.getComputedStyle(container).maxHeight,
        width: window.getComputedStyle(container).width,
        hasClass: container.classList.contains('layout-n1-featured')
      });
    } else if (level === 'n2') {
      // Adicionar classe espec√≠fica para o layout N2
      container.classList.add('layout-n2-gallery');
      container.style.display = 'flex';
      container.style.flexWrap = 'wrap';
      container.style.gap = '10px';
      container.style.justifyContent = 'flex-start';
      container.style.width = '100%';
      container.style.padding = '0';
      container.style.margin = '0';
      container.style.boxSizing = 'border-box';
      // REMOVIDO: max-height e overflow-y para permitir rolagem da p√°gina inteira (n√£o interna)
      container.style.maxHeight = 'none'; // Permite rolagem da p√°gina
      container.style.overflowY = 'visible'; // Permite rolagem da p√°gina
      container.style.overflowX = 'hidden';
      
      // Aplicar estilos diretamente nos itens
      const items = container.querySelectorAll('.mobile-layout-2-gallery');
      console.log(`üìê Aplicando estilos N2 em ${items.length} itens`);
      items.forEach((item, index) => {
        const widthValue = 'calc((100% - 10px) / 2)';
        item.style.width = widthValue;
        item.style.maxWidth = widthValue;
        item.style.minWidth = widthValue;
        item.style.flex = '0 0 calc((100% - 10px) / 2)';
        item.style.boxSizing = 'border-box';
        item.style.margin = '0';
        item.style.padding = '0';
        item.style.display = 'block';
        
        // Log do primeiro item para debug
        if (index === 0) {
          console.log(`üìê Item 0 estilos aplicados:`, {
            width: item.style.width,
            maxWidth: item.style.maxWidth,
            flex: item.style.flex,
            computedWidth: window.getComputedStyle(item).width
          });
        }
      });
      
      // Log do container ap√≥s aplicar estilos
      console.log(`üìê Container ap√≥s aplicar N2:`, {
        display: window.getComputedStyle(container).display,
        flexWrap: window.getComputedStyle(container).flexWrap,
        gap: window.getComputedStyle(container).gap,
        width: window.getComputedStyle(container).width,
        hasClass: container.classList.contains('layout-n2-gallery')
      });
    } else if (level === 'n3') {
      // Adicionar classe espec√≠fica para o layout N3
      container.classList.add('layout-n3-gallery');
      container.style.display = 'flex';
      container.style.flexWrap = 'wrap';
      container.style.gap = '10px';
      container.style.justifyContent = 'flex-start';
      container.style.width = '100%';
      container.style.padding = '0';
      container.style.margin = '0';
      container.style.boxSizing = 'border-box';
      
      // Aplicar estilos diretamente nos itens (3 colunas)
      const items = container.querySelectorAll('.mobile-layout-3-gallery');
      console.log(`üìê Aplicando estilos N3 em ${items.length} itens`);
      items.forEach((item, index) => {
        const widthValue = 'calc((100% - 20px) / 3)'; // 3 colunas com 2 gaps de 10px
        item.style.width = widthValue;
        item.style.maxWidth = widthValue;
        item.style.minWidth = widthValue;
        item.style.flex = '0 0 calc((100% - 20px) / 3)';
        item.style.boxSizing = 'border-box';
        item.style.margin = '0';
        item.style.padding = '0';
        item.style.display = 'block';
        
        // Log do primeiro item para debug
        if (index === 0) {
          console.log(`üìê Item 0 estilos aplicados (N3):`, {
            width: item.style.width,
            maxWidth: item.style.maxWidth,
            flex: item.style.flex,
            computedWidth: window.getComputedStyle(item).width
          });
        }
      });
      
      // Log do container ap√≥s aplicar estilos
      console.log(`üìê Container ap√≥s aplicar N3:`, {
        display: window.getComputedStyle(container).display,
        flexWrap: window.getComputedStyle(container).flexWrap,
        gap: window.getComputedStyle(container).gap,
        width: window.getComputedStyle(container).width,
        hasClass: container.classList.contains('layout-n3-gallery')
      });
    } else {
      container.style.display = 'grid';
    }
    
    // For√ßar reflow para garantir que o layout seja aplicado
    void container.offsetHeight;
    
    // Garantir que barra de layout e categorias estejam sempre vis√≠veis ap√≥s mudan√ßa de layout
    // Comportamento padr√£o igual para todos os layouts (n7, n2, n3, n1)
    const finalScrollY = window.scrollY;
    if (finalScrollY <= 50 && isMobile) {
      const finalLayoutSwitcherBar = document.getElementById('layout-switcher-bar');
      const finalCategoriesContainer = document.querySelector('.categories-container');
      
      if (finalLayoutSwitcherBar) {
        finalLayoutSwitcherBar.style.display = 'flex';
      }
      if (finalCategoriesContainer) {
        finalCategoriesContainer.classList.remove('hidden');
        finalCategoriesContainer.style.display = 'flex';
      }
    }
    
    // Verificar quantos elementos foram renderizados
    const renderedItems = container.querySelectorAll('.mobile-layout-2-gallery, .mobile-layout-3-gallery, .mobile-layout-preview, .mobile-layout-1, .mobile-layout-1-featured, .mobile-layout-3, .mobile-layout-news');
    console.log(`üì± Layout aplicado: ${level}, ${renderedItems.length} itens renderizados de ${profiles.length} perfis`);
    console.log(`üìê Container styles:`, {
      display: container.style.display,
      flexWrap: container.style.flexWrap,
      gap: container.style.gap,
      width: container.style.width
    });
    return;
  }

  // Caso contr√°rio, no desktop mant√©m comportamento padr√£o
  console.log('üñ•Ô∏è Ignorando mudan√ßa de layout ‚Äî modo desktop.');
}

// Fun√ß√£o para gerar cards espec√≠ficos para layouts mobile
function generateMobileLayoutCards(level, profiles) {
  let html = '';
  
  profiles.forEach((profile, index) => {
    if (level === 'n7') {
      // Layout Lista - 1 card por linha com imagem √† esquerda
      const imageUrl = profile.photo && profile.photo !== 'undefined' ? profile.photo : `https://picsum.photos/300/300?random=${profile.id}`;
      html += `
        <a href="#" class="acompanhante-card" onclick="openProfileModal(${profile.id})">
          <div class="card-image-wrapper">
            <img src="${imageUrl}" alt="${profile.name}" class="card-image">
          </div>
          <div class="card-info">
            <div class="card-name">${profile.name}</div>
            <div class="card-phrase">${profile.phrase || 'Frase de efeito n√£o dispon√≠vel'}</div>
            <div class="px-item-localhorario">${profile.age || 'N/A'} anos</div>
          </div>
        </a>
      `;
    } else if (level === 'n2') {
      // Layout 2 Colunas - manter como est√°
      html += generateProfileCardHtml(profile, index);
    } else if (level === 'n3') {
      // Layout 3 Colunas - apenas fotos
      const imageUrl = profile.photo && profile.photo !== 'undefined' ? profile.photo : `https://picsum.photos/300/300?random=${profile.id}`;
      html += `
        <a href="#" class="acompanhante-card" onclick="openProfileModal(${profile.id})">
          <div class="card-image-wrapper">
            <img src="${imageUrl}" alt="${profile.name}" class="card-image">
          </div>
          <div class="card-info">
            <div class="card-name">${profile.name}</div>
            <div class="card-phrase">${profile.phrase || 'Frase de efeito n√£o dispon√≠vel'}</div>
          </div>
        </a>
      `;
    } else if (level === 'n1') {
      // Layout Destaque - estilo Skokka
      const description = profile.description || 'Descri√ß√£o n√£o dispon√≠vel';
      const shortDescription = description.length > 130 ? description.substring(0, 130) + '...' : description;
      // Localiza√ß√£o removida para sexo virtual (n√£o necess√°rio)
      const imageUrl = profile.photo && profile.photo !== 'undefined' ? profile.photo : `https://picsum.photos/400/300?random=${profile.id}`;
      
      html += `
        <a href="#" class="acompanhante-card" onclick="openProfileModal(${profile.id})">
          <div class="card-image-wrapper">
            <img src="${imageUrl}" alt="${profile.name}" class="card-image">
          </div>
          <div class="card-info">
            <div class="card-name">${profile.name}</div>
            <div class="card-phrase">${profile.phrase || 'Frase de efeito n√£o dispon√≠vel'}</div>
            <div class="card-description">${shortDescription}</div>
            <div class="card-details">
              <span class="card-age">${profile.age || 'N/A'} anos</span>
            </div>
          </div>
        </a>
      `;
    }
  });
  
  return html;
}


// 5. Fun√ß√£o de renderiza√ß√£o principal
function renderGallery() {
  isMobileDevice = window.innerWidth <= 768;
  const storiesSection = document.querySelector('.stories-section');
  const categoriesContainer = document.querySelector('.categories-container');
  const layoutSwitcherBar = document.getElementById('layout-switcher-bar');

  // Garantir que elementos estejam vis√≠veis no modo galeria
  if (storiesSection) {
    storiesSection.style.display = 'block';
  }
  if (categoriesContainer) {
    // CORRE√á√ÉO: Verificar se n√£o est√° em modo transparente antes de mostrar
    const isMobile = window.innerWidth <= 1024;
    const mainHeader = document.querySelector('.main-header');
    const isHeaderTransparent = mainHeader && mainHeader.classList.contains('scrolled');
    
    if (!(isMobile && isHeaderTransparent)) {
      categoriesContainer.classList.remove('hidden');
    }
  }

  if (isMobileDevice) {
    // MOBILE: Visibilidade da barra, restaurar layout salvo ou iniciar em N7
    // Comportamento padr√£o: sempre mostrar barra de layout e categorias quando no topo
    // Para layouts N7 e N1, esconder quando rola para baixo (scroll > 10px)
    const scrollY = window.scrollY;
    
    if (layoutSwitcherBar && scrollY <= 10) {
      layoutSwitcherBar.style.display = 'flex';
    }
    
    if (categoriesContainer && scrollY <= 10) {
      categoriesContainer.classList.remove('hidden');
      categoriesContainer.style.display = 'flex';
    }
    
    // Verificar se h√° um layout salvo no localStorage
    const savedLayout = localStorage.getItem('selectedLayout');
    const layoutToUse = savedLayout || 'n7'; // Usar layout salvo ou N7 como padr√£o
    
    console.log('üì± Restaurando layout:', layoutToUse, savedLayout ? '(salvo)' : '(padr√£o)');
    
    // Atualizar √≠cone ativo baseado no layout salvo
    const layoutIcons = document.querySelectorAll('#layout_anuncios .layout-icon');
    layoutIcons.forEach(icon => icon.classList.remove('active'));
    const activeIcon = document.querySelector(`#layout_anuncios .layout-icon[data-layout="${layoutToUse}"]`);
    if (activeIcon) {
      activeIcon.classList.add('active');
    } else {
      // Fallback: se o layout salvo n√£o existir, usar N7
      const n7Icon = document.querySelector('#layout_anuncios .layout-icon[data-layout="n7"]');
      if (n7Icon) {
        n7Icon.classList.add('active');
      }
    }
    
    handleManualLayoutSwitch(layoutToUse);
  } else {
    // DESKTOP: Barra escondida, Tiered Grid
    if (layoutSwitcherBar) {
      layoutSwitcherBar.style.display = 'none';
    }
    generateTieredGrid();
  }
}

// --- FUN√á√ïES DE EVENTOS ---

// 1. Scroll-Hide da Barra
let lastScrollTop = 0;
// REMOVIDO: Event listener antigo de scroll - substitu√≠do por handleScroll()
// window.addEventListener('scroll', function() {
//   if (window.innerWidth <= 768) {
//     const st = window.pageYOffset || document.documentElement.scrollTop;
//     if (st > 120) {
//       if (st > lastScrollTop){
//         layoutSwitcherBar.classList.add('hidden-on-scroll');
//       } else {
//         layoutSwitcherBar.classList.remove('hidden-on-scroll');
//       }
//     } else {
//       layoutSwitcherBar.classList.remove('hidden-on-scroll');
//     }
//     lastScrollTop = st <= 0 ? 0 : st;
//   }
// }, false);

// 2. L√≥gica para mudar o Layout (Bot√µes da barra) - REMOVIDO
// Este event listener foi movido para o DOMContentLoaded para evitar conflitos

// --- FUN√á√ïES DE STORIES ---
function initStories() {
  try {
    console.log('üé† Inicializando stories...');
    const storiesWrapper = document.getElementById('stories-wrapper');
    
    if (!storiesWrapper) {
      console.error('‚ùå Elemento stories-wrapper n√£o encontrado');
      return;
    }
    
    // Usar window.PROFILES_DATA se existir (filtrado), sen√£o usar PROFILES_DATA local
    const dadosParaStories = (typeof window.PROFILES_DATA !== 'undefined' && window.PROFILES_DATA && window.PROFILES_DATA.length >= 0) 
      ? window.PROFILES_DATA 
      : PROFILES_DATA;
    
    console.log(`üìä Usando ${dadosParaStories.length} an√∫ncios para stories (filtrados: ${dadosParaStories === window.PROFILES_DATA})`);
    
    // Filtrar an√∫ncios que t√™m foto_stories (verificar m√∫ltiplos formatos)
    const anunciosComStories = dadosParaStories.filter(ad => {
      // Verificar no objeto principal
      const temStoryPrincipal = ad.foto_stories || ad.fotoStories || ad.stories_photo || ad.storiesPhoto || ad.foto_stories_url;
      
      // Verificar no originalData tamb√©m
      const temStoryOriginal = ad.originalData?.foto_stories || ad.originalData?.fotoStories || ad.originalData?.stories_photo || 
                               ad.originalData?.storiesPhoto || ad.originalData?.foto_stories_url;
      
      const temStory = temStoryPrincipal || temStoryOriginal;
      
      if (temStory) {
        console.log(`‚úÖ An√∫ncio "${ad.name}" tem story:`, {
          fotoStories: ad.fotoStories,
          stories_photo: ad.stories_photo,
          originalData_foto_stories: ad.originalData?.foto_stories,
          originalData_fotoStories: ad.originalData?.fotoStories
        });
      }
      return !!temStory;
    });
    console.log(`üì∏ ${anunciosComStories.length} an√∫ncios com stories encontrados de ${dadosParaStories.length} totais`);
    
    // Log detalhado dos an√∫ncios com stories
    if (anunciosComStories.length > 0) {
      console.log(`üìã Lista de an√∫ncios com stories:`, anunciosComStories.map(ad => ({
        tem_originalData: !!ad.originalData,
        originalData_foto_stories: ad.originalData?.foto_stories
      })));
    }
    
    // Limpar stories existentes
    storiesWrapper.innerHTML = '';
    
    // Criar container para o carrossel
    const carouselContainer = document.createElement('div');
    carouselContainer.className = 'stories-carousel-container';
    carouselContainer.style.cssText = `
      display: flex;
      overflow: hidden;
      width: 100%;
      position: relative;
      cursor: grab;
      user-select: none;
    `;
    
    // Criar trilha de stories (duplicada para loop infinito)
    const storiesTrack = document.createElement('div');
    storiesTrack.className = 'stories-track';
    storiesTrack.style.cssText = `
      display: flex;
      transition: transform 0.3s ease;
      will-change: transform;
    `;
    
    // Fun√ß√£o para criar um story item
    function createStoryItem(ad, index) {
      const storyItem = document.createElement('div');
      storyItem.className = 'text-center story-item';
      storyItem.style.cssText = `
        flex: 0 0 80px;
        margin: 0 8px;
        cursor: pointer;
        transition: transform 0.2s ease;
      `;
      
      // Usar foto_stories se dispon√≠vel, sen√£o usar foto principal
      // Verificar m√∫ltiplos formatos poss√≠veis
      const fotoStory = ad.foto_stories || ad.fotoStories || ad.stories_photo || ad.storiesPhoto || ad.foto_stories_url || ad.originalData?.foto_stories;
      let storyImage = ad.image; // Fallback padr√£o
      
      if (fotoStory) {
        // Se j√° √© uma URL completa, usar diretamente
        if (typeof fotoStory === 'string' && (fotoStory.startsWith('http://') || fotoStory.startsWith('https://'))) {
          storyImage = fotoStory;
        }
        // Se √© um caminho do Firebase Storage (gs://), construir URL
        else if (typeof fotoStory === 'string' && fotoStory.startsWith('gs://')) {
          // Converter gs:// para URL HTTP
          const path = fotoStory.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
          storyImage = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
        }
        // Se √© uma URL assinada do Firebase, usar diretamente
        else if (typeof fotoStory === 'string' && fotoStory.includes('firebasestorage.googleapis.com')) {
          storyImage = fotoStory;
        }
        else if (typeof fotoStory === 'string') {
          // Assumir que √© um caminho e construir URL
          const path = fotoStory.replace(/^\/+/, ''); // Remover barras iniciais
          storyImage = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
        }
        console.log(`üì∏ Story para ${ad.name}:`, {
          foto_stories_original: ad.foto_stories,
          fotoStory_encontrado: fotoStory,
          storyImage_final: storyImage
        });
      } else {
        // Tentar buscar no originalData tamb√©m
        const fotoStoryOriginal = ad.originalData?.foto_stories || ad.originalData?.fotoStories || ad.originalData?.stories_photo;
        if (fotoStoryOriginal) {
          if (typeof fotoStoryOriginal === 'string' && (fotoStoryOriginal.startsWith('http') || fotoStoryOriginal.includes('firebasestorage'))) {
            storyImage = fotoStoryOriginal;
          } else if (typeof fotoStoryOriginal === 'string') {
            const path = fotoStoryOriginal.replace(/^\/+/, '');
            storyImage = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
          }
          console.log(`üì∏ Story encontrado no originalData para ${ad.name}:`, storyImage);
        } else {
          console.log(`‚ö†Ô∏è An√∫ncio ${ad.name} n√£o tem foto_stories em nenhum formato`);
        }
      }
      
      storyItem.innerHTML = `
        <div class="rounded-circle overflow-hidden story-ring border border-danger mx-auto" style="width: 60px; height: 60px;">
          <img src="${storyImage}" class="story-thumb img-fluid" alt="${ad.name}" 
               style="width: 100%; height: 100%; object-fit: cover;"
               onerror="this.src='${ad.image}'">
        </div>
        <div class="story-name mt-2" style="font-size: 12px; color: #333;">${ad.name.split(' ')[0]}</div>
      `;
      
      // Click no story
      storyItem.addEventListener('click', (e) => {
        e.preventDefault();
        console.log('Story clicado:', ad.name);
      });
      
      return storyItem;
    }
    
    // Adicionar stories
    // Remover duplicatas por ID antes de adicionar (caso algum an√∫ncio tenha sido duplicado no array)
    const storiesUnicos = [...new Map(anunciosComStories.map(ad => [ad.id || ad.name || ad.originalData?.id, ad])).values()];
    const storiesToShow = storiesUnicos.slice(0, 20);
    
    console.log(`üìä Mostrando ${storiesToShow.length} stories √∫nicos (de ${anunciosComStories.length} an√∫ncios com stories)`);
    
    // Adicionar apenas UMA c√≥pia de cada story (sem duplica√ß√£o)
    storiesToShow.forEach((ad, index) => {
      storiesTrack.appendChild(createStoryItem(ad, index));
    });
    
    carouselContainer.appendChild(storiesTrack);
    storiesWrapper.appendChild(carouselContainer);
    
    console.log('‚úÖ Stories criados com sucesso');
    
    // Inicializar carrossel com o n√∫mero correto de stories √∫nicos
    initStoriesCarousel(carouselContainer, storiesTrack, storiesUnicos.length);
    
  } catch (error) {
    console.error('‚ùå Erro ao inicializar stories:', error);
  }
}

// Vari√°veis globais para o carrossel
let storiesCarousel = null;

function initStoriesCarousel(container, track, itemCount) {
  let currentIndex = 0;
  const itemWidth = 96; // 80px + 16px margin
  let animationId = null;
  let isPaused = false;
  let isDragging = false;
  let startX = 0;
  let scrollLeft = 0;
  
  // Fun√ß√£o para mover o carrossel (mais lenta e suave)
  function moveCarousel() {
    if (!isPaused && !isDragging) {
      currentIndex++;
      
      // Se chegou ao final, voltar ao in√≠cio
      if (currentIndex >= itemCount) {
        currentIndex = 0;
        // Resetar posi√ß√£o sem transi√ß√£o
        track.style.transition = 'none';
        track.style.transform = 'translateX(0px)';
        
        // For√ßar reflow
        track.offsetHeight;
        
        // Restaurar transi√ß√£o
        track.style.transition = 'transform 0.8s ease-in-out';
      } else {
        // Mover para o pr√≥ximo item com transi√ß√£o suave
        track.style.transition = 'transform 0.8s ease-in-out';
        const translateX = -currentIndex * itemWidth;
        track.style.transform = `translateX(${translateX}px)`;
      }
    }
    
    // Agendar pr√≥xima movimenta√ß√£o (mais lenta - 3 segundos)
    animationId = setTimeout(moveCarousel, 3000);
  }
  
  // Fun√ß√£o para pausar/retomar
  function pauseCarousel() {
    isPaused = true;
  }
  
  function resumeCarousel() {
    isPaused = false;
  }
  
  // Eventos de mouse
  container.addEventListener('mousedown', (e) => {
    isDragging = true;
    startX = e.pageX - container.offsetLeft;
    scrollLeft = currentIndex * itemWidth;
    pauseCarousel();
    container.style.cursor = 'grabbing';
  });
  
  container.addEventListener('mouseleave', () => {
    if (isDragging) {
      isDragging = false;
      resumeCarousel();
      container.style.cursor = 'grab';
    }
  });
  
  container.addEventListener('mouseup', () => {
    if (isDragging) {
      isDragging = false;
      resumeCarousel();
      container.style.cursor = 'grab';
    }
  });
  
  container.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    e.preventDefault();
    
    const x = e.pageX - container.offsetLeft;
    const walk = (x - startX) * 2; // Velocidade do arraste
    const newScrollLeft = scrollLeft - walk;
    
    // Calcular novo √≠ndice
    const newIndex = Math.round(newScrollLeft / itemWidth);
    if (newIndex >= 0 && newIndex < itemCount) {
      currentIndex = newIndex;
      const translateX = -currentIndex * itemWidth;
      track.style.transition = 'none';
      track.style.transform = `translateX(${translateX}px)`;
    }
  });
  
  // Eventos de touch para mobile
  container.addEventListener('touchstart', (e) => {
    isDragging = true;
    startX = e.touches[0].pageX - container.offsetLeft;
    scrollLeft = currentIndex * itemWidth;
    pauseCarousel();
  });
  
  container.addEventListener('touchend', () => {
    if (isDragging) {
      isDragging = false;
      resumeCarousel();
    }
  });
  
  container.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    e.preventDefault();
    
    const x = e.touches[0].pageX - container.offsetLeft;
    const walk = (x - startX) * 2;
    const newScrollLeft = scrollLeft - walk;
    
    const newIndex = Math.round(newScrollLeft / itemWidth);
    if (newIndex >= 0 && newIndex < itemCount) {
      currentIndex = newIndex;
      const translateX = -currentIndex * itemWidth;
      track.style.transition = 'none';
      track.style.transform = `translateX(${translateX}px)`;
    }
  });
  
  // Pausar quando hover
  container.addEventListener('mouseenter', pauseCarousel);
  container.addEventListener('mouseleave', resumeCarousel);
  
  // Iniciar anima√ß√£o
  moveCarousel();
  
  // Limpar anima√ß√£o quando a p√°gina for fechada
  window.addEventListener('beforeunload', () => {
    if (animationId) {
      clearTimeout(animationId);
    }
  });
  
  // Salvar refer√™ncia para controle
  storiesCarousel = {
    pause: pauseCarousel,
    resume: resumeCarousel,
    moveTo: (index) => {
      currentIndex = index;
      const translateX = -currentIndex * itemWidth;
      track.style.transform = `translateX(${translateX}px)`;
    }
  };
}

// --- AUTO-SCROLL BASEADO NA POSI√á√ÉO DO TOQUE ---
function initAutoScroll() {
  const scrollContainer = document.getElementById('stories-wrapper');
  let autoScroll = null;
  let direction = 0;
  let isTouching = false;

  // Para desktop - mouse hover nas bordas
  scrollContainer.addEventListener('mousemove', (e) => {
    if (isTouching) return;
   
    const { left, right, width } = scrollContainer.getBoundingClientRect();
    const x = e.clientX;
    const scrollSpeed = 3;
    const edgeThreshold = 80;

    clearInterval(autoScroll);

    const distanceLeft = x - left;
    const distanceRight = right - x;

    if (distanceLeft < edgeThreshold) {
      autoScroll = setInterval(() => {
        scrollContainer.scrollLeft -= scrollSpeed;
      }, 10);
    } else if (distanceRight < edgeThreshold) {
      autoScroll = setInterval(() => {
        scrollContainer.scrollLeft += scrollSpeed;
      }, 10);
    }
  });

  scrollContainer.addEventListener('mouseleave', () => {
    if (!isTouching) {
      clearInterval(autoScroll);
    }
  });

  // Para mobile - touch baseado na posi√ß√£o do dedo
  scrollContainer.addEventListener('touchstart', (e) => {
    isTouching = true;
    const touchX = e.touches[0].clientX;
    const screenWidth = window.innerWidth;
    const scrollSpeed = 1.5;

    direction = touchX < screenWidth / 2 ? -1 : 1;

    autoScroll = setInterval(() => {
      scrollContainer.scrollLeft += direction * scrollSpeed;
    }, 15);
  });

  scrollContainer.addEventListener('touchend', () => {
    isTouching = false;
    clearInterval(autoScroll);
  });

  scrollContainer.addEventListener('touchmove', (e) => {
    if (!isTouching) return;
   
    const touchX = e.touches[0].clientX;
    const screenWidth = window.innerWidth;
    const newDirection = touchX < screenWidth / 2 ? -1 : 1;
   
    if (newDirection !== direction) {
      direction = newDirection;
    }
  });
}

// --- FUN√á√ïES DO MENU HAMB√öRGUER ---
function initMenu() {
  const menuToggle = document.querySelector('.menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuOverlay = document.getElementById('menu-overlay');

  function toggleMenu() {
    mobileMenu.classList.toggle('open');
    menuOverlay.classList.toggle('active');
    
    if (mobileMenu.classList.contains('open')) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = '';
    }
  }

  function closeMenu() {
    mobileMenu.classList.remove('open');
    menuOverlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  // Event listeners
  menuToggle.addEventListener('click', toggleMenu);
  menuOverlay.addEventListener('click', closeMenu);

  // Fecha o menu quando clica em um link
  const menuLinks = mobileMenu.querySelectorAll('a');
  menuLinks.forEach(link => {
    link.addEventListener('click', closeMenu);
  });

  // Fecha o menu quando redimensiona a tela para desktop
  window.addEventListener('resize', () => {
    if (window.innerWidth > 768) {
      closeMenu();
    }
  });
}


function openProfileModal(profile) {
  const profileWindow = document.getElementById('profile-window');
  const profileCarousel = document.getElementById('profile-carousel');
  const carouselNav = document.getElementById('carousel-nav');
 
  document.getElementById('profile-name').textContent = profile.name;
  document.getElementById('profile-phrase').textContent = profile.phrase;
 
  profileCarousel.innerHTML = '';
  carouselNav.innerHTML = '';
 
  // Coletar todas as imagens dispon√≠veis do perfil
  currentProfileImages = [profile.image];
  
  // Se h√° dados originais do Firebase, tentar adicionar mais imagens
  if (profile.originalData) {
    const originalData = profile.originalData;
    
    // Adicionar galeria de fotos se dispon√≠vel
    if (originalData.mediaFiles?.galeria && Array.isArray(originalData.mediaFiles.galeria)) {
      originalData.mediaFiles.galeria.forEach(img => {
        if (img && img !== profile.image) {
          currentProfileImages.push(img);
        }
      });
    }
    
    // Adicionar outras fotos se dispon√≠vel
    if (originalData.fotoPerfil && originalData.fotoPerfil !== profile.image) {
      currentProfileImages.push(originalData.fotoPerfil);
    }
  }
  
  // Criar carrossel com todas as imagens
  currentProfileImages.forEach((image, index) => {
    const carouselItem = document.createElement('div');
    carouselItem.className = 'carousel-item';
   
    const img = document.createElement('img');
    img.src = image;
    img.alt = `${profile.name} - Foto ${index + 1}`;
    img.onerror = () => {
      // Se a imagem falhar, usar placeholder
      img.src = `https://picsum.photos/300/400?random=${Math.random()}`;
    };
   
    carouselItem.appendChild(img);
    profileCarousel.appendChild(carouselItem);
   
    const dot = document.createElement('div');
    dot.className = `carousel-dot ${index === 0 ? 'active' : ''}`;
    dot.setAttribute('data-index', index);
    dot.addEventListener('click', () => scrollToCarouselItem(index));
    carouselNav.appendChild(dot);
  });
  
  // Adicionar informa√ß√µes adicionais se dispon√≠vel
  addProfileDetails(profile);
 
  profileWindow.classList.add('show');
}

// Fun√ß√£o para adicionar detalhes do perfil
function addProfileDetails(profile) {
  const profileWindow = document.getElementById('profile-window');
  
  // Remover detalhes anteriores se existirem
  const existingDetails = profileWindow.querySelector('.profile-details');
  if (existingDetails) {
    existingDetails.remove();
  }
  
  // Criar se√ß√£o de detalhes
  const detailsSection = document.createElement('div');
  detailsSection.className = 'profile-details';
  detailsSection.style.cssText = `
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-light);
  `;
  
  let detailsHTML = '';
  
  // Informa√ß√µes b√°sicas
  if (profile.cidade && profile.estado) {
    detailsHTML += `
      <div style="margin-bottom: 0.5rem;">
        <strong>üìç Localiza√ß√£o:</strong> ${profile.cidade}, ${profile.estado}
      </div>
    `;
  }
  
  if (profile.preco_1h) {
    detailsHTML += `
      <div style="margin-bottom: 0.5rem;">
        <strong>üí∞ Pre√ßo 1h:</strong> R$ ${profile.preco_1h}
      </div>
    `;
  }
  
  if (profile.status) {
    detailsHTML += `
      <div style="margin-bottom: 0.5rem;">
        <strong>üìä Status:</strong> ${profile.status}
      </div>
    `;
  }
  
  if (profile.info) {
    detailsHTML += `
      <div style="margin-bottom: 0.5rem;">
        <strong>‚≠ê N√≠vel:</strong> ${profile.info}
      </div>
    `;
  }
  
  // Se h√° dados originais do Firebase, mostrar informa√ß√µes adicionais
  if (profile.originalData) {
    const originalData = profile.originalData;
    
    if (originalData.preco_30min) {
      detailsHTML += `
        <div style="margin-bottom: 0.5rem;">
          <strong>‚è∞ 30min:</strong> R$ ${originalData.preco_30min}
        </div>
      `;
    }
    
    if (originalData.preco_45min) {
      detailsHTML += `
        <div style="margin-bottom: 0.5rem;">
          <strong>‚è∞ 45min:</strong> R$ ${originalData.preco_45min}
        </div>
      `;
    }
    
    if (originalData.telefone) {
      detailsHTML += `
        <div style="margin-bottom: 0.5rem;">
          <strong>üìû Telefone:</strong> ${originalData.telefone}
        </div>
      `;
    }
    
    if (originalData.whatsapp) {
      detailsHTML += `
        <div style="margin-bottom: 0.5rem;">
          <strong>üí¨ WhatsApp:</strong> ${originalData.whatsapp}
        </div>
      `;
    }
  }
  
  if (detailsHTML) {
    detailsSection.innerHTML = `
      <h4 style="color: var(--primary-color); margin-bottom: 0.5rem; font-size: 1.1rem;">Informa√ß√µes do Perfil</h4>
      ${detailsHTML}
    `;
    profileWindow.appendChild(detailsSection);
  }
}

function scrollToCarouselItem(index) {
  const profileCarousel = document.getElementById('profile-carousel');
  const carouselNav = document.getElementById('carousel-nav');
 
  const carouselItems = profileCarousel.querySelectorAll('.carousel-item');
  if (carouselItems[index]) {
    carouselItems[index].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
   
    const dots = carouselNav.querySelectorAll('.carousel-dot');
    dots.forEach((dot, i) => {
      dot.classList.toggle('active', i === index);
    });
  }
}

function closeProfileModal() {
  const profileWindow = document.getElementById('profile-window');
  profileWindow.classList.remove('show');
}



// --- INICIALIZA√á√ÉO ---
window.onload = async () => {
  // Mostrar loading state
  showLoadingState();
  
  try {
    // Carregar dados diretamente do Firebase Firestore
    PROFILES_DATA = await loadProfilesFromFirebase();
    window.PROFILES_DATA = PROFILES_DATA; // Sincronizar para o sistema de filtro
    console.log('üîÑ Dados carregados:', PROFILES_DATA.length, 'an√∫ncios');
    
    // Disparar evento para que o sistema de filtro saiba que os dados foram carregados
    window.dispatchEvent(new CustomEvent('profilesDataLoaded', {
      detail: {
        total: PROFILES_DATA.length,
        data: PROFILES_DATA
      }
    }));
    
    // Escutar eventos de filtro para re-renderizar
    window.addEventListener('anunciosFiltradosPorEstado', function(event) {
      console.log('üì¢ Evento de filtro recebido:', event.detail);
      console.log(`üîÑ Re-renderizando com ${event.detail.anuncios.length} an√∫ncios filtrados`);
      
      // Atualizar stories com os dados filtrados
      if (typeof initStories === 'function') {
        console.log('üé† Atualizando stories ap√≥s filtro');
        initStories();
      }
      
      // For√ßar re-renderiza√ß√£o
      if (typeof generateTieredGrid === 'function') {
        console.log('üé® Chamando generateTieredGrid ap√≥s filtro');
        generateTieredGrid();
      } else if (typeof handleManualLayoutSwitch === 'function') {
        console.log('üé® Chamando handleManualLayoutSwitch ap√≥s filtro');
        const currentLevel = window.currentLayoutLevel || 'n7';
        handleManualLayoutSwitch(currentLevel);
      }
    });
    
    // C√≥digo de debug espec√≠fico removido

    // Inicializar componentes
    // Aguardar um pouco para garantir que o filtro seja aplicado primeiro
    setTimeout(() => {
      initStories();
    }, 100);
    initMenu();
    renderGallery();
    
    // Garantir que todos os cards est√£o vis√≠veis ap√≥s renderiza√ß√£o
    setTimeout(() => {
      // Seletores que cobrem todos os tipos de cards poss√≠veis no site
      const cardSelectors = [
        '.mobile-layout-2-gallery',
        '.mobile-layout-3-gallery',
        '.mobile-layout-1-featured',
        '.pub-book-item',
        '.acompanhante-card',
        '.mobile-layout-3',
        '.mobile-layout-preview',
        '.mobile-layout-news'
      ];
      const cards = document.querySelectorAll(cardSelectors.join(', '));
      
      console.log('üîç Cards encontrados no DOM:', cards.length);
      
      if (cards.length > 0) {
        // Certificar-se que os cards est√£o vis√≠veis (evita que CSS/JS os esconda)
        cards.forEach(card => {
          card.style.display = '';       // '' permite que CSS assuma o display correto
          card.style.visibility = 'visible';
          card.style.opacity = '1';
        });
        console.log(`‚úÖ ${cards.length} an√∫ncios exibidos`);
      }
    }, 80);
    
    // Esconder loading state
    hideLoadingState();
    
    console.log("‚úÖ P√°gina carregada com sucesso com dados do Firebase!");
    
  } catch (error) {
    console.error("‚ùå Erro ao inicializar p√°gina:", error);
    hideLoadingState();
    
    // Mesmo com erro, inicializar com dados de fallback
    initStories();
    initMenu();
    renderGallery();
  }
};

window.addEventListener('resize', renderGallery);

// Fun√ß√£o para mostrar estado de carregamento
function showLoadingState() {
  const loadingOverlay = document.createElement('div');
  loadingOverlay.id = 'loading-overlay';
  loadingOverlay.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.9);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    font-family: 'Roboto', Arial, sans-serif;
  `;
  
  loadingOverlay.innerHTML = `
    <div style="text-align: center;">
      <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #e25352; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
      <h3 style="color: #e25352; margin-bottom: 10px;">Carregando perfis...</h3>
      <p style="color: #666; font-size: 14px;">Buscando dados do Firebase</p>
    </div>
  `;
  
  const style = document.createElement('style');
  style.textContent = `
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `;
  document.head.appendChild(style);
  
  document.body.appendChild(loadingOverlay);
}

// Fun√ß√£o para esconder estado de carregamento
function hideLoadingState() {
  const loadingOverlay = document.getElementById('loading-overlay');
  if (loadingOverlay) {
    loadingOverlay.remove();
  }
}

// Fun√ß√£o para controlar o indicador de fonte de dados
function showDataSourceIndicator(message, type = "loading") {
  const indicator = document.getElementById('data-source-indicator');
  const text = document.getElementById('data-source-text');
  
  if (indicator && text) {
    text.textContent = message;
    indicator.className = `data-source-indicator ${type}`;
    indicator.style.display = 'block';
    
    // Auto-hide ap√≥s 5 segundos para mensagens de sucesso
    if (type === "success") {
      setTimeout(() => {
        indicator.style.display = 'none';
      }, 5000);
    }
  }
}

// Fun√ß√£o para esconder o indicador de fonte de dados
function hideDataSourceIndicator() {
  const indicator = document.getElementById('data-source-indicator');
  if (indicator) {
    indicator.style.display = 'none';
  }
}

// Fun√ß√£o para mostrar mensagem de erro na interface
function showErrorMessage(message) {
  const galleryGrid = document.getElementById('gallery-grid');
  if (galleryGrid) {
    galleryGrid.innerHTML = `
      <div class="error-message-container" style="
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 400px;
        text-align: center;
        padding: 2rem;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        margin: 2rem 0;
      ">
        <div style="
          font-size: 4rem;
          color: #e25352;
          margin-bottom: 1rem;
        ">‚ö†Ô∏è</div>
        <h3 style="
          color: #e25352;
          margin-bottom: 1rem;
          font-size: 1.5rem;
        ">Sistema Indispon√≠vel</h3>
        <p style="
          color: #666;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
          max-width: 500px;
          line-height: 1.6;
        ">${message}</p>
        <div style="
          background: #f8f9fa;
          padding: 1rem;
          border-radius: 8px;
          border-left: 4px solid #e25352;
          max-width: 600px;
        ">
          <h4 style="color: #333; margin-bottom: 0.5rem;">Para resolver:</h4>
          <ol style="
            text-align: left;
            color: #666;
            margin: 0;
            padding-left: 1.5rem;
          ">
            <li>Verifique se o Firebase est√° configurado corretamente</li>
            <li>Verifique se a cole√ß√£o 'anuncios' ou 'advertisements' existe no Firestore</li>
            <li>Configure as credenciais do Firebase</li>
            <li>Recarregue a p√°gina</li>
          </ol>
        </div>
        <button onclick="location.reload()" style="
          background: #e25352;
          color: white;
          border: none;
          padding: 0.75rem 1.5rem;
          border-radius: 5px;
          font-size: 1rem;
          cursor: pointer;
          margin-top: 1rem;
          transition: background 0.3s;
        " onmouseover="this.style.background='#d44443'" onmouseout="this.style.background='#e25352'">
          üîÑ Recarregar P√°gina
        </button>
      </div>
    `;
  }
}

// Fun√ß√£o global para fechar modal de perfil
window.closeProfileModal = closeProfileModal;

// ================================== */
// ========== FUN√á√ïES DO POPUP DE CADASTRO ========== */
// ================================== */

// Fun√ß√£o para abrir o popup de cadastro
function openCadastroPopup() {
  const popup = document.getElementById('cadastro-popup');
  if (popup) {
    popup.classList.add('show');
    document.body.style.overflow = 'hidden'; // Previne scroll do body
  }
}

// Fun√ß√£o para fechar o popup de cadastro
function closeCadastroPopup() {
  const popup = document.getElementById('cadastro-popup');
  if (popup) {
    popup.classList.remove('show');
    document.body.style.overflow = ''; // Restaura scroll do body
  }
}

// Fun√ß√£o global para abrir popup de cadastro
window.openCadastroPopup = openCadastroPopup;
window.closeCadastroPopup = closeCadastroPopup;

// Fechar popup ao clicar no overlay
document.addEventListener('DOMContentLoaded', function() {
  const popup = document.getElementById('cadastro-popup');
  if (popup) {
    popup.addEventListener('click', function(e) {
      if (e.target === popup) {
        closeCadastroPopup();
      }
    });
  }
  
  // Fechar popup com tecla ESC
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeCadastroPopup();
    }
  });
});

// ================================== */
// ========== FUN√á√ïES DO CONTAINER DE CATEGORIAS ========== */
// ================================== */

// Vari√°veis para controlar o estado das categorias e layout switcher
let categoriesHidden = false;
let layoutSwitcherHidden = false;
let lastScrollY = 0;
let scrollThreshold = 100; // pixels para considerar scroll significativo

// Fun√ß√£o para esconder o container de categorias
function hideCategoriesContainer() {
  const container = document.querySelector('.categories-container');
  const scrollY = window.scrollY;
  const isMobile = window.innerWidth <= 1024;
  
  // Comportamento padr√£o (igual ao N7): n√£o esconder se estiver no topo (scroll <= 10px)
  // Para layouts N7 e N1, esconder quando rola para baixo
  if (scrollY <= 10 && isMobile) {
    return; // Manter vis√≠vel quando no topo
  }
  
  if (container && !categoriesHidden) {
    // Aplicar height: 0 imediatamente para liberar espa√ßo
    container.style.height = '0';
    container.style.padding = '0';
    container.style.margin = '0';
    container.style.overflow = 'hidden';
    container.classList.add('fade-out');
    setTimeout(() => {
      container.classList.add('hidden');
      container.classList.remove('fade-out');
    }, 300);
    categoriesHidden = true;
  }
}

// Fun√ß√£o para mostrar o container de categorias
function showCategoriesContainer() {
  const container = document.querySelector('.categories-container');
  const isMobile = window.innerWidth <= 1024; // Inclui tablets
  const mainHeader = document.querySelector('.main-header');
  const isHeaderTransparent = mainHeader && mainHeader.classList.contains('scrolled');
  const scrollY = window.scrollY;
  
  // Comportamento padr√£o (igual ao N7): sempre mostrar quando no topo (scroll <= 10px)
  // Para layouts N7 e N1, esconder quando rola para baixo
  if (scrollY <= 10 && isMobile) {
    if (container) {
      container.classList.remove('hidden');
      container.style.display = 'flex'; // Garantir que est√° vis√≠vel
      container.style.height = '';
      container.style.padding = '';
      container.style.margin = '';
      container.style.overflow = '';
      categoriesHidden = false;
    }
    return;
  }
  
  // CORRE√á√ÉO: N√£o mostrar categorias se estiver em mobile/tablet com header transparente
  if (isMobile && isHeaderTransparent) {
    return;
  }
  
  if (container && categoriesHidden) {
    container.classList.remove('hidden');
    container.style.display = 'flex'; // Garantir que est√° vis√≠vel
    // Restaurar altura e padding
    container.style.height = '';
    container.style.padding = '';
    container.style.margin = '';
    container.style.overflow = '';
    container.classList.add('show');
    setTimeout(() => {
      container.classList.remove('show');
    }, 300);
    categoriesHidden = false;
  }
}

// Fun√ß√£o para controlar visibilidade baseada no scroll
function handleScroll() {
  const currentScrollY = window.scrollY;
  const isMobile = window.innerWidth <= 1024; // Inclui tablets
  const mainHeader = document.querySelector('.main-header');
  const isHeaderTransparent = mainHeader && mainHeader.classList.contains('scrolled');
  const floatingMenuToggle = document.getElementById('floatingMenuToggle');
  
  // Debug: log apenas quando necess√°rio (comentado para reduzir polui√ß√£o do console)
  // console.log('üìú handleScroll chamada:', {
  //   currentScrollY: currentScrollY,
  //   lastScrollY: lastScrollY,
  //   isScrollingDown: currentScrollY > lastScrollY,
  //   isMobile: isMobile,
  //   categoriesHidden: categoriesHidden,
  //   layoutSwitcherHidden: layoutSwitcherHidden
  // });
  
  // Comportamento padr√£o (igual ao N7): sempre mostrar quando no topo (scroll <= 10px)
  // Para layouts N7 e N1, esconder quando rola para baixo
  if (currentScrollY <= 10) {
    const layoutSwitcherBar = document.getElementById('layout-switcher-bar');
    const categoriesContainer = document.querySelector('.categories-container');
    
    // Garantir que ambos estejam vis√≠veis quando no topo
    if (layoutSwitcherBar) {
      layoutSwitcherBar.classList.remove('hidden');
      layoutSwitcherBar.style.display = 'flex';
      layoutSwitcherBar.style.height = '';
      layoutSwitcherBar.style.padding = '';
      layoutSwitcherBar.style.margin = '';
      layoutSwitcherBar.style.overflow = '';
      layoutSwitcherHidden = false;
    }
    
    if (categoriesContainer) {
      categoriesContainer.classList.remove('hidden');
      categoriesContainer.style.display = 'flex';
      categoriesContainer.style.height = '';
      categoriesContainer.style.padding = '';
      categoriesContainer.style.margin = '';
      categoriesContainer.style.overflow = '';
      categoriesHidden = false;
    }
    
    if (floatingMenuToggle) {
      floatingMenuToggle.classList.remove('show');
    }
    lastScrollY = currentScrollY;
    return;
  }
  
  // CORRE√á√ÉO: Para mobile/tablet, se o header estiver transparente, manter categorias ocultas
  if (isMobile && isHeaderTransparent) {
    hideCategoriesContainer();
    hideLayoutSwitcher();
    // Mostrar menu sandu√≠che quando barras estiverem escondidas
    if (floatingMenuToggle) {
      floatingMenuToggle.classList.add('show');
    }
    lastScrollY = currentScrollY;
    return;
  }
  
  // Se est√° rolando para baixo e passou de 10px, esconder ambas as barras imediatamente
  // Comportamento igual para layouts N7 e N1 (e outros layouts)
  if (currentScrollY > lastScrollY && currentScrollY > 10) {
    console.log('‚¨áÔ∏è Rolando para baixo - escondendo barras');
    // N√£o verificar scroll <= 50 aqui, deixar as fun√ß√µes hideCategoriesContainer e hideLayoutSwitcher decidirem
    hideLayoutSwitcher();
    hideCategoriesContainer();
    // Mostrar menu sandu√≠che quando barras estiverem escondidas (apenas em mobile/tablet)
    if (floatingMenuToggle && isMobile) {
      floatingMenuToggle.classList.add('show');
    }
  }
  // Se est√° rolando para cima significativamente, mostrar ambos (apenas se n√£o estiver em modo transparente)
  else if (currentScrollY < lastScrollY && currentScrollY > scrollThreshold && !isHeaderTransparent) {
    showCategoriesContainer();
    showLayoutSwitcher();
    // Esconder menu sandu√≠che quando barras estiverem vis√≠veis
    if (floatingMenuToggle) {
      floatingMenuToggle.classList.remove('show');
    }
  }
  // Se est√° parado mas com scroll > 10px, manter barras escondidas (caso n√£o tenha detectado antes)
  else if (currentScrollY > 10 && currentScrollY === lastScrollY) {
    // Se as barras est√£o vis√≠veis mas deveriam estar escondidas, esconder
    if (!categoriesHidden || !layoutSwitcherHidden) {
      hideLayoutSwitcher();
      hideCategoriesContainer();
      if (floatingMenuToggle) {
        floatingMenuToggle.classList.add('show');
      }
    }
  }
  
  lastScrollY = currentScrollY;
}

// Fun√ß√£o para esconder o layout switcher
function hideLayoutSwitcher() {
  const layoutSwitcher = document.getElementById('layout-switcher-bar');
  const scrollY = window.scrollY;
  const isMobile = window.innerWidth <= 1024;
  
  // Comportamento padr√£o (igual ao N7): n√£o esconder se estiver no topo (scroll <= 10px)
  // Para layouts N7 e N1, esconder quando rola para baixo
  if (scrollY <= 10 && isMobile) {
    return; // Manter vis√≠vel quando no topo
  }
  
  if (layoutSwitcher && !layoutSwitcherHidden) {
    // Aplicar height: 0 imediatamente para liberar espa√ßo
    layoutSwitcher.style.height = '0';
    layoutSwitcher.style.padding = '0';
    layoutSwitcher.style.margin = '0';
    layoutSwitcher.style.overflow = 'hidden';
    layoutSwitcher.classList.add('fade-out');
    setTimeout(() => {
      layoutSwitcher.classList.add('hidden');
      layoutSwitcher.classList.remove('fade-out');
    }, 300);
    layoutSwitcherHidden = true;
  }
}

// Fun√ß√£o para mostrar o layout switcher
function showLayoutSwitcher() {
  const layoutSwitcher = document.getElementById('layout-switcher-bar');
  const scrollY = window.scrollY;
  const isMobile = window.innerWidth <= 1024;
  
  // Comportamento padr√£o (igual ao N7): sempre mostrar quando no topo (scroll <= 10px)
  // Para layouts N7 e N1, esconder quando rola para baixo
  if (scrollY <= 10 && isMobile) {
    if (layoutSwitcher) {
      layoutSwitcher.classList.remove('hidden');
      layoutSwitcher.style.display = 'flex'; // Garantir que est√° vis√≠vel
      layoutSwitcher.style.height = '';
      layoutSwitcher.style.padding = '';
      layoutSwitcher.style.margin = '';
      layoutSwitcher.style.overflow = '';
      layoutSwitcherHidden = false;
    }
    return;
  }
  
  if (layoutSwitcher && layoutSwitcherHidden) {
    layoutSwitcher.classList.remove('hidden');
    layoutSwitcher.style.display = 'flex'; // Restaurar display
    // Restaurar altura e padding
    layoutSwitcher.style.height = '';
    layoutSwitcher.style.padding = '';
    layoutSwitcher.style.margin = '';
    layoutSwitcher.style.overflow = '';
    layoutSwitcher.classList.add('show');
    setTimeout(() => {
      layoutSwitcher.classList.remove('show');
    }, 300);
    layoutSwitcherHidden = false;
  }
}

// Fun√ß√£o para esconder ap√≥s clique em categoria
function handleCategoryClick() {
  // Pequeno delay para permitir que o link funcione
  setTimeout(() => {
    // Comportamento padr√£o: s√≥ esconder se estiver com scroll > 10px
    // Se estiver no topo, manter vis√≠vel (comportamento padr√£o igual ao N7)
    const scrollY = window.scrollY;
    const isMobile = window.innerWidth <= 1024;
    
    if (scrollY > 10 && isMobile) {
      hideCategoriesContainer();
      hideLayoutSwitcher();
    }
    // Se estiver no topo (scroll <= 10px), n√£o esconder (comportamento padr√£o igual ao N7)
  }, 100);
}

// Fun√ß√£o para esconder ap√≥s clique no layout switcher
function handleLayoutClick() {
  // Pequeno delay para permitir que a funcionalidade funcione
  setTimeout(() => {
    // Comportamento padr√£o: s√≥ esconder se estiver com scroll > 10px
    // Se estiver no topo, manter vis√≠vel (comportamento padr√£o igual ao N7)
    const scrollY = window.scrollY;
    const isMobile = window.innerWidth <= 1024;
    
    if (scrollY > 10 && isMobile) {
      hideLayoutSwitcher();
    }
    // Se estiver no topo (scroll <= 10px), n√£o esconder (comportamento padr√£o igual ao N7)
  }, 200);
}

// === Substitui o bloco DOMContentLoaded que apenas ligava handleLayoutClick ===
// Este bloco garante que ao clicar num √≠cone ele:
// 1) aplica a classe "active" ao √≠cone
// 2) chama handleManualLayoutSwitch(...) para reconstruir o grid
// 3) depois chama hideLayoutSwitcher() (com pequeno delay) para manter a UX

document.addEventListener('DOMContentLoaded', function() {
  // Links de categoria ‚Äî mantemos o comportamento existente
  const categoryLinks = document.querySelectorAll('.category-link');
  categoryLinks.forEach(link => {
    link.addEventListener('click', handleCategoryClick);
  });

  // √çcones do layout ‚Äî substitui listeners antigos por este
  const layoutIcons = document.querySelectorAll('#layout_anuncios .layout-icon');
  layoutIcons.forEach(icon => {
    icon.addEventListener('click', function(event) {
      event.preventDefault();

      // Sempre atualizar visual do √≠cone
      layoutIcons.forEach(i => i.classList.remove('active'));
      this.classList.add('active');

      // Para debug r√°pido (abre console do browser)
      console.log('Layout switch clicked ->', this.dataset.layout, 'innerWidth:', window.innerWidth);

      // Salvar o layout selecionado no localStorage
      const selectedLayout = this.dataset.layout;
      localStorage.setItem('selectedLayout', selectedLayout);
      console.log('üíæ Layout salvo no localStorage:', selectedLayout);

      // Se quiseres for√ßar a troca mesmo em desktop, remove/ajusta o if abaixo.
      if (window.innerWidth <= 768) {
        // Chama a fun√ß√£o que reconstr√≥i o grid para mobile/tablet
        handleManualLayoutSwitch(this.dataset.layout);
      } else {
        // Se estiver em desktop e quiseres ver a troca (√∫til em dev), podes descomentar:
        // handleManualLayoutSwitch(this.dataset.layout);
        console.log('Troca de layout filtrada por largura (>768px). Para testar em desktop, ajuste o condicional.');
      }

      // Comportamento padr√£o: s√≥ esconder se estiver com scroll > 10px
      // Se estiver no topo, manter vis√≠vel (comportamento padr√£o igual ao N7)
      setTimeout(() => {
        const scrollY = window.scrollY;
        const isMobile = window.innerWidth <= 1024;
        
        if (scrollY > 10 && isMobile) {
          hideLayoutSwitcher();
        }
        // Se estiver no topo (scroll <= 10px), n√£o esconder (comportamento padr√£o igual ao N7)
      }, 160);
    });
  });

  // Event listener de scroll - chama handleScroll imediatamente
  let scrollTimeout;
  window.addEventListener('scroll', function() {
    // Chamar imediatamente para resposta r√°pida
    handleScroll();
    // Tamb√©m usar timeout para otimiza√ß√£o (debounce)
    if (scrollTimeout) {
      clearTimeout(scrollTimeout);
    }
    scrollTimeout = setTimeout(function() {
      // Verificar novamente ap√≥s um pequeno delay para garantir
      handleScroll();
    }, 50);
  }, { passive: true });
  
  // Chamar handleScroll no carregamento inicial para garantir estado correto
  setTimeout(function() {
    handleScroll();
  }, 100);

  // Expor fun√ß√£o de reset para debug
  window.resetCategories = function() {
    showCategoriesContainer();
    showLayoutSwitcher();
  };
});

// ================================== */
// ========== FUN√á√ïES DO HEADER LEFT ========== */
// ================================== */


// Inicializar funcionalidades do header-left
document.addEventListener('DOMContentLoaded', function() {
  // Elementos para header transparente
  const mainHeader = document.querySelector('.main-header');
  const floatingMenuToggle = document.getElementById('floatingMenuToggle');
  const floatingMenu = document.getElementById('floatingMenu');
  const categoriesContainer = document.querySelector('.categories-container');
  
  // Vari√°veis para controle do scroll
  let isScrolled = false;
  let scrollThreshold = 100; // pixels para ativar transpar√™ncia
  
  // Fun√ß√£o para controlar header transparente em mobile/tablet
  function handleHeaderTransparency() {
    const isMobile = window.innerWidth <= 1024; // Inclui tablets
    const scrollY = window.scrollY;
    const layoutSwitcherBar = document.getElementById('layout-switcher-bar');
    const categoriesContainer = document.querySelector('.categories-container');
    
    // Comportamento padr√£o: sempre mostrar barra de layout e categorias quando no topo
    // Para layouts N7 e N1, esconder quando rola para baixo (scroll > 10px)
    if (isMobile && scrollY > 10) { // Mudan√ßa: qualquer scroll > 10px esconde tudo (igual ao N7)
      if (!isScrolled) {
        // Ativar modo transparente - esconder tudo
        mainHeader.classList.add('scrolled');
        document.body.classList.add('header-transparent');
        // CORRE√á√ÉO: For√ßar escondimento das categorias quando header transparente
        if (categoriesContainer) {
          categoriesContainer.classList.add('hidden');
        }
        if (layoutSwitcherBar) {
          layoutSwitcherBar.style.display = 'none';
        }
        floatingMenuToggle.classList.add('show');
        isScrolled = true;
      }
    } else if (scrollY <= 10) { // S√≥ mostra quando estiver muito pr√≥ximo do topo (igual ao N7)
      if (isScrolled) {
        // Desativar modo transparente - mostrar tudo
        mainHeader.classList.remove('scrolled');
        document.body.classList.remove('header-transparent');
        // CORRE√á√ÉO: Mostrar categorias e barra de layout sempre quando no topo
        // Comportamento padr√£o igual para todos os layouts (n7, n2, n3, n1)
        if (categoriesContainer) {
          categoriesContainer.classList.remove('hidden');
          categoriesContainer.style.display = 'flex'; // Garantir que est√° vis√≠vel
        }
        if (layoutSwitcherBar) {
          layoutSwitcherBar.style.display = 'flex';
        }
        floatingMenuToggle.classList.remove('show');
        floatingMenu.classList.remove('show');
        isScrolled = false;
      }
    }
  }
  
  // Event listener para scroll
  let scrollTimeout;
  window.addEventListener('scroll', function() {
    if (scrollTimeout) {
      clearTimeout(scrollTimeout);
    }
    scrollTimeout = setTimeout(handleHeaderTransparency, 10);
  });
  
  // Fun√ß√£o para mostrar header temporariamente
  function showHeaderTemporarily() {
    if (isScrolled) {
      const layoutSwitcherBar = document.getElementById('layout-switcher-bar');
      const categoriesContainer = document.querySelector('.categories-container');
      
      // Mostrar header temporariamente
      mainHeader.classList.remove('scrolled');
      document.body.classList.remove('header-transparent');
      // CORRE√á√ÉO: Mostrar categorias temporariamente quando clicar no menu
      if (categoriesContainer) {
        categoriesContainer.classList.remove('hidden');
      }
      if (layoutSwitcherBar) {
        layoutSwitcherBar.style.display = 'flex';
      }
      floatingMenuToggle.classList.remove('show');
      floatingMenu.classList.remove('show');
      isScrolled = false;
      
      // Voltar ao modo transparente ap√≥s 3 segundos se n√£o estiver no topo
      setTimeout(() => {
        if (window.scrollY > 10) { // Mudan√ßa: usar mesmo threshold de 10px (igual ao N7)
          mainHeader.classList.add('scrolled');
          document.body.classList.add('header-transparent');
          // CORRE√á√ÉO: Esconder categorias quando voltar ao modo transparente
          if (categoriesContainer) {
            categoriesContainer.classList.add('hidden');
          }
          if (layoutSwitcherBar) {
            layoutSwitcherBar.style.display = 'none';
          }
          floatingMenuToggle.classList.add('show');
          isScrolled = true;
        }
      }, 3000);
    }
  }

  // Event listener para o menu flutuante
  if (floatingMenuToggle) {
    floatingMenuToggle.addEventListener('click', function(e) {
      e.stopPropagation();
      floatingMenu.classList.toggle('show');
      // Mostrar barras quando clicar no menu sandu√≠che
      showCategoriesContainer();
      showLayoutSwitcher();
      // Esconder menu sandu√≠che temporariamente quando as barras aparecerem
      // Se o usu√°rio rolar novamente, o handleScroll vai mostrar o menu de novo
      floatingMenuToggle.classList.remove('show');
    });
  }
  
  // Fechar menu flutuante ao clicar fora
  document.addEventListener('click', function(e) {
    if (floatingMenu && floatingMenuToggle && 
        !floatingMenu.contains(e.target) && 
        !floatingMenuToggle.contains(e.target)) {
      floatingMenu.classList.remove('show');
    }
  });
  
  
});

</script>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Entrar</h5>
            <button
              type="button"
              class="close btn btn-default btn-circle"
              data-dismiss="modal"
              aria-label="Close"
              onclick="document.getElementById('loginModal').classList.remove('show')"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <form id="loginForm">
              <div class="row">
                <div class="form-group col-12 text-center">
                  <a
                    href="https://accounts.google.com/o/oauth2/v2/auth?response_type=code&access_type=online&client_id=YOUR_CLIENT_ID&redirect_uri=YOUR_REDIRECT_URI&state&scope=email%20profile&approval_prompt=auto"
                    class="google-button"
                    style="
                      display: flex;
                      align-items: center;
                      justify-content: center;
                      gap: 10px;
                      width: 100%;
                      padding: 12px;
                      background-color: #fff;
                      border: 1px solid #ddd;
                      border-radius: 4px;
                      cursor: pointer;
                      margin-bottom: 20px;
                      text-decoration: none;
                      color: #333;
                    "
                  >
                    <svg
                      class="google-icon"
                      xmlns="https://www.w3.org/2000/svg"
                      width="20"
                      height="24"
                      viewBox="0 0 40 48"
                      aria-hidden="true"
                    >
                      <path
                        fill="#4285F4"
                        d="M39.2 24.45c0-1.55-.16-3.04-.43-4.45H20v8h10.73c-.45 2.53-1.86 4.68-4 6.11v5.05h6.5c3.78-3.48 5.97-8.62 5.97-14.71z"
                      ></path>
                      <path
                        fill="#34A853"
                        d="M20 44c5.4 0 9.92-1.79 13.24-4.84l-6.5-5.05C24.95 35.3 22.67 36 20 36c-5.19 0-9.59-3.51-11.15-8.23h-6.7v5.2C5.43 39.51 12.18 44 20 44z"
                      ></path>
                      <path
                        fill="#FABB05"
                        d="M8.85 27.77c-.4-1.19-.62-2.46-.62-3.77s.22-2.58.62-3.77v-5.2h-6.7C.78 17.73 0 20.77 0 24s.78 6.27 2.14 8.97l6.71-5.2z"
                      ></path>
                      <path
                        fill="#E94235"
                        d="M20 12c2.9 0 5.52 1 7.54 2.64l5.66-5.66C29.78 4.9 25.18 2 20 2 12.18 2 5.43 6.49 2.14 12.97l6.71 5.2C10.41 15.51 14.81 12 20 12z"
                      ></path>
                    </svg>
                    <span>Entrar com Google</span>
                  </a>
                </div>
              </div>
              <div class="row">
                <div class="form-group col-12">
                  <label class="form-control-label">Email</label>
                  <div class="position-relative">
                    <div class="input-prepend">
                      <i class="fa fa-envelope"></i>
                    </div>
                    <input
                      type="email"
                      class="form-control"
                      name="user_email"
                      id="user_email"
                      required
                      placeholder="Digite seu email"
                      onkeypress="return /[a-zA-Z0-9@._-]/.test(event.key)"
                      maxlength="100"
                      style="padding-left: 40px"
                    />
                  </div>
                </div>
                <div class="form-group col-12">
                  <label class="form-control-label">Senha</label>
                  <div class="position-relative">
                    <div class="input-prepend">
                      <i class="fa fa-key"></i>
                    </div>
                    <input
                      type="password"
                      class="form-control"
                      name="user_password"
                      id="user_password"
                      required
                      minlength="8"
                      maxlength="64"
                      pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
                      title="A senha deve conter pelo menos 8 caracteres, incluindo mai√∫sculas, min√∫sculas, n√∫meros e caracteres especiais"
                      onkeypress="return /[a-zA-Z0-9@$!%*?&]/.test(event.key)"
                      style="padding-left: 40px"
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="form-group col-12 text-center">
                  <button
                    type="submit"
                    class="btn btn-primary btn-xl w-full"
                    onclick="handleLogin(event)"
                  >
                    Entrar
                  </button>
                </div>
              </div>
              <div class="row">
                <div class="form-group col-12 text-center">
                  <button
                    type="button"
                    class="btn btn-xl btn-default btn-outline w-full"
                    onclick="handleForgotPassword()"
                  >
                    Esqueceu sua Senha?
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Script para mostrar tipo de perfil -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const gender = localStorage.getItem("userGender");
        const category = localStorage.getItem("userCategory");

        if (gender && category) {
          console.log("Perfil atual:", gender, "+", category);

          // Exibir no console para debug
          console.log(`üìç Perfil detectado: ${gender.toUpperCase()} + ${category.toUpperCase()}`);

          // Exibir no topo da p√°gina como banner
          const pageTitle = document.querySelector("h1, .page-title, .main-header");
          if (pageTitle) {
            const profileBanner = document.createElement("div");
            profileBanner.style.cssText = `
              background: linear-gradient(135deg, #007bff, #0056b3);
              color: white;
              padding: 8px 15px;
              border-radius: 5px;
              margin-bottom: 20px;
              font-size: 14px;
              text-align: center;
              box-shadow: 0 2px 4px rgba(0,0,0,0.1);
              position: fixed;
              top: 80px;
              left: 50%;
              transform: translateX(-50%);
              z-index: 999;
              max-width: 90%;
            `;
            profileBanner.innerHTML = `üéØ Perfil: ${gender.toUpperCase()} + ${category.toUpperCase()}`;
            document.body.appendChild(profileBanner);
            
            // Remover o banner ap√≥s 5 segundos
            setTimeout(() => {
              if (profileBanner.parentNode) {
                profileBanner.parentNode.removeChild(profileBanner);
              }
            }, 5000);
          }

          // Adicionar classe CSS para estiliza√ß√£o espec√≠fica
          document.body.classList.add(`profile-${gender}`, `category-${category}`);
        } else {
          console.log("Nenhum perfil detectado no localStorage");
        }
      });

      // Fun√ß√£o para fazer scroll suave para o topo da p√°gina
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      }

      // Script para o bot√£o de localiza√ß√£o
      const locationBtn = document.getElementById('locationBtn');
      if (locationBtn) {
        locationBtn.addEventListener('click', function(e) {
          e.preventDefault();
          // Fun√ß√£o de localiza√ß√£o ser√° implementada posteriormente
          console.log('Bot√£o de localiza√ß√£o clicado');
          // TODO: Implementar detec√ß√£o de localiza√ß√£o
        });
      }

      // Script para o dropdown do menu "Brasil"
      const dropdownItem = document.querySelector('.dropdown-menu-item');
      
      if (dropdownItem) {
        const dropdownLink = dropdownItem.querySelector('a');
        
        // Toggle ao clicar
        dropdownLink.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Fechar outros dropdowns se houver
          document.querySelectorAll('.dropdown-menu-item.active').forEach(openMenu => {
            if (openMenu !== dropdownItem) {
              openMenu.classList.remove('active');
            }
          });
          
          // Toggle do menu atual
          dropdownItem.classList.toggle('active');
        });
        
        // Fechar ao clicar fora
        document.addEventListener('click', function(e) {
          if (!dropdownItem.contains(e.target) && !locationBtn?.contains(e.target)) {
            dropdownItem.classList.remove('active');
          }
        });
      }

      // Sistema de Dropdown Brasil e Localiza√ß√£o - Scripts
      // Carregar m√≥dulos na ordem correta
      (function() {
        // 0. Estados do Brasil (deve carregar PRIMEIRO)
        const script0 = document.createElement('script');
        script0.src = 'js/geolocation/estados-brasil.js';
        script0.onload = function() {
          console.log('‚úÖ estados-brasil.js carregado');
          
          // 0.1. Dropdown Brasil (depende de estados-brasil.js)
          const script0_1 = document.createElement('script');
          script0_1.src = 'js/brasil-dropdown.js';
          script0_1.onload = function() {
            console.log('‚úÖ brasil-dropdown.js carregado');
            
            // 0.2. Sistema de filtro por estado (depende de brasil-dropdown.js)
            const script0_2 = document.createElement('script');
            script0_2.src = 'js/estado-filter.js';
            script0_2.onload = function() {
              console.log('‚úÖ estado-filter.js carregado');
            };
            script0_2.onerror = function() {
              console.error('‚ùå Erro ao carregar estado-filter.js');
            };
            document.body.appendChild(script0_2);
          };
          script0_1.onerror = function() {
            console.error('‚ùå Erro ao carregar brasil-dropdown.js');
          };
          document.body.appendChild(script0_1);
          
          // 1. Mapa de Capitais
          const script1 = document.createElement('script');
          script1.src = 'js/geolocation/capital-map.js';
          script1.onload = function() {
            // 2. Detec√ß√£o por IP
            const script2 = document.createElement('script');
            script2.src = 'js/geolocation/ip-detection.js';
            script2.onload = function() {
              // 3. Detec√ß√£o por GPS
              const script3 = document.createElement('script');
              script3.src = 'js/geolocation/gps-detection.js';
              script3.onload = function() {
                // 4. Gerenciador
                const script4 = document.createElement('script');
                script4.src = 'js/geolocation/location-manager.js';
                script4.onload = function() {
                  // 5. Integra√ß√£o Principal
                  const script5 = document.createElement('script');
                  script5.src = 'js/location-main.js';
                  document.body.appendChild(script5);
                };
                document.body.appendChild(script4);
              };
              document.body.appendChild(script3);
            };
            document.body.appendChild(script2);
          };
          document.body.appendChild(script1);
        };
        script0.onerror = function() {
          console.error('‚ùå Erro ao carregar estados-brasil.js');
        };
        document.body.appendChild(script0);
      })();
    </script>
    
    <!-- Script para ocultar Painel de Controle nas p√°ginas principais -->
    <script>
      (function() {
        // Lista de p√°ginas principais onde o elemento n√£o deve ser mostrado
        const paginasPrincipais = [
          'A_01__index.html',
          'A_02__premium.html',
          'A_02__premium_copy.html',
          'A_03__massagistas.html',
          'A_04__trans.html',
          'A_05__homens.html',
          'luxo.html'
        ];
        
        // Obter o nome do arquivo atual
        const nomeArquivoAtual = window.location.pathname.split('/').pop() || window.location.href.split('/').pop();
        
        // Verificar se √© uma p√°gina principal
        const ehPaginaPrincipal = paginasPrincipais.some(pagina => nomeArquivoAtual.includes(pagina));
        
        // Ocultar o elemento se for p√°gina principal
        if (ehPaginaPrincipal) {
          const elementoPainel = document.getElementById('painel-controle-container') || document.getElementById('boton_control_footer') || document.getElementById('boton_control');
          if (elementoPainel) {
            // Ocultar o container ou a section pai se existir
            const sectionPai = elementoPainel.closest('section');
            if (sectionPai) {
              sectionPai.style.display = 'none';
            } else {
              elementoPainel.style.display = 'none';
            }
          }
        }
      })();
    </script>
  </body>
</html>