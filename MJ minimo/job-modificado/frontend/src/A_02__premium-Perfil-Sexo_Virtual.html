<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil - Modelo A | Premium VIP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Sistema de Localização - CSS -->
    <link rel="stylesheet" href="css/location-styles.css" />
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <style>
        :root {
            --primary-color: #dc3545;
            --secondary-color: #6c757d;
            --accent-color: #ffc107;
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --text-dark: #212529;
            --text-muted: #6c757d;
            --border-color: #dee2e6;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
            position: relative;
        }
        
        html {
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
        }

        /* Header */
        .header {
            background: var(--bg-white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .back-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: #c82333;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Profile Header */
        .profile-header {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 0;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .profile-banner {
            width: 100%;
            height: 450px;
            object-fit: cover;
            border-radius: 15px 15px 0 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-size: cover;
            transition: opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s ease;
            position: relative;
        }
        
        .profile-banner[src=""] {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            animation: shimmer 2s infinite;
        }
        
        .profile-banner[src=""]::before,
        .profile-banner[style*="opacity: 0"]::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer-slide 2s infinite;
            z-index: 1;
        }
        
        .profile-banner:not([src=""])::before {
            display: none;
        }
        
        @keyframes shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.9; }
        }
        
        @keyframes shimmer-slide {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .profile-picture-container {
            position: absolute;
            top: 350px;
            right: 2rem;
            z-index: 10;
        }

        .profile-image {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 50%;
            border: 6px solid var(--bg-white);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            background-size: cover;
            position: relative;
        }
        
        .profile-image[src=""] {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                opacity: 1;
            }
            50% { 
                transform: scale(1.02);
                opacity: 0.95;
            }
        }

        .profile-image:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.4);
        }

        .profile-status {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 25px;
            height: 25px;
            background: #28a745;
            border: 4px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .profile-info {
            padding: 2rem;
            padding-top: 4rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            text-align: left;
        }

        .profile-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .profile-level {
            display: inline-block;
            background: linear-gradient(45deg, var(--primary-color), #ff6b6b);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .profile-description {
            font-size: 1.1rem;
            color: var(--text-muted);
            line-height: 1.8;
            margin-bottom: 1rem;
            text-align: justify;
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-word;
            overflow-x: hidden;
            max-width: 100%;
            box-sizing: border-box;
        }

        .profile-stats {
            display: flex;
            flex-direction: row;
            gap: 1rem;
            margin-top: 1rem;
            justify-content: center;
            align-items: center;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: var(--bg-light);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Gallery Section */
        .gallery-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Pub Book Gallery Styles */
        .pub-book {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.25rem;
            margin-top: 1rem;
        }

        .pub-book-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            min-height: 360px; /* Aumentado para acomodar nome e localização */
            display: flex;
            flex-direction: column;
            background: white;
        }

        .pub-book-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .pub-book-link {
            display: block;
            text-decoration: none;
            color: inherit;
        }

        .pub-book-img {
            width: 100%;
            min-width: 100%;
            height: 300px;
            min-height: 300px;
            object-fit: cover;
            object-position: center;
            display: block;
            transition: opacity 0.3s ease;
            background-color: #f0f0f0;
        }

        .pub-book-item:hover .pub-book-img {
            opacity: 0.9;
        }

        /* Estilos para informações do card */
        .card_title {
            padding: 12px 15px;
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            text-align: center;
            border-top: 1px solid #eee;
            background: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card_resume {
            padding: 8px 15px 15px;
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            background: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .pub-book-item .gallery-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0; /* Permite que a imagem se ajuste */
        }

        .pub-book-item .gallery-item img {
            flex: 1;
            object-fit: cover;
        }

        /* Botão de Like */
        .gallery-like-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: transparent;
            border: none;
            width: auto;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            transition: all 0.3s ease;
            padding: 0;
        }

        .gallery-like-btn:hover {
            transform: scale(1.15);
        }

        .gallery-like-btn i {
            font-size: 1.5rem;
            color: white;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .gallery-like-btn.liked i {
            color: #4CAF50;
            text-shadow: 0 2px 8px rgba(76, 175, 80, 0.6);
        }

        .gallery-like-btn:active {
            transform: scale(0.9);
        }

        /* Layout N3 (3 Colunas) - Aumentar altura das fotos em 25% */
        body[data-layout="n3"] .pub-book-img,
        .pub-book.layout-n3 .pub-book-img,
        [data-layout="n3"] .pub-book-img {
            height: 375px; /* 300px * 1.25 = 375px (25% maior) */
            min-height: 375px;
        }

        body[data-layout="n3"] .pub-book-item,
        .pub-book.layout-n3 .pub-book-item,
        [data-layout="n3"] .pub-book-item {
            min-height: 450px; /* Aumentado para acomodar nome e localização (375px imagem + 75px informações) */
            overflow: visible !important; /* Garantir que as informações não sejam cortadas */
            height: auto !important; /* Permitir que o card cresça para acomodar conteúdo */
        }

        /* Garantir que as informações apareçam no modo n3 - Desktop */
        body[data-layout="n3"] .card_title,
        .pub-book.layout-n3 .card_title,
        [data-layout="n3"] .card_title,
        body[data-layout="n3"] .pub-book-item .card_title,
        .pub-book.layout-n3 .pub-book-item .card_title {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 10 !important;
            height: auto !important;
            min-height: auto !important;
            max-height: none !important;
        }

        body[data-layout="n3"] .card_resume,
        .pub-book.layout-n3 .card_resume,
        [data-layout="n3"] .card_resume,
        body[data-layout="n3"] .pub-book-item .card_resume,
        .pub-book.layout-n3 .pub-book-item .card_resume {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 10 !important;
            height: auto !important;
            min-height: auto !important;
            max-height: none !important;
        }

        body[data-layout="n3"] .gallery-item,
        .pub-book.layout-n3 .gallery-item,
        [data-layout="n3"] .gallery-item {
            min-height: 375px;
            max-height: 375px; /* Limitar altura da imagem para deixar espaço para informações */
            flex: 0 0 375px; /* Não permitir que cresça além da altura da imagem */
        }

        body[data-layout="n3"] .gallery-item img,
        .pub-book.layout-n3 .gallery-item img,
        [data-layout="n3"] .gallery-item img {
            min-height: 375px;
            max-height: 375px;
            flex: 0 0 375px; /* Imagem fixa em 375px */
        }

        /* Layout N3 - Ajustar grid para 3 colunas */
        body[data-layout="n3"] .pub-book,
        .pub-book.layout-n3 {
            grid-template-columns: repeat(3, 1fr);
        }

        /* Lightbox Styles */
        .mfp-hide {
            display: none !important;
        }

        .lightbox-block {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .mfp-img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .mfp-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s ease;
            z-index: 10000;
        }

        .mfp-close:hover {
            background: rgba(255, 255, 255, 1);
        }

        .mfp-close i {
            font-size: 18px;
            color: #333;
        }

        /* Estilos do Modal de Galeria Customizado */
        .gallery-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gallery-modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            cursor: pointer;
        }

        .gallery-modal-content {
            position: relative;
            width: 90%;
            height: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }

        .gallery-modal-image {
            max-width: 100%;
            max-height: 100%;
            min-width: 300px;
            min-height: 300px;
            width: auto;
            height: auto;
            object-fit: contain;
            object-position: center;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
            animation: fadeIn 0.3s ease;
            background-color: rgba(0, 0, 0, 0.3);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .gallery-modal-close,
        .gallery-modal-prev,
        .gallery-modal-next {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10002;
            font-size: 20px;
            color: #333;
        }

        .gallery-modal-close {
            top: 20px;
            right: 20px;
        }

        .gallery-modal-prev,
        .gallery-modal-next {
            top: 50%;
            transform: translateY(-50%);
        }

        .gallery-modal-prev {
            left: 20px;
        }

        .gallery-modal-next {
            right: 20px;
        }

        .gallery-modal-close:hover,
        .gallery-modal-prev:hover,
        .gallery-modal-next:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-50%) scale(1.1);
        }

        .gallery-modal-close:hover {
            transform: scale(1.1);
        }

        .gallery-modal-counter {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            z-index: 10002;
        }

        @media (max-width: 768px) {
            .gallery-modal-prev,
            .gallery-modal-next {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .gallery-modal-close {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .gallery-modal-counter {
                font-size: 14px;
                padding: 8px 16px;
            }

            .gallery-modal-image {
                min-width: 200px;
                min-height: 250px; /* 25% maior que 200px (200 * 1.25 = 250) */
                max-height: 85vh; /* Permite que a imagem seja maior verticalmente */
            }

            .gallery-modal-content {
                height: 95vh; /* Aumenta o espaço disponível para a imagem */
            }
        }

        /* Utility Classes */
        .position-relative {
            position: relative;
        }

        .h-full {
            height: 100%;
        }

        .w-full {
            width: 100%;
        }

        .d-flex {
            display: flex;
        }

        .absolute {
            position: absolute;
        }

        .top {
            top: 0;
        }

        .right {
            right: 0;
        }

        .m-10 {
            margin: 10px;
        }

        .mr-2 {
            margin-right: 0.5rem;
        }

        .p-0 {
            padding: 0;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .btn-default {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #dee2e6;
        }

        .btn-circle {
            border-radius: 50%;
        }

        .no-events {
            pointer-events: none;
        }

        /* Modal de Mensagem */
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            background: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .modal-header .close {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .modal-header .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-color-hover);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        /* Description Section */
        .description-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .description-content {
            margin-top: 1rem;
        }

        .description-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-dark);
            text-align: justify;
            margin: 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-word;
            overflow-x: hidden;
            max-width: 100%;
            box-sizing: border-box;
        }

        .video-item .gallery-overlay i {
            font-size: 2.5rem;
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-item {
            width: 100%;
            height: 100%;
            min-height: 300px;
            display: flex;
            align-items: stretch;
            position: relative;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            min-height: 300px;
            object-fit: cover;
            object-position: center;
        }

        .gallery-overlay i {
            color: white;
            font-size: 2rem;
        }

        /* Services Section */
        .services-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Forçar layout em grid para os cards de serviços */
        .services-section .services-cards-container,
        .section .services-cards-container {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 0.25rem !important; /* Mesmo espaçamento do .pub-book */
            margin-top: 1rem;
            width: 100%;
        }

        .services-section .service-card,
        .section .service-card {
            width: 100% !important;
            border: 1px solid #d1d5db !important;
            border-radius: 12px !important;
            padding: 16px !important;
            background: #f8fafc !important;
            min-height: 115px !important;
            min-width: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.3s ease !important;
            margin: 0 !important;
            float: none !important;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .service-item {
            padding: 1.5rem;
            background: var(--bg-light);
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
        }

        .service-title {
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .service-price {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* Contact Section */
        .contact-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .contact-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .contact-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
        }

        .contact-btn.primary {
            background: var(--primary-color);
            color: white;
        }

        .contact-btn.primary:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .contact-btn.secondary {
            background: var(--secondary-color);
            color: white;
        }

        .contact-btn.secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .contact-btn.success {
            background: #28a745;
            color: white;
        }

        .contact-btn.success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        /* Estilo para botão de telefone com número visível */
        .contact-btn .btn-phone-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }
        
        .contact-btn .btn-phone-label {
            font-size: 0.75rem;
            font-weight: 500;
            opacity: 0.9;
            line-height: 1;
        }
        
        .contact-btn .btn-phone-number {
            font-size: 1rem;
            font-weight: 700;
            line-height: 1.2;
        }

        /* Info Section */
        .info-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Padronização para todas as seções */
        .section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-light);
            border-radius: 10px;
        }

        .info-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .info-content h4 {
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }

        .info-content p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* ================================== */
        /* ======== MOBILE FIXED BAR ======== */
        /* ================================== */
        .mobile-fixed-bar {
            display: none;
        }

        @media (max-width: 768px) {
            /* Barra fixa de botões mobile */
            .mobile-fixed-bar {
                display: flex;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: var(--bg-white);
                box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
                z-index: 9999;
                padding: 0.5rem;
                justify-content: space-around;
                align-items: center;
                border-top: 1px solid var(--border-color);
            }

            .mobile-fixed-bar .mobile-btn {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 0.25rem;
                padding: 0.5rem;
                border: none;
                background: transparent;
                color: var(--text-muted);
                font-size: 0.75rem;
                cursor: pointer;
                transition: all 0.3s;
                flex: 1;
                min-width: 0;
                text-decoration: none;
            }

            .mobile-fixed-bar .mobile-btn i {
                font-size: 1.25rem;
                margin-bottom: 0.125rem;
            }

            .mobile-fixed-bar .mobile-btn:hover,
            .mobile-fixed-bar .mobile-btn:active {
                color: var(--primary-color);
                transform: scale(1.1);
            }

            .mobile-fixed-bar .mobile-btn.btn-phone {
                color: #28a745;
            }

            .mobile-fixed-bar .mobile-btn.btn-phone:hover,
            .mobile-fixed-bar .mobile-btn.btn-phone:active {
                color: #218838;
            }

            .mobile-fixed-bar .mobile-btn.btn-whatsapp {
                color: #25d366;
            }

            .mobile-fixed-bar .mobile-btn.btn-whatsapp:hover,
            .mobile-fixed-bar .mobile-btn.btn-whatsapp:active {
                color: #1da851;
            }

            .mobile-fixed-bar .mobile-btn.btn-share {
                color: var(--secondary-color);
            }

            .mobile-fixed-bar .mobile-btn.btn-share:hover,
            .mobile-fixed-bar .mobile-btn.btn-share:active {
                color: var(--primary-color);
            }

            .mobile-fixed-bar .mobile-btn.btn-like {
                color: var(--text-muted);
            }

            .mobile-fixed-bar .mobile-btn.btn-like.active {
                color: #007bff;
            }

            .mobile-fixed-bar .mobile-btn.btn-like:hover,
            .mobile-fixed-bar .mobile-btn.btn-like:active {
                color: #0056b3;
            }

            .mobile-fixed-bar .mobile-btn.btn-favorite {
                color: var(--text-muted);
            }

            .mobile-fixed-bar .mobile-btn.btn-favorite.active {
                color: var(--primary-color);
            }

            .mobile-fixed-bar .mobile-btn.btn-favorite:hover,
            .mobile-fixed-bar .mobile-btn.btn-favorite:active {
                color: #c82333;
            }

            /* Adicionar padding-bottom no body para não sobrepor conteúdo */
            body {
                padding-bottom: 70px;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                padding: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .profile-header {
                padding: 0;
            }

            .profile-banner {
                height: 375px;
            }

            .profile-picture-container {
                top: 275px;
                right: 1rem;
            }

            .profile-image {
                width: 150px;
                height: 150px;
                border: 4px solid var(--bg-white);
            }

            .profile-status {
                width: 20px;
                height: 20px;
                border: 3px solid white;
            }

            .profile-info {
                padding: 1rem;
                padding-top: 3rem;
                text-align: center;
            }

            .profile-name {
                font-size: 2rem;
            }

            .pub-book {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.25rem;
            }

            .pub-book-img {
                height: 200px;
                min-height: 200px;
                max-height: 200px; /* Limitar altura para garantir espaço para informações */
            }

            .pub-book-item {
                min-height: 260px; /* Aumentado para acomodar nome e localização */
            }

            /* Garantir que as informações apareçam no modo padrão (2 colunas) mobile */
            .card_title {
                display: block !important;
            }

            .card_resume {
                display: block !important;
            }

            .gallery-item {
                min-height: 225px;
            }

            .gallery-item img {
                min-height: 225px;
            }

            /* Botão de like em mobile */
            .gallery-like-btn {
                top: 4px;
                right: 4px;
            }

            .gallery-like-btn i {
                font-size: 1.2rem;
            }

            /* Estilos para informações do card no mobile */
            .card_title {
                font-size: 0.9rem;
                padding: 10px 12px;
            }

            .card_resume {
                font-size: 0.75rem;
                padding: 6px 12px 12px;
            }

            /* Layout N3 no Mobile - 3 colunas com cards maiores */
            body[data-layout="n3"] .pub-book,
            .pub-book.layout-n3 {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem; /* Aumentar espaçamento entre cards */
            }

            body[data-layout="n3"] .pub-book-img,
            .pub-book.layout-n3 .pub-book-img,
            [data-layout="n3"] .pub-book-img {
                height: 200px; /* Altura ajustada para deixar espaço para informações */
                min-height: 200px;
                max-height: 200px; /* Limitar altura para garantir espaço para informações */
            }

            body[data-layout="n3"] .pub-book-item,
            .pub-book.layout-n3 .pub-book-item,
            [data-layout="n3"] .pub-book-item {
                min-height: 280px; /* Altura total para acomodar imagem + nome + localização */
            }

            body[data-layout="n3"] .gallery-item,
            .pub-book.layout-n3 .gallery-item,
            [data-layout="n3"] .gallery-item {
                min-height: 200px;
                max-height: 200px; /* Limitar para não ocupar todo o espaço */
            }

            body[data-layout="n3"] .gallery-item img,
            .pub-book.layout-n3 .gallery-item img,
            [data-layout="n3"] .gallery-item img {
                min-height: 200px;
                max-height: 200px; /* Limitar altura da imagem */
            }

            /* Garantir que as informações apareçam no modo n3 - Mobile e Tablet */
            body[data-layout="n3"] .card_title,
            .pub-book.layout-n3 .card_title,
            [data-layout="n3"] .card_title,
            body[data-layout="n3"] .pub-book-item .card_title,
            .pub-book.layout-n3 .pub-book-item .card_title {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                font-size: 0.85rem;
                padding: 8px 10px;
                font-weight: 600;
                color: #333 !important;
                text-align: center;
                border-top: 1px solid #eee;
                background: white !important;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                height: auto !important;
                min-height: auto !important;
                max-height: none !important;
            }

            body[data-layout="n3"] .card_resume,
            .pub-book.layout-n3 .card_resume,
            [data-layout="n3"] .card_resume,
            body[data-layout="n3"] .pub-book-item .card_resume,
            .pub-book.layout-n3 .pub-book-item .card_resume {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                font-size: 0.7rem;
                padding: 4px 10px 10px;
                color: #666 !important;
                text-align: center;
                background: white !important;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                height: auto !important;
                min-height: auto !important;
                max-height: none !important;
            }

            /* Garantir que o container do card mostre as informações */
            body[data-layout="n3"] .pub-book-item,
            .pub-book.layout-n3 .pub-book-item {
                display: flex !important;
                flex-direction: column !important;
                overflow: visible !important;
            }

            .mfp-img {
                max-width: 95%;
                max-height: 80%;
            }
        }

        /* Media Query para Tablets (768px a 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            /* Garantir que as informações apareçam no modo n3 - Tablet */
            body[data-layout="n3"] .card_title,
            .pub-book.layout-n3 .card_title,
            [data-layout="n3"] .card_title,
            body[data-layout="n3"] .pub-book-item .card_title,
            .pub-book.layout-n3 .pub-book-item .card_title {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                font-size: 0.9rem;
                padding: 10px 12px;
                font-weight: 600;
                color: #333 !important;
                text-align: center;
                border-top: 1px solid #eee;
                background: white !important;
                height: auto !important;
                min-height: auto !important;
                max-height: none !important;
            }

            body[data-layout="n3"] .card_resume,
            .pub-book.layout-n3 .card_resume,
            [data-layout="n3"] .card_resume,
            body[data-layout="n3"] .pub-book-item .card_resume,
            .pub-book.layout-n3 .pub-book-item .card_resume {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                font-size: 0.8rem;
                padding: 6px 12px 12px;
                color: #666 !important;
                text-align: center;
                background: white !important;
                height: auto !important;
                min-height: auto !important;
                max-height: none !important;
            }

            /* Garantir que o container do card mostre as informações no tablet */
            body[data-layout="n3"] .pub-book-item,
            .pub-book.layout-n3 .pub-book-item {
                display: flex !important;
                flex-direction: column !important;
                overflow: visible !important;
            }
        }

            /* Modal de Mensagem - Mobile */
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }

            .modal-header {
                padding: 1rem;
            }

            .modal-header h3 {
                font-size: 1.2rem;
            }

            .modal-body {
                padding: 1rem;
            }

            .form-actions {
                flex-direction: column;
                gap: 0.5rem;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            /* Description Section - Mobile */
            .description-section {
                padding: 1.5rem;
            }

        .description-text {
            font-size: 1rem;
            text-align: justify !important; /* Texto justificado em mobile */
        }
        
        /* Info Grid - Mobile: Idade e Peso lado a lado */
        .info-grid {
            display: flex !important;
            flex-wrap: wrap !important;
            gap: 0.75rem !important;
        }
        
        /* Os dois primeiros itens (Idade e Peso) ficam lado a lado, menores e do mesmo tamanho */
        .info-grid .info-item:nth-child(1) {
            order: 1; /* Idade */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(2) {
            order: 2; /* Peso */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        /* Altura e Anal ficam lado a lado - usando order para reorganizar visualmente */
        .info-grid .info-item:nth-child(3) {
            order: 3; /* Altura */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(4) {
            order: 5; /* Oral sem */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(5) {
            order: 6; /* Beija */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(6) {
            order: 4; /* Anal - vai ao lado de Altura */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(7) {
            order: 7; /* Local */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(8) {
            order: 8; /* Mora só */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(9) {
            order: 9; /* Valor */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        .info-grid .info-item:nth-child(10) {
            order: 11; /* Horário de Atendimento - vai depois */
        }
        
        .info-grid .info-item:nth-child(11) {
            order: 10; /* Atende - vai ao lado de Valor */
            flex: 0 0 calc(50% - 0.375rem) !important;
            max-width: calc(50% - 0.375rem) !important;
            min-width: calc(50% - 0.375rem) !important;
            padding: 0.75rem !important;
            box-sizing: border-box !important;
            gap: 0.5rem !important; /* Reduzir gap interno */
        }
        
        /* Reduzir tamanho dos ícones nos itens lado a lado */
        .info-grid .info-item:nth-child(1) .info-icon,
        .info-grid .info-item:nth-child(2) .info-icon,
        .info-grid .info-item:nth-child(3) .info-icon,
        .info-grid .info-item:nth-child(4) .info-icon,
        .info-grid .info-item:nth-child(5) .info-icon,
        .info-grid .info-item:nth-child(6) .info-icon,
        .info-grid .info-item:nth-child(7) .info-icon,
        .info-grid .info-item:nth-child(8) .info-icon,
        .info-grid .info-item:nth-child(9) .info-icon,
        .info-grid .info-item:nth-child(11) .info-icon {
            width: 32px !important;
            height: 32px !important;
            font-size: 0.9rem !important;
        }
        
        /* Reduzir tamanho do texto nos itens lado a lado */
        .info-grid .info-item:nth-child(1) .info-content h4,
        .info-grid .info-item:nth-child(2) .info-content h4,
        .info-grid .info-item:nth-child(3) .info-content h4,
        .info-grid .info-item:nth-child(4) .info-content h4,
        .info-grid .info-item:nth-child(5) .info-content h4,
        .info-grid .info-item:nth-child(6) .info-content h4,
        .info-grid .info-item:nth-child(7) .info-content h4,
        .info-grid .info-item:nth-child(8) .info-content h4,
        .info-grid .info-item:nth-child(9) .info-content h4,
        .info-grid .info-item:nth-child(11) .info-content h4 {
            font-size: 0.85rem !important;
            margin-bottom: 0.2rem !important;
        }
        
        .info-grid .info-item:nth-child(1) .info-content p,
        .info-grid .info-item:nth-child(2) .info-content p,
        .info-grid .info-item:nth-child(3) .info-content p,
        .info-grid .info-item:nth-child(4) .info-content p,
        .info-grid .info-item:nth-child(5) .info-content p,
        .info-grid .info-item:nth-child(6) .info-content p,
        .info-grid .info-item:nth-child(7) .info-content p,
        .info-grid .info-item:nth-child(8) .info-content p,
        .info-grid .info-item:nth-child(9) .info-content p,
        .info-grid .info-item:nth-child(11) .info-content p {
            font-size: 0.9rem !important;
        }
        
        /* Os demais itens ocupam 100% da largura */
        .info-grid .info-item:nth-child(10),
        .info-grid .info-item:nth-child(12) {
            flex: 0 0 100% !important;
            max-width: 100% !important;
        }

        /* Services Cards Styles */
        .services-cards-container {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 0.25rem !important; /* Mesmo espaçamento do .pub-book */
            margin-top: 1rem;
            width: 100%;
        }

        .service-card {
            width: 100% !important;
            border: 1px solid #d1d5db !important;
            border-radius: 12px !important;
            padding: 16px !important;
            background: #f8fafc !important;
            min-height: 115px !important;
            min-width: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.3s ease !important;
            margin: 0 !important;
            float: none !important;
        }

        /* Garantir que os cards apareçam em todas as resoluções */
        .section .services-cards-container,
        .services-section .services-cards-container {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 0.25rem !important; /* Mesmo espaçamento do .pub-book */
            margin-top: 1rem;
            width: 100%;
        }

        .section .service-card,
        .services-section .service-card {
            width: 100% !important;
            border: 1px solid #d1d5db !important;
            border-radius: 12px !important;
            padding: 16px !important;
            background: #f8fafc !important;
            min-height: 115px !important;
            min-width: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.3s ease !important;
            margin: 0 !important;
            float: none !important;
        }

        .service-card:hover {
            background: #f1f5f9;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            cursor: pointer;
        }

        .card-title-section {
            display: flex;
            align-items: start;
            gap: 8px;
        }

        .card-icon {
            display: inline-block;
            margin-top: 4px;
        }

        .card-label {
            color: #E25352;
            font-weight: 500;
            font-size: 12px;
        }

        .card-label-section {
            display: flex;
            flex-direction: column;
            text-align: start;
        }

        .card-content {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            flex: 1;
        }

        /* Card de Valores */
        .price-label {
            font-weight: normal;
            font-size: 10px;
            margin: 0;
            text-align: left;
        }

        .price-section {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 4px;
            margin: 4px 0;
            flex-wrap: wrap;
        }

        .price-value {
            font-weight: 600;
            font-size: 18px;
            margin: 0;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .price-duration {
            font-weight: normal;
            font-size: 12px;
            margin: 0;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .service-info {
            margin-top: 8px;
            text-align: left;
        }
        
        .service-info h4 {
            font-size: 0.85rem;
            font-weight: 600;
            color: #333;
            margin: 0 0 0.25rem 0;
        }
        
        .service-info p {
            font-size: 0.9rem;
            color: #666;
            margin: 0;
            word-break: break-word;
            overflow-wrap: break-word;
        }
        
        .payment-icons-container {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .payment-icons-container i {
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s ease, opacity 0.2s ease;
        }
        
        .payment-icons-container i:hover {
            transform: scale(1.15);
            opacity: 0.8;
        }

        .service-text {
            font-size: 12px;
            font-weight: normal;
            margin-right: 4px;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        /* Card de Localização */
        .location-city {
            font-size: 18px;
            font-weight: bold;
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 4px;
            text-align: center;
            max-width: 100%;
        }

        .location-state {
            font-size: 12px;
            margin-bottom: 9px;
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            text-align: center;
        }

        .location-info {
            display: block;
            text-align: left;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .location-info h4 {
            font-size: 0.85rem;
            font-weight: 600;
            color: #333;
            margin: 0 0 0.25rem 0;
        }
        
        .location-info p {
            font-size: 0.9rem;
            color: #666;
            margin: 0;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .location-text {
            font-size: 12px;
            font-weight: normal;
            text-transform: lowercase;
            word-break: break-word;
            overflow-wrap: break-word;
            text-align: center;
        }
        
        .card-content {
            overflow: hidden;
            text-align: center;
        }
        
        /* Alinhar card de valores à esquerda */
        .service-card:has(.price-label) .card-content,
        .service-card:has(.price-section) .card-content {
            text-align: left;
        }
        
        /* Alinhar elementos específicos do card de valores */
        .service-card .price-label,
        .service-card .price-section,
        .service-card .service-info {
            text-align: left;
        }

        @media (max-width: 768px) {
            .profile-stats {
                display: flex !important;
                flex-direction: row !important;
                gap: 1rem !important;
                justify-content: center !important;
                align-items: center !important;
            }
            
            .stat-item {
                flex: 1;
                min-width: 0;
            }
            
            .services-cards-container {
                grid-template-columns: 1fr !important;
                gap: 0.25rem !important; /* Mesmo espaçamento do .pub-book */
                margin-top: 1rem !important;
                width: 100% !important;
                padding: 0 !important;
            }

            .service-card {
                min-height: 100px !important;
                padding: 1rem !important; /* Mesmo padding das subcaixas de views/likes */
                overflow: hidden !important;
                margin: 0 !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }

            .card-header {
                margin-bottom: 1rem !important; /* Mesma distância das subcaixas */
                padding: 0 !important;
            }
            
            .card-title-section {
                gap: 8px !important;
            }

            .location-state {
                max-width: 100%;
            }
            
            .card-content {
                overflow: hidden !important;
                text-align: center !important;
                padding: 0 !important;
            }
            
            /* Alinhar card de valores à esquerda no mobile */
            .service-card:has(.price-label) .card-content,
            .service-card:has(.price-section) .card-content {
                text-align: left !important;
            }
            
            .price-section {
                justify-content: flex-start !important;
                flex-wrap: wrap !important;
                margin: 4px 0 !important;
            }
            
            .price-label,
            .service-info {
                text-align: left !important;
            }
            
            .location-city,
            .location-state,
            .location-text {
                max-width: 100% !important;
                overflow: hidden !important;
                text-overflow: ellipsis !important;
            }
            
            /* Garantir que os elementos internos não extrapolem */
            .price-value,
            .price-duration,
            .service-text,
            .location-city,
            .location-state,
            .location-text {
                word-break: break-word !important;
                overflow-wrap: break-word !important;
                max-width: 100% !important;
            }

            /* Responsividade para seções padronizadas */
            .section,
            .description-section,
            .info-section,
            .contact-section,
            .gallery-section,
            .services-section {
                padding: 1.5rem !important;
                margin: 0 0 2rem 0 !important;
                box-sizing: border-box !important;
                width: 100% !important;
                max-width: 100% !important;
                overflow: hidden !important;
            }
            
            /* Texto da descrição justificado em mobile */
            .description-text,
            .description-content p,
            .description-content .description-text {
                text-align: justify !important;
            }
            
            /* Ajustes para telas muito pequenas (celulares pequenos) */
            .services-cards-container {
                padding: 0 !important;
                margin: 1rem 0 0 0 !important;
                width: 100% !important;
                max-width: 100% !important;
                box-sizing: border-box !important;
            }
            
            .service-card {
                max-width: 100% !important;
                width: 100% !important;
                box-sizing: border-box !important;
                overflow: hidden !important;
            }
            
            /* Garantir que elementos não extrapolem em mobile */
            .price-label,
            .price-section,
            .price-value,
            .price-duration,
            .service-info,
            .service-text,
            .location-city,
            .location-state,
            .location-text {
                max-width: 100% !important;
                box-sizing: border-box !important;
            }
            
            .gallery-row.two-items {
                grid-template-columns: 1fr;
            }

            .contact-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        /* Ajustes para celulares pequenos (até 480px) */
        @media (max-width: 480px) {
            .services-section {
                padding: 1rem !important; /* Distância mínima da borda da box principal */
                margin: 0 0 2rem 0 !important;
                box-sizing: border-box !important;
                width: 100% !important;
                max-width: 100% !important;
                overflow: hidden !important;
            }
            
            .services-cards-container {
                gap: 0.25rem !important; /* Mesmo espaçamento do .pub-book */
                margin-top: 0.75rem !important;
                padding: 0 !important;
                width: 100% !important;
                max-width: 100% !important;
                box-sizing: border-box !important;
            }
            
            .service-card {
                padding: 0.75rem !important; /* Padding interno reduzido */
                min-height: auto !important;
                width: 100% !important;
                max-width: 100% !important;
                box-sizing: border-box !important;
                overflow: hidden !important;
                margin: 0 !important;
            }
            
            .card-header {
                margin-bottom: 0.75rem !important;
                padding: 0 !important;
            }
            
            .card-content {
                padding: 0 !important;
                width: 100% !important;
                max-width: 100% !important;
                box-sizing: border-box !important;
            }
            
            .card-label {
                font-size: 11px !important;
            }
            
            .price-value {
                font-size: 16px !important;
            }
            
            .price-duration {
                font-size: 11px !important;
            }
            
            .location-city {
                font-size: 16px !important;
            }
            
            .location-state,
            .location-text,
            .service-text {
                font-size: 11px !important;
            }
            
            /* Garantir que nenhum elemento extrapole */
            .price-label,
            .price-section,
            .price-value,
            .price-duration,
            .service-info,
            .service-text,
            .location-city,
            .location-state,
            .location-text {
                max-width: 100% !important;
                box-sizing: border-box !important;
                word-break: break-word !important;
                overflow-wrap: break-word !important;
            }
            
            /* Texto da descrição justificado em celulares pequenos */
            .description-text,
            .description-content p,
            .description-content .description-text {
                text-align: justify !important;
            }
        }
        
        /* Ajustes para tablets (até 1024px) */
        @media (max-width: 1024px) and (min-width: 769px) {
            .section,
            .description-section,
            .info-section,
            .contact-section,
            .gallery-section,
            .services-section {
                padding: 1.5rem !important;
                margin: 0 0 2rem 0 !important;
                box-sizing: border-box !important;
                width: 100% !important;
                max-width: 100% !important;
            }
            
            .services-cards-container {
                gap: 0.25rem !important; /* Mesmo espaçamento do .pub-book */
                padding: 0 !important;
            }
            
            /* Texto da descrição justificado em tablets */
            .description-text,
            .description-content p,
            .description-content .description-text {
                text-align: justify !important;
            }
            
            .service-card {
                padding: 1rem !important;
                box-sizing: border-box !important;
            }
            
            .card-header {
                margin-bottom: 1rem !important;
            }
        }

        /* Loading Animation */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--bg-light);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal for Gallery */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
        }

        .modal-content {
            position: relative;
            margin: auto;
            padding: 0;
            width: 90%;
            max-width: 800px;
            top: 50%;
            transform: translateY(-50%);
        }

        .modal-image {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .modal-video {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--primary-color);
        }


        /* Estilos para serviços detalhados */
        .services-section-detailed {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            position: relative;
        }

        .services-section-detailed:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }

        .services-section-detailed:last-child {
            margin-bottom: 0;
        }

        .services-section-detailed h5 {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .services-list-detailed {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 0.5rem;
        }

        .services-list-detailed li {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            background: var(--bg-light);
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .services-list-detailed li i {
            color: var(--primary-color);
            margin-right: 0.5rem;
            font-size: 0.8rem;
        }

        /* Estilos para preços detalhados */

        /* Estilos para descrição detalhada */
        .description-text-detailed {
            line-height: 1.8;
            color: var(--text-dark);
            font-size: 1rem;
        }

        /* Botão Painel de Controle */
        .painel-controle-btn {
            display: none; /* Oculto por padrão */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            text-decoration: none;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            margin-right: 1rem;
            cursor: pointer;
            position: relative;
        }

        .painel-controle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .painel-controle-btn i {
            font-size: 1rem;
        }

        .painel-controle-btn.visible {
            display: flex !important;
        }

        /* Indicador visual quando botão está disponível */
        .painel-controle-btn.visible::before {
            content: '';
            position: absolute;
            top: -5px;
            right: -5px;
            width: 12px;
            height: 12px;
            background: #28a745;
            border-radius: 50%;
            border: 2px solid white;
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        /* Seção de Comentários */
        .comentarios-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: var(--shadow);
        }

        .comentarios-section h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .comentarios-aviso {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 5px;
            font-size: 0.9rem;
            color: #856404;
        }

        .comentarios-lista {
            margin-bottom: 2rem;
        }

        .comentario-item {
            background: var(--bg-light);
            padding: 1.2rem;
            margin-bottom: 1rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
        }

        .comentario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .comentario-autor {
            font-weight: 600;
            color: var(--primary-color);
        }

        .comentario-data {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .comentario-texto {
            color: var(--text-dark);
            line-height: 1.6;
            margin-top: 0.5rem;
        }

        .comentario-form {
            background: var(--bg-light);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1.5rem;
        }

        .comentario-form h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .form-group-comentario {
            margin-bottom: 1rem;
        }

        .form-group-comentario label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
            font-weight: 500;
        }

        .form-group-comentario textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
            min-height: 100px;
            transition: border-color 0.3s;
        }

        .form-group-comentario textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn-enviar-comentario {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-enviar-comentario:hover {
            background: #c82333;
        }

        .btn-enviar-comentario:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
        }

        .login-prompt {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 1rem;
            border-radius: 5px;
            text-align: center;
            margin-top: 1.5rem;
        }

        .login-prompt a {
            color: var(--primary-color);
            font-weight: 600;
            text-decoration: none;
        }

        .login-prompt a:hover {
            text-decoration: underline;
        }

        /* Área de Moderação */
        .moderacao-area {
            background: #f8f9fa;
            border: 2px dashed var(--primary-color);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 2rem;
            display: none;
        }

        .moderacao-area.visible {
            display: block;
        }

        .moderacao-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .moderacao-header h3 {
            color: var(--primary-color);
            margin: 0;
        }

        .comentario-pendente {
            background: white;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .comentario-pendente-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.5rem;
        }

        .comentario-pendente-info {
            flex: 1;
        }

        .comentario-pendente-acoes {
            display: flex;
            gap: 0.5rem;
        }

        .btn-aprovar {
            background: #28a745;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.3s;
        }

        .btn-aprovar:hover {
            background: #218838;
        }

        .btn-rejeitar {
            background: #dc3545;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.3s;
        }

        .btn-rejeitar:hover {
            background: #c82333;
        }

        .politica-comentarios {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .politica-comentarios h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .politica-comentarios ul {
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .politica-comentarios li {
            margin-bottom: 0.3rem;
        }

        .sem-comentarios {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Modal de Painel de Controle */
        .painel-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }

        .painel-modal.active {
            display: block;
        }

        .painel-modal-content {
            background-color: var(--bg-white);
            margin: 2% auto;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
        }

        .painel-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .painel-modal-header h2 {
            color: var(--primary-color);
            margin: 0;
        }

        .painel-modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s;
        }

        .painel-modal-close:hover {
            color: var(--primary-color);
        }

        @media (max-width: 768px) {
            .painel-controle-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }

            .painel-controle-btn span {
                display: none;
            }

            .comentarios-section {
                padding: 1.5rem;
            }

            .painel-modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="A_02__premium_copy.html" class="logo">
                <i class="fas fa-heart"></i> Premium VIP
            </a>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="painel-controle-btn" id="painel-controle-btn" onclick="abrirPainelControle()" title="Painel de Controle - Apenas para anunciante">
                    <i class="fas fa-cog"></i>
                    <span>Painel de controle</span>
                </button>
                <a href="A_02__premium_copy.html" class="back-btn" id="back-btn-link" onclick="handleBackClick(event)">
                    <i class="fas fa-arrow-left"></i>
                    Voltar
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Profile Header -->
        <section class="profile-header">
            <!-- Banner retangular de fundo -->
            <img src="" 
                 alt="Banner" 
                 class="profile-banner" 
                 id="profile-banner" 
                 width="1200" 
                 height="450"
                 loading="eager"
                 fetchpriority="high"
                 decoding="async"
                 style="opacity: 0; transition: opacity 0.4s ease;">
            
            <!-- Foto circular sobreposta -->
            <div class="profile-picture-container">
                <img src="" 
                     alt="Foto do Perfil" 
                     class="profile-image" 
                     id="profile-image" 
                     width="200" 
                     height="200"
                     loading="eager"
                     fetchpriority="high"
                     decoding="async"
                     style="opacity: 0; transition: opacity 0.4s ease;">
                <div class="profile-status"></div>
            </div>
            
            <div class="profile-info">
                <h1 class="profile-name" id="profile-name">seu nome aqui</h1>
                <span class="profile-level" id="profile-level">Acompanhante Premium</span>
                <p class="profile-description" id="profile-description">
                    Homem experiente e atencioso, oferecendo companhia de qualidade para momentos especiais. Discreto e profissional.
                </p>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="stat-views">0</div>
                        <div class="stat-label">Views</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="stat-likes">0</div>
                        <div class="stat-label">Likes</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section class="services-section">
            <h2 class="section-title">
                <i class="fas fa-star"></i>
                Serviços e Preços
            </h2>
            <div class="services-cards-container">
                <!-- Card de Valores -->
                <div class="service-card">
                    <div class="card-header">
                        <div class="card-title-section">
                            <span class="card-label">Valores <span style="margin-left: 4px; color: #E25352;">$</span></span>
                        </div>
                    </div>
                    <div class="card-content">
                        <p class="price-label">a partir de</p>
                        <div class="price-section">
                            <p class="price-value">R$ 300</p>
                            <p class="price-duration">(1 hora)</p>
                        </div>
                        <div class="service-info">
                            <h4 style="font-size: 0.85rem; font-weight: 600; color: #333; margin: 0 0 0.5rem 0;">Formas de Pagamento</h4>
                            <div id="info-pagamento-card" class="payment-icons-container">
                                <!-- Ícones serão inseridos dinamicamente aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card de Localização -->
                <div class="service-card">
                    <div class="card-header">
                        <div class="card-title-section">
                            <div class="card-label-section">
                                <span class="card-label">Localização <i class="fas fa-map-marker-alt" style="margin-left: 4px; color: #E25352; font-size: 14px;"></i></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <span class="location-city">Vila Madalena</span>
                        <span class="location-state">São Paulo - SP</span>
                        <div class="location-info">
                            <h4 style="font-size: 0.85rem; font-weight: 600; color: #333; margin: 0 0 0.25rem 0;">Local</h4>
                            <p id="info-local-card" style="font-size: 0.9rem; color: #666; margin: 0;">Com Local</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Description Section -->
        <section class="description-section">
            <h2 class="section-title">
                <i class="fas fa-align-left"></i>
                Descrição
            </h2>
            <div class="description-content">
                <p class="description-text" id="description-text">
                    Olá! Sou Carlos, um homem experiente e atencioso, oferecendo companhia de qualidade para momentos especiais. Com mais de 8 anos de experiência, sou conhecido por ser discreto, profissional e respeitoso. Especializado em acompanhar mulheres em eventos sociais, jantares, viagens e momentos íntimos. Minha abordagem é sempre elegante e sofisticada, proporcionando uma experiência agradável e memorável. Sou bem-educado, culto e tenho boa conversa. Atendo exclusivamente mulheres em um ambiente privado e confortável. Disponibilidade noturna (19h às 02h) com agendamento flexível. Venha conhecer um companheiro que valoriza sua privacidade e satisfação!
                </p>
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="gallery-section">
            <h2 class="section-title">
                <i class="fas fa-images"></i>
                Galeria de Fotos
            </h2>
            
            <!-- Listar Galeria de Fotos - Será preenchida dinamicamente pelo loadGallery() -->
            <div class="pub-book">
                <!-- Galeria será carregada aqui via JavaScript -->
                <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <p>Carregando galeria...</p>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="contact-section">
            <h2 class="section-title">
                <i class="fas fa-phone"></i>
                Entre em Contato
            </h2>
            <div class="contact-buttons">
                <a href="tel:+5511999999999" id="btn-ligar-agora" class="contact-btn primary">
                    <i class="fas fa-phone"></i>
                    <div class="btn-phone-content">
                        <span class="btn-phone-label">Ligar Agora</span>
                        <span class="btn-phone-number" id="btn-ligar-phone-number">(61) 98484-7878</span>
                    </div>
                </a>
                <a href="https://wa.me/5511999999999" id="btn-whatsapp" class="contact-btn success" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    WhatsApp
                </a>
                <a href="tel:+5511999999999" id="btn-telefone-fixo" class="contact-btn secondary" style="opacity: 0.5; pointer-events: none; cursor: not-allowed;">
                    <i class="fas fa-phone-alt"></i>
                    Telefone Fixo
                </a>
                <a href="#" class="contact-btn secondary" onclick="openMessageModal()">
                    <i class="fas fa-comment"></i>
                    Mensagem
                </a>
            </div>
        </section>

        <!-- Info Section -->
        <section class="info-section">
            <h2 class="section-title">
                <i class="fas fa-info-circle"></i>
                Informações Básicas
            </h2>
            <div class="info-grid" id="basic-info-grid">
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-birthday-cake"></i>
                    </div>
                    <div class="info-content">
                        <h4>Idade</h4>
                        <p id="info-idade">32</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-weight"></i>
                    </div>
                    <div class="info-content">
                        <h4>Peso</h4>
                        <p id="info-peso">78kg</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-ruler-vertical"></i>
                    </div>
                    <div class="info-content">
                        <h4>Altura</h4>
                        <p id="info-altura">1.82m</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-kiss-wink-heart"></i>
                    </div>
                    <div class="info-content">
                        <h4>Oral sem</h4>
                        <p id="info-oral-sem">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-kiss"></i>
                    </div>
                    <div class="info-content">
                        <h4>Beija</h4>
                        <p id="info-beija">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <div class="info-content">
                        <h4>Anal</h4>
                        <p id="info-anal">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="info-content">
                        <h4>Local</h4>
                        <p id="info-local">São Paulo, SP</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="info-content">
                        <h4>Mora só</h4>
                        <p id="info-mora-so">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="info-content">
                        <h4>Valor</h4>
                        <p id="info-valor">R$ 200</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="info-content">
                        <h4>Horário de Atendimento</h4>
                        <p id="info-horario">24h</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="info-content">
                        <h4>Atende</h4>
                        <p id="info-atende">Mulheres</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="info-content">
                        <h4>Formas de Pagamento</h4>
                        <p id="info-pagamento">Dinheiro PIX Débito Crédito</p>
                    </div>
                </div>
            </div>
        </section>



        <!-- Schedule Section -->
        <section class="info-section" id="schedule-section" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-clock"></i>
                Horários de Atendimento
            </h2>
            <div class="info-grid" id="schedule-info-grid">
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-sun"></i>
                    </div>
                    <div class="info-content">
                        <h4>Início</h4>
                        <p id="info-horario-inicio">-</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-moon"></i>
                    </div>
                    <div class="info-content">
                        <h4>Fim</h4>
                        <p id="info-horario-fim">-</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Preços -->


        <!-- Informações Específicas - Homem -->
        <section class="section" id="section-homem-info" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-male"></i>
                Informações Específicas - Homem
            </h2>
            <p style="color: #666; margin-top: -15px; margin-bottom: 1.5rem;">Dados específicos para homens</p>
            
            <div class="info-card">
                <div class="services-section-detailed">
                    <h5>Orientação Sexual</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Heterossexual</li>
                        <li><i class="fas fa-check"></i> Gay</li>
                        <li><i class="fas fa-check"></i> Bissexual</li>
                        <li><i class="fas fa-check"></i> Pansexual</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Preferências de Atendimento</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Atende Homens</li>
                        <li><i class="fas fa-check"></i> Atende Mulheres</li>
                        <li><i class="fas fa-check"></i> Atende Trans</li>
                        <li><i class="fas fa-check"></i> Atende Casais</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Especialidades</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Massagem</li>
                        <li><i class="fas fa-check"></i> Acompanhante</li>
                        <li><i class="fas fa-check"></i> Dominação</li>
                        <li><i class="fas fa-check"></i> Submissão</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Eu Faço -->
        <section class="section" id="section-eu-faco" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-spa"></i>
                Eu Faço
            </h2>
            
            <div class="info-card">
                <div class="services-section-detailed">
                    <h5>Eu Faço</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Venda de conteúdo</li>
                        <li><i class="fas fa-check"></i> 24 horas</li>
                        <li><i class="fas fa-check"></i> Viajo até você</li>
                        <li><i class="fas fa-check"></i> Massoterapia</li>
                        <li><i class="fas fa-check"></i> Aceito cartões</li>
                        <li><i class="fas fa-check"></i> Vou à sua casa</li>
                        <li><i class="fas fa-check"></i> Beijo na boca</li>
                        <li><i class="fas fa-check"></i> Gozo Facial</li>
                        <li><i class="fas fa-check"></i> Atendo em dupla</li>
                        <li><i class="fas fa-check"></i> Atendo Mulheres</li>
                        <li><i class="fas fa-check"></i> Casais</li>
                        <li><i class="fas fa-check"></i> Ator pornô</li>
                        <li><i class="fas fa-check"></i> Homem Trans</li>
                        <li><i class="fas fa-check"></i> BDSM</li>
                        <li><i class="fas fa-check"></i> Uso Fantasias</li>
                        <li><i class="fas fa-check"></i> Só brotheragem com masturbação</li>
                        <li><i class="fas fa-check"></i> Podo (trampling, footjob, dirty feet)</li>
                        <li><i class="fas fa-check"></i> Só brotheragem sem penetração</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Corpo</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Atlético</li>
                        <li><i class="fas fa-check"></i> Musculoso</li>
                        <li><i class="fas fa-check"></i> Magro</li>
                        <li><i class="fas fa-check"></i> Gordinho</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Pubis</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Peludos</li>
                        <li><i class="fas fa-check"></i> Depilado</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Estatura</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Alto</li>
                        <li><i class="fas fa-check"></i> Baixo</li>
                        <li><i class="fas fa-check"></i> Mediano</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Serviços Oferecidos -->
        <section class="section">
            <h2 class="section-title">Serviços Oferecidos</h2>
            <div class="info-card">
                <div class="services-section-detailed">
                    <h5>Serviços Básicos</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Beijos na boca</li>
                        <li><i class="fas fa-check"></i> Oral com camisinha</li>
                        <li><i class="fas fa-check"></i> Oral sem camisinha</li>
                        <li><i class="fas fa-check"></i> Oral até o final</li>
                        <li><i class="fas fa-check"></i> Sexo anal</li>
                        <li><i class="fas fa-check"></i> Garganta profunda</li>
                        <li><i class="fas fa-check"></i> Massagem erótica</li>
                        <li><i class="fas fa-check"></i> Namoradinha</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços Especiais</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Beijo negro</li>
                        <li><i class="fas fa-check"></i> Beijo branco</li>
                        <li><i class="fas fa-check"></i> Ejaculação facial</li>
                        <li><i class="fas fa-check"></i> Ejaculação corpo</li>
                        <li><i class="fas fa-check"></i> Chuva dourada</li>
                        <li><i class="fas fa-check"></i> Cubana</li>
                        <li><i class="fas fa-check"></i> PSE</li>
                        <li><i class="fas fa-check"></i> Face fucking</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços de Fetichismo e BDSM</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Fetichismo</li>
                        <li><i class="fas fa-check"></i> Sado submissa</li>
                        <li><i class="fas fa-check"></i> Sado dominadora</li>
                        <li><i class="fas fa-check"></i> Sado suave</li>
                        <li><i class="fas fa-check"></i> Sado duro</li>
                        <li><i class="fas fa-check"></i> Fisting Anal</li>
                        <li><i class="fas fa-check"></i> Brinquedos sexuais</li>
                        <li><i class="fas fa-check"></i> Lingerie</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços de Atendimento em Grupo</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Atenção à casais</li>
                        <li><i class="fas fa-check"></i> Duplas</li>
                        <li><i class="fas fa-check"></i> Trios</li>
                        <li><i class="fas fa-check"></i> Orgia</li>
                        <li><i class="fas fa-check"></i> Festas e eventos</li>
                        <li><i class="fas fa-check"></i> Despedida de solteiro</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços do Perfil e Estilo</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Ativo</li>
                        <li><i class="fas fa-check"></i> Passivo</li>
                        <li><i class="fas fa-check"></i> Versátil</li>
                        <li><i class="fas fa-check"></i> Inversão de papéis</li>
                        <li><i class="fas fa-check"></i> Lésbica</li>
                        <li><i class="fas fa-check"></i> Atenção à mulheres</li>
                        <li><i class="fas fa-check"></i> Experto principiantes</li>
                        <li><i class="fas fa-check"></i> Atenção à deficientes físicos</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços Extras</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Fantasias e figurinos</li>
                        <li><i class="fas fa-check"></i> Sem limite</li>
                        <li><i class="fas fa-check"></i> Sexcam</li>
                        <li><i class="fas fa-check"></i> Atendimento em domicílio</li>
                        <li><i class="fas fa-check"></i> Pacotes promocionais</li>
                        <li><i class="fas fa-check"></i> Acompanhante para eventos</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Seção de Comentários -->
        <section class="comentarios-section" id="comentarios-section">
            <h2><i class="fas fa-comments"></i> Comentários</h2>
            
            <!-- Aviso sobre responsabilidade -->
            <div class="comentarios-aviso">
                <strong><i class="fas fa-info-circle"></i> Aviso:</strong> Os comentários são de responsabilidade exclusiva de seus autores. 
                Todos os comentários passam por moderação antes de serem publicados.
            </div>

            <!-- Lista de comentários aprovados (públicos) -->
            <div class="comentarios-lista" id="comentarios-lista">
                <div class="sem-comentarios">
                    <i class="fas fa-comment-slash" style="font-size: 2rem; color: var(--text-muted); margin-bottom: 0.5rem;"></i>
                    <p>Ainda não há comentários aprovados. Seja o primeiro a comentar!</p>
                </div>
            </div>

            <!-- Formulário para adicionar comentário (visível apenas para usuários logados) -->
            <div class="comentario-form" id="comentario-form" style="display: none;">
                <h3><i class="fas fa-edit"></i> Deixe seu comentário</h3>
                <form id="form-comentario">
                    <div class="form-group-comentario">
                        <label for="comentario-texto">Seu comentário:</label>
                        <textarea 
                            id="comentario-texto" 
                            name="comentario" 
                            placeholder="Escreva seu comentário aqui..." 
                            required 
                            maxlength="1000"
                            rows="5"></textarea>
                        <small style="color: var(--text-muted);">Máximo de 1000 caracteres</small>
                    </div>
                    <button type="submit" class="btn-enviar-comentario" id="btn-enviar-comentario">
                        <i class="fas fa-paper-plane"></i> Enviar Comentário
                    </button>
                </form>
            </div>

            <!-- Mensagem para usuários não logados -->
            <div class="login-prompt" id="login-prompt">
                <p>
                    <i class="fas fa-lock"></i> Você precisa estar cadastrado para comentar. 
                    <a href="register.html">Faça login ou cadastre-se</a> para participar!
                </p>
            </div>

            <!-- Política de comentários -->
            <div class="politica-comentarios">
                <h4><i class="fas fa-gavel"></i> Política de Comentários</h4>
                <ul>
                    <li>Comentários devem ser respeitosos e apropriados</li>
                    <li>Não são permitidos comentários ofensivos, discriminatórios ou com conteúdo inadequado</li>
                    <li>Todos os comentários passam por moderação antes de serem publicados</li>
                    <li>A anunciante reserva-se o direito de aprovar ou rejeitar comentários</li>
                </ul>
            </div>

            <!-- Área de Moderação (visível apenas para anunciante/admin) -->
            <div class="moderacao-area" id="moderacao-area">
                <div class="moderacao-header">
                    <h3><i class="fas fa-shield-alt"></i> Área de Moderação</h3>
                    <button class="btn-enviar-comentario" onclick="carregarComentariosPendentes()" style="padding: 0.5rem 1rem;">
                        <i class="fas fa-sync-alt"></i> Atualizar
                    </button>
                </div>
                <div id="comentarios-pendentes">
                    <div class="sem-comentarios">
                        <p>Não há comentários pendentes de moderação.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal de Painel de Controle -->
    <div class="painel-modal" id="painel-modal">
        <div class="painel-modal-content">
            <div class="painel-modal-header">
                <h2><i class="fas fa-cog"></i> Painel de Controle</h2>
                <button class="painel-modal-close" onclick="fecharPainelControle()">&times;</button>
            </div>
            <div id="painel-modal-body">
                <!-- Conteúdo do painel será carregado aqui -->
                <div class="moderacao-area visible">
                    <div class="moderacao-header">
                        <h3><i class="fas fa-shield-alt"></i> Moderação de Comentários</h3>
                        <button class="btn-enviar-comentario" onclick="carregarComentariosPendentes()" style="padding: 0.5rem 1rem;">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>
                    <div id="comentarios-pendentes-modal">
                        <div class="sem-comentarios">
                            <p>Carregando comentários pendentes...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Gallery -->
    <!-- Modal do Carrossel de Galeria -->
    <div id="gallery-modal" class="gallery-modal" style="display: none;">
        <div class="gallery-modal-backdrop"></div>
        <button class="gallery-modal-close" id="gallery-close-btn" aria-label="Fechar">
            <i class="fas fa-times"></i>
        </button>
        <button class="gallery-modal-prev" id="gallery-prev-btn" aria-label="Foto anterior">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="gallery-modal-next" id="gallery-next-btn" aria-label="Próxima foto">
            <i class="fas fa-chevron-right"></i>
        </button>
        <div class="gallery-modal-content">
            <img class="gallery-modal-image" id="gallery-modal-image" src="" alt="Foto da galeria">
            <div class="gallery-modal-counter">
                <span id="gallery-current-index">1</span> / <span id="gallery-total-count">1</span>
            </div>
        </div>
    </div>

    <!-- Modal de Mensagem -->
    <div id="message-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Enviar Mensagem</h3>
                <span class="close" onclick="closeMessageModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="message-form">
                    <div class="form-group">
                        <label for="message-name">Seu Nome:</label>
                        <input type="text" id="message-name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="message-email">Seu E-mail:</label>
                        <input type="email" id="message-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message-phone">Seu Telefone:</label>
                        <input type="tel" id="message-phone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="message-text">Mensagem:</label>
                        <textarea id="message-text" name="message" rows="5" required placeholder="Digite sua mensagem aqui..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeMessageModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Enviar Mensagem</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Inicializar Firebase
        let db = null;
        let auth = null;
        
        // Função para lidar com clique no botão voltar
        function handleBackClick(event) {
            // Se há histórico, tentar voltar
            if (window.history.length > 1) {
                const referrer = document.referrer;
                // Se veio da página de listagem, usar history.back()
                if (referrer.includes('A_02__premium_copy.html') || referrer.includes('premium_copy')) {
                    event.preventDefault();
                    window.history.back();
                    return false;
                }
            }
            // Caso contrário, deixar o link funcionar normalmente (voltar para A_02__premium_copy.html)
            return true;
        }
        
        // Aguardar Firebase estar pronto e carregar dados
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 DOMContentLoaded - Inicializando página...');
            
            // Verificar se está em modo de teste
            const urlParams = new URLSearchParams(window.location.search);
            const modoTeste = urlParams.get('teste') || urlParams.get('simular');
            
            if (modoTeste === '1') {
                console.log('🧪 Modo de teste detectado! Carregando dados simulados...');
                // Aguardar um pouco para garantir que o DOM está totalmente carregado
                setTimeout(() => {
                    const jsonTeste = {
                        "nome": "Rapariga",
                        "descricao": "fazemos as massagem mais intrigantes de todas as massagistas do difederalOlá meus amores. Estou de volta a Brasília, daquele jeitinho que vcs já conhecem, meiga e abusada, e louca p te dar prazer. Ambiente de fácil acesso, limpo e climatizado. Será, literalmente, um prazer. Ofereço serviço de podolatria. Atendimento para homens de alto nivel",
                        "frase-efeito": "sou uma rapariga de primeira linha e faco uma massagem das mais legais de sua vida ",
                        "frase_efeito": "sou uma rapariga de primeira linha e faco uma massagem das mais legais de sua vida ",
                        "telefone_celular": "(61) 98484-8848",
                        "telefone_fixo": "(11) 3232-3232",
                        "idade": "22",
                        "peso": "99",
                        "altura": "177",
                        "oral-sem": "sim",
                        "oral_sem": "sim",
                        "beija": "sim",
                        "anal": "sim",
                        "local": "sim",
                        "mora-so": "sim",
                        "mora_so": "sim",
                        "valor": "500",
                        "horario_24h": "sim",
                        "horario_inicio": "",
                        "horario_fim": "",
                        "atende": [
                            "ele",
                            "ela",
                            "casais"
                        ],
                        "pagamento": [
                            "dinheiro",
                            "credito"
                        ],
                        "servicos": [
                            "beijos-boca",
                            "beijo-negro",
                            "fetichismo",
                            "atencao-casais",
                            "ativo",
                            "fantasias-figurinos"
                        ],
                        "estado": "AM",
                        "cidade": "itacoatiara",
                        "files": {
                            "foto_banner": {},
                            "foto_capa": {},
                            "galeria": [
                                {
                                    "campo": "galeria_1",
                                    "arquivo": "a1.jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 64209,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_2",
                                    "arquivo": "avatar (4).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 33391,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_3",
                                    "arquivo": "avatar (13).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 24356,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_4",
                                    "arquivo": "gallery-1754067033866-783292598.jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 8807,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_5",
                                    "arquivo": "foto (25).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 9448,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_6",
                                    "arquivo": "foto (20).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 7847,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_7",
                                    "arquivo": "avatar (2).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 40910,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_9",
                                    "arquivo": "avatar (4).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 33391,
                                    "isVideo": false,
                                    "isStories": true
                                }
                            ]
                        },
                        "created_at": "2025-11-05T00:32:16.945Z",
                        "updated_at": "2025-11-05T00:32:16.945Z",
                        "status": "rascunho"
                    };
                    if (window.simularCarregamentoDados) {
                        simularCarregamentoDados(jsonTeste);
                    } else {
                        console.error('❌ Função simularCarregamentoDados não encontrada!');
                    }
                }, 1000);
                return; // Não tentar carregar do Firebase
            }
            
            if (typeof firebase !== 'undefined' && window.firebaseConfig) {
                try {
                    firebase.initializeApp(firebaseConfig);
                    db = firebase.firestore();
                    auth = firebase.auth();
                    console.log('✅ Firebase inicializado com sucesso na página de perfil');
                    
                    // Aguardar um pouco para garantir que o Firebase está totalmente pronto
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // Agora carregar os dados do perfil
                    console.log('📥 Chamando loadProfileData...');
                    await loadProfileData();
                } catch (e) {
                    console.error('❌ Erro ao inicializar Firebase:', e);
                    // Mesmo com erro, tentar carregar dados
                    setTimeout(() => loadProfileData(), 1000);
                }
            } else {
                console.error('❌ Firebase não configurado. Verifique firebase-config.js');
                // Tentar carregar dados mesmo sem Firebase (pode estar usando dados estáticos)
                setTimeout(() => loadProfileData(), 500);
            }
        });

        // Função para obter parâmetros da URL
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Função para carregar dados do perfil do Firebase
        async function loadProfileData() {
            try {
                console.log('🔥 Iniciando loadProfileData...');
                
                const profileId = getUrlParameter('id');
                const profileName = getUrlParameter('name');
                
                console.log('📋 Parâmetros da URL:', { id: profileId, name: profileName });
                
                if (!profileId && !profileName) {
                    console.error('❌ ID ou nome do perfil não fornecido');
                    return;
                }

                // Aguardar Firebase estar inicializado (até 5 segundos)
                let attempts = 0;
                const maxAttempts = 50; // 50 tentativas x 100ms = 5 segundos
                while (!db && attempts < maxAttempts) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                    attempts++;
                    if (typeof firebase !== 'undefined' && window.firebaseConfig && !db) {
                        try {
                            firebase.initializeApp(firebaseConfig);
                            db = firebase.firestore();
                            auth = firebase.auth();
                            console.log('✅ Firebase inicializado dentro de loadProfileData');
                        } catch (e) {
                            console.warn('⚠️ Erro ao inicializar Firebase (tentativa ' + attempts + '):', e);
                        }
                    }
                }
                
                if (!db) {
                    const errorMsg = "Firebase não inicializado após " + (maxAttempts * 100) + "ms. Verifique firebase-config.js";
                    console.error('❌', errorMsg);
                    throw new Error(errorMsg);
                }
                
                console.log('✅ Firebase pronto para buscar dados');

                let anuncio = null;
                
                // Tentar buscar por ID primeiro
                if (profileId) {
                    console.log(`🔍 Buscando anúncio por ID: "${profileId}"`);
                    console.log(`📊 Tipo do ID: ${typeof profileId}, Tamanho: ${profileId.length}`);
                    
                    // CORREÇÃO: Buscar em AMBAS as coleções simultaneamente
                    const promises = [];
                    
                    // Buscar na coleção 'anuncios'
                    promises.push(
                        db.collection('anuncios').doc(profileId).get().then(doc => ({
                            collection: 'anuncios',
                            doc: doc
                        })).catch(e => {
                            console.warn('⚠️ Erro ao buscar em "anuncios":', e);
                            return { collection: 'anuncios', doc: null };
                        })
                    );
                    
                    // Buscar na coleção 'advertisements'
                    promises.push(
                        db.collection('advertisements').doc(profileId).get().then(doc => ({
                            collection: 'advertisements',
                            doc: doc
                        })).catch(e => {
                            console.warn('⚠️ Erro ao buscar em "advertisements":', e);
                            return { collection: 'advertisements', doc: null };
                        })
                    );
                    
                    // Aguardar ambas as buscas
                    const results = await Promise.all(promises);
                    
                    // Verificar resultados
                    for (const result of results) {
                        if (result.doc && result.doc.exists) {
                            anuncio = { id: result.doc.id, ...result.doc.data() };
                            console.log(`✅ Anúncio encontrado na coleção "${result.collection}"!`);
                            console.log('📝 Dados do anúncio:', {
                                id: anuncio.id,
                                nome: anuncio.nome || anuncio.name,
                                email: anuncio.email || anuncio.userEmail,
                                status: anuncio.status,
                                plano: anuncio.plano,
                                categoria: anuncio.categoria || anuncio.category,
                                genero: anuncio.genero || anuncio.gender,
                                colecao: result.collection,
                                todas_chaves: Object.keys(anuncio).slice(0, 20) // Primeiras 20 chaves
                            });
                            break; // Parar na primeira busca bem-sucedida
                        } else {
                            console.log(`⚠️ Documento não encontrado na coleção "${result.collection}" com ID: ${profileId}`);
                        }
                    }
                    
                    // Se não encontrou, listar alguns documentos para debug
                    if (!anuncio) {
                        console.warn('⚠️ Anúncio não encontrado em nenhuma coleção com ID:', profileId);
                        console.log('🔍 Listando alguns documentos para debug...');
                        
                        try {
                            const sampleAnuncios = await db.collection('anuncios').limit(3).get();
                            const sampleAds = await db.collection('advertisements').limit(3).get();
                            
                            console.log('📋 Primeiros 3 documentos em "anuncios":', 
                                sampleAnuncios.docs.map(d => ({ 
                                    id: d.id, 
                                    nome: d.data().nome || d.data().name || 'sem nome' 
                                }))
                            );
                            console.log('📋 Primeiros 3 documentos em "advertisements":', 
                                sampleAds.docs.map(d => ({ 
                                    id: d.id, 
                                    nome: d.data().nome || d.data().name || 'sem nome' 
                                }))
                            );
                        } catch (e) {
                            console.error('❌ Erro ao listar documentos:', e);
                        }
                    }
                    
                    // Se ainda não encontrou, tentar coleção 'advertisers' (onde pode estar o ID do usuário)
                    if (!anuncio) {
                        try {
                            console.log('🔎 Tentando buscar na coleção "advertisers"...');
                            // Primeiro tentar buscar o documento diretamente
                            const docRef = db.collection('advertisers').doc(profileId);
                            let doc = await docRef.get();
                            
                            if (!doc.exists) {
                                // Tentar buscar pelo nome "Bebel do mel"
                                console.log('🔎 Buscando por nome na coleção "advertisers"...');
                                const snapshot = await db.collection('advertisers')
                                    .where('nome', '==', profileName || 'Bebel do mel')
                                    .limit(1)
                                    .get();
                                if (!snapshot.empty) {
                                    doc = snapshot.docs[0];
                                    console.log('✅ Encontrado na coleção "advertisers" por nome:', doc.id);
                                }
                            }
                            
                            if (doc.exists) {
                                const advertiserData = doc.data();
                                console.log('📋 Dados do advertiser:', advertiserData);
                                
                                // Agora buscar o anúncio relacionado na coleção 'anuncios'
                                // O ID do anúncio pode estar no campo userId ou similar
                                if (advertiserData.userId || advertiserData.anuncioId) {
                                    const anuncioId = advertiserData.anuncioId || advertiserData.userId;
                                    console.log('🔎 Buscando anúncio relacionado com ID:', anuncioId);
                                    
                                    const anuncioDoc = await db.collection('anuncios').doc(anuncioId).get();
                                    if (anuncioDoc.exists) {
                                        anuncio = { id: anuncioDoc.id, ...anuncioDoc.data() };
                                        console.log('✅ Anúncio encontrado relacionado ao advertiser!');
                                    }
                                }
                            }
                        } catch (e) {
                            console.error('❌ Erro ao buscar na coleção "advertisers":', e);
                        }
                    }
                }
                
                // Se não encontrou por ID, tentar por nome
                if (!anuncio && profileName) {
                    console.log(`🔍 Buscando anúncio por nome: "${profileName}"`);
                    
                    // CORREÇÃO: Buscar em ambas as coleções e também por campo 'name'
                    const nomeBuscas = [];
                    
                    // Buscar na coleção 'anuncios' por campo 'nome'
                    nomeBuscas.push(
                        db.collection('anuncios')
                            .where('nome', '==', profileName)
                            .limit(1)
                            .get()
                            .then(snapshot => ({ collection: 'anuncios', campo: 'nome', snapshot }))
                            .catch(e => {
                                console.warn('⚠️ Erro ao buscar por nome em "anuncios":', e);
                                return { collection: 'anuncios', campo: 'nome', snapshot: null };
                            })
                    );
                    
                    // Buscar na coleção 'anuncios' por campo 'name'
                    nomeBuscas.push(
                        db.collection('anuncios')
                            .where('name', '==', profileName)
                            .limit(1)
                            .get()
                            .then(snapshot => ({ collection: 'anuncios', campo: 'name', snapshot }))
                            .catch(e => {
                                console.warn('⚠️ Erro ao buscar por name em "anuncios":', e);
                                return { collection: 'anuncios', campo: 'name', snapshot: null };
                            })
                    );
                    
                    // Buscar na coleção 'advertisements' por campo 'nome'
                    nomeBuscas.push(
                        db.collection('advertisements')
                            .where('nome', '==', profileName)
                            .limit(1)
                            .get()
                            .then(snapshot => ({ collection: 'advertisements', campo: 'nome', snapshot }))
                            .catch(e => {
                                console.warn('⚠️ Erro ao buscar por nome em "advertisements":', e);
                                return { collection: 'advertisements', campo: 'nome', snapshot: null };
                            })
                    );
                    
                    // Buscar na coleção 'advertisements' por campo 'name'
                    nomeBuscas.push(
                        db.collection('advertisements')
                            .where('name', '==', profileName)
                            .limit(1)
                            .get()
                            .then(snapshot => ({ collection: 'advertisements', campo: 'name', snapshot }))
                            .catch(e => {
                                console.warn('⚠️ Erro ao buscar por name em "advertisements":', e);
                                return { collection: 'advertisements', campo: 'name', snapshot: null };
                            })
                    );
                    
                    // Aguardar todas as buscas
                    const nomeResults = await Promise.all(nomeBuscas);
                    
                    // Verificar resultados
                    for (const result of nomeResults) {
                        if (result.snapshot && !result.snapshot.empty) {
                            const doc = result.snapshot.docs[0];
                            anuncio = { id: doc.id, ...doc.data() };
                            console.log(`✅ Anúncio encontrado por nome na coleção "${result.collection}" (campo: ${result.campo})!`);
                            console.log('📝 Dados do anúncio:', {
                                id: anuncio.id,
                                nome: anuncio.nome || anuncio.name,
                                email: anuncio.email || anuncio.userEmail
                            });
                            break; // Parar na primeira busca bem-sucedida
                        }
                    }
                    
                    // Se ainda não encontrou, tentar busca parcial (case-insensitive)
                    if (!anuncio) {
                        console.log('🔍 Tentando busca parcial (case-insensitive)...');
                        try {
                            // Buscar todos os anúncios e filtrar localmente (fallback)
                            const allAnuncios = await db.collection('anuncios').limit(50).get();
                            const allAds = await db.collection('advertisements').limit(50).get();
                            
                            const allDocs = [
                                ...allAnuncios.docs.map(d => ({ ...d.data(), id: d.id, _collection: 'anuncios' })),
                                ...allAds.docs.map(d => ({ ...d.data(), id: d.id, _collection: 'advertisements' }))
                            ];
                            
                            const encontrado = allDocs.find(doc => {
                                const nomeDoc = (doc.nome || doc.name || '').toLowerCase().trim();
                                const nomeBusca = profileName.toLowerCase().trim();
                                return nomeDoc === nomeBusca || nomeDoc.includes(nomeBusca) || nomeBusca.includes(nomeDoc);
                            });
                            
                            if (encontrado) {
                                const { _collection, ...rest } = encontrado;
                                anuncio = rest;
                                console.log(`✅ Anúncio encontrado por busca parcial na coleção "${encontrado._collection}"!`);
                            }
                        } catch (e) {
                            console.warn('⚠️ Erro ao fazer busca parcial:', e);
                        }
                    }
                }

                if (!anuncio) {
                    console.error('❌ Anúncio não encontrado no Firebase');
                    console.error('❌ ID buscado:', profileId);
                    console.error('❌ Nome buscado:', profileName);
                    alert('Anúncio não encontrado. Verifique se o ID ou nome está correto.\n\nAbra o console (F12) para mais detalhes.');
                    return;
                }

                console.log('✅ Anúncio carregado com sucesso!');
                console.log('📋 ========== DADOS COMPLETOS DO ANÚNCIO ==========');
                console.log('📋 ID do documento:', anuncio.id);
                console.log('📋 Nome:', anuncio.nome || anuncio.name || 'NÃO ENCONTRADO');
                console.log('📋 Descrição:', anuncio.descricao || anuncio.description || 'NÃO ENCONTRADO');
                console.log('📋 Telefone:', anuncio.telefone_celular || anuncio.telefone || 'NÃO ENCONTRADO');
                console.log('📋 Idade:', anuncio.idade || 'NÃO ENCONTRADO');
                console.log('📋 Cidade:', anuncio.cidade || 'NÃO ENCONTRADO');
                console.log('📋 Estado:', anuncio.estado || 'NÃO ENCONTRADO');
                console.log('📋 Foto Banner:', anuncio.foto_banner || anuncio.foto_banner_url || 'NÃO ENCONTRADO');
                console.log('📋 Foto Capa:', anuncio.foto_capa || anuncio.foto_capa_url || 'NÃO ENCONTRADO');
                console.log('📋 Galeria:', anuncio.galeria || anuncio.fotos || anuncio.images || 'NÃO ENCONTRADO');
                console.log('📋 Status:', anuncio.status);
                console.log('📋 Plano:', anuncio.plano);
                console.log('📋 TODAS as chaves disponíveis:', Object.keys(anuncio));
                console.log('📋 Estrutura JSON completa:', JSON.stringify(anuncio, null, 2));

                // Verificar se os elementos do DOM existem antes de atualizar
                console.log('🔍 Verificando elementos do DOM...');
                const profileNameEl = document.getElementById('profile-name');
                const profileLevelEl = document.getElementById('profile-level');
                const profileDescEl = document.getElementById('profile-description');
                
                console.log('📝 Elementos encontrados:', {
                    profileName: !!profileNameEl,
                    profileLevel: !!profileLevelEl,
                    profileDescription: !!profileDescEl
                });
                
                if (!profileNameEl || !profileLevelEl || !profileDescEl) {
                    console.warn('⚠️ Alguns elementos do DOM não foram encontrados. Aguardando...');
                    await new Promise(resolve => setTimeout(resolve, 500));
                }

                // Incrementar contador de views quando a página é carregada
                let newViews = 0;
                if (anuncio.id) {
                    newViews = await incrementViews(anuncio.id);
                    // Atualizar o objeto anuncio com o novo valor de views
                    if (newViews !== null && newViews !== undefined) {
                        anuncio.views = newViews;
                        anuncio.visualizacoes = newViews;
                    }
                }
                
                // Atualizar dados do perfil
                console.log('🔄 Chamando updateProfileData...');
                await updateProfileData(anuncio);
                console.log('✅ updateProfileData concluído');
                
                // Carregar galeria
                console.log('🖼️ Chamando loadGallery...');
                loadGallery(anuncio);
                console.log('✅ loadGallery concluído');
                
            } catch (error) {
                console.error('❌ Erro ao carregar dados do perfil:', error);
                alert('Erro ao carregar dados do anúncio. Tente novamente.');
            }
        }

        // Função para atualizar dados do perfil
        async function updateProfileData(anuncio) {
            console.log('📝 ========== INICIANDO updateProfileData ==========');
            console.log('📝 Anúncio recebido:', {
                id: anuncio.id,
                nome: anuncio.nome,
                name: anuncio.name,
                descricao: anuncio.descricao || anuncio.description || '',
                descricao_original: anuncio.descricao,
                description_original: anuncio.description,
                plano: anuncio.plano,
                nivel: anuncio.nivel,
                status: anuncio.status,
                todas_chaves: Object.keys(anuncio)
            });
            
            // Verificar campos relacionados à descrição e frase de efeito
            const camposDescricao = Object.keys(anuncio).filter(k => 
                k.toLowerCase().includes('descricao') || 
                k.toLowerCase().includes('description') ||
                k.toLowerCase().includes('bio') ||
                k.toLowerCase().includes('sobre')
            );
            const camposFraseEfeito = Object.keys(anuncio).filter(k => 
                k.toLowerCase().includes('frase') || 
                k.toLowerCase().includes('efeito') ||
                k.toLowerCase().includes('tagline') ||
                k.toLowerCase().includes('slogan')
            );
            console.log('📋 Campos relacionados à descrição encontrados:', camposDescricao);
            console.log('📋 Campos relacionados à frase de efeito encontrados:', camposFraseEfeito);
            if (camposDescricao.length > 0) {
                camposDescricao.forEach(campo => {
                    console.log(`  - ${campo}:`, anuncio[campo]?.substring(0, 100) + (anuncio[campo]?.length > 100 ? '...' : ''));
                });
            }
            if (camposFraseEfeito.length > 0) {
                camposFraseEfeito.forEach(campo => {
                    console.log(`  - ${campo}:`, anuncio[campo]);
                });
            }
            
            // IMPORTANTE: O status "aguardando_verificacao" NÃO impede a exibição na página de perfil!
            // A página de perfil deve mostrar TODOS os anúncios, independente do status.
            
            // Função para adicionar preload de imagens críticas
            function addImagePreload(url, as = 'image') {
                if (!url) return;
                // Verificar se já existe um preload para esta URL
                const existingPreload = document.querySelector(`link[rel="preload"][href="${url}"]`);
                if (existingPreload) return;
                
                const link = document.createElement('link');
                link.rel = 'preload';
                link.as = as;
                link.href = url;
                link.setAttribute('fetchpriority', 'high');
                document.head.appendChild(link);
                console.log('🚀 Preload adicionado:', url);
            }
            
            // Função otimizada para carregar imagem com decode e preload
            async function loadImageOptimized(imgElement, imageUrl, isCritical = false) {
                if (!imgElement || !imageUrl) return;
                
                // Adicionar preload para imagens críticas
                if (isCritical) {
                    addImagePreload(imageUrl);
                }
                
                // Criar nova imagem para preload e decode
                const img = new Image();
                img.fetchPriority = 'high';
                img.decoding = 'async';
                
                return new Promise((resolve, reject) => {
                    img.onload = async () => {
                        try {
                            // Decodificar imagem assincronamente
                            await img.decode();
                            // Atualizar elemento da página
                            imgElement.src = imageUrl;
                            imgElement.setAttribute('fetchpriority', 'high');
                            imgElement.setAttribute('decoding', 'async');
                            // Remover placeholder quando imagem carregar
                            imgElement.removeAttribute('data-placeholder');
                            // Mostrar imagem com transição suave
                            requestAnimationFrame(() => {
                                imgElement.style.opacity = '1';
                            });
                            console.log('✅ Imagem carregada e decodificada:', imageUrl);
                            resolve();
                        } catch (error) {
                            console.warn('⚠️ Erro ao decodificar imagem, usando fallback:', error);
                            imgElement.src = imageUrl;
                            imgElement.removeAttribute('data-placeholder');
                            requestAnimationFrame(() => {
                                imgElement.style.opacity = '1';
                            });
                            resolve();
                        }
                    };
                    
                    img.onerror = () => {
                        console.error('❌ Erro ao carregar imagem:', imageUrl);
                        reject(new Error('Failed to load image'));
                    };
                    
                    img.src = imageUrl;
                });
            }
            
            // Atualizar banner
            const profileBanner = document.getElementById('profile-banner');
            console.log('🖼️ Buscando elemento profile-banner:', profileBanner);
            
            if (profileBanner) {
                // Tentar múltiplos campos possíveis para o banner
                // Verificar também em objetos aninhados (mediaFiles, etc)
                const bannerUrl = anuncio.foto_banner_url || 
                                  anuncio.foto_banner || 
                                  anuncio.banner_url || 
                                  anuncio.bannerImage ||
                                  anuncio.mediaFiles?.foto_banner ||
                                  anuncio.mediaFiles?.foto_banner_url ||
                                  anuncio.mediaFiles?.banner ||
                                  (anuncio.mediaFiles && typeof anuncio.mediaFiles === 'object' ? 
                                    Object.values(anuncio.mediaFiles).find(v => 
                                      typeof v === 'string' && v.includes('banner')
                                    ) : null) ||
                                  null;
                
                console.log('🔍 ========== VERIFICAÇÃO DE BANNER ==========');
                console.log('🔍 Campos de banner verificados:', {
                    foto_banner_url: anuncio.foto_banner_url,
                    foto_banner: anuncio.foto_banner,
                    banner_url: anuncio.banner_url,
                    bannerImage: anuncio.bannerImage,
                    mediaFiles_foto_banner: anuncio.mediaFiles?.foto_banner,
                    mediaFiles_foto_banner_url: anuncio.mediaFiles?.foto_banner_url,
                    mediaFiles_completo: anuncio.mediaFiles,
                    resultado_encontrado: bannerUrl
                });
                console.log('🔍 Tipo do bannerUrl:', typeof bannerUrl);
                console.log('🔍 Valor do bannerUrl:', bannerUrl);
                
                if (bannerUrl) {
                    let finalBannerUrl = bannerUrl;
                    
                    // Se é uma URL completa, usar diretamente
                    if (typeof bannerUrl === 'string' && (bannerUrl.startsWith('http://') || bannerUrl.startsWith('https://'))) {
                        finalBannerUrl = bannerUrl;
                    } 
                    // Se é um caminho do Firebase Storage (gs://), converter
                    else if (typeof bannerUrl === 'string' && bannerUrl.startsWith('gs://')) {
                        const path = bannerUrl.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
                        finalBannerUrl = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                    } 
                    // Se é um nome de arquivo simples (ex: "foto_banner_1761936697295_banner-1754069202781-935737209.jpg")
                    else if (typeof bannerUrl === 'string' && !bannerUrl.includes('://')) {
                        // Usar estrutura padronizada 'advertisements/ID_ANUNCIO/' (compatibilidade com anuncios/ mantida)
                        const anuncioId = anuncio.id;
                        const path = `advertisements/${anuncioId}/${bannerUrl}`;
                        finalBannerUrl = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                        
                        // Fallback para estrutura antiga (compatibilidade)
                        const pathAntigo = `anuncios/${anuncioId}/${bannerUrl}`;
                        const urlAntiga = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(pathAntigo)}?alt=media`;
                        
                        console.log('🖼️ Tentando URL padronizada:', finalBannerUrl);
                        console.log('🖼️ Fallback para estrutura antiga:', urlAntiga);
                    }
                    
                    console.log('📝 Valor ANTES da atualização:', profileBanner.src);
                    console.log('📝 Valor DEPOIS da atualização:', finalBannerUrl);
                    
                    // Carregar imagem de forma otimizada (crítica - acima da dobra)
                    loadImageOptimized(profileBanner, finalBannerUrl, true).catch(error => {
                        console.error('❌ Erro ao carregar banner:', finalBannerUrl, error);
                        // Tentar URLs alternativas em caso de erro
                        const alternativas = [
                            `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(bannerUrl)}?alt=media`,
                            `https://storage.googleapis.com/copia-do-job.firebasestorage.app/${encodeURIComponent(bannerUrl)}`
                        ];
                        console.log('🔄 Tentando URLs alternativas:', alternativas);
                        // Tentar primeira alternativa
                        if (alternativas[0] && alternativas[0] !== finalBannerUrl) {
                            loadImageOptimized(profileBanner, alternativas[0], true).catch(() => {
                                console.error('❌ Todas as tentativas de carregar banner falharam');
                            });
                        }
                    });
                } else {
                    console.warn('⚠️ Nenhuma URL de banner encontrada no anúncio');
                }
            } else {
                console.error('❌ Elemento profile-banner não encontrado no DOM!');
            }
            
            // Atualizar foto de perfil
            const profileImage = document.getElementById('profile-image');
            if (profileImage) {
                const imageUrl = anuncio.foto_capa_url || anuncio.foto_capa || anuncio.fotoPerfil || anuncio.coverImage || anuncio.image;
                if (imageUrl) {
                    let finalImageUrl = imageUrl;
                    
                    // Se é uma URL completa, usar diretamente
                    if (imageUrl.startsWith('http://') || imageUrl.startsWith('https://')) {
                        finalImageUrl = imageUrl;
                    } else if (imageUrl.startsWith('gs://')) {
                        // Converter gs:// para URL HTTP
                        const path = imageUrl.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
                        finalImageUrl = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                    } else {
                        // Assumir que é um caminho
                        const path = imageUrl.replace(/^\/+/, '');
                        finalImageUrl = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                    }
                    
                    console.log('🖼️ Foto de perfil URL:', finalImageUrl);
                    
                    // Carregar imagem de forma otimizada (crítica - acima da dobra)
                    loadImageOptimized(profileImage, finalImageUrl, true).catch(error => {
                        console.error('❌ Erro ao carregar foto de perfil:', finalImageUrl, error);
                    });
                }
            }
            
            // Atualizar nome - com múltiplas tentativas
            // Verificar TODOS os campos possíveis de nome
            const nomeAnuncio = anuncio.nome || 
                                anuncio.name || 
                                anuncio.nomeAnuncio ||
                                anuncio.nomeCompleto ||
                                anuncio.nome_completo ||
                                anuncio.advertiserName ||
                                anuncio.title ||
                                'Nome não disponível';
            
            console.log('✏️ ========== VERIFICAÇÃO DE NOME ==========');
            console.log('✏️ Nome a ser atualizado:', nomeAnuncio);
            console.log('📋 Campos de nome verificados (em ordem de prioridade):', {
                '1. nome (PRIORIDADE)': anuncio.nome,
                '2. name': anuncio.name,
                '3. nomeAnuncio': anuncio.nomeAnuncio,
                '4. nomeCompleto': anuncio.nomeCompleto,
                '5. nome_completo': anuncio.nome_completo,
                '6. advertiserName': anuncio.advertiserName,
                '7. title': anuncio.title,
                '✅ RESULTADO FINAL': nomeAnuncio
            });
            const camposComNome = Object.keys(anuncio).filter(k => k.toLowerCase().includes('nome'));
            console.log('📋 Todos os campos do anúncio que contêm "nome":', camposComNome);
            
            let profileName = document.getElementById('profile-name');
            if (!profileName) {
                console.warn('⚠️ Elemento profile-name não encontrado. Tentando novamente em 200ms...');
                await new Promise(resolve => setTimeout(resolve, 200));
                profileName = document.getElementById('profile-name');
            }
            
            if (profileName) {
                console.log('✅ Elemento profile-name encontrado!');
                console.log('📝 Valor ANTES:', profileName.textContent);
                profileName.textContent = nomeAnuncio;
                console.log('📝 Valor DEPOIS:', profileName.textContent);
                
                // Verificar se realmente foi atualizado
                if (profileName.textContent === nomeAnuncio) {
                    console.log('✅ Nome atualizado com sucesso!');
                } else {
                    console.error('❌ ERRO: Nome não foi atualizado! Esperado:', nomeAnuncio, 'Atual:', profileName.textContent);
                    // Tentar forçar atualização
                    profileName.innerHTML = nomeAnuncio;
                    console.log('🔄 Tentativa de forçar atualização com innerHTML');
                }
            } else {
                console.error('❌ Elemento profile-name NÃO encontrado no DOM após 2 tentativas!');
                console.error('🔍 Tentando buscar todos os elementos com "profile":', 
                    Array.from(document.querySelectorAll('[id*="profile"]')).map(el => el.id)
                );
            }

            // Atualizar nível/plano
            const profileLevel = document.getElementById('profile-level');
            if (profileLevel) {
                let levelText = 'Plus';
                const plano = (anuncio.plano || anuncio.nivel || '').toLowerCase();
                if (plano === 'camarote' || plano.includes('n1')) {
                    levelText = 'Camarote - Premium VIP';
                } else if (plano === 'especial' || plano.includes('n3')) {
                    levelText = 'Especial - Destaque';
                } else if (plano === 'plus' || plano.includes('n7')) {
                    levelText = 'Plus - Padrão';
                } else if (plano === 'basico') {
                    levelText = 'Básico';
                }
                profileLevel.textContent = levelText;
            }

            // Atualizar FRASE DE EFEITO no profile-description (parágrafo pequeno)
            const profileDescription = document.getElementById('profile-description');
            if (profileDescription) {
                // Buscar frase de efeito em múltiplos campos possíveis
                const fraseEfeito = anuncio['frase-efeito'] || 
                                   anuncio.frase_efeito || 
                                   anuncio.fraseEfeito ||
                                   anuncio.frase_efeito_anuncio ||
                                   anuncio.tagline ||
                                   anuncio.slogan ||
                                   '';
                
                if (fraseEfeito) {
                    profileDescription.textContent = fraseEfeito;
                    console.log('✅ Frase de efeito atualizada no profile-description:', fraseEfeito);
                } else {
                    // Se não tiver frase de efeito, usar início da descrição (máximo 150 caracteres)
                    const descricao = anuncio.descricao || anuncio.description || '';
                    if (descricao) {
                        const preview = descricao.length > 150 ? descricao.substring(0, 150) + '...' : descricao;
                        profileDescription.textContent = preview;
                        console.log('⚠️ Frase de efeito não encontrada, usando início da descrição:', preview);
                    } else {
                        profileDescription.textContent = 'Descrição não disponível';
                        console.warn('⚠️ Nem frase de efeito nem descrição encontradas');
                    }
                }
            }
            
            // Atualizar DESCRIÇÃO COMPLETA na seção de descrição
            const descriptionText = document.getElementById('description-text');
            if (descriptionText) {
                // Buscar descrição completa em múltiplos campos
                const descricao = anuncio.descricao || 
                                anuncio.description || 
                                anuncio.descricao_completa ||
                                anuncio.bio ||
                                anuncio.sobre_mim ||
                                'Descrição não disponível';
                
                descriptionText.textContent = descricao;
                console.log('✅ Descrição completa atualizada no description-text:', {
                    tamanho: descricao.length,
                    preview: descricao.substring(0, 100) + (descricao.length > 100 ? '...' : '')
                });
            } else {
                console.warn('⚠️ Elemento description-text não encontrado. Tentando novamente em 200ms...');
                await new Promise(resolve => setTimeout(resolve, 200));
                const descriptionTextRetry = document.getElementById('description-text');
                if (descriptionTextRetry) {
                    const descricao = anuncio.descricao || 
                                    anuncio.description || 
                                    anuncio.descricao_completa ||
                                    'Descrição não disponível';
                    descriptionTextRetry.textContent = descricao;
                    console.log('✅ Descrição completa atualizada no description-text (tentativa 2):', descricao.substring(0, 100) + '...');
                } else {
                    console.error('❌ Elemento description-text NÃO encontrado após 2 tentativas!');
                }
            }

            // Preencher campos obrigatórios
            loadBasicInfo(anuncio);
            
            // Preencher campos opcionais (só mostrar se preenchidos)
            loadOptionalInfo(anuncio);
            
            // Atualizar serviços e preços
            updateServicesAndPrices(anuncio);
            
            
            // Controlar visibilidade de seções baseado no gênero
            controlSectionVisibility(anuncio);
            
            // Atualizar serviços oferecidos
            updateServicosOferecidos(anuncio);
            
            // Atualizar botões de contato
            updateContactButtons(anuncio);
            
            // Atualizar título da página
            document.title = `Perfil - ${nomeAnuncio} | Premium VIP`;
        }
        
        // Função para controlar visibilidade de seções baseado no gênero
        function controlSectionVisibility(anuncio) {
            const genero = (anuncio.genero || anuncio.gender || '').toLowerCase();
            const categoria = (anuncio.categoria || anuncio.category || '').toLowerCase();
            
            const isHomem = genero === 'homem' || categoria === 'homem';
            const isTrans = genero === 'trans' || categoria === 'trans';
            // Verificar se é mulher acompanhante (considerando variações possíveis)
            const isMulherAcompanhante = genero === 'mulher' && 
                (categoria === 'acompanhante' || 
                 categoria === 'acompanhantes' ||
                 categoria === 'mulher' ||
                 categoria === 'feminino' ||
                 categoria === 'female' ||
                 // Se categoria estiver vazia mas genero for mulher, considerar como acompanhante
                 (categoria === '' && genero === 'mulher'));
            
            const sectionHomemInfo = document.getElementById('section-homem-info');
            const sectionEuFaco = document.getElementById('section-eu-faco');
            
            // Mostrar apenas se for homem ou trans
            if (sectionHomemInfo) {
                sectionHomemInfo.style.display = (isHomem || isTrans) ? 'block' : 'none';
                console.log(`📋 Seção "Informações Específicas - Homem": ${(isHomem || isTrans) ? 'VISÍVEL' : 'OCULTA'}`);
            }
            
            if (sectionEuFaco) {
                sectionEuFaco.style.display = (isHomem || isTrans) ? 'block' : 'none';
                console.log(`📋 Seção "Eu Faço": ${(isHomem || isTrans) ? 'VISÍVEL' : 'OCULTA'}`);
            }
            
        }
        
        // Função para atualizar serviços oferecidos
        function updateServicosOferecidos(anuncio) {
            console.log('🛠️ Atualizando serviços oferecidos...');
            console.log('📋 ========== DIAGNÓSTICO COMPLETO DO ANÚNCIO ==========');
            console.log('📋 ID do anúncio:', anuncio.id);
            console.log('📋 Nome do anúncio:', anuncio.nome || anuncio.name);
            console.log('📋 TODOS os campos do anúncio:', Object.keys(anuncio));
            console.log('📋 Dados do anúncio para serviços:', {
                servicos: anuncio.servicos,
                servicos_oferecidos: anuncio.servicos_oferecidos,
                beija: anuncio.beija,
                anal: anuncio.anal,
                'oral-sem': anuncio['oral-sem'],
                'oral-com': anuncio['oral-com'],
                todas_chaves: Object.keys(anuncio).filter(k => k.toLowerCase().includes('servico') || k.toLowerCase().includes('beija') || k.toLowerCase().includes('anal') || k.toLowerCase().includes('oral'))
            });
            
            // Verificar TIPO dos campos de serviços
            if (anuncio.servicos) {
                console.log('📋 Tipo do campo "servicos":', typeof anuncio.servicos);
                console.log('📋 É array?', Array.isArray(anuncio.servicos));
                console.log('📋 Valor completo:', JSON.stringify(anuncio.servicos, null, 2));
            }
            if (anuncio.servicos_oferecidos) {
                console.log('📋 Tipo do campo "servicos_oferecidos":', typeof anuncio.servicos_oferecidos);
                console.log('📋 É array?', Array.isArray(anuncio.servicos_oferecidos));
                console.log('📋 Valor completo:', JSON.stringify(anuncio.servicos_oferecidos, null, 2));
            }
            
            // Mapeamento de valores do checkbox (como salvos no Firebase) para textos exibidos
            const checkboxToDisplayMap = {
                // MAPEAMENTO REVERSO: Nomes completos que vêm do Firebase também mapeiam para si mesmos
                // (para quando os serviços são salvos como texto completo em vez de slugs)
                'beijo branco': 'Beijo branco',
                'beijo negro': 'Beijo negro',
                'ejaculação facial': 'Ejaculação facial',
                'ejaculação corpo': 'Ejaculação corpo',
                'chuva dourada': 'Chuva dourada',
                'face fucking': 'Face fucking',
                'beijos na boca': 'Beijos na boca',
                'oral com camisinha': 'Oral com camisinha',
                'oral sem camisinha': 'Oral sem camisinha',
                'oral até o final': 'Oral até o final',
                'sexo anal': 'Sexo anal',
                'garganta profunda': 'Garganta profunda',
                'massagem erótica': 'Massagem erótica',
                // Serviços Básicos
                'beijos-boca': 'Beijos na boca',
                'beijos_na_boca': 'Beijos na boca',
                'beijo-na-boca': 'Beijos na boca',
                'oral-com-camisinha': 'Oral com camisinha',
                'oral_com_camisinha': 'Oral com camisinha',
                'oral-com': 'Oral com camisinha',
                'oral-sem-camisinha': 'Oral sem camisinha',
                'oral_sem_camisinha': 'Oral sem camisinha',
                'oral-sem': 'Oral sem camisinha',
                'oral-ate-final': 'Oral até o final',
                'oral_ate_final': 'Oral até o final',
                'sexo-anal': 'Sexo anal',
                'sexo_anal': 'Sexo anal',
                'garganta-profunda': 'Garganta profunda',
                'garganta_profunda': 'Garganta profunda',
                'massagem-erotica': 'Massagem erótica',
                'massagem_erotica': 'Massagem erótica',
                'namoradinha': 'Namoradinha',
                
                // Serviços Especiais
                'beijo-negro': 'Beijo negro',
                'beijo_negro': 'Beijo negro',
                'beijo-branco': 'Beijo branco',
                'beijo_branco': 'Beijo branco',
                'ejaculacao-facial': 'Ejaculação facial',
                'ejaculacao_facial': 'Ejaculação facial',
                'gozo-facial': 'Ejaculação facial',
                'ejaculacao-corpo': 'Ejaculação corpo',
                'ejaculacao_corpo': 'Ejaculação corpo',
                'chuva-dourada': 'Chuva dourada',
                'chuva_dourada': 'Chuva dourada',
                'cubana': 'Cubana',
                'pse': 'PSE',
                'face-fucking': 'Face fucking',
                'face_fucking': 'Face fucking',
                
                // Fetichismo e BDSM
                'fetichismo': 'Fetichismo',
                'sado-submissa': 'Sado submissa',
                'sado_submissa': 'Sado submissa',
                'sado-dominadora': 'Sado dominadora',
                'sado_dominadora': 'Sado dominadora',
                'sado-suave': 'Sado suave',
                'sado_suave': 'Sado suave',
                'sado-duro': 'Sado duro',
                'sado_duro': 'Sado duro',
                'fisting-anal': 'Fisting Anal',
                'fisting_anal': 'Fisting Anal',
                'brinquedos-sexuais': 'Brinquedos sexuais',
                'brinquedos_sexuais': 'Brinquedos sexuais',
                'lingerie': 'Lingerie',
                
                // Atendimento em Grupo
                'atencao-casais': 'Atenção à casais',
                'atencao_casais': 'Atenção à casais',
                'atende-casais': 'Atenção à casais',
                'casais': 'Atenção à casais',
                'duplas': 'Duplas',
                'trios': 'Trios',
                'orgia': 'Orgia',
                'festas-eventos': 'Festas e eventos',
                'festas_eventos': 'Festas e eventos',
                'despedida-solteiro': 'Despedida de solteiro',
                'despedida_solteiro': 'Despedida de solteiro',
                
                // Perfil e Estilo
                'ativo': 'Ativo',
                'ativa': 'Ativo', // Forma feminina no formulário
                'passivo': 'Passivo',
                'passiva': 'Passivo', // Forma feminina no formulário
                'versatil': 'Versátil',
                'versátil': 'Versátil', // Com acento
                'inversao-papeis': 'Inversão de papéis',
                'inversao_papeis': 'Inversão de papéis',
                'lesbica': 'Lésbica',
                'lésbica': 'Lésbica', // Com acento
                'atencao-mulheres': 'Atenção à mulheres',
                'atencao_mulheres': 'Atenção à mulheres',
                'atencao-mulher': 'Atenção à mulheres',
                'experto-principiantes': 'Experto principiantes',
                'experto_principiantes': 'Experto principiantes',
                'experta-principiantes': 'Experto principiantes', // Forma feminina
                'atencao-deficientes': 'Atenção à deficientes físicos',
                'atencao_deficientes': 'Atenção à deficientes físicos',
                
                // Serviços Extras
                'fantasias-figurinos': 'Fantasias e figurinos',
                'fantasias_figurinos': 'Fantasias e figurinos',
                'fantasias': 'Fantasias e figurinos',
                'sem-limite': 'Sem limite',
                'sem_limite': 'Sem limite',
                'sexcam': 'Sexcam',
                'atendimento-domicilio': 'Atendimento em domicílio',
                'atendimento_domicilio': 'Atendimento em domicílio',
                'vou-sua-casa': 'Atendimento em domicílio',
                'pacotes-promocionais': 'Pacotes promocionais',
                'pacotes_promocionais': 'Pacotes promocionais',
                'acompanhante-eventos': 'Acompanhante para eventos',
                'acompanhante_eventos': 'Acompanhante para eventos'
            };
            
            // Mapeamento de serviços do Firebase para os itens da lista
            // IMPORTANTE: USAR APENAS ARRAYS - Campos booleanos REMOVIDOS completamente
            const servicosMap = {
                // Serviços Básicos - PRIORIDADE: arrays categorizados (servicos_basicos)
                // Fallback: campos antigos apenas para compatibilidade
                'Beijos na boca': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Beijos na boca')) ||
                                 // Fallback para anúncios antigos (campos removidos mas ainda podem existir)
                                 (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Beijos na boca')) ||
                                 (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Beijos na boca')),
                'Oral com camisinha': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Oral com camisinha')) ||
                                      (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Oral com camisinha')) ||
                                      (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Oral com camisinha')),
                'Oral sem camisinha': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Oral sem camisinha')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Oral sem camisinha')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Oral sem camisinha')),
                'Oral até o final': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Oral até o final')) ||
                                   (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Oral até o final')) ||
                                   (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Oral até o final')),
                'Sexo anal': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Sexo anal')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sexo anal')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sexo anal')),
                'Garganta profunda': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Garganta profunda')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Garganta profunda')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Garganta profunda')),
                'Massagem erótica': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Massagem erótica')) ||
                                   (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Massagem erótica')) ||
                                   (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Massagem erótica')),
                'Namoradinha': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Namoradinha')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Namoradinha')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Namoradinha')),
                
                // Serviços Especiais - APENAS arrays
                'Beijo negro': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Beijo negro')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Beijo negro')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Beijo negro')),
                'Beijo branco': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Beijo branco')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Beijo branco')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Beijo branco')),
                'Ejaculação facial': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Ejaculação facial')) ||
                                    (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Ejaculação facial')) ||
                                    (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Ejaculação facial')),
                'Ejaculação corpo': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Ejaculação corpo')) ||
                                  (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Ejaculação corpo')) ||
                                  (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Ejaculação corpo')),
                'Chuva dourada': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Chuva dourada')) ||
                                (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Chuva dourada')) ||
                                (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Chuva dourada')),
                'Cubana': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Cubana')) ||
                         (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Cubana')) ||
                         (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Cubana')),
                'PSE': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('PSE')) ||
                      (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('PSE')) ||
                      (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('PSE')),
                'Face fucking': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Face fucking')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Face fucking')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Face fucking')),
                
                // Fetichismo e BDSM - APENAS arrays
                'Fetichismo': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Fetichismo')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Fetichismo')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Fetichismo')),
                'Sado submissa': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado submissa')) ||
                               (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado submissa')) ||
                               (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado submissa')),
                'Sado dominadora': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado dominadora')) ||
                                 (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado dominadora')) ||
                                 (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado dominadora')),
                'Sado suave': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado suave')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado suave')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado suave')),
                'Sado duro': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado duro')) ||
                           (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado duro')) ||
                           (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado duro')),
                'Fisting Anal': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Fisting Anal')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Fisting Anal')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Fisting Anal')),
                'Brinquedos sexuais': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Brinquedos sexuais')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Brinquedos sexuais')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Brinquedos sexuais')),
                'Lingerie': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Lingerie')) ||
                          (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Lingerie')) ||
                          (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Lingerie')),
                
                // Atendimento em Grupo - APENAS arrays
                'Atenção à casais': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Atenção à casais')) ||
                                  (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atenção à casais')) ||
                                  (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atenção à casais')),
                'Duplas': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Duplas')) ||
                         (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Duplas')) ||
                         (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Duplas')),
                'Trios': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Trios')) ||
                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Trios')) ||
                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Trios')),
                'Orgia': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Orgia')) ||
                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Orgia')) ||
                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Orgia')),
                'Festas e eventos': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Festas e eventos')) ||
                                  (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Festas e eventos')) ||
                                  (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Festas e eventos')),
                'Despedida de solteiro': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Despedida de solteiro')) ||
                                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Despedida de solteiro')) ||
                                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Despedida de solteiro')),
                
                // Perfil e Estilo - APENAS arrays
                'Ativo': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Ativo')) ||
                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Ativo')) ||
                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Ativo')),
                'Passivo': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Passivo')) ||
                          (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Passivo')) ||
                          (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Passivo')),
                'Versátil': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Versátil')) ||
                           (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Versátil')) ||
                           (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Versátil')),
                'Inversão de papéis': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Inversão de papéis')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Inversão de papéis')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Inversão de papéis')),
                'Lésbica': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Lésbica')) ||
                          (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Lésbica')) ||
                          (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Lésbica')),
                'Atenção à mulheres': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Atenção à mulheres')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atenção à mulheres')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atenção à mulheres')),
                'Experto principiantes': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Experto principiantes')) ||
                                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Experto principiantes')) ||
                                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Experto principiantes')),
                'Atenção à deficientes físicos': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Atenção à deficientes físicos')) ||
                                                 (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atenção à deficientes físicos')) ||
                                                 (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atenção à deficientes físicos')),
                
                // Serviços Extras - APENAS arrays
                'Fantasias e figurinos': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Fantasias e figurinos')) ||
                                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Fantasias e figurinos')) ||
                                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Fantasias e figurinos')),
                'Sem limite': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Sem limite')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sem limite')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sem limite')),
                'Sexcam': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Sexcam')) ||
                         (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sexcam')) ||
                         (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sexcam')),
                'Atendimento em domicílio': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Atendimento em domicílio')) ||
                                           (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atendimento em domicílio')) ||
                                           (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atendimento em domicílio')),
                'Pacotes promocionais': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Pacotes promocionais')) ||
                                       (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Pacotes promocionais')) ||
                                       (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Pacotes promocionais')),
                'Acompanhante para eventos': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Acompanhante para eventos')) ||
                                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Acompanhante para eventos')) ||
                                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Acompanhante para eventos'))
            };
            
            // Verificar se há array de serviços no Firebase - buscar em múltiplos campos
            // PRIORIDADE: Campo "servicos" primeiro (formato novo do formulário), depois arrays categorizados
            let servicosArray = [];
            
            // MÉTODO 1: PRIORIDADE MÁXIMA - Campo "servicos" (formato novo do formulário que salva como array de slugs)
            // Este é o formato que está sendo usado no formulário de cadastro
            if (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.length > 0) {
                servicosArray = anuncio.servicos;
                console.log('✅ Array de serviços encontrado em campo "servicos" (formato novo):', servicosArray);
                console.log(`📦 Total: ${servicosArray.length} serviços encontrados`);
            } 
            else if (anuncio.servicos && typeof anuncio.servicos === 'string') {
                // Se for string, tentar converter para array
                try {
                    servicosArray = JSON.parse(anuncio.servicos);
                    console.log('✅ Array de serviços convertido de string JSON:', servicosArray);
                } catch (e) {
                    servicosArray = anuncio.servicos.split(',').map(s => s.trim());
                    console.log('✅ Array de serviços convertido de string (vírgula):', servicosArray);
                }
            }
            // MÉTODO 2: Fallback - Combinar arrays categorizados (formato antigo)
            else {
                const categorias = [
                    anuncio.servicos_basicos,
                    anuncio.servicos_especiais,
                    anuncio.fetichismo_bdsm,
                    anuncio.atendimento_grupo,
                    anuncio.perfil_estilo,
                    anuncio.servicos_extras
                ];
                
                const servicosDeCategorias = [];
                const nomesCategorias = ['servicos_basicos', 'servicos_especiais', 'fetichismo_bdsm', 'atendimento_grupo', 'perfil_estilo', 'servicos_extras'];
                
                categorias.forEach((cat, index) => {
                    if (cat && Array.isArray(cat) && cat.length > 0) {
                        console.log(`📦 Categoria "${nomesCategorias[index]}" encontrada com ${cat.length} itens:`, cat);
                        servicosDeCategorias.push(...cat);
                    }
                });
                
                if (servicosDeCategorias.length > 0) {
                    servicosArray = servicosDeCategorias;
                    console.log('📦 Array de serviços combinado das categorias (MÉTODO 2 - fallback):', servicosArray);
                    console.log(`📦 Total: ${servicosArray.length} serviços encontrados nas categorias`);
                }
            }
            // MÉTODO 3: Fallback adicional - campo servicos_oferecidos (anúncios muito antigos)
            if (servicosArray.length === 0 && anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.length > 0) {
                servicosArray = anuncio.servicos_oferecidos;
                console.log('⚠️ Array de serviços encontrado em campo antigo (servicos_oferecidos - FALLBACK):', servicosArray);
            }
            
            // SEMPRE filtrar valores inválidos
            if (servicosArray.length > 0) {
                const servicosValidos = servicosArray.filter(s => {
                    const valor = String(s).toLowerCase().trim();
                    return valor && valor !== 'on' && valor !== 'null' && valor !== 'undefined' && valor !== '';
                });
                
                if (servicosValidos.length !== servicosArray.length) {
                    console.warn(`⚠️ Array contém ${servicosArray.length - servicosValidos.length} valores inválidos ("on", null, etc). Filtrando...`);
                    console.log('📦 Array original:', servicosArray);
                    console.log('📦 Array filtrado:', servicosValidos);
                }
                
                servicosArray = servicosValidos;
                console.log(`✅ Array final de serviços válidos: ${servicosArray.length} itens`, servicosArray);
            }
            
            // Se após filtrar não houver serviços válidos, avisar
            if (servicosArray.length === 0 && (anuncio.servicos || anuncio.servicos_oferecidos)) {
                console.warn('⚠️⚠️⚠️ ATENÇÃO: Array de serviços encontrado no Firebase, mas todos os valores são inválidos ("on", null, etc).');
                console.warn('⚠️ Isso indica que o anúncio foi criado com a versão antiga do formulário que salvava "on" em vez dos valores dos checkboxes.');
                console.warn('⚠️ Será necessário recriar o anúncio ou atualizar manualmente os valores no Firebase.');
            }
            
            // Log detalhado de todos os campos que podem conter serviços
            const camposComServicos = Object.keys(anuncio).filter(k => 
                k.toLowerCase().includes('servico') || 
                k.toLowerCase().includes('service')
            );
            console.log('📋 Todos os campos relacionados a serviços encontrados:', camposComServicos);
            camposComServicos.forEach(campo => {
                console.log(`  - ${campo}:`, anuncio[campo], `(tipo: ${typeof anuncio[campo]}, é array: ${Array.isArray(anuncio[campo])})`);
            });
            
            // Mapeamento de serviços para suas categorias
            const servicoParaCategoria = {
                // Serviços Básicos
                'Beijos na boca': 'Serviços Básicos',
                'Oral com camisinha': 'Serviços Básicos',
                'Oral sem camisinha': 'Serviços Básicos',
                'Oral até o final': 'Serviços Básicos',
                'Sexo anal': 'Serviços Básicos',
                'Garganta profunda': 'Serviços Básicos',
                'Massagem erótica': 'Serviços Básicos',
                'Namoradinha': 'Serviços Básicos',
                
                // Serviços Especiais
                'Beijo negro': 'Serviços Especiais',
                'Beijo branco': 'Serviços Especiais',
                'Ejaculação facial': 'Serviços Especiais',
                'Ejaculação corpo': 'Serviços Especiais',
                'Chuva dourada': 'Serviços Especiais',
                'Cubana': 'Serviços Especiais',
                'PSE': 'Serviços Especiais',
                'Face fucking': 'Serviços Especiais',
                
                // Fetichismo e BDSM
                'Fetichismo': 'Serviços de Fetichismo e BDSM',
                'Sado submissa': 'Serviços de Fetichismo e BDSM',
                'Sado dominadora': 'Serviços de Fetichismo e BDSM',
                'Sado suave': 'Serviços de Fetichismo e BDSM',
                'Sado duro': 'Serviços de Fetichismo e BDSM',
                'Fisting Anal': 'Serviços de Fetichismo e BDSM',
                'Brinquedos sexuais': 'Serviços de Fetichismo e BDSM',
                'Lingerie': 'Serviços de Fetichismo e BDSM',
                
                // Atendimento em Grupo
                'Atenção à casais': 'Serviços de Atendimento em Grupo',
                'Duplas': 'Serviços de Atendimento em Grupo',
                'Trios': 'Serviços de Atendimento em Grupo',
                'Orgia': 'Serviços de Atendimento em Grupo',
                'Festas e eventos': 'Serviços de Atendimento em Grupo',
                'Despedida de solteiro': 'Serviços de Atendimento em Grupo',
                
                // Perfil e Estilo
                'Ativo': 'Serviços do Perfil e Estilo',
                'Passivo': 'Serviços do Perfil e Estilo',
                'Versátil': 'Serviços do Perfil e Estilo',
                'Inversão de papéis': 'Serviços do Perfil e Estilo',
                'Lésbica': 'Serviços do Perfil e Estilo',
                'Atenção à mulheres': 'Serviços do Perfil e Estilo',
                'Experto principiantes': 'Serviços do Perfil e Estilo',
                'Atenção à deficientes físicos': 'Serviços do Perfil e Estilo',
                
                // Serviços Extras
                'Fantasias e figurinos': 'Serviços Extras',
                'Sem limite': 'Serviços Extras',
                'Sexcam': 'Serviços Extras',
                'Atendimento em domicílio': 'Serviços Extras',
                'Pacotes promocionais': 'Serviços Extras',
                'Acompanhante para eventos': 'Serviços Extras'
            };
            
            // Converter valores do array para textos de exibição
            // NOVO: Os serviços agora são salvos como nomes completos em português
            // Mas precisamos manter compatibilidade com dados antigos que usam slugs
            const servicosArrayNormalized = servicosArray.map(s => {
                const valorOriginal = String(s).trim();
                const checkboxValue = valorOriginal.toLowerCase().trim();
                console.log(`🔍 Processando serviço do Firebase: "${valorOriginal}" (normalizado: "${checkboxValue}")`);
                
                // PRIMEIRO: Verificar se já é um nome completo em português (novo formato)
                // Lista de todos os nomes esperados em português
                const nomesPortuguesEsperados = [
                    'Beijos na boca', 'Oral com camisinha', 'Oral sem camisinha', 'Oral até o final',
                    'Sexo anal', 'Garganta profunda', 'Massagem erótica', 'Namoradinha',
                    'Beijo negro', 'Beijo branco', 'Ejaculação facial', 'Ejaculação corpo',
                    'Chuva dourada', 'Cubana', 'PSE', 'Face fucking',
                    'Fetichismo', 'Sado submissa', 'Sado dominadora', 'Sado suave',
                    'Sado duro', 'Fisting Anal', 'Brinquedos sexuais', 'Lingerie',
                    'Atenção à casais', 'Duplas', 'Trios', 'Orgia',
                    'Festas e eventos', 'Despedida de solteiro',
                    'Ativo', 'Passivo', 'Versátil', 'Inversão de papéis',
                    'Lésbica', 'Atenção à mulheres', 'Experto principiantes', 'Atenção à deficientes físicos',
                    'Fantasias e figurinos', 'Sem limite', 'Sexcam',
                    'Atendimento em domicílio', 'Pacotes promocionais', 'Acompanhante para eventos'
                ];
                
                // Verificar se o valor já é um nome completo (comparação case-insensitive)
                const nomeCompletoEncontrado = nomesPortuguesEsperados.find(nome => 
                    nome.toLowerCase() === valorOriginal.toLowerCase()
                );
                
                if (nomeCompletoEncontrado) {
                    console.log(`  ✅ Já é nome completo: "${valorOriginal}" → "${nomeCompletoEncontrado}"`);
                    return nomeCompletoEncontrado; // Retornar o nome padronizado
                }
                
                // SEGUNDO: Se não for nome completo, tratar como slug antigo e converter
                const found = Object.keys(checkboxToDisplayMap).find(key => {
                    const keyNormalized = key.toLowerCase().trim();
                    const checkboxNormalized = checkboxValue;
                    
                    // Comparação exata
                    if (keyNormalized === checkboxNormalized) return true;
                    
                    // Comparação sem hífen/underscore
                    if (keyNormalized.replace(/[-_]/g, '') === checkboxNormalized.replace(/[-_]/g, '')) return true;
                    
                    // Comparação parcial
                    if (keyNormalized.includes(checkboxNormalized) || checkboxNormalized.includes(keyNormalized)) return true;
                    
                    return false;
                });
                
                if (found) {
                    console.log(`  ✅ Mapeado (slug antigo): "${valorOriginal}" → "${checkboxToDisplayMap[found]}"`);
                    return checkboxToDisplayMap[found];
                }
                
                // Se não encontrar, tentar buscar valores similares
                const similarKeys = Object.keys(checkboxToDisplayMap).filter(key => {
                    const keyNormalized = key.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '');
                    const checkboxNormalized = checkboxValue.normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '');
                    return keyNormalized.includes(checkboxNormalized) || checkboxNormalized.includes(keyNormalized);
                });
                
                if (similarKeys.length > 0) {
                    console.log(`  ✅ Mapeado (similar): "${valorOriginal}" → "${checkboxToDisplayMap[similarKeys[0]]}"`);
                    return checkboxToDisplayMap[similarKeys[0]];
                }
                
                // Se não encontrar, retornar o valor original (pode ser um nome já em português que não está na lista)
                console.log(`  ⚠️ Não mapeado, usando valor original: "${valorOriginal}"`);
                return valorOriginal;
            });
            
            // Agrupar serviços por categoria
            const servicosPorCategoria = {
                'Serviços Básicos': [],
                'Serviços Especiais': [],
                'Serviços de Fetichismo e BDSM': [],
                'Serviços de Atendimento em Grupo': [],
                'Serviços do Perfil e Estilo': [],
                'Serviços Extras': []
            };
            
            servicosArrayNormalized.forEach(servico => {
                const categoria = servicoParaCategoria[servico];
                if (categoria && servicosPorCategoria[categoria]) {
                    servicosPorCategoria[categoria].push(servico);
                }
            });
            
            console.log('📋 Serviços agrupados por categoria:', servicosPorCategoria);
            
            console.log('📦 Serviços normalizados do array:', servicosArrayNormalized);
            console.log(`📊 Total de serviços encontrados: ${servicosArray.length}`);
            
            // Mostrar TODOS os serviços do array com seus mapeamentos
            if (servicosArray.length > 0) {
                console.log('\n📋 ========== MAPEAMENTO DE TODOS OS SERVIÇOS ==========');
                servicosArray.forEach((servicoOriginal, idx) => {
                    const checkboxValue = String(servicoOriginal).toLowerCase().trim();
                    const mapeado = checkboxToDisplayMap[checkboxValue] || 
                                   Object.keys(checkboxToDisplayMap).find(k => {
                                       const kNorm = k.toLowerCase().trim();
                                       return kNorm === checkboxValue || 
                                              kNorm.replace(/[-_]/g, '') === checkboxValue.replace(/[-_]/g, '');
                                   });
                    const resultado = mapeado ? checkboxToDisplayMap[mapeado] : '❌ NÃO MAPEADO';
                    console.log(`  ${idx + 1}. "${servicoOriginal}" → "${resultado}"`);
                });
                console.log('=====================================================\n');
            }
            
            // Função para atualizar uma lista de serviços
            function updateServiceList(sectionTitle, serviceMap) {
                console.log(`\n🔍 Processando seção: "${sectionTitle}"`);
                const sections = document.querySelectorAll('.services-section-detailed');
                let sectionFound = false;
                sections.forEach(section => {
                    const title = section.querySelector('h5');
                    if (title && title.textContent.trim() === sectionTitle) {
                        sectionFound = true;
                        console.log(`  ✅ Seção encontrada: "${sectionTitle}"`);
                        const list = section.querySelector('.services-list-detailed');
                        if (list) {
                            const items = Array.from(list.querySelectorAll('li')); // Converter para array para poder remover
                            console.log(`  📋 Total de itens na lista: ${items.length}`);
                            
                            // Array para armazenar itens a serem removidos
                            const itemsToRemove = [];
                            
                            items.forEach((li, index) => {
                                // Extrair texto do serviço (clonando e removendo ícone)
                                const clone = li.cloneNode(true);
                                const icons = clone.querySelectorAll('i');
                                icons.forEach(icon => icon.remove());
                                let text = clone.textContent.trim();
                                // Remover qualquer símbolo no início
                                text = text.replace(/^[✓✔×✕•]\s*/, '').trim();
                                const checkIcon = li.querySelector('i');
                                
                                // Debug: mostrar item sendo processado (apenas primeiros 3 para não poluir)
                                if (index < 3) {
                                    console.log(`    🔍 Item ${index + 1}: "${text}"`);
                                }
                                
                                // Verificar se o serviço está ativo
                                let isActive = false;
                                let activeSource = '';
                                
                                // PRIMEIRO: Verificar no array de serviços do Firebase (PRIORITÁRIO - funciona para TODOS os serviços)
                                // Isso é CRÍTICO porque TODOS os serviços (básicos e especiais) vêm do array quando marcados no formulário
                                if (servicosArray.length > 0) {
                                    const normalizedText = text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w\s]/g, '').replace(/\s+/g, '');
                                    
                                    const encontradoNoArray = servicosArray.some(s => {
                                        const servicoFirebase = String(s).trim();
                                        
                                        // PRIMEIRO: Comparação direta exata (case-insensitive)
                                        if (servicoFirebase.toLowerCase() === text.toLowerCase()) {
                                            console.log(`    ✅ Match DIRETO EXATO: "${servicoFirebase}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // SEGUNDO: Verificar se o valor do Firebase mapeia para este texto via checkboxToDisplayMap
                                        const servicoLower = servicoFirebase.toLowerCase();
                                        const mapeado = checkboxToDisplayMap[servicoLower];
                                        if (mapeado && mapeado.toLowerCase() === text.toLowerCase()) {
                                            console.log(`    ✅ Match por mapeamento: "${servicoFirebase}" → "${mapeado}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // TERCEIRO: Se o valor do Firebase é um slug (como "beijo-branco"), verificar mapeamento
                                        const mapeadoSlug = checkboxToDisplayMap[servicoLower];
                                        if (mapeadoSlug && mapeadoSlug.toLowerCase() === text.toLowerCase()) {
                                            console.log(`    ✅ Match por slug mapeado: "${servicoFirebase}" → "${mapeadoSlug}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // QUARTO: Verificar mapeamento reverso (texto → slug)
                                        const valoresMapeados = Object.keys(checkboxToDisplayMap).filter(key => 
                                            checkboxToDisplayMap[key] && checkboxToDisplayMap[key].toLowerCase() === text.toLowerCase()
                                        );
                                        
                                        if (valoresMapeados.length > 0 && valoresMapeados.some(slug => slug === servicoLower)) {
                                            console.log(`    ✅ Match por mapeamento reverso: "${servicoFirebase}" → "${text}"`);
                                            return true;
                                        }
                                        
                                        // QUINTO: Comparação normalizada (sem acentos e espaços)
                                        const normalizedS = servicoFirebase.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w\s]/g, '').replace(/\s+/g, '');
                                        const match = normalizedS === normalizedText || 
                                               normalizedS.includes(normalizedText) || 
                                               normalizedText.includes(normalizedS);
                                        if (match) {
                                            console.log(`    ✅ Match por normalização: "${servicoFirebase}" (${normalizedS}) === "${text}" (${normalizedText})`);
                                        }
                                        return match;
                                    });
                                    
                                    if (encontradoNoArray) {
                                        isActive = true;
                                        activeSource = 'servicosArray (original)';
                                        if (index < 5) {
                                            console.log(`  ✅ "${text}": ATIVO encontrado em servicosArray`);
                                        }
                                    }
                                }
                                
                                // SEGUNDO: Verificar no array de serviços normalizados do Firebase
                                if (!isActive && servicosArrayNormalized.length > 0) {
                                    const normalizedText = text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '').replace(/\s+/g, '');
                                    const encontradoNormalizado = servicosArrayNormalized.some(s => {
                                        const normalizedS = String(s).toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '').replace(/\s+/g, '');
                                        
                                        // Comparação exata
                                        if (normalizedS === normalizedText) {
                                            console.log(`    ✅ Match EXATO: "${s}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // Comparação parcial (mais flexível)
                                        const match = normalizedS.includes(normalizedText) || normalizedText.includes(normalizedS);
                                        if (match) {
                                            console.log(`    ✅ Match PARCIAL: "${s}" (${normalizedS}) contém "${text}" (${normalizedText})`);
                                        }
                                        return match;
                                    });
                                    if (encontradoNormalizado) {
                                        isActive = true;
                                        activeSource = 'servicosArray (normalizado)';
                                    }
                                }
                                
                                // TERCEIRO: Verificar no mapeamento fornecido (APENAS ARRAYS - campos booleanos REMOVIDOS)
                                // IMPORTANTE: serviceMap retorna true/false/undefined baseado em arrays
                                // Só marcar como ativo se o valor for EXATAMENTE true
                                if (!isActive && serviceMap && text in serviceMap) {
                                    const value = serviceMap[text];
                                    // Verificar se é verdadeiramente true (não apenas truthy)
                                    if (value === true) {
                                        isActive = true;
                                        activeSource = 'servicosMap (array)';
                                        console.log(`    ✅ "${text}": Encontrado no serviceMap como true`);
                                    } else {
                                        console.log(`    ❌ "${text}": serviceMap retornou ${value} (não true)`);
                                    }
                                }
                                // QUARTO: Verificar no mapeamento global de serviços (APENAS ARRAYS)
                                if (!isActive && servicosMap && text in servicosMap) {
                                    const value = servicosMap[text];
                                    // Verificar se é verdadeiramente true (não apenas truthy)
                                    if (value === true) {
                                        isActive = true;
                                        activeSource = 'servicosMap (array)';
                                        console.log(`    ✅ "${text}": Encontrado no servicosMap como true`);
                                    } else {
                                        console.log(`    ❌ "${text}": servicosMap retornou ${value} (não true)`);
                                    }
                                }
                                
                                // Verificar se há dados no Firebase
                                const temDadosFirebase = servicosArray.length > 0 || 
                                                       servicosArrayNormalized.length > 0 ||
                                                       (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.length > 0) ||
                                                       (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.length > 0) ||
                                                       (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.length > 0) ||
                                                       (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.length > 0) ||
                                                       (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.length > 0) ||
                                                       (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.length > 0);
                                
                                // Atualizar ícone e estilo OU remover se inativo
                                if (checkIcon) {
                                    // IMPORTANTE: Só marcar como ativo se isActive for verdadeiro
                                    if (isActive) {
                                        checkIcon.className = 'fas fa-check';
                                        checkIcon.style.color = '#28a745';
                                        li.style.opacity = '1';
                                        li.style.fontWeight = '500';
                                        checkIcon.style.display = 'inline-block'; // Garantir que está visível
                                        if (index < 5) {
                                            console.log(`  ✅ "${text}": ATIVO (${activeSource})`);
                                        }
                                    } else {
                                        // Se há dados no Firebase mas este serviço não está ativo, REMOVER completamente
                                        if (temDadosFirebase) {
                                            itemsToRemove.push(li);
                                            if (index < 5) {
                                                console.log(`  🗑️ "${text}": INATIVO - será REMOVIDO`);
                                            }
                                        } else {
                                            // Se não há dados no Firebase, manter mas sem ícone
                                            checkIcon.style.display = 'none';
                                            li.style.opacity = '0.6'; // Levemente transparente
                                            if (index < 5) {
                                                console.log(`  ⚪ "${text}": SEM DADOS (ícone removido - arrays vazios)`);
                                            }
                                        }
                                    }
                                }
                            });
                            
                            // Remover todos os itens inativos
                            itemsToRemove.forEach(li => {
                                li.remove();
                                console.log(`  🗑️ Item removido: "${li.textContent.trim()}"`);
                            });
                            
                            // Se a lista ficou vazia após remover itens inativos, ocultar a seção inteira
                            if (list.querySelectorAll('li').length === 0) {
                                section.style.display = 'none';
                                console.log(`  👁️ Seção "${sectionTitle}" oculta (nenhum serviço ativo)`);
                            } else {
                                section.style.display = 'block';
                            }
                            
                            // Resumo da seção
                            const ativosSection = list.querySelectorAll('li').length;
                            const removidos = itemsToRemove.length;
                            console.log(`  📊 Seção "${sectionTitle}": ${ativosSection} ativos, ${removidos} removidos`);
                        }
                    }
                });
                
                if (!sectionFound) {
                    console.warn(`  ⚠️ Seção "${sectionTitle}" NÃO encontrada no DOM!`);
                }
            }
            
            // DEBUG: Verificar se servicos_especiais está sendo carregado corretamente
            console.log('\n🔍 DEBUG - Verificando servicos_especiais do Firebase:');
            console.log('  - anuncio.servicos_especiais:', anuncio.servicos_especiais);
            console.log('  - Tipo:', typeof anuncio.servicos_especiais, 'É Array?', Array.isArray(anuncio.servicos_especiais));
            if (Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.length > 0) {
                console.log('  - Itens no array:', anuncio.servicos_especiais);
                console.log('  - "Beijo branco" está incluído?', anuncio.servicos_especiais.includes('Beijo branco'));
            }
            console.log('  - servicosArray final:', servicosArray);
            console.log('  - servicosArrayNormalized:', servicosArrayNormalized);
            console.log('  - servicosMap["Beijo branco"]:', servicosMap['Beijo branco']);
            
            // Atualizar todas as listas principais - agora usando servicosPorCategoria
            // Isso garante que apenas as categorias com serviços apareçam
            const categoriasParaAtualizar = [
                'Serviços Básicos',
                'Serviços Especiais',
                'Serviços de Fetichismo e BDSM',
                'Serviços de Atendimento em Grupo',
                'Serviços do Perfil e Estilo',
                'Serviços Extras'
            ];
            
            categoriasParaAtualizar.forEach(categoria => {
                // Se a categoria tem serviços no array, atualizar e mostrar
                if (servicosPorCategoria[categoria] && servicosPorCategoria[categoria].length > 0) {
                    updateServiceList(categoria, servicosMap);
                    // Mostrar a seção
                    const sections = document.querySelectorAll('.services-section-detailed');
                    let sectionEncontrada = false;
                    sections.forEach(section => {
                        const title = section.querySelector('h5');
                        if (title && title.textContent.trim() === categoria) {
                            section.style.display = 'block';
                            sectionEncontrada = true;
                            console.log(`✅ Seção "${categoria}" exibida com ${servicosPorCategoria[categoria].length} serviços`);
                        }
                    });
                    if (!sectionEncontrada) {
                        console.warn(`⚠️ Seção "${categoria}" não encontrada no DOM para exibir`);
                    }
                } else {
                    // Ocultar a seção se não tiver serviços
                    const sections = document.querySelectorAll('.services-section-detailed');
                    sections.forEach(section => {
                        const title = section.querySelector('h5');
                        if (title && title.textContent.trim() === categoria) {
                            section.style.display = 'none';
                        }
                    });
                }
            });
            
            // CORREÇÃO: Garantir que pelo menos uma seção seja exibida se houver serviços
            const totalServicos = Object.values(servicosPorCategoria).reduce((sum, arr) => sum + arr.length, 0);
            if (totalServicos > 0) {
                console.log(`✅ Total de ${totalServicos} serviços encontrados, garantindo que seções sejam exibidas`);
                // Verificar se alguma seção está visível
                const sectionsVisiveis = document.querySelectorAll('.services-section-detailed[style*="block"]');
                if (sectionsVisiveis.length === 0) {
                    console.warn('⚠️ Nenhuma seção de serviços está visível, forçando exibição da primeira com serviços');
                    // Forçar exibição da primeira categoria que tem serviços
                    for (const categoria of categoriasParaAtualizar) {
                        if (servicosPorCategoria[categoria] && servicosPorCategoria[categoria].length > 0) {
                            const sections = document.querySelectorAll('.services-section-detailed');
                            sections.forEach(section => {
                                const title = section.querySelector('h5');
                                if (title && title.textContent.trim() === categoria) {
                                    section.style.display = 'block';
                                    console.log(`✅ Forçando exibição da seção "${categoria}"`);
                                }
                            });
                            break;
                        }
                    }
                }
            }
            
            // Atualizar seções específicas de Homem/Trans
            if (anuncio.genero === 'homem' || anuncio.genero === 'trans') {
                // Orientações Sexuais
                const orientacaoMap = {
                    'Heterossexual': anuncio.orientacao_sexual === 'heterossexual' || anuncio.orientacao === 'heterossexual',
                    'Gay': anuncio.orientacao_sexual === 'gay' || anuncio.orientacao === 'gay',
                    'Bissexual': anuncio.orientacao_sexual === 'bissexual' || anuncio.orientacao === 'bissexual',
                    'Pansexual': anuncio.orientacao_sexual === 'pansexual' || anuncio.orientacao === 'pansexual'
                };
                
                updateServiceList('Orientações Sexuais', orientacaoMap);
                
                // Preferências de Atendimento
                const preferenciasMap = {
                    'Atende Homens': anuncio.atende_homens || (anuncio.genero === 'homem'),
                    'Atende Mulheres': anuncio.atende_mulheres || (anuncio.genero === 'mulher'),
                    'Atende Trans': anuncio.atende_trans || (anuncio.genero === 'trans'),
                    'Atende Casais': anuncio.atende_casais || anuncio.casais
                };
                
                updateServiceList('Preferências de Atendimento', preferenciasMap);
                
                // Especialidades
                const especialidadesMap = {
                    'Massagem': anuncio.massagem || anuncio.especialidade_massagem,
                    'Acompanhante': anuncio.acompanhante || anuncio.especialidade_acompanhante,
                    'Dominação': anuncio.dominacao || anuncio.especialidade_dominacao,
                    'Submissão': anuncio.submissao || anuncio.especialidade_submissao
                };
                
                updateServiceList('Especialidades', especialidadesMap);
                
                // Eu Faço
                const euFacoMap = {
                    'Venda de conteúdo': anuncio.venda_conteudo || anuncio['venda-conteudo'],
                    '24 horas': anuncio['24h'] || anuncio.atende_24h || (anuncio.plano === 'camarote' || anuncio.plano === 'vip'),
                    'Viajo até você': anuncio.viajo_ate_voce || anuncio['viajo-ate-voce'],
                    'Massoterapia': anuncio.massoterapia,
                    'Aceito cartões': anuncio.aceita_cartoes || anuncio['aceita-cartoes'] || anuncio.pagamento_credito !== false,
                    'Vou à sua casa': anuncio.vou_sua_casa || anuncio['vou-sua-casa'] || anuncio.atendimento_domicilio,
                    'Beijo na boca': anuncio.beija || anuncio.beijo_boca,
                    'Gozo Facial': anuncio.gozo_facial || anuncio.ejaculacao_facial,
                    'Atendo em dupla': anuncio.atende_dupla || anuncio.duplas,
                    'Atendo Mulheres': anuncio.atende_mulheres,
                    'Casais': anuncio.atende_casais || anuncio.casais,
                    'Ator pornô': anuncio.ator_porno || anuncio['ator-porno'],
                    'Homem Trans': anuncio.genero === 'trans',
                    'BDSM': anuncio.bdsm || anuncio.fetichismo,
                    'Uso Fantasias': anuncio.fantasias || anuncio.usa_fantasias,
                    'Só brotheragem com masturbação': anuncio.brotheragem_com_masturbacao || anuncio['brotheragem-com-masturbacao'],
                    'Podo (trampling, footjob, dirty feet)': anuncio.podo || anuncio['podo-trampling'],
                    'Só brotheragem sem penetração': anuncio.brotheragem_sem_penetracao || anuncio['brotheragem-sem-penetracao']
                };
                
                updateServiceList('Eu Faço', euFacoMap);
                
                // Corpo
                const corpoMap = {
                    'Atlético': anuncio.corpo === 'atletico' || anuncio.tipo_corpo === 'atletico',
                    'Musculoso': anuncio.corpo === 'musculoso' || anuncio.tipo_corpo === 'musculoso',
                    'Magro': anuncio.corpo === 'magro' || anuncio.tipo_corpo === 'magro',
                    'Gordinho': anuncio.corpo === 'gordinho' || anuncio.tipo_corpo === 'gordinho'
                };
                
                updateServiceList('Corpo', corpoMap);
                
                // Pubis
                const pubisMap = {
                    'Peludos': anuncio.pubis === 'peludo' || anuncio.depilacao_pubis === false,
                    'Depilado': anuncio.pubis === 'depilado' || anuncio.depilacao_pubis === true
                };
                
                updateServiceList('Pubis', pubisMap);
                
                // Estatura
                const estaturaMap = {
                    'Alto': anuncio.estatura === 'alto' || (anuncio.altura && parseFloat(anuncio.altura) >= 1.75),
                    'Baixo': anuncio.estatura === 'baixo' || (anuncio.altura && parseFloat(anuncio.altura) < 1.65),
                    'Mediano': anuncio.estatura === 'mediano' || (anuncio.altura && parseFloat(anuncio.altura) >= 1.65 && parseFloat(anuncio.altura) < 1.75)
                };
                
                updateServiceList('Estatura', estaturaMap);
            }
            
            // Resumo final - contar quantos serviços foram ativados
            const totalServicosDOM = document.querySelectorAll('.services-list-detailed li').length;
            const servicosAtivos = document.querySelectorAll('.services-list-detailed li .fa-check').length;
            const servicosInativos = document.querySelectorAll('.services-list-detailed li .fa-times').length;
            
            console.log('✅ Serviços oferecidos atualizados');
            console.log(`📊 Resumo: ${servicosAtivos} ativos, ${servicosInativos} inativos de ${totalServicosDOM} total`);
            
            // Aviso se encontrar array mas não ativar nada
            if (servicosArray.length > 0 && servicosAtivos === 0) {
                console.error('❌ AVISO: Array de serviços encontrado mas nenhum serviço foi ativado!');
                console.error('   Array original:', servicosArray);
                console.error('   Array normalizado:', servicosArrayNormalized);
                console.error('   Verifique se os valores do array correspondem aos textos na página.');
                
                // Mostrar tentativas de match para debug
                console.log('🔍 Tentando encontrar matches manualmente...');
                servicosArray.forEach(valorOriginal => {
                    const checkboxValue = String(valorOriginal).toLowerCase().trim();
                    const mapeado = checkboxToDisplayMap[checkboxValue] || 
                                   Object.keys(checkboxToDisplayMap).find(k => 
                                       k.toLowerCase() === checkboxValue || 
                                       k.toLowerCase().replace(/[-_]/g, '') === checkboxValue.replace(/[-_]/g, '')
                                   );
                    console.log(`  - "${valorOriginal}" → "${mapeado || 'NÃO ENCONTRADO NO MAPEAMENTO'}"`);
                });
            }
            
            // Aviso se não encontrar array de serviços
            if (servicosArray.length === 0) {
                console.warn('⚠️ AVISO: Nenhum array de serviços encontrado no Firebase!');
                console.warn('   Isso pode significar que:');
                console.warn('   1. Os serviços não foram salvos no formulário de cadastro');
                console.warn('   2. Os serviços estão salvos em um campo com nome diferente');
                console.warn('   3. Este anúncio foi criado antes da implementação do campo de serviços');
                console.warn('   Campos verificados: servicos, servicos_oferecidos');
            }
        }
        
        // Função para atualizar botões de contato
        function updateContactButtons(anuncio) {
            console.log('📞 Atualizando botões de contato...');
            
            // Buscar telefones do anúncio
            const telefoneCelular = anuncio.telefone_celular || anuncio.telefone || anuncio.whatsapp || anuncio.phone;
            const telefoneFixo = anuncio.telefone_fixo || anuncio.telefone_fixo_numero;
            const whatsapp = anuncio.whatsapp || anuncio.telefone_celular || anuncio.telefone || anuncio.phone;
            
            console.log('📞 Telefones encontrados:', {
                celular: telefoneCelular,
                fixo: telefoneFixo,
                whatsapp: whatsapp
            });
            
            // Função para formatar telefone para link tel: ou wa.me:
            function formatPhoneForLink(phone) {
                if (!phone) return '';
                // Remover caracteres não numéricos
                let cleanPhone = String(phone).replace(/\D/g, '');
                // Se não começar com código do país, adicionar 55 (Brasil)
                if (cleanPhone.length === 10 || cleanPhone.length === 11) {
                    cleanPhone = '55' + cleanPhone;
                }
                return cleanPhone;
            }
            
            // Botão "Ligar Agora" - usar telefone celular
            const btnLigarAgora = document.getElementById('btn-ligar-agora');
            const btnPhoneNumber = document.getElementById('btn-ligar-phone-number');
            
            if (btnLigarAgora && telefoneCelular) {
                const phoneLink = formatPhoneForLink(telefoneCelular);
                btnLigarAgora.href = `tel:+${phoneLink}`;
                
                // Atualizar número de telefone visível no botão
                if (btnPhoneNumber) {
                    // Formatar telefone para exibição
                    function formatPhoneForDisplay(phone) {
                        if (!phone) return 'Não disponível';
                        
                        // Remover caracteres não numéricos
                        const cleanPhone = String(phone).replace(/\D/g, '');
                        
                        // Se já estiver formatado, tentar manter o formato
                        if (phone.includes('(') && phone.includes(')')) {
                            return phone; // Já está formatado
                        }
                        
                        // Formatar como (XX) XXXXX-XXXX ou (XX) XXXX-XXXX
                        if (cleanPhone.length === 11) {
                            // Celular: (XX) XXXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                        } else if (cleanPhone.length === 10) {
                            // Fixo: (XX) XXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
                        } else if (cleanPhone.length === 13) {
                            // Com código do país: +55 (XX) XXXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{2})(\d{5})(\d{4})/, '+$1 ($2) $3-$4');
                        }
                        
                        // Se não conseguir formatar, retornar original
                        return telefoneCelular;
                    }
                    
                    const phoneFormatted = formatPhoneForDisplay(telefoneCelular);
                    btnPhoneNumber.textContent = phoneFormatted;
                    console.log(`✅ Número de telefone exibido no botão: ${phoneFormatted}`);
                }
                
                console.log(`✅ Botão "Ligar Agora" atualizado: tel:+${phoneLink}`);
            } else if (btnLigarAgora) {
                console.warn('⚠️ Telefone celular não encontrado para botão "Ligar Agora"');
                if (btnPhoneNumber) {
                    btnPhoneNumber.textContent = 'Não disponível';
                }
            }
            
            // Botão "WhatsApp" - usar número do WhatsApp
            const btnWhatsapp = document.getElementById('btn-whatsapp');
            if (btnWhatsapp && whatsapp) {
                const whatsappLink = formatPhoneForLink(whatsapp);
                btnWhatsapp.href = `https://wa.me/${whatsappLink}`;
                console.log(`✅ Botão "WhatsApp" atualizado: wa.me/${whatsappLink}`);
            } else if (btnWhatsapp) {
                console.warn('⚠️ Número do WhatsApp não encontrado');
            }
            
            // Botão "Telefone Fixo" - habilitar se houver telefone fixo
            const btnTelefoneFixo = document.getElementById('btn-telefone-fixo');
            if (btnTelefoneFixo) {
                if (telefoneFixo) {
                    const fixoLink = formatPhoneForLink(telefoneFixo);
                    btnTelefoneFixo.href = `tel:+${fixoLink}`;
                    btnTelefoneFixo.style.opacity = '1';
                    btnTelefoneFixo.style.pointerEvents = 'auto';
                    btnTelefoneFixo.style.cursor = 'pointer';
                    console.log(`✅ Botão "Telefone Fixo" habilitado: tel:+${fixoLink}`);
                } else {
                    btnTelefoneFixo.href = '#';
                    btnTelefoneFixo.style.opacity = '0.5';
                    btnTelefoneFixo.style.pointerEvents = 'none';
                    btnTelefoneFixo.style.cursor = 'not-allowed';
                    console.log('⚠️ Telefone fixo não encontrado, botão desabilitado');
                }
            }
            
            console.log('✅ Botões de contato atualizados');
        }
        
        // Função para atualizar serviços e preços
        function updateServicesAndPrices(anuncio) {
            console.log('💰 Atualizando serviços e preços...');
            
            // Atualizar preço e duração
            const priceValue = document.querySelector('.price-value');
            const priceDuration = document.querySelector('.price-duration');
            
            if (priceValue) {
                let preco = null;
                let duracao = '(1 hora)'; // Padrão
                
                // Tentar múltiplos campos de preço, priorizando por ordem de preferência
                if (anuncio.preco_1h || anuncio.preco_1hora || anuncio.preco1h || anuncio.valor_1h) {
                    preco = anuncio.preco_1h || anuncio.preco_1hora || anuncio.preco1h || anuncio.valor_1h;
                    duracao = '(1 hora)';
                } else if (anuncio.preco_30min || anuncio.preco_30_min || anuncio.valor_30min) {
                    preco = anuncio.preco_30min || anuncio.preco_30_min || anuncio.valor_30min;
                    duracao = '(30 minutos)';
                } else if (anuncio.preco_2h || anuncio.preco_2hora || anuncio.valor_2h) {
                    preco = anuncio.preco_2h || anuncio.preco_2hora || anuncio.valor_2h;
                    duracao = '(2 horas)';
                } else if (anuncio.valor) {
                    // Se for string, tentar extrair número
                    const valorStr = String(anuncio.valor).replace(/[^\d,.]/g, '').replace(',', '.');
                    preco = valorStr || null;
                    duracao = '(1 hora)'; // Assumir 1 hora se não especificado
                } else if (anuncio.cache) {
                    preco = anuncio.cache;
                    duracao = '(1 hora)'; // Assumir 1 hora se não especificado
                } else if (anuncio.preco) {
                    preco = anuncio.preco;
                    duracao = '(1 hora)'; // Assumir 1 hora se não especificado
                } else {
                    preco = '300'; // Valor padrão
                    duracao = '(1 hora)';
                }
                
                // Formatar preço
                let precoFormatado;
                if (typeof preco === 'number') {
                    precoFormatado = preco.toFixed(2);
                } else if (typeof preco === 'string' && preco.trim()) {
                    // Remover caracteres não numéricos exceto vírgula e ponto
                    let precoLimpo = preco.replace(/[^\d,.]/g, '').replace(',', '.');
                    // Se não tiver decimais, adicionar .00
                    if (precoLimpo && !isNaN(parseFloat(precoLimpo))) {
                        precoFormatado = parseFloat(precoLimpo).toFixed(2);
                    } else {
                        precoFormatado = '300.00';
                    }
                } else {
                    precoFormatado = '300.00';
                }
                
                priceValue.textContent = `R$ ${precoFormatado}`;
                console.log('✅ Preço atualizado:', priceValue.textContent);
                
                // Atualizar duração se o elemento existir
                if (priceDuration) {
                    priceDuration.textContent = duracao;
                    console.log('✅ Duração atualizada:', priceDuration.textContent);
                }
            }
            
            // Atualizar campo "Local" na seção de informações básicas (Com Local / Sem Local)
            const infoLocal = document.getElementById('info-local');
            if (infoLocal) {
                let localText = 'Não informado';
                if (anuncio.local) {
                    const localValue = String(anuncio.local).toLowerCase().trim();
                    if (localValue === 'com local' || localValue === 'com-local' || localValue === 'temos-local' || localValue === 'sim') {
                        localText = 'Com Local';
                    } else if (localValue === 'sem local' || localValue === 'sem-local' || localValue === 'nao' || localValue === 'não') {
                        localText = 'Sem Local';
                    } else {
                        localText = String(anuncio.local);
                    }
                }
                infoLocal.textContent = localText;
                console.log(`✅ Campo "Local" (info-local) atualizado: ${localText}`);
            }
            
            // Atualizar localização (cidade/estado para outros campos)
            // Declarar variáveis fora dos blocos if para poder usar depois
            const cidade = anuncio.cidade || anuncio.city || 'Não informado';
            const estado = anuncio.estado || anuncio.state || 'SP';
            
            const locationCity = document.querySelector('.location-city');
            if (locationCity) {
                locationCity.textContent = cidade;
                console.log('✅ Cidade atualizada:', cidade);
            }
            
            const locationState = document.querySelector('.location-state');
            if (locationState) {
                const estadoCompleto = cidade && cidade !== 'Não informado' 
                    ? `${cidade} - ${estado}` 
                    : estado;
                locationState.textContent = estadoCompleto;
                console.log('✅ Estado atualizado:', estadoCompleto);
            }
            
            // Atualizar "Local" no card
            const localCardEl = document.getElementById('info-local-card');
            if (localCardEl) {
                let localText = 'Não informado';
                if (anuncio.local) {
                    const localValue = String(anuncio.local).toLowerCase().trim();
                    if (localValue === 'com local' || localValue === 'com-local' || localValue === 'temos-local' || localValue === 'sim') {
                        localText = 'Com Local';
                    } else if (localValue === 'sem local' || localValue === 'sem-local' || localValue === 'nao' || localValue === 'não') {
                        localText = 'Sem Local';
                    } else {
                        localText = String(anuncio.local);
                    }
                }
                localCardEl.textContent = localText;
                console.log('✅ Local atualizado no card:', localText);
            }
            
            // Atualizar formas de pagamento no card com ícones
            const pagamentoCardEl = document.getElementById('info-pagamento-card');
            if (pagamentoCardEl) {
                // Limpar conteúdo anterior
                pagamentoCardEl.innerHTML = '';
                
                // Buscar formas de pagamento de múltiplos campos possíveis
                const pagamento = anuncio.pagamento || anuncio.formas_pagamento || anuncio.forma_pagamento || [];
                let pagamentosArray = [];
                
                // Processar array ou string
                if (Array.isArray(pagamento) && pagamento.length > 0) {
                    pagamentosArray = pagamento.map(p => String(p).toLowerCase().trim());
                } else if (typeof pagamento === 'string' && pagamento.trim()) {
                    pagamentosArray = pagamento.split(/[,\s]+/).map(p => p.toLowerCase().trim()).filter(p => p);
                }
                
                // Criar ícones para cada forma de pagamento
                const iconMap = {
                    'dinheiro': {
                        icon: 'fa-money-bill-wave',
                        title: 'Dinheiro',
                        color: '#28a745'
                    },
                    'pix': {
                        icon: 'fa-exchange-alt',
                        title: 'PIX',
                        color: '#32BCAD'
                    },
                    'debito': {
                        icon: 'fa-credit-card',
                        title: 'Cartão de Débito',
                        color: '#007bff'
                    },
                    'credito': {
                        icon: 'fa-credit-card',
                        title: 'Cartão de Crédito',
                        color: '#6f42c1'
                    },
                    'cartao': {
                        icon: 'fa-credit-card',
                        title: 'Cartão',
                        color: '#007bff'
                    },
                    'cartão': {
                        icon: 'fa-credit-card',
                        title: 'Cartão',
                        color: '#007bff'
                    }
                };
                
                // Verificar se há débito e crédito para mostrar dois cartões
                const temDebito = pagamentosArray.includes('debito');
                const temCredito = pagamentosArray.includes('credito');
                const temCartao = pagamentosArray.includes('cartao') || pagamentosArray.includes('cartão');
                
                // Adicionar ícone de dinheiro
                if (pagamentosArray.includes('dinheiro')) {
                    const iconEl = document.createElement('i');
                    iconEl.className = `fas ${iconMap.dinheiro.icon}`;
                    iconEl.style.cssText = `font-size: 1.2rem; color: ${iconMap.dinheiro.color}; cursor: pointer;`;
                    iconEl.title = iconMap.dinheiro.title;
                    pagamentoCardEl.appendChild(iconEl);
                }
                
                // Adicionar ícone de PIX (Font Awesome original)
                if (pagamentosArray.includes('pix')) {
                    const iconEl = document.createElement('i');
                    iconEl.className = `fas ${iconMap.pix.icon}`;
                    iconEl.style.cssText = `font-size: 1.2rem; color: ${iconMap.pix.color}; cursor: pointer;`;
                    iconEl.title = iconMap.pix.title;
                    pagamentoCardEl.appendChild(iconEl);
                }
                
                // Adicionar ícone(s) de cartão
                if (temDebito && temCredito) {
                    // Dois cartões (débito e crédito)
                    const iconDebito = document.createElement('i');
                    iconDebito.className = `fas ${iconMap.debito.icon}`;
                    iconDebito.style.cssText = `font-size: 1.2rem; color: ${iconMap.debito.color}; cursor: pointer;`;
                    iconDebito.title = iconMap.debito.title;
                    pagamentoCardEl.appendChild(iconDebito);
                    
                    const iconCredito = document.createElement('i');
                    iconCredito.className = `fas ${iconMap.credito.icon}`;
                    iconCredito.style.cssText = `font-size: 1.2rem; color: ${iconMap.credito.color}; cursor: pointer;`;
                    iconCredito.title = iconMap.credito.title;
                    pagamentoCardEl.appendChild(iconCredito);
                } else if (temDebito) {
                    // Apenas débito
                    const iconEl = document.createElement('i');
                    iconEl.className = `fas ${iconMap.debito.icon}`;
                    iconEl.style.cssText = `font-size: 1.2rem; color: ${iconMap.debito.color}; cursor: pointer;`;
                    iconEl.title = iconMap.debito.title;
                    pagamentoCardEl.appendChild(iconEl);
                } else if (temCredito) {
                    // Apenas crédito
                    const iconEl = document.createElement('i');
                    iconEl.className = `fas ${iconMap.credito.icon}`;
                    iconEl.style.cssText = `font-size: 1.2rem; color: ${iconMap.credito.color}; cursor: pointer;`;
                    iconEl.title = iconMap.credito.title;
                    pagamentoCardEl.appendChild(iconEl);
                } else if (temCartao) {
                    // Cartão genérico
                    const iconEl = document.createElement('i');
                    iconEl.className = `fas ${iconMap.cartao.icon}`;
                    iconEl.style.cssText = `font-size: 1.2rem; color: ${iconMap.cartao.color}; cursor: pointer;`;
                    iconEl.title = iconMap.cartao.title;
                    pagamentoCardEl.appendChild(iconEl);
                }
                
                // Se não houver nenhuma forma de pagamento, mostrar mensagem
                if (pagamentoCardEl.children.length === 0) {
                    const noInfo = document.createElement('span');
                    noInfo.textContent = 'Não informado';
                    noInfo.style.cssText = 'font-size: 0.85rem; color: #999; font-style: italic;';
                    pagamentoCardEl.appendChild(noInfo);
                }
                
                console.log('✅ Formas de pagamento atualizadas no card com ícones:', pagamentosArray);
            }
        }

        // Função comum para processar e retornar o texto do campo "Atende"
        function processarCampoAtende(anuncio) {
            console.log('\n🔍 ========== PROCESSAR CAMPO ATENDE ==========');
            console.log('📦 anuncio.atende:', anuncio.atende, `(tipo: ${typeof anuncio.atende}, é array: ${Array.isArray(anuncio.atende)})`);
            console.log('📦 Campos relacionados:');
            console.log('  - atende_homens:', anuncio.atende_homens);
            console.log('  - atende_mulheres:', anuncio.atende_mulheres);
            console.log('  - atende_trans:', anuncio.atende_trans);
            console.log('  - atende_casais:', anuncio.atende_casais);
            
            const genero = (anuncio.genero || anuncio.gender || '').toLowerCase();
            const categoria = (anuncio.categoria || anuncio.category || '').toLowerCase();
            
            let atende = 'Não informado';
            
            // Construir lista de "Atende" baseado em campos booleanos ou array
            const atendeList = [];
            if (anuncio.atende_homens || anuncio.atendeHomens || anuncio['atende-homens']) {
                console.log('  ✅ atende_homens encontrado');
                atendeList.push('Ele');
            }
            if (anuncio.atende_mulheres || anuncio.atendeMulheres || anuncio['atende-mulheres']) {
                console.log('  ✅ atende_mulheres encontrado');
                atendeList.push('Ela');
            }
            if (anuncio.atende_trans || anuncio.atendeTrans || anuncio['atende-trans']) {
                console.log('  ✅ atende_trans encontrado');
                atendeList.push('Trans');
            }
            if (anuncio.atende_casais || anuncio.atendeCasais || anuncio['atende-casais'] || anuncio.casais) {
                console.log('  ✅ atende_casais encontrado');
                atendeList.push('Casais');
            }
            
            console.log(`📊 Lista de campos booleanos: ${atendeList.length} itens`);
            
            // Se tiver campos booleanos, usar eles
            if (atendeList.length > 0) {
                atende = atendeList.join(', ');
                console.log(`✅ "Atende" dos campos booleanos: "${atende}"`);
            }
            // Se não tiver campos booleanos, tentar campo direto "atende" (pode ser array ou string)
            else if (anuncio.atende) {
                console.log('📦 Tentando processar campo direto "atende"');
                if (Array.isArray(anuncio.atende)) {
                    console.log(`📦 Array com ${anuncio.atende.length} elementos:`, anuncio.atende);
                    
                    // Filtrar valores inválidos ("on", null, undefined, "")
                    const atendeValido = anuncio.atende.filter(a => {
                        const valor = String(a).toLowerCase().trim();
                        const valido = valor && valor !== 'on' && valor !== 'null' && valor !== 'undefined' && valor !== '';
                        if (!valido) {
                            console.log(`  ❌ Filtrado: "${a}" (inválido)`);
                        }
                        return valido;
                    });
                    
                    console.log(`📦 Após filtro: ${atendeValido.length} valores válidos:`, atendeValido);
                    
                    if (atendeValido.length > 0) {
                        // Mapear valores para textos exibidos
                        atende = atendeValido.map(a => {
                            const val = String(a).toLowerCase().trim();
                            let resultado;
                            if (val === 'ele' || val === 'homem' || val === 'homens') {
                                resultado = 'Ele';
                            } else if (val === 'ela' || val === 'mulher' || val === 'mulheres') {
                                resultado = 'Ela';
                            } else if (val === 'trans') {
                                resultado = 'Trans';
                            } else if (val === 'casais' || val === 'casal') {
                                resultado = 'Casais';
                            } else {
                                resultado = String(a).charAt(0).toUpperCase() + String(a).slice(1).toLowerCase();
                            }
                            console.log(`  ✅ Mapeado: "${a}" → "${resultado}"`);
                            return resultado;
                        }).join(', ');
                        
                        console.log(`✅ "Atende" final do array: "${atende}"`);
                    } else {
                        console.warn('⚠️ Nenhum valor válido após filtro do array');
                    }
                } else {
                    console.log('📦 Campo "atende" é string:', anuncio.atende);
                    const val = String(anuncio.atende).toLowerCase().trim();
                    if (val !== 'on' && val !== 'null' && val !== 'undefined' && val !== '') {
                        if (val === 'todos' || val === 'all') {
                            atende = 'Todos';
                        } else {
                            atende = String(anuncio.atende);
                        }
                        console.log(`✅ "Atende" final da string: "${atende}"`);
                    } else {
                        console.warn('⚠️ Campo "atende" contém valor inválido:', anuncio.atende);
                    }
                }
            } else {
                console.warn('⚠️ Campo "atende" não existe no objeto anuncio');
            }
            
            // FALLBACK: Se ainda for "Não informado" mas o array existe com valores "on",
            // significa que foi criado com formulário antigo. Vamos INFERIR baseado na quantidade:
            if (atende === 'Não informado' && Array.isArray(anuncio.atende) && anuncio.atende.length > 0) {
                console.warn('⚠️⚠️⚠️ ANÚNCIO ANTIGO DETECTADO!');
                console.warn('   Campo "atende" contém apenas valores "on" (formulário antigo).');
                console.warn(`   Array encontrado: ${anuncio.atende.length} elementos`, anuncio.atende);
                
                // INFERÊNCIA: Se o array tem 3 elementos "on", provavelmente os 3 checkboxes foram marcados
                if (anuncio.atende.length === 3) {
                    console.warn('   ✅ INFERÊNCIA: Array com 3 elementos "on" → Todos os checkboxes marcados');
                    console.warn('   ✅ Aplicando inferência: "Ele, Ela, Casais"');
                    atende = 'Ele, Ela, Casais';
                }
                // Se tiver 2 elementos, pode ser diferentes combinações (mais complexo inferir)
                else if (anuncio.atende.length === 2) {
                    console.warn('   ⚠️ INFERÊNCIA PARCIAL: Array com 2 elementos "on"');
                    console.warn('   ⚠️ Não é possível determinar quais checkboxes foram marcados sem recriar o anúncio.');
                    console.warn('   ⚠️ Mantendo "Não informado" - RECOMENDADO RECRIAR o anúncio.');
                }
                // Se tiver 1 elemento
                else if (anuncio.atende.length === 1) {
                    console.warn('   ⚠️ INFERÊNCIA PARCIAL: Array com 1 elemento "on"');
                    console.warn('   ⚠️ Não é possível determinar qual checkbox foi marcado sem recriar o anúncio.');
                    console.warn('   ⚠️ Mantendo "Não informado" - RECOMENDADO RECRIAR o anúncio.');
                }
                else {
                    console.warn('   ⚠️ Quantidade inesperada de elementos:', anuncio.atende.length);
                    console.warn('   ⚠️ RECOMENDADO RECRIAR o anúncio com o formulário atualizado.');
                }
            }
            
            console.log(`📋 RESULTADO FINAL: "${atende}"`);
            console.log('==========================================\n');
            return atende;
        }
        
        // Função para carregar informações básicas (obrigatórias)
        function loadBasicInfo(anuncio) {
            console.log('📝 ========== INICIANDO loadBasicInfo ==========');
            console.log('📝 Dados recebidos:', {
                nome: anuncio.nome || anuncio.name,
                idade: anuncio.idade,
                peso: anuncio.peso,
                altura: anuncio.altura,
                oral_sem: anuncio.oral_sem || anuncio['oral-sem'],
                beija: anuncio.beija,
                anal: anuncio.anal,
                mora_so: anuncio.mora_so || anuncio['mora-so'],
                valor: anuncio.valor || anuncio.cache,
                horario_24h: anuncio.horario_24h,
                horario_inicio: anuncio.horario_inicio,
                horario_fim: anuncio.horario_fim,
                pagamento: anuncio.pagamento,
                telefone_celular: anuncio.telefone_celular,
                telefone: anuncio.telefone,
                cidade: anuncio.cidade,
                estado: anuncio.estado,
                categoria: anuncio.categoria || anuncio.category
            });
            
            const nomeEl = document.getElementById('info-nome');
            if (nomeEl) {
                nomeEl.textContent = anuncio.nome || anuncio.name || 'Não informado';
                console.log('✅ Nome atualizado:', nomeEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-nome não encontrado');
            }
            
            const idadeEl = document.getElementById('info-idade');
            if (idadeEl) {
                idadeEl.textContent = anuncio.idade || 'Não informado';
                console.log('✅ Idade atualizada:', idadeEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-idade não encontrado');
            }
            
            const pesoEl = document.getElementById('info-peso');
            if (pesoEl) {
                const pesoValue = anuncio.peso || 'Não informado';
                // Adicionar 'kg' se o valor não contiver unidade e não for 'Não informado'
                pesoEl.textContent = pesoValue === 'Não informado' ? pesoValue : (pesoValue.includes('kg') ? pesoValue : pesoValue + 'kg');
                console.log('✅ Peso atualizado:', pesoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-peso não encontrado');
            }
            
            const alturaEl = document.getElementById('info-altura');
            if (alturaEl) {
                const alturaValue = anuncio.altura || 'Não informado';
                // Adicionar 'm' se o valor não contiver unidade e não for 'Não informado'
                alturaEl.textContent = alturaValue === 'Não informado' ? alturaValue : (alturaValue.includes('m') || alturaValue.includes('cm') ? alturaValue : alturaValue + 'm');
                console.log('✅ Altura atualizada:', alturaEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-altura não encontrado');
            }
            
            const telefoneEl = document.getElementById('info-telefone');
            if (telefoneEl) {
                telefoneEl.textContent = anuncio.telefone_celular || anuncio.telefone || 'Não informado';
                console.log('✅ Telefone atualizado:', telefoneEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-telefone não encontrado');
            }
            
            const localizacaoEl = document.getElementById('info-localizacao');
            if (localizacaoEl) {
                localizacaoEl.textContent = `${anuncio.cidade || 'Não informado'}, ${anuncio.estado || 'Não informado'}`;
                console.log('✅ Localização atualizada:', localizacaoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-localizacao não encontrado');
            }
            
            const categoriaEl = document.getElementById('info-categoria');
            if (categoriaEl) {
                categoriaEl.textContent = anuncio.categoria || anuncio.category || 'Não informado';
                console.log('✅ Categoria atualizada:', categoriaEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-categoria não encontrado');
            }
            
            const tipoEl = document.getElementById('info-tipo');
            if (tipoEl) {
                tipoEl.textContent = anuncio.category || anuncio.categoria || 'Não informado';
                console.log('✅ Tipo atualizado:', tipoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-tipo não encontrado');
            }
            
            // Atualizar campo "Atende" na seção de informações básicas
            const atendeEl = document.getElementById('info-atende');
            if (atendeEl) {
                const atendeTexto = processarCampoAtende(anuncio);
                atendeEl.textContent = atendeTexto;
                console.log('✅ info-atende atualizado:', atendeTexto);
            }
            
            // Atualizar campo "Oral sem"
            const oralSemEl = document.getElementById('info-oral-sem');
            if (oralSemEl) {
                const oralSemValue = anuncio.oral_sem || anuncio['oral-sem'] || null;
                oralSemEl.textContent = oralSemValue === 'sim' ? 'Sim' : (oralSemValue || 'Não informado');
                console.log('✅ Oral sem atualizado:', oralSemEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-oral-sem não encontrado');
            }
            
            // Atualizar campo "Beija"
            const beijaEl = document.getElementById('info-beija');
            if (beijaEl) {
                const beijaValue = anuncio.beija || null;
                beijaEl.textContent = beijaValue === 'sim' ? 'Sim' : (beijaValue || 'Não informado');
                console.log('✅ Beija atualizado:', beijaEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-beija não encontrado');
            }
            
            // Atualizar campo "Anal"
            const analEl = document.getElementById('info-anal');
            if (analEl) {
                const analValue = anuncio.anal || null;
                analEl.textContent = analValue === 'sim' ? 'Sim' : (analValue || 'Não informado');
                console.log('✅ Anal atualizado:', analEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-anal não encontrado');
            }
            
            // Atualizar campo "Mora só"
            const moraSoEl = document.getElementById('info-mora-so');
            if (moraSoEl) {
                const moraSoValue = anuncio.mora_so || anuncio['mora-so'] || null;
                moraSoEl.textContent = moraSoValue === 'sim' ? 'Sim' : (moraSoValue || 'Não informado');
                console.log('✅ Mora só atualizado:', moraSoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-mora-so não encontrado');
            }
            
            // Atualizar campo "Valor"
            const valorEl = document.getElementById('info-valor');
            if (valorEl) {
                let valorTexto = 'Não informado';
                let valorNumerico = null;
                
                // Função auxiliar para validar e formatar valor
                const validarEFormatarValor = (valor) => {
                    if (!valor) return null;
                    
                    // Converter para string e remover caracteres não numéricos
                    let valorStr = String(valor).replace(/[^\d,.]/g, '').replace(',', '.');
                    
                    // Converter para número
                    let valorNum = parseFloat(valorStr);
                    
                    // Verificar se é um número válido
                    if (isNaN(valorNum) || !isFinite(valorNum)) {
                        console.warn('⚠️ Valor inválido:', valor);
                        return null;
                    }
                    
                    // Converter para inteiro (remover decimais)
                    valorNum = Math.floor(valorNum);
                    
                    // Validar limite máximo de 10.000
                    if (valorNum > 10000) {
                        console.warn('⚠️ Valor excede o limite de R$ 10.000:', valorNum);
                        valorNum = 10000; // Limitar ao máximo permitido
                    }
                    
                    // Validar que não seja negativo
                    if (valorNum < 0) {
                        console.warn('⚠️ Valor negativo não permitido:', valorNum);
                        return null;
                    }
                    
                    return valorNum;
                };
                
                // Tentar pegar de diferentes campos possíveis
                if (anuncio.valor) {
                    valorNumerico = validarEFormatarValor(anuncio.valor);
                } else if (anuncio.cache) {
                    valorNumerico = validarEFormatarValor(anuncio.cache);
                } else if (anuncio.preco_1h) {
                    valorNumerico = validarEFormatarValor(anuncio.preco_1h);
                } else if (anuncio.preco_30min) {
                    valorNumerico = validarEFormatarValor(anuncio.preco_30min);
                }
                
                // Formatar valor se válido
                if (valorNumerico !== null && valorNumerico !== undefined) {
                    // Formatar com separador de milhar
                    valorTexto = `R$ ${valorNumerico.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}`;
                }
                
                valorEl.textContent = valorTexto;
                console.log('✅ Valor atualizado:', valorEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-valor não encontrado');
            }
            
            // Atualizar campo "Horário de Atendimento"
            const horarioEl = document.getElementById('info-horario');
            if (horarioEl) {
                let horarioTexto = 'Não informado';
                if (anuncio.horario_24h === true || anuncio.horario_24h === 'sim' || anuncio.horario_24h === 'Sim') {
                    horarioTexto = '24h';
                } else if (anuncio.horario_inicio && anuncio.horario_fim) {
                    horarioTexto = `${anuncio.horario_inicio} às ${anuncio.horario_fim}`;
                } else if (anuncio.horario_inicio) {
                    horarioTexto = `A partir das ${anuncio.horario_inicio}`;
                }
                horarioEl.textContent = horarioTexto;
                console.log('✅ Horário atualizado:', horarioEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-horario não encontrado');
            }
            
            // Atualizar campo "Formas de Pagamento"
            const pagamentoEl = document.getElementById('info-pagamento');
            if (pagamentoEl) {
                let pagamentoTexto = 'Não informado';
                const pagamento = anuncio.pagamento || anuncio.formas_pagamento || [];
                
                if (Array.isArray(pagamento) && pagamento.length > 0) {
                    // Capitalizar primeira letra de cada forma de pagamento
                    pagamentoTexto = pagamento.map(p => {
                        const pStr = String(p).toLowerCase();
                        return pStr.charAt(0).toUpperCase() + pStr.slice(1);
                    }).join(' ');
                } else if (typeof pagamento === 'string' && pagamento.trim()) {
                    pagamentoTexto = pagamento;
                }
                
                pagamentoEl.textContent = pagamentoTexto;
                console.log('✅ Formas de pagamento atualizado:', pagamentoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-pagamento não encontrado');
            }
        }

        // Função para carregar informações opcionais
        function loadOptionalInfo(anuncio) {
            // Seção "Características Físicas" removida - dados já aparecem em "Informações Básicas"
            // Seção "Preferências de Serviços" removida - dados já aparecem em "Informações Básicas"
            // Não precisa carregar nada aqui relacionado a essas seções

            // Horários de atendimento
            const scheduleSection = document.getElementById('schedule-section');
            let hasScheduleInfo = false;
            
            if (anuncio.horario_inicio) {
                const horarioInicioEl = document.getElementById('info-horario-inicio');
                if (horarioInicioEl) {
                    horarioInicioEl.textContent = anuncio.horario_inicio;
                    hasScheduleInfo = true;
                }
            }
            if (anuncio.horario_fim) {
                const horarioFimEl = document.getElementById('info-horario-fim');
                if (horarioFimEl) {
                    horarioFimEl.textContent = anuncio.horario_fim;
                    hasScheduleInfo = true;
                }
            }
            
            if (hasScheduleInfo && scheduleSection) {
                scheduleSection.style.display = 'block';
            }
            
            // Atualizar estatísticas (views e likes) após atualizar o perfil
            // Usar setTimeout para garantir que o elemento esteja no DOM
            setTimeout(() => {
                updateProfileStats(anuncio, 0); // totalFotos será atualizado quando loadGallery for chamado
            }, 100);
        }

        // Função para gerenciar likes das fotos da galeria
        function handleGalleryLike(event, photoIndex, photoUrl) {
            event.preventDefault();
            event.stopPropagation();
            
            const likeBtn = event.currentTarget;
            const isLiked = likeBtn.classList.contains('liked');
            const icon = likeBtn.querySelector('i');
            
            // Alternar estado de like
            if (isLiked) {
                // Remover like
                likeBtn.classList.remove('liked');
                icon.className = 'far fa-thumbs-up';
                console.log(`💔 Like removido da foto ${photoIndex + 1}`);
            } else {
                // Adicionar like
                likeBtn.classList.add('liked');
                icon.className = 'fas fa-thumbs-up';
                console.log(`👍 Like adicionado à foto ${photoIndex + 1}`);
            }
            
            // Aqui você pode adicionar lógica para salvar no Firebase
            // Por exemplo, salvar em uma coleção de likes ou atualizar contador
            // Exemplo:
            // if (window.db && window.currentAnuncioId) {
            //     const likesRef = window.db.collection('gallery_likes').doc(`${window.currentAnuncioId}_${photoIndex}`);
            //     if (!isLiked) {
            //         likesRef.set({
            //             anuncioId: window.currentAnuncioId,
            //             photoIndex: photoIndex,
            //             photoUrl: photoUrl,
            //             likedAt: firebase.firestore.FieldValue.serverTimestamp()
            //         });
            //     } else {
            //         likesRef.delete();
            //     }
            // }
        }

        // Função para carregar galeria
        function loadGallery(anuncio) {
            console.log('🖼️ ========== INICIANDO loadGallery ==========');
            console.log('🖼️ Anúncio recebido:', {
                id: anuncio.id,
                nome: anuncio.nome || anuncio.name,
                foto_capa: anuncio.foto_capa,
                foto_capa_url: anuncio.foto_capa_url,
                foto_banner: anuncio.foto_banner,
                foto_banner_url: anuncio.foto_banner_url,
                galeria: anuncio.galeria,
                fotos: anuncio.fotos,
                images: anuncio.images,
                todas_chaves_fotos: Object.keys(anuncio).filter(k => 
                    k.toLowerCase().includes('foto') || 
                    k.toLowerCase().includes('galeria') || 
                    k.toLowerCase().includes('image') ||
                    k.toLowerCase().includes('photo')
                )
            });
            
            const pubBook = document.querySelector('.pub-book');
            if (!pubBook) {
                console.error('❌ Elemento .pub-book não encontrado no DOM!');
                console.error('🔍 Tentando buscar elementos relacionados:', {
                    pubBook: !!document.querySelector('.pub-book'),
                    gallery: !!document.querySelector('.gallery'),
                    galeria: !!document.querySelector('.galeria'),
                    photos: !!document.querySelector('.photos')
                });
                return;
            }
            
            console.log('✅ Elemento .pub-book encontrado!');

            // Limpar galeria de teste
            pubBook.innerHTML = '';

            // Função auxiliar para converter URL do Firebase
            function getFirebaseImageUrl(url, anuncioId) {
                if (!url) return null;
                
                // Se já é uma URL completa, usar diretamente
                if (url.startsWith('http://') || url.startsWith('https://')) {
                    return url;
                }
                
                // Se é gs://, converter
                if (url.startsWith('gs://')) {
                    const path = url.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
                    return `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                }
                
                // Se é um nome de arquivo, construir URL (estrutura padronizada)
                if (!url.includes('://')) {
                    const path = `advertisements/${anuncioId}/${url}`;
                    return `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                }
                
                return url;
            }

            // Coletar todas as fotos da galeria
            const fotos = [];
            
            // Adicionar foto de capa se disponível (opcional, pode não querer incluir)
            // if (anuncio.foto_capa_url || anuncio.foto_capa) {
            //     const capaUrl = getFirebaseImageUrl(anuncio.foto_capa_url || anuncio.foto_capa, anuncio.id);
            //     if (capaUrl) fotos.push(capaUrl);
            // }

            // Adicionar fotos da galeria (galeria_1, galeria_2, etc. até galeria_9)
            for (let i = 1; i <= 9; i++) {
                const campo = `galeria_${i}`;
                const campo_url = `galeria_${i}_url`;
                const campo_url_alt = `foto_galeria_${i}_url`;
                
                // Verificar campo_url primeiro
                if (anuncio[campo_url]) {
                    const url = getFirebaseImageUrl(anuncio[campo_url], anuncio.id);
                    if (url && !fotos.includes(url)) fotos.push(url);
                } 
                // Verificar campo_url_alt como alternativa
                else if (anuncio[campo_url_alt]) {
                    const url = getFirebaseImageUrl(anuncio[campo_url_alt], anuncio.id);
                    if (url && !fotos.includes(url)) fotos.push(url);
                }
                // Verificar campo direto
                else if (anuncio[campo]) {
                    const url = getFirebaseImageUrl(anuncio[campo], anuncio.id);
                    if (url && !fotos.includes(url)) fotos.push(url);
                }
            }
            
            // Adicionar foto_stories se existir (galeria_9 também aparece como stories)
            // Verificar foto_stories_url primeiro
            if (anuncio.foto_stories_url) {
                const url = getFirebaseImageUrl(anuncio.foto_stories_url, anuncio.id);
                if (url && !fotos.includes(url)) {
                    fotos.push(url);
                    console.log('✅ foto_stories_url adicionada à galeria');
                }
            }
            // Verificar stories_photo_url como alternativa
            else if (anuncio.stories_photo_url) {
                const url = getFirebaseImageUrl(anuncio.stories_photo_url, anuncio.id);
                if (url && !fotos.includes(url)) {
                    fotos.push(url);
                    console.log('✅ stories_photo_url adicionada à galeria');
                }
            }
            // Se galeria_9 existe mas não está na lista, verificar se foi salva como foto_stories
            else if (anuncio.galeria_9_url && !fotos.some(f => f.includes('galeria_9'))) {
                const url = getFirebaseImageUrl(anuncio.galeria_9_url, anuncio.id);
                if (url && !fotos.includes(url)) {
                    fotos.push(url);
                    console.log('✅ galeria_9_url adicionada à galeria (também usada como stories)');
                }
            }

            // Adicionar fotos de mediaFiles.galeria (array)
            if (anuncio.mediaFiles?.galeria && Array.isArray(anuncio.mediaFiles.galeria)) {
                anuncio.mediaFiles.galeria.forEach(foto => {
                    const url = getFirebaseImageUrl(foto, anuncio.id);
                    if (url && !fotos.includes(url)) fotos.push(url);
                });
            }

            // Adicionar fotos de galeria (array direto)
            if (anuncio.galeria && Array.isArray(anuncio.galeria)) {
                anuncio.galeria.forEach(foto => {
                    const url = getFirebaseImageUrl(foto, anuncio.id);
                    if (url && !fotos.includes(url)) fotos.push(url);
                });
            }

            console.log(`📸 ${fotos.length} fotos encontradas na galeria:`, fotos);

            // Se não há fotos, mostrar mensagem
            if (fotos.length === 0) {
                pubBook.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Nenhuma foto disponível na galeria</p>';
                console.warn('⚠️ Nenhuma foto encontrada na galeria');
                // Atualizar estatísticas mesmo sem fotos
                updateProfileStats(anuncio, 0);
                return;
            }

            // Obter nome e localização do anúncio
            const nomeAnuncio = anuncio.nome || anuncio.name || 'Anúncio';
            const cidade = anuncio.cidade || anuncio.city || '';
            const estado = anuncio.estado || anuncio.state || '';
            // Mostrar apenas a UF (sigla do estado) - pegar apenas os 2 primeiros caracteres se for sigla completa
            const estadoUF = estado ? (estado.length <= 2 ? estado.toUpperCase() : estado.substring(0, 2).toUpperCase()) : '';
            // Formato: Cidade/UF ou apenas UF
            const localizacao = cidade && estadoUF ? `${cidade}/${estadoUF}` : (estadoUF || cidade || 'Localização não informada');
            
            console.log('📋 Informações do card:', { nomeAnuncio, cidade, estado, estadoUF, localizacao });

            // Criar elementos da galeria no formato pub-book
            fotos.forEach((foto, index) => {
                const mediaId = index + 1;
                const pubBookItem = document.createElement('div');
                pubBookItem.className = 'pub-book-item';
                pubBookItem.setAttribute('data-media_id', mediaId);
                pubBookItem.setAttribute('data-media_type', 'photo');
                pubBookItem.setAttribute('data-media_message', '');
                pubBookItem.setAttribute('data-media_verified', '0');
                
                // Usar carrossel customizado - adicionar evento de clique
                // Incluir nome e localização na parte inferior do card
                pubBookItem.innerHTML = `
                    <div class="gallery-item" data-photo-index="${index}" style="cursor: pointer; position: relative;">
                        <img loading="lazy" src="${foto}" 
                             data-fallback="${foto}" 
                             class="pub-book-img lazyload" 
                             alt="Galeria ${mediaId}"
                             onerror="this.src='${foto}';">
                        <button class="gallery-like-btn" data-photo-index="${index}" data-photo-url="${encodeURIComponent(foto)}" aria-label="Curtir foto">
                            <i class="far fa-thumbs-up"></i>
                        </button>
                    </div>
                    <div class="card_title" style="display: block !important; visibility: visible !important;">${nomeAnuncio}</div>
                    <div class="card_resume" style="display: block !important; visibility: visible !important;">${localizacao}</div>
                `;
                
                // Debug: verificar se os elementos foram criados
                const cardTitle = pubBookItem.querySelector('.card_title');
                const cardResume = pubBookItem.querySelector('.card_resume');
                if (!cardTitle || !cardResume) {
                    console.error('❌ Elementos card_title ou card_resume não foram criados!');
                } else {
                    console.log('✅ Elementos criados:', { 
                        title: cardTitle.textContent, 
                        resume: cardResume.textContent,
                        titleDisplay: window.getComputedStyle(cardTitle).display,
                        resumeDisplay: window.getComputedStyle(cardResume).display
                    });
                }
                
                // Adicionar evento de clique para abrir o modal (apenas na imagem)
                const galleryItem = pubBookItem.querySelector('.gallery-item');
                galleryItem.addEventListener('click', (e) => {
                    // Não abrir modal se clicar no botão de like
                    if (!e.target.closest('.gallery-like-btn')) {
                        openGalleryModal(index);
                    }
                });
                
                // Adicionar evento de clique no botão de like
                const likeBtn = pubBookItem.querySelector('.gallery-like-btn');
                if (likeBtn) {
                    likeBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        const photoUrl = decodeURIComponent(likeBtn.getAttribute('data-photo-url'));
                        handleGalleryLike(e, index, photoUrl);
                    });
                }
                
                pubBook.appendChild(pubBookItem);
            });

            console.log(`✅ Galeria atualizada com ${fotos.length} fotos`);
            
            // Armazenar fotos globalmente para o modal
            window.galleryPhotos = fotos;
            
            // Atualizar estatísticas (views e likes)
            updateProfileStats(anuncio, fotos.length);
        }
        
        // Função para incrementar views no Firestore
        async function incrementViews(anuncioId) {
            try {
                if (!db || !anuncioId) {
                    console.warn('⚠️ Firebase não inicializado ou anuncioId não fornecido');
                    return 0;
                }
                
                console.log(`📊 Incrementando views para anúncio: ${anuncioId}`);
                
                // Tentar atualizar na coleção 'advertisements' primeiro
                const adRef = db.collection('advertisements').doc(anuncioId);
                const adDoc = await adRef.get();
                
                if (adDoc.exists) {
                    const currentViews = adDoc.data().views || adDoc.data().visualizacoes || adDoc.data().visualizations || 0;
                    const newViews = currentViews + 1;
                    await adRef.update({
                        views: firebase.firestore.FieldValue.increment(1),
                        visualizacoes: firebase.firestore.FieldValue.increment(1),
                        last_viewed_at: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    console.log(`✅ Views incrementadas na coleção 'advertisements': ${currentViews} -> ${newViews}`);
                    return newViews;
                }
                
                // Tentar atualizar na coleção 'anuncios'
                const anuncioRef = db.collection('anuncios').doc(anuncioId);
                const anuncioDoc = await anuncioRef.get();
                
                if (anuncioDoc.exists) {
                    const currentViews = anuncioDoc.data().views || anuncioDoc.data().visualizacoes || anuncioDoc.data().visualizations || 0;
                    const newViews = currentViews + 1;
                    await anuncioRef.update({
                        views: firebase.firestore.FieldValue.increment(1),
                        visualizacoes: firebase.firestore.FieldValue.increment(1),
                        last_viewed_at: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    console.log(`✅ Views incrementadas na coleção 'anuncios': ${currentViews} -> ${newViews}`);
                    return newViews;
                }
                
                console.warn('⚠️ Anúncio não encontrado para incrementar views');
                return 0;
            } catch (error) {
                console.error('❌ Erro ao incrementar views:', error);
                return 0;
            }
        }
        
        // Função para atualizar estatísticas (views e likes)
        function updateProfileStats(anuncio, totalFotos) {
            console.log('📊 Atualizando estatísticas...', { anuncioId: anuncio?.id, totalFotos });
            
            // Atualizar Views
            const statViews = document.getElementById('stat-views');
            console.log('🔍 Elemento stat-views encontrado:', !!statViews);
            if (statViews) {
                // Pegar views do anuncio - iniciar zerado se não existir
                const views = anuncio?.views || anuncio?.visualizacoes || anuncio?.visualizations || 0;
                statViews.textContent = views.toLocaleString('pt-BR');
                console.log(`📊 Views atualizadas: ${views}`, 'Elemento:', statViews);
            } else {
                console.warn('⚠️ Elemento stat-views não encontrado no DOM');
            }
            
            // Atualizar Likes - soma dos likes de todas as fotos
            const statLikes = document.getElementById('stat-likes');
            if (statLikes) {
                let totalLikes = 0;
                
                // Tentar pegar likes das fotos individuais
                for (let i = 1; i <= 9; i++) {
                    const campoLikes = `galeria_${i}_likes`;
                    const likes = anuncio[campoLikes] || 0;
                    totalLikes += parseInt(likes) || 0;
                }
                
                // Se não houver likes individuais, pegar total geral
                if (totalLikes === 0) {
                    totalLikes = anuncio.likes || anuncio.total_likes || anuncio.likes_total || 0;
                }
                
                // Se ainda não houver, usar valor simulado baseado no número de fotos
                if (totalLikes === 0 && totalFotos > 0) {
                    totalLikes = Math.floor(Math.random() * 500) + (totalFotos * 10);
                }
                
                statLikes.textContent = totalLikes.toLocaleString('pt-BR');
                console.log(`❤️ Likes atualizados: ${totalLikes}`);
            }
        }
        
        // Variáveis globais para o carrossel customizado
        let currentGalleryIndex = 0;
        let galleryPhotos = [];
        let galleryPhotosBackup = null;
        let isCustomGalleryActive = false;

        // Função para abrir o modal de galeria
        function openGalleryModal(index = 0, options = {}) {
            const customPhotos = Array.isArray(options.photos)
                ? options.photos.filter(Boolean)
                : null;

            if (customPhotos && customPhotos.length === 0) {
                console.warn('⚠️ Nenhuma foto válida fornecida para o carrossel personalizado');
                return;
            }

            if (customPhotos) {
                if (!isCustomGalleryActive) {
                    galleryPhotosBackup = window.galleryPhotos || [];
                }
                window.galleryPhotos = customPhotos;
                isCustomGalleryActive = true;
            } else if (!window.galleryPhotos || window.galleryPhotos.length === 0) {
                console.warn('⚠️ Nenhuma foto na galeria');
                return;
            }

            const maxIndex = window.galleryPhotos.length - 1;
            currentGalleryIndex = Math.min(Math.max(index, 0), maxIndex);

            const modal = document.getElementById('gallery-modal');
            const modalImage = document.getElementById('gallery-modal-image');
            const currentIndexSpan = document.getElementById('gallery-current-index');
            const totalCountSpan = document.getElementById('gallery-total-count');
            const prevBtn = document.getElementById('gallery-prev-btn');
            const nextBtn = document.getElementById('gallery-next-btn');

            if (!modal || !modalImage) {
                console.error('❌ Elementos do modal não encontrados');
                return;
            }

            // Atualizar imagem
            modalImage.src = window.galleryPhotos[currentGalleryIndex];
            modalImage.alt = `Foto ${currentGalleryIndex + 1}`;

            // Atualizar contador
            currentIndexSpan.textContent = currentGalleryIndex + 1;
            totalCountSpan.textContent = window.galleryPhotos.length;

            // Mostrar/ocultar botões de navegação conforme necessário
            const shouldShowNav = window.galleryPhotos.length > 1;
            if (prevBtn) {
                prevBtn.style.display = shouldShowNav ? 'flex' : 'none';
            }
            if (nextBtn) {
                nextBtn.style.display = shouldShowNav ? 'flex' : 'none';
            }

            // Mostrar modal
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';

            console.log(`📸 Abrindo foto ${currentGalleryIndex + 1} de ${window.galleryPhotos.length}`);
        }

        // Função para fechar o modal
        function closeGalleryModal() {
            const modal = document.getElementById('gallery-modal');
            const prevBtn = document.getElementById('gallery-prev-btn');
            const nextBtn = document.getElementById('gallery-next-btn');
            
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            
            // Restaurar botões de navegação (caso tenham sido escondidos)
            if (prevBtn) {
                prevBtn.style.display = 'flex';
            }
            if (nextBtn) {
                nextBtn.style.display = 'flex';
            }

            if (isCustomGalleryActive) {
                window.galleryPhotos = galleryPhotosBackup || [];
                galleryPhotosBackup = null;
                isCustomGalleryActive = false;
            }
        }

        // Função para navegar para a foto anterior
        function prevGalleryPhoto() {
            if (!window.galleryPhotos || window.galleryPhotos.length === 0) return;
            
            currentGalleryIndex = (currentGalleryIndex - 1 + window.galleryPhotos.length) % window.galleryPhotos.length;
            updateGalleryModal();
        }

        // Função para navegar para a próxima foto
        function nextGalleryPhoto() {
            if (!window.galleryPhotos || window.galleryPhotos.length === 0) return;
            
            currentGalleryIndex = (currentGalleryIndex + 1) % window.galleryPhotos.length;
            updateGalleryModal();
        }

        // Função para atualizar o modal com a foto atual
        function updateGalleryModal() {
            const modalImage = document.getElementById('gallery-modal-image');
            const currentIndexSpan = document.getElementById('gallery-current-index');

            if (modalImage && window.galleryPhotos[currentGalleryIndex]) {
                modalImage.src = window.galleryPhotos[currentGalleryIndex];
                modalImage.alt = `Foto ${currentGalleryIndex + 1}`;
                currentIndexSpan.textContent = currentGalleryIndex + 1;
            }
        }

        // Inicializar eventos do modal após o DOM estar carregado
        document.addEventListener('DOMContentLoaded', function() {
            // Botão fechar
            const closeBtn = document.getElementById('gallery-close-btn');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeGalleryModal);
            }

            // Botão anterior
            const prevBtn = document.getElementById('gallery-prev-btn');
            if (prevBtn) {
                prevBtn.addEventListener('click', prevGalleryPhoto);
            }

            // Botão próximo
            const nextBtn = document.getElementById('gallery-next-btn');
            if (nextBtn) {
                nextBtn.addEventListener('click', nextGalleryPhoto);
            }

            // Fechar ao clicar no backdrop
            const backdrop = document.querySelector('.gallery-modal-backdrop');
            if (backdrop) {
                backdrop.addEventListener('click', closeGalleryModal);
            }

            // Navegação por teclado
            document.addEventListener('keydown', function(e) {
                const modal = document.getElementById('gallery-modal');
                if (!modal || modal.style.display === 'none') return;

                switch(e.key) {
                    case 'Escape':
                        closeGalleryModal();
                        break;
                    case 'ArrowLeft':
                        prevGalleryPhoto();
                        break;
                    case 'ArrowRight':
                        nextGalleryPhoto();
                        break;
                }
            });

            console.log('✅ Eventos do carrossel de galeria inicializados');
            
            // Função para verificar se está no modo mobile/tablet
            function isMobileDevice() {
                return window.innerWidth <= 1024;
            }

            function openPhotoInCarousel(imageUrl, contextLabel = 'Foto') {
                if (!imageUrl || typeof imageUrl !== 'string') {
                    console.warn('⚠️ URL inválida para exibição no carrossel:', imageUrl);
                    return;
                }

                const normalizedUrl = imageUrl.trim();
                if (!normalizedUrl) {
                    console.warn('⚠️ URL vazia após normalização');
                    return;
                }

                const basePhotos = Array.isArray(window.galleryPhotos) ? window.galleryPhotos : [];
                const existingIndex = basePhotos.indexOf(normalizedUrl);

                if (existingIndex !== -1) {
                    openGalleryModal(existingIndex);
                    console.log(`📸 ${contextLabel} já está na galeria. Abrindo índice ${existingIndex + 1}.`);
                    return;
                }

                const customPhotos = [normalizedUrl, ...basePhotos.filter(photo => photo && photo !== normalizedUrl)];
                openGalleryModal(0, { photos: customPhotos });
                console.log(`📸 ${contextLabel} aberto no carrossel com ${customPhotos.length} foto(s).`);
            }
            
            // Handlers para banner e foto de perfil
            function handleBannerClick(e) {
                if (isMobileDevice()) {
                    e.preventDefault();
                    e.stopPropagation();
                    const bannerUrl = this.src || this.getAttribute('src');
                    if (bannerUrl && bannerUrl !== '' && !bannerUrl.includes('data:image')) {
                        openPhotoInCarousel(bannerUrl, 'Banner do Perfil');
                    }
                }
            }
            
            function handleProfileImageClick(e) {
                if (isMobileDevice()) {
                    e.preventDefault();
                    e.stopPropagation();
                    const imageUrl = this.src || this.getAttribute('src');
                    if (imageUrl && imageUrl !== '' && !imageUrl.includes('data:image')) {
                        openPhotoInCarousel(imageUrl, 'Foto do Perfil');
                    }
                }
            }
            
            // Adicionar event listeners para banner e foto de perfil no modo mobile
            function setupMobilePhotoClickListeners() {
                // Listener para o banner
                const profileBanner = document.getElementById('profile-banner');
                if (profileBanner) {
                    // Remover listener anterior se existir
                    profileBanner.removeEventListener('click', handleBannerClick);
                    // Adicionar novo listener
                    profileBanner.addEventListener('click', handleBannerClick);
                    // Adicionar cursor pointer no mobile
                    if (isMobileDevice()) {
                        profileBanner.style.cursor = 'pointer';
                    } else {
                        profileBanner.style.cursor = 'default';
                    }
                }
                
                // Listener para a foto de perfil
                const profileImage = document.getElementById('profile-image');
                if (profileImage) {
                    // Remover listener anterior se existir
                    profileImage.removeEventListener('click', handleProfileImageClick);
                    // Adicionar novo listener
                    profileImage.addEventListener('click', handleProfileImageClick);
                    // Adicionar cursor pointer no mobile
                    if (isMobileDevice()) {
                        profileImage.style.cursor = 'pointer';
                    } else {
                        profileImage.style.cursor = 'default';
                    }
                }
            }
            
            // Configurar listeners inicialmente
            setupMobilePhotoClickListeners();
            
            // Reconfigurar listeners quando a tela for redimensionada
            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(function() {
                    setupMobilePhotoClickListeners();
                }, 250);
            });
        });


        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // loadProfileData() já é chamado no outro DOMContentLoaded que inicializa o Firebase
            // Não chamar aqui para evitar duplicação
            
            // Eventos do modal de galeria já foram configurados acima
        });
        
        // ==========================================
        // FUNÇÃO DE SIMULAÇÃO PARA TESTE COM JSON
        // ==========================================
        // Esta função permite testar a página com dados JSON sem precisar do Firebase
        // Para usar, chame no console: simularCarregamentoDados(jsonData)
        window.simularCarregamentoDados = async function(jsonData) {
            console.log('🧪 ========== SIMULANDO CARREGAMENTO DE DADOS ==========');
            console.log('📋 JSON recebido:', jsonData);
            
            // Converter o JSON para o formato esperado pela página
            const anuncio = {
                id: 'test-id-' + Date.now(),
                ...jsonData,
                
                // Simular URLs de imagens baseadas nos nomes dos arquivos
                foto_banner_url: jsonData.files?.foto_banner?.arquivo 
                    ? `https://via.placeholder.com/1200x450?text=Banner+${encodeURIComponent(jsonData.files.foto_banner.arquivo)}`
                    : null,
                
                foto_capa_url: jsonData.files?.foto_capa?.arquivo 
                    ? `https://via.placeholder.com/400x400?text=Capa+${encodeURIComponent(jsonData.files.foto_capa.arquivo)}`
                    : null,
            };
            
            // Mapear arquivos da galeria para os campos corretos
            if (jsonData.files?.galeria && Array.isArray(jsonData.files.galeria)) {
                jsonData.files.galeria.forEach(item => {
                    const campoNum = item.campo.replace('galeria_', '');
                    const urlKey = `galeria_${campoNum}_url`;
                    
                    // Simular URL da imagem (usando placeholder ou nome do arquivo)
                    if (item.isVideo) {
                        anuncio[urlKey] = `https://via.placeholder.com/800x600?text=Video+${encodeURIComponent(item.arquivo)}`;
                        anuncio.video_capa_url = anuncio[urlKey];
                    } else {
                        // Simular URL de imagem real
                        anuncio[urlKey] = `https://via.placeholder.com/800x600?text=Galeria+${campoNum}+${encodeURIComponent(item.arquivo)}`;
                        
                        // Se for stories (galeria_9), também salvar
                        if (item.isStories) {
                            anuncio.stories_photo_url = anuncio[urlKey];
                        }
                    }
                });
            }
            
            // Processar vídeo separado se existir
            if (jsonData.files?.video) {
                anuncio.galeria_8_url = `https://via.placeholder.com/800x600?text=Video+${encodeURIComponent(jsonData.files.video.arquivo)}`;
                anuncio.video_capa_url = anuncio.galeria_8_url;
            }
            
            // Converter estado e cidade para formato legível
            if (anuncio.estado) {
                const estadosMap = {
                    'DF': 'Distrito Federal',
                    'SP': 'São Paulo',
                    'RJ': 'Rio de Janeiro',
                    'MG': 'Minas Gerais',
                };
                anuncio.estado_nome = estadosMap[anuncio.estado] || anuncio.estado;
            }
            
            if (anuncio.cidade) {
                anuncio.cidade_nome = anuncio.cidade
                    .split('-')
                    .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
                    .join(' ');
            }
            
            // Processar horário
            if (anuncio.horario_24h === 'sim') {
                anuncio.horario_display = '24 horas';
            } else if (anuncio.horario_inicio && anuncio.horario_fim) {
                anuncio.horario_display = `${anuncio.horario_inicio} às ${anuncio.horario_fim}`;
            } else {
                anuncio.horario_display = 'Não informado';
            }
            
            // Processar formas de pagamento
            if (anuncio.pagamento && Array.isArray(anuncio.pagamento)) {
                anuncio.pagamento_display = anuncio.pagamento
                    .map(p => {
                        const pagamentosMap = {
                            'dinheiro': 'Dinheiro',
                            'pix': 'PIX',
                            'debito': 'Débito',
                            'credito': 'Crédito'
                        };
                        return pagamentosMap[p] || p;
                    })
                    .join(', ');
            }
            
            // Processar "atende"
            if (anuncio.atende && Array.isArray(anuncio.atende)) {
                anuncio.atende_display = anuncio.atende
                    .map(a => {
                        const atendeMap = {
                            'ele': 'Ele',
                            'ela': 'Ela',
                            'casais': 'Casais'
                        };
                        return atendeMap[a] || a;
                    })
                    .join(', ');
            }
            
            console.log('✅ Anúncio formatado:', anuncio);
            console.log('📸 URLs de imagens simuladas:', {
                banner: anuncio.foto_banner_url,
                capa: anuncio.foto_capa_url,
                galeria: {
                    galeria_1: anuncio.galeria_1_url,
                    galeria_2: anuncio.galeria_2_url,
                    galeria_3: anuncio.galeria_3_url,
                    galeria_4: anuncio.galeria_4_url,
                    galeria_5: anuncio.galeria_5_url,
                    galeria_6: anuncio.galeria_6_url,
                    galeria_7: anuncio.galeria_7_url,
                    galeria_8: anuncio.galeria_8_url,
                    galeria_9: anuncio.galeria_9_url
                }
            });
            
            // Chamar a função de atualização da página
            console.log('🔄 Chamando updateProfileData com dados simulados...');
            await updateProfileData(anuncio);
            console.log('✅ Simulação concluída!');
            
            return anuncio;
        };
        
        // ==========================================
        // MODO DE TESTE AUTOMÁTICO (já movido para o DOMContentLoaded principal acima)
        // ==========================================

        // Fechar modal com ESC já está implementado no DOMContentLoaded acima para a galeria
        // Aqui apenas para o modal de mensagem
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeMessageModal();
            }
        });

        // Funções do Modal de Mensagem
        function openMessageModal() {
            const modal = document.getElementById('message-modal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeMessageModal() {
            const modal = document.getElementById('message-modal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // Limpar formulário
            document.getElementById('message-form').reset();
        }

        // Event listener para o formulário de mensagem
        document.addEventListener('DOMContentLoaded', function() {
            const messageForm = document.getElementById('message-form');
            if (messageForm) {
                messageForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Coletar dados do formulário
                    const formData = new FormData(messageForm);
                    const messageData = {
                        name: formData.get('name'),
                        email: formData.get('email'),
                        phone: formData.get('phone'),
                        message: formData.get('message'),
                        timestamp: new Date().toISOString()
                    };
                    
                    // Simular envio da mensagem
                    console.log('Mensagem enviada:', messageData);
                    
                    // Mostrar mensagem de sucesso
                    alert('Mensagem enviada com sucesso! Entraremos em contato em breve.');
                    
                    // Fechar modal
                    closeMessageModal();
                });
            }

            // Fechar modal ao clicar fora
            const messageModal = document.getElementById('message-modal');
            if (messageModal) {
                messageModal.addEventListener('click', function(event) {
                    if (event.target === messageModal) {
                        closeMessageModal();
                    }
                });
            }
        });

        // Lightbox functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Handle gallery clicks
            const galleryLinks = document.querySelectorAll('.pub-book-link');
            
            galleryLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const lightbox = document.querySelector(targetId);
                    
                    if (lightbox) {
                        lightbox.style.display = 'flex';
                        document.body.style.overflow = 'hidden';
                    }
                });
            });

            // Handle close button clicks
            const closeButtons = document.querySelectorAll('.mfp-close');
            
            closeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const lightbox = this.closest('.lightbox-block');
                    if (lightbox) {
                        lightbox.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                });
            });

            // Handle background clicks to close
            const lightboxes = document.querySelectorAll('.lightbox-block');
            
            lightboxes.forEach(lightbox => {
                lightbox.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                });
            });

            // Handle ESC key to close
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const openLightbox = document.querySelector('.lightbox-block[style*="flex"]');
                    if (openLightbox) {
                        openLightbox.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        });

        // ============================================
        // FUNCIONALIDADES DA BARRA FIXA MOBILE
        // ============================================
        
        // Função para compartilhar
        function shareProfile() {
            const url = window.location.href;
            const profileName = document.querySelector('.profile-name');
            const title = profileName ? profileName.textContent.trim() : 'Perfil Premium VIP';
            const description = document.querySelector('.profile-description')?.textContent?.trim() || '';
            const text = description ? `${title} - ${description.substring(0, 100)}...` : `Confira este perfil: ${title}`;
            
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: text,
                    url: url
                }).then(() => {
                    console.log('✅ Compartilhamento realizado com sucesso');
                }).catch(err => {
                    console.log('Erro ao compartilhar:', err);
                    // Fallback: copiar para clipboard
                    fallbackShare(url);
                });
            } else {
                // Fallback: copiar para clipboard
                fallbackShare(url);
            }
        }
        
        function fallbackShare(url) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('Link copiado para a área de transferência!');
                }).catch(() => {
                    // Fallback manual
                    const textarea = document.createElement('textarea');
                    textarea.value = url;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('Link copiado para a área de transferência!');
                });
            }
        }

        // Função para like
        let isLiked = false;
        function toggleLike() {
            isLiked = !isLiked;
            const btn = document.getElementById('mobile-btn-like');
            if (btn) {
                if (isLiked) {
                    btn.classList.add('active');
                    btn.querySelector('i').classList.remove('far');
                    btn.querySelector('i').classList.add('fas');
                    // Atualizar contador de likes se existir
                    const likesCount = document.getElementById('stat-likes');
                    if (likesCount) {
                        const current = parseInt(likesCount.textContent) || 0;
                        likesCount.textContent = current + 1;
                    }
                } else {
                    btn.classList.remove('active');
                    btn.querySelector('i').classList.remove('fas');
                    btn.querySelector('i').classList.add('far');
                    // Atualizar contador de likes se existir
                    const likesCount = document.getElementById('stat-likes');
                    if (likesCount) {
                        const current = parseInt(likesCount.textContent) || 0;
                        likesCount.textContent = Math.max(0, current - 1);
                    }
                }
            }
        }

        // Função para favoritar
        let isFavorited = false;
        function toggleFavorite() {
            isFavorited = !isFavorited;
            const btn = document.getElementById('mobile-btn-favorite');
            if (btn) {
                if (isFavorited) {
                    btn.classList.add('active');
                    btn.querySelector('i').classList.remove('far');
                    btn.querySelector('i').classList.add('fas');
                    // Salvar no localStorage
                    const anuncioId = new URLSearchParams(window.location.search).get('id');
                    if (anuncioId) {
                        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                        if (!favorites.includes(anuncioId)) {
                            favorites.push(anuncioId);
                            localStorage.setItem('favorites', JSON.stringify(favorites));
                        }
                    }
                } else {
                    btn.classList.remove('active');
                    btn.querySelector('i').classList.remove('fas');
                    btn.querySelector('i').classList.add('far');
                    // Remover do localStorage
                    const anuncioId = new URLSearchParams(window.location.search).get('id');
                    if (anuncioId) {
                        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                        favorites = favorites.filter(id => id !== anuncioId);
                        localStorage.setItem('favorites', JSON.stringify(favorites));
                    }
                }
            }
        }

        // Verificar se já está favoritado ao carregar
        document.addEventListener('DOMContentLoaded', function() {
            const anuncioId = new URLSearchParams(window.location.search).get('id');
            if (anuncioId) {
                const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                if (favorites.includes(anuncioId)) {
                    isFavorited = true;
                    const btn = document.getElementById('mobile-btn-favorite');
                    if (btn) {
                        btn.classList.add('active');
                        btn.querySelector('i').classList.remove('far');
                        btn.querySelector('i').classList.add('fas');
                    }
                }
            }

            // Atualizar links de telefone e WhatsApp quando os dados carregarem
            function updateMobileButtons() {
                // Pegar telefone do botão existente na página
                const phoneNumberElement = document.getElementById('btn-ligar-phone-number');
                const phoneNumber = phoneNumberElement?.textContent?.trim() || '';
                
                // Pegar link do WhatsApp do botão existente
                const whatsappBtn = document.getElementById('btn-whatsapp');
                const whatsappHref = whatsappBtn?.href || '';
                
                // Formatar telefone para link
                const formatPhone = (phone) => {
                    if (!phone) return '';
                    return phone.replace(/\D/g, '');
                };

                // Atualizar botão de telefone mobile
                const mobilePhoneBtn = document.getElementById('mobile-btn-phone');
                if (mobilePhoneBtn && phoneNumber) {
                    const formattedPhone = formatPhone(phoneNumber);
                    mobilePhoneBtn.href = `tel:+55${formattedPhone}`;
                    mobilePhoneBtn.onclick = function(e) {
                        e.preventDefault();
                        window.location.href = `tel:+55${formattedPhone}`;
                    };
                }

                // Atualizar botão de WhatsApp mobile
                const mobileWhatsappBtn = document.getElementById('mobile-btn-whatsapp');
                if (mobileWhatsappBtn && whatsappHref) {
                    mobileWhatsappBtn.href = whatsappHref;
                    mobileWhatsappBtn.onclick = function(e) {
                        e.preventDefault();
                        window.open(whatsappHref, '_blank');
                    };
                }
            }

            // Tentar atualizar imediatamente e depois de um delay
            updateMobileButtons();
            setTimeout(updateMobileButtons, 1000);
            setTimeout(updateMobileButtons, 3000);

            // Sistema de Layout - Ativar layout N3 quando o ícone for clicado
            const layoutIcons = document.querySelectorAll('.layout-icon[data-layout]');
            layoutIcons.forEach(icon => {
                icon.addEventListener('click', function(e) {
                    e.preventDefault();
                    const layout = this.getAttribute('data-layout');
                    
                    // Remover classe active de todos os ícones
                    layoutIcons.forEach(i => i.classList.remove('active'));
                    
                    // Adicionar classe active ao ícone clicado
                    this.classList.add('active');
                    
                    // Aplicar layout ao body e ao container pub-book
                    if (layout === 'n3') {
                        document.body.setAttribute('data-layout', 'n3');
                        const pubBook = document.querySelector('.pub-book');
                        if (pubBook) {
                            pubBook.classList.add('layout-n3');
                        }
                    } else {
                        // Remover layout n3 se outro layout for selecionado
                        document.body.removeAttribute('data-layout');
                        const pubBook = document.querySelector('.pub-book');
                        if (pubBook) {
                            pubBook.classList.remove('layout-n3');
                        }
                    }
                    
                    console.log(`✅ Layout ${layout} ativado`);
                });
            });

            // Verificar se há um layout ativo por padrão
            const activeLayoutIcon = document.querySelector('.layout-icon.active[data-layout]');
            if (activeLayoutIcon) {
                const layout = activeLayoutIcon.getAttribute('data-layout');
                if (layout === 'n3') {
                    document.body.setAttribute('data-layout', 'n3');
                    const pubBook = document.querySelector('.pub-book');
                    if (pubBook) {
                        pubBook.classList.add('layout-n3');
                    }
                }
            }
        });

        // ==========================================
        // SISTEMA DE COMENTÁRIOS E MODERAÇÃO
        // ==========================================
        
        let anuncioId = null;
        let anuncioEmail = null;
        let isAnunciante = false;
        let isAdmin = false;
        let currentUser = null;

        // Variáveis globais do Firebase (já inicializadas acima)
        // db e auth já estão disponíveis globalmente

        // Verificar se usuário é anunciante ou admin
        async function verificarPermissoes() {
            try {
                console.log('🔍 Iniciando verificação de permissões...');
                
                // Obter ID do anúncio da URL
                anuncioId = new URLSearchParams(window.location.search).get('id');
                if (!anuncioId) {
                    console.warn('⚠️ ID do anúncio não encontrado na URL');
                    return;
                }
                
                console.log('📋 ID do anúncio:', anuncioId);
                console.log('🔐 Auth disponível:', !!auth);
                console.log('👤 Usuário atual:', auth?.currentUser?.email || 'Não logado');

                // Verificar autenticação
                if (auth && auth.currentUser) {
                    currentUser = auth.currentUser;
                    const userEmail = currentUser.email;
                    console.log('✅ Usuário autenticado:', userEmail);

                    // Buscar dados do anúncio para verificar email
                    try {
                        const anuncioDoc = await db.collection('anuncios').doc(anuncioId).get();
                        if (!anuncioDoc.exists) {
                            // Tentar coleção advertisements
                            const adDoc = await db.collection('advertisements').doc(anuncioId).get();
                            if (adDoc.exists) {
                                anuncioEmail = adDoc.data().email || adDoc.data().userEmail;
                            }
                        } else {
                            anuncioEmail = anuncioDoc.data().email || anuncioDoc.data().userEmail;
                        }

                        // Verificar se é anunciante
                        if (anuncioEmail && userEmail && anuncioEmail.toLowerCase() === userEmail.toLowerCase()) {
                            isAnunciante = true;
                            console.log('✅ Usuário é a anunciante do anúncio');
                        }

                        // Verificar se é admin
                        try {
                            const userDoc = await db.collection('users').doc(currentUser.uid).get();
                            if (userDoc.exists) {
                                const userData = userDoc.data();
                                if (userData.role === 'admin' || userData.admin === true) {
                                    isAdmin = true;
                                    console.log('✅ Usuário é administrador');
                                }
                            }
                        } catch (e) {
                            console.warn('⚠️ Erro ao verificar role de admin:', e);
                        }

                        // Mostrar botão de painel se for anunciante ou admin
                        if (isAnunciante || isAdmin) {
                            const btnPainel = document.getElementById('painel-controle-btn');
                            if (btnPainel) {
                                btnPainel.classList.add('visible');
                                console.log('✅ Botão Painel de Controle exibido para:', isAnunciante ? 'Anunciante' : 'Admin');
                            } else {
                                console.warn('⚠️ Botão painel-controle-btn não encontrado no DOM');
                            }
                            const areaModeracao = document.getElementById('moderacao-area');
                            if (areaModeracao) {
                                areaModeracao.classList.add('visible');
                            }
                        } else {
                            console.log('ℹ️ Usuário não é anunciante nem admin. Email do anúncio:', anuncioEmail, 'Email do usuário:', currentUser?.email);
                        }

                        // Mostrar formulário de comentário se usuário estiver logado
                        if (currentUser) {
                            const formComentario = document.getElementById('comentario-form');
                            const loginPrompt = document.getElementById('login-prompt');
                            if (formComentario) formComentario.style.display = 'block';
                            if (loginPrompt) loginPrompt.style.display = 'none';
                        }

                    } catch (error) {
                        console.error('❌ Erro ao verificar permissões:', error);
                    }
                } else {
                    // Usuário não logado
                    const formComentario = document.getElementById('comentario-form');
                    const loginPrompt = document.getElementById('login-prompt');
                    if (formComentario) formComentario.style.display = 'none';
                    if (loginPrompt) loginPrompt.style.display = 'block';
                }

                // Carregar comentários aprovados (públicos)
                await carregarComentariosAprovados();

                // Carregar comentários pendentes se for anunciante/admin
                if (isAnunciante || isAdmin) {
                    await carregarComentariosPendentes();
                }

            } catch (error) {
                console.error('❌ Erro ao verificar permissões:', error);
            }
        }

        // Carregar comentários aprovados (públicos)
        async function carregarComentariosAprovados() {
            try {
                if (!anuncioId || !db) return;

                const comentariosRef = db.collection('comentarios')
                    .where('anuncioId', '==', anuncioId)
                    .where('status', '==', 'aprovado')
                    .orderBy('createdAt', 'desc');

                const snapshot = await comentariosRef.get();
                const comentarios = [];
                
                snapshot.forEach(doc => {
                    comentarios.push({ id: doc.id, ...doc.data() });
                });

                exibirComentariosAprovados(comentarios);

            } catch (error) {
                console.error('❌ Erro ao carregar comentários aprovados:', error);
                // Se erro de índice, tentar sem orderBy
                try {
                    const comentariosRef = db.collection('comentarios')
                        .where('anuncioId', '==', anuncioId)
                        .where('status', '==', 'aprovado');
                    const snapshot = await comentariosRef.get();
                    const comentarios = [];
                    snapshot.forEach(doc => {
                        comentarios.push({ id: doc.id, ...doc.data() });
                    });
                    // Ordenar manualmente
                    comentarios.sort((a, b) => {
                        const dateA = a.createdAt?.toDate() || new Date(0);
                        const dateB = b.createdAt?.toDate() || new Date(0);
                        return dateB - dateA;
                    });
                    exibirComentariosAprovados(comentarios);
                } catch (e) {
                    console.error('❌ Erro ao carregar comentários (fallback):', e);
                }
            }
        }

        // Exibir comentários aprovados
        function exibirComentariosAprovados(comentarios) {
            const container = document.getElementById('comentarios-lista');
            if (!container) return;

            if (comentarios.length === 0) {
                container.innerHTML = `
                    <div class="sem-comentarios">
                        <i class="fas fa-comment-slash" style="font-size: 2rem; color: var(--text-muted); margin-bottom: 0.5rem;"></i>
                        <p>Ainda não há comentários aprovados. Seja o primeiro a comentar!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = comentarios.map(comentario => {
                const data = comentario.createdAt?.toDate() || new Date();
                const dataFormatada = data.toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <div class="comentario-item">
                        <div class="comentario-header">
                            <span class="comentario-autor">
                                <i class="fas fa-user"></i> ${escapeHtml(comentario.userName || comentario.userEmail || 'Anônimo')}
                            </span>
                            <span class="comentario-data">${dataFormatada}</span>
                        </div>
                        <div class="comentario-texto">${escapeHtml(comentario.comentario)}</div>
                    </div>
                `;
            }).join('');
        }

        // Carregar comentários pendentes (apenas anunciante/admin)
        async function carregarComentariosPendentes() {
            try {
                if (!anuncioId || !db) return;
                if (!isAnunciante && !isAdmin) return;

                const comentariosRef = db.collection('comentarios')
                    .where('anuncioId', '==', anuncioId)
                    .where('status', '==', 'pendente')
                    .orderBy('createdAt', 'desc');

                const snapshot = await comentariosRef.get();
                const comentarios = [];
                
                snapshot.forEach(doc => {
                    comentarios.push({ id: doc.id, ...doc.data() });
                });

                // Exibir na área de moderação da página
                exibirComentariosPendentes(comentarios, 'comentarios-pendentes');
                
                // Exibir no modal também
                exibirComentariosPendentes(comentarios, 'comentarios-pendentes-modal');

            } catch (error) {
                console.error('❌ Erro ao carregar comentários pendentes:', error);
                // Tentar sem orderBy se houver erro de índice
                try {
                    const comentariosRef = db.collection('comentarios')
                        .where('anuncioId', '==', anuncioId)
                        .where('status', '==', 'pendente');
                    const snapshot = await comentariosRef.get();
                    const comentarios = [];
                    snapshot.forEach(doc => {
                        comentarios.push({ id: doc.id, ...doc.data() });
                    });
                    comentarios.sort((a, b) => {
                        const dateA = a.createdAt?.toDate() || new Date(0);
                        const dateB = b.createdAt?.toDate() || new Date(0);
                        return dateB - dateA;
                    });
                    exibirComentariosPendentes(comentarios, 'comentarios-pendentes');
                    exibirComentariosPendentes(comentarios, 'comentarios-pendentes-modal');
                } catch (e) {
                    console.error('❌ Erro ao carregar comentários pendentes (fallback):', e);
                }
            }
        }

        // Exibir comentários pendentes
        function exibirComentariosPendentes(comentarios, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            if (comentarios.length === 0) {
                container.innerHTML = `
                    <div class="sem-comentarios">
                        <p>Não há comentários pendentes de moderação.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = comentarios.map(comentario => {
                const data = comentario.createdAt?.toDate() || new Date();
                const dataFormatada = data.toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <div class="comentario-pendente">
                        <div class="comentario-pendente-header">
                            <div class="comentario-pendente-info">
                                <strong>${escapeHtml(comentario.userName || comentario.userEmail || 'Anônimo')}</strong>
                                <br>
                                <small style="color: var(--text-muted);">${dataFormatada}</small>
                            </div>
                            <div class="comentario-pendente-acoes">
                                <button class="btn-aprovar" onclick="aprovarComentario('${comentario.id}')">
                                    <i class="fas fa-check"></i> Aprovar
                                </button>
                                <button class="btn-rejeitar" onclick="rejeitarComentario('${comentario.id}')">
                                    <i class="fas fa-times"></i> Rejeitar
                                </button>
                            </div>
                        </div>
                        <div class="comentario-texto">${escapeHtml(comentario.comentario)}</div>
                    </div>
                `;
            }).join('');
        }

        // Enviar novo comentário
        async function enviarComentario(comentarioTexto) {
            try {
                if (!currentUser) {
                    alert('Você precisa estar logado para comentar.');
                    return;
                }

                if (!anuncioId || !db) {
                    alert('Erro: ID do anúncio não encontrado.');
                    return;
                }

                // Sanitizar texto
                const comentarioLimpo = comentarioTexto.trim();
                if (comentarioLimpo.length < 10) {
                    alert('O comentário deve ter pelo menos 10 caracteres.');
                    return;
                }

                if (comentarioLimpo.length > 1000) {
                    alert('O comentário não pode ter mais de 1000 caracteres.');
                    return;
                }

                // Salvar como pendente
                const novoComentario = {
                    anuncioId: anuncioId,
                    userId: currentUser.uid,
                    userEmail: currentUser.email,
                    userName: currentUser.displayName || currentUser.email.split('@')[0],
                    comentario: comentarioLimpo,
                    status: 'pendente',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection('comentarios').add(novoComentario);

                // Limpar formulário
                document.getElementById('comentario-texto').value = '';

                // Mostrar mensagem de sucesso
                alert('Comentário enviado com sucesso! Ele será moderado antes de ser publicado.');

                // Recarregar comentários pendentes se for anunciante/admin
                if (isAnunciante || isAdmin) {
                    await carregarComentariosPendentes();
                }

            } catch (error) {
                console.error('❌ Erro ao enviar comentário:', error);
                alert('Erro ao enviar comentário. Tente novamente.');
            }
        }

        // Aprovar comentário
        async function aprovarComentario(comentarioId) {
            try {
                if (!isAnunciante && !isAdmin) {
                    alert('Você não tem permissão para aprovar comentários.');
                    return;
                }

                if (!confirm('Deseja aprovar este comentário?')) return;

                await db.collection('comentarios').doc(comentarioId).update({
                    status: 'aprovado',
                    aprovadoPor: currentUser.email,
                    aprovadoEm: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Recarregar comentários
                await carregarComentariosAprovados();
                await carregarComentariosPendentes();

                alert('Comentário aprovado com sucesso!');

            } catch (error) {
                console.error('❌ Erro ao aprovar comentário:', error);
                alert('Erro ao aprovar comentário. Tente novamente.');
            }
        }

        // Rejeitar comentário
        async function rejeitarComentario(comentarioId) {
            try {
                if (!isAnunciante && !isAdmin) {
                    alert('Você não tem permissão para rejeitar comentários.');
                    return;
                }

                if (!confirm('Deseja rejeitar este comentário? Esta ação não pode ser desfeita.')) return;

                await db.collection('comentarios').doc(comentarioId).update({
                    status: 'rejeitado',
                    rejeitadoPor: currentUser.email,
                    rejeitadoEm: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Recarregar comentários pendentes
                await carregarComentariosPendentes();

                alert('Comentário rejeitado.');

            } catch (error) {
                console.error('❌ Erro ao rejeitar comentário:', error);
                alert('Erro ao rejeitar comentário. Tente novamente.');
            }
        }

        // Abrir painel de controle
        function abrirPainelControle() {
            const modal = document.getElementById('painel-modal');
            if (modal) {
                modal.classList.add('active');
                // Carregar comentários pendentes no modal
                carregarComentariosPendentes();
            }
        }

        // Fechar painel de controle
        function fecharPainelControle() {
            const modal = document.getElementById('painel-modal');
            if (modal) {
                modal.classList.remove('active');
            }
        }

        // Fechar modal ao clicar fora
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('painel-modal');
            if (event.target === modal) {
                fecharPainelControle();
            }
        });

        // Função auxiliar para escapar HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Event listener para formulário de comentário
        document.addEventListener('DOMContentLoaded', function() {
            const formComentario = document.getElementById('form-comentario');
            if (formComentario) {
                formComentario.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const texto = document.getElementById('comentario-texto').value;
                    const btnEnviar = document.getElementById('btn-enviar-comentario');
                    
                    if (btnEnviar) {
                        btnEnviar.disabled = true;
                        btnEnviar.textContent = 'Enviando...';
                    }
                    
                    await enviarComentario(texto);
                    
                    if (btnEnviar) {
                        btnEnviar.disabled = false;
                        btnEnviar.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Comentário';
                    }
                });
            }

            // Verificar permissões quando Firebase estiver pronto
            if (auth) {
                auth.onAuthStateChanged(async (user) => {
                    currentUser = user;
                    await verificarPermissoes();
                });
            } else {
                // Tentar verificar após um delay se auth ainda não estiver pronto
                setTimeout(async () => {
                    if (auth) {
                        auth.onAuthStateChanged(async (user) => {
                            currentUser = user;
                            await verificarPermissoes();
                        });
                    } else {
                        // Se ainda não houver auth, verificar permissões sem autenticação
                        await verificarPermissoes();
                    }
                }, 1000);
            }

            // Aguardar um pouco mais para garantir que loadProfileData terminou
            setTimeout(async () => {
                await verificarPermissoes();
            }, 2000);
        });

        // Função de teste temporária para mostrar botão (apenas para debug - remover em produção)
        window.mostrarPainelTeste = function() {
            const btnPainel = document.getElementById('painel-controle-btn');
            if (btnPainel) {
                btnPainel.classList.add('visible');
                console.log('🧪 TESTE: Botão Painel de Controle forçado a aparecer');
                alert('Botão Painel de Controle exibido para teste. Use o console para mais informações.');
            }
        };

        // Log para debug - mostrar posição do botão
        console.log('📍 Botão Painel de Controle está localizado no HEADER, à esquerda do botão "Voltar"');
        console.log('💡 Para testar, execute no console: mostrarPainelTeste()');
    </script>

    <!-- Barra Fixa Mobile -->
    <div class="mobile-fixed-bar">
        <a href="#" id="mobile-btn-phone" class="mobile-btn btn-phone">
            <i class="fas fa-phone"></i>
            <span>Ligar</span>
        </a>
        <a href="#" id="mobile-btn-whatsapp" class="mobile-btn btn-whatsapp" target="_blank">
            <i class="fab fa-whatsapp"></i>
            <span>WhatsApp</span>
        </a>
        <button class="mobile-btn btn-share" onclick="shareProfile()">
            <i class="fas fa-share-alt"></i>
            <span>Compartilhar</span>
        </button>
        <button class="mobile-btn btn-like" id="mobile-btn-like" onclick="toggleLike()">
            <i class="far fa-thumbs-up"></i>
            <span>Like</span>
        </button>
        <button class="mobile-btn btn-favorite" id="mobile-btn-favorite" onclick="toggleFavorite()">
            <i class="far fa-heart"></i>
            <span>Favoritar</span>
        </button>
    </div>
    
</body>
</html>
