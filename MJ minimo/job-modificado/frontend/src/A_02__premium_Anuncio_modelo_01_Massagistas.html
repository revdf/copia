<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil - Modelo A | Premium VIP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <style>
        :root {
            --primary-color: #dc3545;
            --secondary-color: #6c757d;
            --accent-color: #ffc107;
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --text-dark: #212529;
            --text-muted: #6c757d;
            --border-color: #dee2e6;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: var(--bg-white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .back-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: #c82333;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Profile Header */
        .profile-header {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 0;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .profile-banner {
            width: 100%;
            height: 450px;
            object-fit: cover;
            border-radius: 15px 15px 0 0;
        }

        .profile-picture-container {
            position: absolute;
            top: 350px;
            right: 2rem;
            z-index: 10;
        }

        .profile-image {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 50%;
            border: 6px solid var(--bg-white);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .profile-image:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.4);
        }

        .profile-status {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 25px;
            height: 25px;
            background: #28a745;
            border: 4px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .profile-info {
            padding: 2rem;
            padding-top: 4rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            text-align: left;
        }

        .profile-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .profile-level {
            display: inline-block;
            background: linear-gradient(45deg, var(--primary-color), #ff6b6b);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .profile-description {
            font-size: 1.1rem;
            color: var(--text-muted);
            line-height: 1.8;
            margin-bottom: 1rem;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: var(--bg-light);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Gallery Section */
        .gallery-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Pub Book Gallery Styles */
        .pub-book {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.25rem;
            margin-top: 1rem;
        }

        .pub-book-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            min-height: 360px;
            display: flex;
            flex-direction: column;
            background: white;
        }

        .pub-book-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .pub-book-link {
            display: block;
            text-decoration: none;
            color: inherit;
        }

        .pub-book-img {
            width: 100%;
            min-width: 100%;
            height: 300px;
            min-height: 300px;
            object-fit: cover;
            object-position: center;
            display: block;
            transition: opacity 0.3s ease;
            background-color: #f0f0f0;
        }

        .pub-book-item:hover .pub-book-img {
            opacity: 0.9;
        }

        /* Estilos para informações do card */
        .card_title {
            padding: 12px 15px;
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            text-align: center;
            border-top: 1px solid #eee;
            background: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card_resume {
            padding: 8px 15px 15px;
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            background: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .pub-book-item .gallery-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .pub-book-item .gallery-item img {
            flex: 1;
            object-fit: cover;
        }

        /* Botão de Like */
        .gallery-like-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: transparent;
            border: none;
            width: auto;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            transition: all 0.3s ease;
            padding: 0;
        }

        .gallery-like-btn:hover {
            transform: scale(1.15);
        }

        .gallery-like-btn i {
            font-size: 1.5rem;
            color: white;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .gallery-like-btn.liked i {
            color: #4CAF50;
            text-shadow: 0 2px 8px rgba(76, 175, 80, 0.6);
        }

        .gallery-like-btn:active {
            transform: scale(0.9);
        }

        /* Layout N3 ajustes */
        body[data-layout="n3"] .pub-book-img,
        .pub-book.layout-n3 .pub-book-img,
        [data-layout="n3"] .pub-book-img {
            height: 375px;
            min-height: 375px;
        }

        body[data-layout="n3"] .pub-book-item,
        .pub-book.layout-n3 .pub-book-item,
        [data-layout="n3"] .pub-book-item {
            min-height: 450px;
            overflow: visible !important;
            height: auto !important;
        }

        body[data-layout="n3"] .card_title,
        .pub-book.layout-n3 .card_title,
        [data-layout="n3"] .card_title,
        body[data-layout="n3"] .pub-book-item .card_title,
        .pub-book.layout-n3 .pub-book-item .card_title {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 10 !important;
            height: auto !important;
            min-height: auto !important;
            max-height: none !important;
        }

        body[data-layout="n3"] .card_resume,
        .pub-book.layout-n3 .card_resume,
        [data-layout="n3"] .card_resume,
        body[data-layout="n3"] .pub-book-item .card_resume,
        .pub-book.layout-n3 .pub-book-item .card_resume {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 10 !important;
            height: auto !important;
            min-height: auto !important;
            max-height: none !important;
        }

        /* Lightbox Styles */
        .mfp-hide {
            display: none !important;
        }

        .lightbox-block {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .mfp-img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .mfp-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s ease;
            z-index: 10000;
        }

        .mfp-close:hover {
            background: rgba(255, 255, 255, 1);
        }

        .mfp-close i {
            font-size: 18px;
            color: #333;
        }

        /* Estilos do Modal de Galeria Customizado */
        .gallery-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gallery-modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            cursor: pointer;
        }

        .gallery-modal-content {
            position: relative;
            width: 90%;
            height: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }

        .gallery-modal-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .gallery-modal-close,
        .gallery-modal-prev,
        .gallery-modal-next {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10002;
            font-size: 20px;
            color: #333;
        }

        .gallery-modal-close {
            top: 20px;
            right: 20px;
        }

        .gallery-modal-prev,
        .gallery-modal-next {
            top: 50%;
            transform: translateY(-50%);
        }

        .gallery-modal-prev {
            left: 20px;
        }

        .gallery-modal-next {
            right: 20px;
        }

        .gallery-modal-close:hover,
        .gallery-modal-prev:hover,
        .gallery-modal-next:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-50%) scale(1.1);
        }

        .gallery-modal-close:hover {
            transform: scale(1.1);
        }

        .gallery-modal-counter {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            z-index: 10002;
        }

        @media (max-width: 768px) {
            .gallery-modal-prev,
            .gallery-modal-next {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .gallery-modal-close {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .gallery-modal-counter {
                font-size: 14px;
                padding: 8px 16px;
            }

            .control-section {
                padding: 1.5rem;
            }

            .control-section #painel-controle-container {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .control-btn {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Utility Classes */
        .position-relative {
            position: relative;
        }

        .h-full {
            height: 100%;
        }

        .w-full {
            width: 100%;
        }

        .d-flex {
            display: flex;
        }

        .absolute {
            position: absolute;
        }

        .top {
            top: 0;
        }

        .right {
            right: 0;
        }

        .m-10 {
            margin: 10px;
        }

        .mr-2 {
            margin-right: 0.5rem;
        }

        .p-0 {
            padding: 0;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .btn-default {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #dee2e6;
        }

        .btn-circle {
            border-radius: 50%;
        }

        .no-events {
            pointer-events: none;
        }

        /* Modal de Mensagem */
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            background: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .modal-header .close {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .modal-header .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-color-hover);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        /* Description Section */
        .description-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .description-content {
            margin-top: 1rem;
        }

        .description-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-dark);
            text-align: justify;
            margin: 0;
        }

        .video-item .gallery-overlay i {
            font-size: 2.5rem;
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-overlay i {
            color: white;
            font-size: 2rem;
        }

        /* Services Section */
        .services-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Forçar layout em grid para os cards de serviços */
        .services-section .services-cards-container,
        .section .services-cards-container {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 2rem !important;
            margin-top: 1rem;
            width: 100%;
        }

        .services-section .service-card,
        .section .service-card {
            width: 100% !important;
            border: 1px solid #d1d5db !important;
            border-radius: 12px !important;
            padding: 16px !important;
            background: #f8fafc !important;
            min-height: 115px !important;
            min-width: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.3s ease !important;
            margin: 0 !important;
            float: none !important;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .service-item {
            padding: 1.5rem;
            background: var(--bg-light);
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
        }

        .service-title {
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .service-price {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* Contact Section */
        .contact-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Espaçamento específico para Nosso Espaço após Comentários */
        .comentarios-section + .contact-section {
            margin-top: 2rem;
        }

        .contact-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .contact-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
        }

        .contact-btn.primary {
            background: var(--primary-color);
            color: white;
        }

        .contact-btn.primary:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .contact-btn.secondary {
            background: var(--secondary-color);
            color: white;
        }

        .contact-btn.secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .contact-btn.success {
            background: #28a745;
            color: white;
        }

        .contact-btn.success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        /* Cores customizadas para botões do Nosso Espaço */
        .contact-btn.verde {
            background: #28a745;
            color: white;
        }

        .contact-btn.verde:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .contact-btn.laranja {
            background: #ff9800;
            color: white;
        }

        .contact-btn.laranja:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }

        .contact-btn.vermelho {
            background: #dc3545;
            color: white;
        }

        .contact-btn.vermelho:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .contact-btn.amarelo {
            background: #ffc107;
            color: #212529;
        }

        .contact-btn.amarelo:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        /* Estilo para botão de telefone com número visível */
        .contact-btn .btn-phone-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }
        
        .contact-btn .btn-phone-label {
            font-size: 0.75rem;
            font-weight: 500;
            opacity: 0.9;
            line-height: 1;
        }
        
        .contact-btn .btn-phone-number {
            font-size: 1rem;
            font-weight: 700;
            line-height: 1.2;
        }

        /* Info Section */
        .info-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Padronização para todas as seções */
        .section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Section do Painel de Controle */
        .control-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .control-section #painel-controle-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
            padding: 0;
        }

        .control-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-weight: 600;
            font-size: 1rem;
            border: none;
            width: 100%;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .control-btn.disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .control-btn.disabled:hover {
            transform: none;
        }

        /* Cores dos botões */
        /* Cores dos botões - Tons mais vibrantes */
        .btn-visibilidade {
            background: linear-gradient(135deg, #8B5CF6 0%, #6366F1 100%);
        }

        .btn-painel {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
        }

        .btn-eliminar {
            background: linear-gradient(135deg, #EC4899 0%, #DB2777 100%);
        }

        .btn-denunciar {
            background: linear-gradient(135deg, #06B6D4 0%, #0891B2 100%);
        }

        /* Section de Estatísticas */
        .stats-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Cores específicas para cada tipo de estatística */
        .stat-card.stat-likes {
            border-color: #EC4899;
        }

        .stat-card.stat-likes .stat-icon {
            color: #EC4899;
        }

        .stat-card.stat-likes .stat-value {
            color: #EC4899;
        }

        .stat-card.stat-comentarios {
            border-color: #06B6D4;
        }

        .stat-card.stat-comentarios .stat-icon {
            color: #06B6D4;
        }

        .stat-card.stat-comentarios .stat-value {
            color: #06B6D4;
        }

        .stat-card.stat-tempo {
            border-color: #8B5CF6;
        }

        .stat-card.stat-tempo .stat-icon {
            color: #8B5CF6;
        }

        .stat-card.stat-tempo .stat-value {
            color: #8B5CF6;
        }

        .stat-card.stat-visualizacoes {
            border-color: #6366F1;
        }

        .stat-card.stat-visualizacoes .stat-icon {
            color: #6366F1;
        }

        .stat-card.stat-visualizacoes .stat-value {
            color: #6366F1;
        }

        .stat-card.stat-entradas {
            border-color: #10B981;
        }

        .stat-card.stat-entradas .stat-icon {
            color: #10B981;
        }

        .stat-card.stat-entradas .stat-value {
            color: #10B981;
        }

        .stat-card.stat-prints {
            border-color: #F59E0B;
        }

        .stat-card.stat-prints .stat-icon {
            color: #F59E0B;
        }

        .stat-card.stat-prints .stat-value {
            color: #F59E0B;
        }

        .stat-card.stat-dispositivos {
            border-color: #EF4444;
        }

        .stat-card.stat-dispositivos .stat-icon {
            color: #EF4444;
        }

        .stat-card.stat-dispositivos .stat-value {
            color: #EF4444;
        }

        /* Lista de top visitantes */
        .top-visitantes {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border-color);
        }

        .top-visitantes h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }

        .visitantes-list {
            display: grid;
            gap: 0.75rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .visitante-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--bg-light);
            border-radius: 8px;
            transition: background 0.2s ease;
        }

        .visitante-item:hover {
            background: #e9ecef;
        }

        .visitante-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .visitante-email {
            font-weight: 500;
            color: var(--text-dark);
        }

        .visitante-visitas {
            color: var(--primary-color);
            font-weight: bold;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-light);
            border-radius: 10px;
        }

        .info-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .info-content h4 {
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }

        .info-content p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                padding: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .control-section {
                padding: 1.5rem;
            }

            .control-section #painel-controle-container {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .control-btn {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            .stats-section {
                padding: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .profile-header {
                padding: 0;
            }

            .profile-banner {
                height: 375px;
            }

            .profile-picture-container {
                top: 275px;
                right: 1rem;
            }

            .profile-image {
                width: 150px;
                height: 150px;
                border: 4px solid var(--bg-white);
            }

            .profile-status {
                width: 20px;
                height: 20px;
                border: 3px solid white;
            }

            .profile-info {
                padding: 1rem;
                padding-top: 3rem;
                text-align: center;
            }

            .profile-name {
                font-size: 2rem;
            }

            .pub-book {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.25rem;
            }

            .pub-book-img {
                height: 225px;
            }

            .mfp-img {
                max-width: 95%;
                max-height: 80%;
            }

            .mfp-close {
                top: 10px;
                right: 10px;
                width: 35px;
                height: 35px;
            }

            .mfp-close i {
                font-size: 16px;
            }

            /* Modal de Mensagem - Mobile */
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }

            .modal-header {
                padding: 1rem;
            }

            .modal-header h3 {
                font-size: 1.2rem;
            }

            .modal-body {
                padding: 1rem;
            }

            .form-actions {
                flex-direction: column;
                gap: 0.5rem;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            /* Description Section - Mobile */
            .description-section {
                padding: 1.5rem;
            }

        .description-text {
            font-size: 1rem;
            text-align: left;
        }

        /* Services Cards Styles */
        .services-cards-container {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 2rem !important;
            margin-top: 1rem;
            width: 100%;
        }

        .service-card {
            width: 100% !important;
            border: 1px solid #d1d5db !important;
            border-radius: 12px !important;
            padding: 16px !important;
            background: #f8fafc !important;
            min-height: 115px !important;
            min-width: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.3s ease !important;
            margin: 0 !important;
            float: none !important;
        }

        /* Garantir que os cards apareçam em todas as resoluções */
        .section .services-cards-container,
        .services-section .services-cards-container {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 2rem !important;
            margin-top: 1rem;
            width: 100%;
        }

        .section .service-card,
        .services-section .service-card {
            width: 100% !important;
            border: 1px solid #d1d5db !important;
            border-radius: 12px !important;
            padding: 16px !important;
            background: #f8fafc !important;
            min-height: 115px !important;
            min-width: 150px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: space-between !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.3s ease !important;
            margin: 0 !important;
            float: none !important;
        }

        .service-card:hover {
            background: #f1f5f9;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            cursor: pointer;
        }

        .card-title-section {
            display: flex;
            align-items: start;
            gap: 8px;
        }

        .card-icon {
            display: inline-block;
            margin-top: 4px;
        }

        .card-label {
            color: #E25352;
            font-weight: 500;
            font-size: 12px;
        }

        .card-label-section {
            display: flex;
            flex-direction: column;
            text-align: start;
        }

        .card-arrow {
            display: inline-block;
            margin-top: 4px;
        }

        .card-content {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            flex: 1;
        }

        /* Card de Valores */
        .price-label {
            font-weight: normal;
            font-size: 10px;
            margin: 0;
        }

        .price-section {
            display: flex;
            align-items: center;
            gap: 4px;
            margin: 4px 0;
        }

        .price-value {
            font-weight: 600;
            font-size: 18px;
            margin: 0;
        }

        .price-duration {
            font-weight: normal;
            font-size: 12px;
            margin: 0;
        }

        .service-info {
            margin-top: 4px;
        }

        .service-text {
            font-size: 12px;
            font-weight: normal;
            margin-right: 4px;
        }

        /* Card de Localização */
        .location-city {
            font-size: 18px;
            font-weight: bold;
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 4px;
        }

        .location-state {
            font-size: 12px;
            margin-bottom: 9px;
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 80%;
        }

        .location-info {
            display: block;
        }

        .location-text {
            font-size: 12px;
            font-weight: normal;
            text-transform: lowercase;
        }

        @media (max-width: 768px) {
            .services-cards-container {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }

            .service-card {
                min-height: 100px !important;
                padding: 12px !important;
            }

            .card-header {
                margin-bottom: 16px;
            }

            .location-state {
                max-width: 100%;
            }

            /* Responsividade para seções padronizadas */
            .section {
                padding: 1.5rem;
            }
        }
            
            .gallery-row.two-items {
                grid-template-columns: 1fr;
            }

            .contact-buttons {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--bg-light);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal for Gallery */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
        }

        .modal-content {
            position: relative;
            margin: auto;
            padding: 0;
            width: 90%;
            max-width: 800px;
            top: 50%;
            transform: translateY(-50%);
        }

        .modal-image {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .modal-video {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--primary-color);
        }


        /* Estilos para serviços detalhados */
        .services-section-detailed {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            position: relative;
        }

        .services-section-detailed:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }

        .services-section-detailed:last-child {
            margin-bottom: 0;
        }

        .services-section-detailed h5 {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .services-list-detailed {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 0.5rem;
        }

        .services-list-detailed li {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            background: var(--bg-light);
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .services-list-detailed li i {
            color: var(--primary-color);
            margin-right: 0.5rem;
            font-size: 0.8rem;
        }

        /* Estilos para preços detalhados */

        /* Estilos para descrição detalhada */
        .description-text-detailed {
            line-height: 1.8;
            color: var(--text-dark);
            font-size: 1rem;
        }
        /* Estilos para o Botão Painel de Controle no footer */
        .boton_dashboard {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #e25352 0%, #c44544 100%);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(226, 83, 82, 0.3);
            font-weight: 600;
            font-size: 1rem;
            border: none;
        }

        .boton_dashboard:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(226, 83, 82, 0.4);
            background: linear-gradient(135deg, #c44544 0%, #b33534 100%);
        }

        .boton_dashboard img {
            width: 24px;
            height: 24px;
            object-fit: contain;
        }

        .boton_dashboard span {
            font-weight: 600;
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .boton_dashboard {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .boton_dashboard img {
                width: 20px;
                height: 20px;
            }
            
            .boton_dashboard span {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="A_02__premium_copy.html" class="logo">
                <i class="fas fa-heart"></i> Premium VIP
            </a>
            <a href="A_02__premium_copy.html" class="back-btn" id="back-btn-link" onclick="handleBackClick(event)">
                <i class="fas fa-arrow-left"></i>
                Voltar
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Profile Header -->
        <section class="profile-header">
            <!-- Banner retangular de fundo -->
            <img src="" 
                 alt="Banner" class="profile-banner" id="profile-banner" style="opacity: 0; transition: opacity 0.3s;">
            
            <!-- Foto circular sobreposta -->
            <div class="profile-picture-container">
                <img src="" 
                     alt="Foto do Perfil" class="profile-image" id="profile-image" style="opacity: 0; transition: opacity 0.3s;">
                <div class="profile-status"></div>
            </div>
            
            <div class="profile-info">
                <h1 class="profile-name" id="profile-name">seu nome aqui</h1>
                <span class="profile-level" id="profile-level">Acompanhante Premium</span>
                <p class="profile-description" id="profile-description">
                    Homem experiente e atencioso, oferecendo companhia de qualidade para momentos especiais. Discreto e profissional.
                </p>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="stat-views">0</div>
                        <div class="stat-label">Views</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="stat-likes">0</div>
                        <div class="stat-label">Likes</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Massagista Section -->
        <section class="services-form-section" style="display: block; background: white; border-radius: 15px; padding: 2rem; margin-bottom: 2rem; box-shadow: var(--shadow);">
            <h2 class="section-title">
                <i class="fas fa-spa"></i>
                Meu Anúncio de Massagista
            </h2>
            <p style="color: #666; margin-top: -15px; margin-bottom: 1.5rem;" id="massagista-subtitle">Massoterapeuta</p>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Tipos de Massagens</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="tipos-massagem-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="terapeutica" style="margin-right: 8px;" disabled="">
                        <span>Terapêutica</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="relaxante" style="margin-right: 8px;" disabled="">
                        <span>Relaxante</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="sensoriais" style="margin-right: 8px;" disabled="">
                        <span>Sensoriais</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="corpo-corpo" style="margin-right: 8px;" disabled="">
                        <span>Corpo a Corpo</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="tantrica" style="margin-right: 8px;" disabled="">
                        <span>Tântrica</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="prostatica" style="margin-right: 8px;" disabled="">
                        <span>Prostática</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="tailandesa" style="margin-right: 8px;" disabled="">
                        <span>Tailandesa</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="sensual" style="margin-right: 8px;" disabled="">
                        <span>Sensual</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="nuru" style="margin-right: 8px;" disabled="">
                        <span>Nuru</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="drenagem" style="margin-right: 8px;" disabled="">
                        <span>Drenagem linfática</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="esportiva" style="margin-right: 8px;" disabled="">
                        <span>Esportiva</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="modeladora" style="margin-right: 8px;" disabled="">
                        <span>Modeladora</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="shiatsu" style="margin-right: 8px;" disabled="">
                        <span>Shiatsu</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="vivencia" style="margin-right: 8px;" disabled="">
                        <span>Vivência</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="reflexologia" style="margin-right: 8px;" disabled="">
                        <span>Reflexologia</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="tipos-massagem" value="4-maos" style="margin-right: 8px;" disabled="">
                        <span>4 Mãos</span>
                    </label>
                </div>
            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Massagens Com Finalização</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="finalizacao-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="finalizacao" value="masturbacao" style="margin-right: 8px;" disabled="">
                        <span>Masturbação</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="finalizacao" value="sexo-oral" style="margin-right: 8px;" disabled="">
                        <span>Sexo Oral</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="finalizacao" value="penetracao" style="margin-right: 8px;" disabled="">
                        <span>Penetração</span>
                    </label>
                </div>
            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Serviços Extras</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="servicos-extras-massagista-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="depilacao" style="margin-right: 8px;" disabled="">
                        <span>Depilação</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="estetica" style="margin-right: 8px;" disabled="">
                        <span>Estética</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="reflexologia-podal" style="margin-right: 8px;" disabled="">
                        <span>Reflexologia Podal</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="liberacao-miofacial" style="margin-right: 8px;" disabled="">
                        <span>Liberação miofacial</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="pedras-quentes" style="margin-right: 8px;" disabled="">
                        <span>Pedras quentes</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="massagem-brinquedos" style="margin-right: 8px;" disabled="">
                        <span>Massagens com Brinquedos</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="servicos-extras" value="escalda-pes" style="margin-right: 8px;" disabled="">
                        <span>Escalda pés</span>
                    </label>
                </div>
            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Atendimento das Massagens Para</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="atendimento-massagem-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="atendimento" value="homens" style="margin-right: 8px;" disabled="">
                        <span>Homens</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="atendimento" value="mulheres" style="margin-right: 8px;" disabled="">
                        <span>Mulheres</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="atendimento" value="trans" style="margin-right: 8px;" disabled="">
                        <span>Trans</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="atendimento" value="casais" style="margin-right: 8px;" disabled="">
                        <span>Casais</span>
                    </label>
                </div>
            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Em Nossas Instalações</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="instalacoes-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="temos-local" style="margin-right: 8px;" disabled="">
                        <span>Temos Local</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="a-domicilio" style="margin-right: 8px;" disabled="">
                        <span>A Domicílio</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="em-hotel" style="margin-right: 8px;" disabled="">
                        <span>Em Hotel</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="em-motel" style="margin-right: 8px;" disabled="">
                        <span>Em Motel</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="ducha" style="margin-right: 8px;" disabled="">
                        <span>Ducha</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="banheira" style="margin-right: 8px;" disabled="">
                        <span>Banheira</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="maca" style="margin-right: 8px;" disabled="">
                        <span>Maca</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="tatami" style="margin-right: 8px;" disabled="">
                        <span>Tatami</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="oleos-essenciais" style="margin-right: 8px;" disabled="">
                        <span>Óleos Essenciais</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="velas-aromaticas" style="margin-right: 8px;" disabled="">
                        <span>Velas Aromáticas</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="musica-relaxante" style="margin-right: 8px;" disabled="">
                        <span>Música Relaxante</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: rgb(231, 243, 255); border: 2px solid rgb(0, 123, 255); border-radius: 20px; transition: 0.3s; font-weight: 500;">
                        <input type="checkbox" name="instalacoes" value="material-descartavel" style="margin-right: 8px;" disabled="">
                        <span>Material Descartável</span>
                    </label>
                </div>
            </div>
        </section>

        <!-- Description Section -->
        <section class="description-section">
            <h2 class="section-title">
                <i class="fas fa-align-left"></i>
                Descrição
            </h2>
            <div class="description-content">
                <p class="description-text" id="description-text">
                    Olá! Sou Carlos, um homem experiente e atencioso, oferecendo companhia de qualidade para momentos especiais. Com mais de 8 anos de experiência, sou conhecido por ser discreto, profissional e respeitoso. Especializado em acompanhar mulheres em eventos sociais, jantares, viagens e momentos íntimos. Minha abordagem é sempre elegante e sofisticada, proporcionando uma experiência agradável e memorável. Sou bem-educado, culto e tenho boa conversa. Atendo exclusivamente mulheres em um ambiente privado e confortável. Disponibilidade noturna (19h às 02h) com agendamento flexível. Venha conhecer um companheiro que valoriza sua privacidade e satisfação!
                </p>
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="gallery-section">
            <h2 class="section-title">
                <i class="fas fa-images"></i>
                Galeria de Fotos
            </h2>
            
            <!-- Listar Galeria de Fotos - Será preenchida dinamicamente pelo loadGallery() -->
            <div class="pub-book">
                <!-- Galeria será carregada aqui via JavaScript -->
                <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <p>Carregando galeria...</p>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="contact-section">
            <h2 class="section-title">
                <i class="fas fa-phone"></i>
                Entre em Contato
            </h2>
            <div class="contact-buttons">
                <a href="tel:+5511999999999" id="btn-ligar-agora" class="contact-btn primary">
                    <i class="fas fa-phone"></i>
                    <div class="btn-phone-content">
                        <span class="btn-phone-label">Ligar Agora</span>
                        <span class="btn-phone-number" id="btn-ligar-phone-number">(61) 98484-7878</span>
                    </div>
                </a>
                <a href="https://wa.me/5511999999999" id="btn-whatsapp" class="contact-btn success" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    WhatsApp
                </a>
                <a href="tel:+5511999999999" id="btn-telefone-fixo" class="contact-btn secondary" style="opacity: 0.5; pointer-events: none; cursor: not-allowed;">
                    <i class="fas fa-phone-alt"></i>
                    Telefone Fixo
                </a>
                <a href="#" class="contact-btn secondary" onclick="openMessageModal()">
                    <i class="fas fa-comment"></i>
                    Mensagem
                </a>
            </div>
        </section>

        <!-- Info Section -->
        <section class="info-section">
            <h2 class="section-title">
                <i class="fas fa-info-circle"></i>
                Informações Básicas
            </h2>
            <div class="info-grid" id="basic-info-grid">
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-birthday-cake"></i>
                    </div>
                    <div class="info-content">
                        <h4>Idade</h4>
                        <p id="info-idade">32</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-weight"></i>
                    </div>
                    <div class="info-content">
                        <h4>Peso</h4>
                        <p id="info-peso">78kg</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-ruler-vertical"></i>
                    </div>
                    <div class="info-content">
                        <h4>Altura</h4>
                        <p id="info-altura">1.82m</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-kiss-wink-heart"></i>
                    </div>
                    <div class="info-content">
                        <h4>Oral sem</h4>
                        <p id="info-oral-sem">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-kiss"></i>
                    </div>
                    <div class="info-content">
                        <h4>Beija</h4>
                        <p id="info-beija">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <div class="info-content">
                        <h4>Anal</h4>
                        <p id="info-anal">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="info-content">
                        <h4>Local</h4>
                        <p id="info-local">São Paulo, SP</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="info-content">
                        <h4>Mora só</h4>
                        <p id="info-mora-so">Sim</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="info-content">
                        <h4>Valor</h4>
                        <p id="info-valor">R$ 200</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="info-content">
                        <h4>Horário de Atendimento</h4>
                        <p id="info-horario">24h</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="info-content">
                        <h4>Atende</h4>
                        <p id="info-atende">Mulheres</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="info-content">
                        <h4>Formas de Pagamento</h4>
                        <p id="info-pagamento">Dinheiro PIX Débito Crédito</p>
                    </div>
                </div>
            </div>
        </section>



        <!-- Schedule Section -->
        <section class="info-section" id="schedule-section" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-clock"></i>
                Horários de Atendimento
            </h2>
            <div class="info-grid" id="schedule-info-grid">
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-sun"></i>
                    </div>
                    <div class="info-content">
                        <h4>Início</h4>
                        <p id="info-horario-inicio">-</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-moon"></i>
                    </div>
                    <div class="info-content">
                        <h4>Fim</h4>
                        <p id="info-horario-fim">-</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Preços -->


        <!-- Informações Específicas - Homem -->
        <section class="section" id="section-homem-info" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-male"></i>
                Informações Específicas - Homem
            </h2>
            <p style="color: #666; margin-top: -15px; margin-bottom: 1.5rem;">Dados específicos para homens</p>
            
            <div class="info-card">
                <div class="services-section-detailed">
                    <h5>Orientação Sexual</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Heterossexual</li>
                        <li><i class="fas fa-check"></i> Gay</li>
                        <li><i class="fas fa-check"></i> Bissexual</li>
                        <li><i class="fas fa-check"></i> Pansexual</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Preferências de Atendimento</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Atende Homens</li>
                        <li><i class="fas fa-check"></i> Atende Mulheres</li>
                        <li><i class="fas fa-check"></i> Atende Trans</li>
                        <li><i class="fas fa-check"></i> Atende Casais</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Especialidades</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Massagem</li>
                        <li><i class="fas fa-check"></i> Acompanhante</li>
                        <li><i class="fas fa-check"></i> Dominação</li>
                        <li><i class="fas fa-check"></i> Submissão</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Eu Faço -->
        <section class="section" id="section-eu-faco" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-spa"></i>
                Eu Faço
            </h2>
            
            <div class="info-card">
                <div class="services-section-detailed">
                    <h5>Eu Faço</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Venda de conteúdo</li>
                        <li><i class="fas fa-check"></i> 24 horas</li>
                        <li><i class="fas fa-check"></i> Viajo até você</li>
                        <li><i class="fas fa-check"></i> Massoterapia</li>
                        <li><i class="fas fa-check"></i> Aceito cartões</li>
                        <li><i class="fas fa-check"></i> Vou à sua casa</li>
                        <li><i class="fas fa-check"></i> Beijo na boca</li>
                        <li><i class="fas fa-check"></i> Gozo Facial</li>
                        <li><i class="fas fa-check"></i> Atendo em dupla</li>
                        <li><i class="fas fa-check"></i> Atendo Mulheres</li>
                        <li><i class="fas fa-check"></i> Casais</li>
                        <li><i class="fas fa-check"></i> Ator pornô</li>
                        <li><i class="fas fa-check"></i> Homem Trans</li>
                        <li><i class="fas fa-check"></i> BDSM</li>
                        <li><i class="fas fa-check"></i> Uso Fantasias</li>
                        <li><i class="fas fa-check"></i> Só brotheragem com masturbação</li>
                        <li><i class="fas fa-check"></i> Podo (trampling, footjob, dirty feet)</li>
                        <li><i class="fas fa-check"></i> Só brotheragem sem penetração</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Corpo</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Atlético</li>
                        <li><i class="fas fa-check"></i> Musculoso</li>
                        <li><i class="fas fa-check"></i> Magro</li>
                        <li><i class="fas fa-check"></i> Gordinho</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Pubis</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Peludos</li>
                        <li><i class="fas fa-check"></i> Depilado</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Estatura</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Alto</li>
                        <li><i class="fas fa-check"></i> Baixo</li>
                        <li><i class="fas fa-check"></i> Mediano</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Serviços Oferecidos -->
        <section class="section">
            <h2 class="section-title">Serviços Oferecidos</h2>
            <div class="info-card">
                <div class="services-section-detailed">
                    <h5>Serviços Básicos</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Beijos na boca</li>
                        <li><i class="fas fa-check"></i> Oral com camisinha</li>
                        <li><i class="fas fa-check"></i> Oral sem camisinha</li>
                        <li><i class="fas fa-check"></i> Oral até o final</li>
                        <li><i class="fas fa-check"></i> Sexo anal</li>
                        <li><i class="fas fa-check"></i> Garganta profunda</li>
                        <li><i class="fas fa-check"></i> Massagem erótica</li>
                        <li><i class="fas fa-check"></i> Namoradinha</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços Especiais</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Beijo negro</li>
                        <li><i class="fas fa-check"></i> Beijo branco</li>
                        <li><i class="fas fa-check"></i> Ejaculação facial</li>
                        <li><i class="fas fa-check"></i> Ejaculação corpo</li>
                        <li><i class="fas fa-check"></i> Chuva dourada</li>
                        <li><i class="fas fa-check"></i> Cubana</li>
                        <li><i class="fas fa-check"></i> PSE</li>
                        <li><i class="fas fa-check"></i> Face fucking</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços de Fetichismo e BDSM</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Fetichismo</li>
                        <li><i class="fas fa-check"></i> Sado submissa</li>
                        <li><i class="fas fa-check"></i> Sado dominadora</li>
                        <li><i class="fas fa-check"></i> Sado suave</li>
                        <li><i class="fas fa-check"></i> Sado duro</li>
                        <li><i class="fas fa-check"></i> Fisting Anal</li>
                        <li><i class="fas fa-check"></i> Brinquedos sexuais</li>
                        <li><i class="fas fa-check"></i> Lingerie</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços de Atendimento em Grupo</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Atenção à casais</li>
                        <li><i class="fas fa-check"></i> Duplas</li>
                        <li><i class="fas fa-check"></i> Trios</li>
                        <li><i class="fas fa-check"></i> Orgia</li>
                        <li><i class="fas fa-check"></i> Festas e eventos</li>
                        <li><i class="fas fa-check"></i> Despedida de solteiro</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços do Perfil e Estilo</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Ativo</li>
                        <li><i class="fas fa-check"></i> Passivo</li>
                        <li><i class="fas fa-check"></i> Versátil</li>
                        <li><i class="fas fa-check"></i> Inversão de papéis</li>
                        <li><i class="fas fa-check"></i> Lésbica</li>
                        <li><i class="fas fa-check"></i> Atenção à mulheres</li>
                        <li><i class="fas fa-check"></i> Experto principiantes</li>
                        <li><i class="fas fa-check"></i> Atenção à deficientes físicos</li>
                    </ul>
                </div>

                <div class="services-section-detailed">
                    <h5>Serviços Extras</h5>
                    <ul class="services-list-detailed">
                        <li><i class="fas fa-check"></i> Fantasias e figurinos</li>
                        <li><i class="fas fa-check"></i> Sem limite</li>
                        <li><i class="fas fa-check"></i> Sexcam</li>
                        <li><i class="fas fa-check"></i> Atendimento em domicílio</li>
                        <li><i class="fas fa-check"></i> Pacotes promocionais</li>
                        <li><i class="fas fa-check"></i> Acompanhante para eventos</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Seção Específica de Massagista -->
        <section class="services-form-section" style="display: none; background: white; border-radius: 15px; padding: 2rem; margin-bottom: 2rem; box-shadow: var(--shadow);">

            <h2 class="section-title">
                <i class="fas fa-spa"></i>
                Meu Anúncio de Massagista
            </h2>

            <p style="color: #666; margin-top: -15px; margin-bottom: 1.5rem;" id="massagista-subtitle">Massoterapeuta</p>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">

                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Tipos de Massagens</h4>

                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="tipos-massagem-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="terapeutica" style="margin-right: 8px;" disabled>
                        <span>Terapêutica</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="relaxante" style="margin-right: 8px;" disabled>
                        <span>Relaxante</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="sensoriais" style="margin-right: 8px;" disabled>
                        <span>Sensoriais</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="corpo-corpo" style="margin-right: 8px;" disabled>
                        <span>Corpo a Corpo</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="tantrica" style="margin-right: 8px;" disabled>
                        <span>Tântrica</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="prostatica" style="margin-right: 8px;" disabled>
                        <span>Prostática</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="tailandesa" style="margin-right: 8px;" disabled>
                        <span>Tailandesa</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="sensual" style="margin-right: 8px;" disabled>
                        <span>Sensual</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="nuru" style="margin-right: 8px;" disabled>
                        <span>Nuru</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="drenagem" style="margin-right: 8px;" disabled>
                        <span>Drenagem linfática</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="esportiva" style="margin-right: 8px;" disabled>
                        <span>Esportiva</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="modeladora" style="margin-right: 8px;" disabled>
                        <span>Modeladora</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="shiatsu" style="margin-right: 8px;" disabled>
                        <span>Shiatsu</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="vivencia" style="margin-right: 8px;" disabled>
                        <span>Vivência</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="reflexologia" style="margin-right: 8px;" disabled>
                        <span>Reflexologia</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="tipos-massagem" value="4-maos" style="margin-right: 8px;" disabled>
                        <span>4 Mãos</span>
                    </label>

                </div>

            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">

                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Massagens Com Finalização</h4>

                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="finalizacao-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="finalizacao" value="masturbacao" style="margin-right: 8px;" disabled>
                        <span>Masturbação</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="finalizacao" value="sexo-oral" style="margin-right: 8px;" disabled>
                        <span>Sexo Oral</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="finalizacao" value="penetracao" style="margin-right: 8px;" disabled>
                        <span>Penetração</span>
                    </label>

                </div>

            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">

                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Serviços Extras</h4>

                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="servicos-extras-massagista-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="depilacao" style="margin-right: 8px;" disabled>
                        <span>Depilação</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="estetica" style="margin-right: 8px;" disabled>
                        <span>Estética</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="reflexologia-podal" style="margin-right: 8px;" disabled>
                        <span>Reflexologia Podal</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="liberacao-miofacial" style="margin-right: 8px;" disabled>
                        <span>Liberação miofacial</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="pedras-quentes" style="margin-right: 8px;" disabled>
                        <span>Pedras quentes</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="massagem-brinquedos" style="margin-right: 8px;" disabled>
                        <span>Massagens com Brinquedos</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="servicos-extras" value="escalda-pes" style="margin-right: 8px;" disabled>
                        <span>Escalda pés</span>
                    </label>

                </div>

            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">

                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Atendimento das Massagens Para</h4>

                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="atendimento-massagem-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="atendimento" value="homens" style="margin-right: 8px;" disabled>
                        <span>Homens</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="atendimento" value="mulheres" style="margin-right: 8px;" disabled>
                        <span>Mulheres</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="atendimento" value="trans" style="margin-right: 8px;" disabled>
                        <span>Trans</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="atendimento" value="casais" style="margin-right: 8px;" disabled>
                        <span>Casais</span>
                    </label>

                </div>

            </div>

            <div class="questionario-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">

                <h4 class="questionario-titulo" style="color: #007bff; font-size: 16px; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">Em Nossas Instalações</h4>

                <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="instalacoes-container">
                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="temos-local" style="margin-right: 8px;" disabled>
                        <span>Temos Local</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="a-domicilio" style="margin-right: 8px;" disabled>
                        <span>A Domicílio</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="em-hotel" style="margin-right: 8px;" disabled>
                        <span>Em Hotel</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="em-motel" style="margin-right: 8px;" disabled>
                        <span>Em Motel</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="ducha" style="margin-right: 8px;" disabled>
                        <span>Ducha</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="banheira" style="margin-right: 8px;" disabled>
                        <span>Banheira</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="maca" style="margin-right: 8px;" disabled>
                        <span>Maca</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="tatami" style="margin-right: 8px;" disabled>
                        <span>Tatami</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="oleos-essenciais" style="margin-right: 8px;" disabled>
                        <span>Óleos Essenciais</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="velas-aromaticas" style="margin-right: 8px;" disabled>
                        <span>Velas Aromáticas</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="musica-relaxante" style="margin-right: 8px;" disabled>
                        <span>Música Relaxante</span>
                    </label>

                    <label style="display: flex; align-items: center; cursor: pointer; padding: 8px 12px; background: white; border: 2px solid #e0e0e0; border-radius: 20px; transition: all 0.3s;">
                        <input type="checkbox" name="instalacoes" value="material-descartavel" style="margin-right: 8px;" disabled>
                        <span>Material Descartável</span>
                    </label>

                </div>

            </div>

        </section>

        <!-- Contact Section - Nosso Espaço -->
        <section class="contact-section">
            <h2 class="section-title">
                <i class="fas fa-user-circle"></i>
                Nosso Espaço
            </h2>
            <div class="contact-buttons">
                <a href="#" class="contact-btn verde" style="opacity: 0.5; pointer-events: none; cursor: not-allowed;">
                    <i class="fas fa-eye"></i>
                    Comprar Visibilidade
                </a>
                <a href="#" class="contact-btn laranja" style="opacity: 0.5; pointer-events: none; cursor: not-allowed;">
                    <i class="fas fa-cog"></i>
                    Painel de Controle
                </a>
                <a href="#" class="contact-btn vermelho" style="opacity: 0.5; pointer-events: none; cursor: not-allowed;">
                    <i class="fas fa-trash"></i>
                    Eliminar Anuncio
                </a>
                <a href="#" class="contact-btn amarelo" style="opacity: 0.5; pointer-events: none; cursor: not-allowed;">
                    <i class="fas fa-flag"></i>
                    Denunciar Anuncio
                </a>
            </div>
        </section>
    </main>

    <!-- Modal for Gallery -->
    <!-- Modal do Carrossel de Galeria -->
    <div id="gallery-modal" class="gallery-modal" style="display: none;">
        <div class="gallery-modal-backdrop"></div>
        <button class="gallery-modal-close" id="gallery-close-btn" aria-label="Fechar">
            <i class="fas fa-times"></i>
        </button>
        <button class="gallery-modal-prev" id="gallery-prev-btn" aria-label="Foto anterior">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="gallery-modal-next" id="gallery-next-btn" aria-label="Próxima foto">
            <i class="fas fa-chevron-right"></i>
        </button>
        <div class="gallery-modal-content">
            <img class="gallery-modal-image" id="gallery-modal-image" src="" alt="Foto da galeria">
            <div class="gallery-modal-counter">
                <span id="gallery-current-index">1</span> / <span id="gallery-total-count">1</span>
            </div>
        </div>
    </div>

    <!-- Modal de Mensagem -->
    <div id="message-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Enviar Mensagem</h3>
                <span class="close" onclick="closeMessageModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="message-form">
                    <div class="form-group">
                        <label for="message-name">Seu Nome:</label>
                        <input type="text" id="message-name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="message-email">Seu E-mail:</label>
                        <input type="email" id="message-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message-phone">Seu Telefone:</label>
                        <input type="tel" id="message-phone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="message-text">Mensagem:</label>
                        <textarea id="message-text" name="message" rows="5" required placeholder="Digite sua mensagem aqui..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeMessageModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Enviar Mensagem</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Inicializar Firebase
        let db = null;
        let auth = null;
        
        // Função para lidar com clique no botão voltar
        function handleBackClick(event) {
            event.preventDefault();
            
            // Verificar se há parâmetro returnPage na URL
            const urlParams = new URLSearchParams(window.location.search);
            const returnPage = urlParams.get('returnPage');
            
            if (returnPage) {
                // Redirecionar para a página de origem salva
                console.log(`🔄 Voltando para página de origem: ${returnPage}`);
                window.location.href = returnPage;
                return false;
            }
            
            // Se não há returnPage, verificar o referrer
            if (window.history.length > 1) {
                const referrer = document.referrer;
                // Se veio da página de listagem, usar history.back()
                if (referrer.includes('A_02__premium_copy.html') || 
                    referrer.includes('premium_copy') || 
                    referrer.includes('sexo-virtual_copy') ||
                    referrer.includes('massagistas')) {
                    window.history.back();
                    return false;
                }
            }
            
            // Caso contrário, voltar para a página padrão de mulheres
            window.location.href = 'A_02__premium_copy.html';
            return false;
        }
        
        // Aguardar Firebase estar pronto e carregar dados
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 DOMContentLoaded - Inicializando página...');
            
            // Verificar se está em modo de teste
            const urlParams = new URLSearchParams(window.location.search);
            const modoTeste = urlParams.get('teste') || urlParams.get('simular');
            
            if (modoTeste === '1') {
                console.log('🧪 Modo de teste detectado! Carregando dados simulados...');
                // Aguardar um pouco para garantir que o DOM está totalmente carregado
                setTimeout(() => {
                    const jsonTeste = {
                        "nome": "Rapariga",
                        "descricao": "fazemos as massagem mais intrigantes de todas as massagistas do difederalOlá meus amores. Estou de volta a Brasília, daquele jeitinho que vcs já conhecem, meiga e abusada, e louca p te dar prazer. Ambiente de fácil acesso, limpo e climatizado. Será, literalmente, um prazer. Ofereço serviço de podolatria. Atendimento para homens de alto nivel",
                        "frase-efeito": "sou uma rapariga de primeira linha e faco uma massagem das mais legais de sua vida ",
                        "frase_efeito": "sou uma rapariga de primeira linha e faco uma massagem das mais legais de sua vida ",
                        "telefone_celular": "(61) 98484-8848",
                        "telefone_fixo": "(11) 3232-3232",
                        "idade": "22",
                        "peso": "99",
                        "altura": "177",
                        "oral-sem": "sim",
                        "oral_sem": "sim",
                        "beija": "sim",
                        "anal": "sim",
                        "local": "sim",
                        "mora-so": "sim",
                        "mora_so": "sim",
                        "valor": "500",
                        "horario_24h": "sim",
                        "horario_inicio": "",
                        "horario_fim": "",
                        "atende": [
                            "ele",
                            "ela",
                            "casais"
                        ],
                        "pagamento": [
                            "dinheiro",
                            "credito"
                        ],
                        "servicos": [
                            "beijos-boca",
                            "beijo-negro",
                            "fetichismo",
                            "atencao-casais",
                            "ativo",
                            "fantasias-figurinos"
                        ],
                        "estado": "AM",
                        "cidade": "itacoatiara",
                        "files": {
                            "foto_banner": {},
                            "foto_capa": {},
                            "galeria": [
                                {
                                    "campo": "galeria_1",
                                    "arquivo": "a1.jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 64209,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_2",
                                    "arquivo": "avatar (4).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 33391,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_3",
                                    "arquivo": "avatar (13).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 24356,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_4",
                                    "arquivo": "gallery-1754067033866-783292598.jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 8807,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_5",
                                    "arquivo": "foto (25).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 9448,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_6",
                                    "arquivo": "foto (20).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 7847,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_7",
                                    "arquivo": "avatar (2).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 40910,
                                    "isVideo": false,
                                    "isStories": false
                                },
                                {
                                    "campo": "galeria_9",
                                    "arquivo": "avatar (4).jpg",
                                    "tipo": "image/jpeg",
                                    "tamanho": 33391,
                                    "isVideo": false,
                                    "isStories": true
                                }
                            ]
                        },
                        "created_at": "2025-11-05T00:32:16.945Z",
                        "updated_at": "2025-11-05T00:32:16.945Z",
                        "status": "rascunho"
                    };
                    if (window.simularCarregamentoDados) {
                        simularCarregamentoDados(jsonTeste);
                    } else {
                        console.error('❌ Função simularCarregamentoDados não encontrada!');
                    }
                }, 1000);
                return; // Não tentar carregar do Firebase
            }
            
            if (typeof firebase !== 'undefined' && window.firebaseConfig) {
                try {
                    firebase.initializeApp(firebaseConfig);
                    db = firebase.firestore();
                    auth = firebase.auth();
                    console.log('✅ Firebase inicializado com sucesso na página de perfil');
                    
                    // Aguardar um pouco para garantir que o Firebase está totalmente pronto
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // Agora carregar os dados do perfil
                    console.log('📥 Chamando loadProfileData...');
                    await loadProfileData();
                } catch (e) {
                    console.error('❌ Erro ao inicializar Firebase:', e);
                    // Mesmo com erro, tentar carregar dados
                    setTimeout(() => loadProfileData(), 1000);
                }
            } else {
                console.error('❌ Firebase não configurado. Verifique firebase-config.js');
                // Tentar carregar dados mesmo sem Firebase (pode estar usando dados estáticos)
                setTimeout(() => loadProfileData(), 500);
            }
        });

        // Função para obter parâmetros da URL
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Função para carregar dados do perfil do Firebase
        async function loadProfileData() {
            try {
                console.log('🔥 Iniciando loadProfileData...');
                
                const profileId = getUrlParameter('id');
                const profileName = getUrlParameter('name');
                
                console.log('📋 Parâmetros da URL:', { id: profileId, name: profileName });
                
                if (!profileId && !profileName) {
                    console.error('❌ ID ou nome do perfil não fornecido');
                    return;
                }

                // Aguardar Firebase estar inicializado (até 5 segundos)
                let attempts = 0;
                const maxAttempts = 50; // 50 tentativas x 100ms = 5 segundos
                while (!db && attempts < maxAttempts) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                    attempts++;
                    if (typeof firebase !== 'undefined' && window.firebaseConfig && !db) {
                        try {
                            firebase.initializeApp(firebaseConfig);
                            db = firebase.firestore();
                            auth = firebase.auth();
                            console.log('✅ Firebase inicializado dentro de loadProfileData');
                        } catch (e) {
                            console.warn('⚠️ Erro ao inicializar Firebase (tentativa ' + attempts + '):', e);
                        }
                    }
                }
                
                if (!db) {
                    const errorMsg = "Firebase não inicializado após " + (maxAttempts * 100) + "ms. Verifique firebase-config.js";
                    console.error('❌', errorMsg);
                    throw new Error(errorMsg);
                }
                
                console.log('✅ Firebase pronto para buscar dados');

                let anuncio = null;
                
                // Tentar buscar por ID primeiro
                if (profileId) {
                    console.log(`🔍 Buscando anúncio por ID: "${profileId}"`);
                    console.log(`📊 Tipo do ID: ${typeof profileId}, Tamanho: ${profileId.length}`);
                    
                    // Tentar coleção 'anuncios'
                    try {
                        console.log('🔎 Tentando buscar na coleção "anuncios"...');
                        const docRef = db.collection('anuncios').doc(profileId);
                        console.log('📄 Referência do documento:', docRef.path);
                        
                        const doc = await docRef.get();
                        console.log('📋 Documento retornado - exists:', doc.exists, 'id:', doc.id);
                        
                        if (doc.exists) {
                            anuncio = { id: doc.id, ...doc.data() };
                            console.log('✅ Anúncio encontrado na coleção "anuncios"!');
                            console.log('📝 Dados do anúncio:', {
                                id: anuncio.id,
                                nome: anuncio.nome,
                                email: anuncio.email,
                                status: anuncio.status,
                                plano: anuncio.plano,
                                status_pagamento: anuncio.status_pagamento,
                                tem_foto_capa: !!anuncio.foto_capa,
                                tem_foto_banner: !!anuncio.foto_banner,
                                todas_chaves: Object.keys(anuncio)
                            });
                            console.log('✅ Status do anúncio:', anuncio.status, '- Isso NÃO impede a exibição na página de perfil');
                        } else {
                            console.warn('⚠️ Documento não existe na coleção "anuncios" com ID:', profileId);
                            console.warn('🔍 Tentando verificar se o ID está correto...');
                            
                            // Listar alguns documentos para debug
                            try {
                                const sampleDocs = await db.collection('anuncios').limit(5).get();
                                console.log('📋 Primeiros 5 documentos na coleção "anuncios":', 
                                    sampleDocs.docs.map(d => ({ id: d.id, nome: d.data().nome }))
                                );
                            } catch (e) {
                                console.error('❌ Erro ao listar documentos:', e);
                            }
                        }
                    } catch (e) {
                        console.error('❌ Erro ao buscar na coleção "anuncios":', e);
                        console.error('📋 Detalhes do erro:', {
                            message: e.message,
                            code: e.code,
                            stack: e.stack
                        });
                    }
                    
                    // Se não encontrou, tentar coleção 'advertisements'
                    if (!anuncio) {
                        try {
                            console.log('🔎 Tentando buscar na coleção "advertisements"...');
                            const docRef = db.collection('advertisements').doc(profileId);
                            const doc = await docRef.get();
                            
                            if (doc.exists) {
                                anuncio = { id: doc.id, ...doc.data() };
                                console.log('✅ Anúncio encontrado na coleção "advertisements"!');
                                console.log('📝 Dados do anúncio:', {
                                    id: anuncio.id,
                                    nome: anuncio.nome,
                                    email: anuncio.email
                                });
                            } else {
                                console.warn('⚠️ Documento não existe na coleção "advertisements" com ID:', profileId);
                            }
                        } catch (e) {
                            console.error('❌ Erro ao buscar na coleção "advertisements":', e);
                        }
                    }
                    
                    // Se ainda não encontrou, tentar coleção 'advertisers' (onde pode estar o ID do usuário)
                    if (!anuncio) {
                        try {
                            console.log('🔎 Tentando buscar na coleção "advertisers"...');
                            // Primeiro tentar buscar o documento diretamente
                            const docRef = db.collection('advertisers').doc(profileId);
                            let doc = await docRef.get();
                            
                            if (!doc.exists) {
                                // Tentar buscar pelo nome "Bebel do mel"
                                console.log('🔎 Buscando por nome na coleção "advertisers"...');
                                const snapshot = await db.collection('advertisers')
                                    .where('nome', '==', profileName || 'Bebel do mel')
                                    .limit(1)
                                    .get();
                                if (!snapshot.empty) {
                                    doc = snapshot.docs[0];
                                    console.log('✅ Encontrado na coleção "advertisers" por nome:', doc.id);
                                }
                            }
                            
                            if (doc.exists) {
                                const advertiserData = doc.data();
                                console.log('📋 Dados do advertiser:', advertiserData);
                                
                                // Agora buscar o anúncio relacionado na coleção 'anuncios'
                                // O ID do anúncio pode estar no campo userId ou similar
                                if (advertiserData.userId || advertiserData.anuncioId) {
                                    const anuncioId = advertiserData.anuncioId || advertiserData.userId;
                                    console.log('🔎 Buscando anúncio relacionado com ID:', anuncioId);
                                    
                                    const anuncioDoc = await db.collection('anuncios').doc(anuncioId).get();
                                    if (anuncioDoc.exists) {
                                        anuncio = { id: anuncioDoc.id, ...anuncioDoc.data() };
                                        console.log('✅ Anúncio encontrado relacionado ao advertiser!');
                                    }
                                }
                            }
                        } catch (e) {
                            console.error('❌ Erro ao buscar na coleção "advertisers":', e);
                        }
                    }
                }
                
                // Se não encontrou por ID, tentar por nome
                if (!anuncio && profileName) {
                    console.log(`🔍 Buscando anúncio por nome: ${profileName}`);
                    
                    try {
                        // Buscar na coleção 'anuncios'
                        let snapshot = await db.collection('anuncios')
                            .where('nome', '>=', profileName)
                            .where('nome', '<=', profileName + '\uf8ff')
                            .limit(1)
                            .get();
                        
                        if (snapshot.empty) {
                            // Tentar coleção 'advertisements'
                            snapshot = await db.collection('advertisements')
                                .where('nome', '>=', profileName)
                                .where('nome', '<=', profileName + '\uf8ff')
                                .limit(1)
                                .get();
                        }
                        
                        if (!snapshot.empty) {
                            const doc = snapshot.docs[0];
                            anuncio = { id: doc.id, ...doc.data() };
                            console.log('✅ Anúncio encontrado por nome:', anuncio);
                        }
                    } catch (e) {
                        console.warn('⚠️ Erro ao buscar por nome:', e);
                    }
                }

                if (!anuncio) {
                    console.error('❌ Anúncio não encontrado no Firebase');
                    alert('Anúncio não encontrado. Verifique se o ID ou nome está correto.');
                    return;
                }

                // ============================================
                // MODERAÇÃO: Bloquear exibição se não aprovado
                // ============================================
                const statusAnuncio = (anuncio.status || '').toLowerCase().trim();
                if (statusAnuncio !== 'approved') {
                    const currentUserAuth = auth ? auth.currentUser : null;
                    const isOwner = currentUserAuth && (
                        currentUserAuth.uid === anuncio.advertiserId || 
                        currentUserAuth.email === anuncio.userEmail
                    );
                    
                    if (!isOwner) {
                        console.warn('🚫 Anúncio não aprovado. Status:', statusAnuncio);
                        alert('Este anúncio não está disponível no momento.');
                        const returnPage = getUrlParameter('returnPage') || 'A_02__premium_massagistas_copy.html';
                        window.location.href = returnPage;
                        return;
                    } else {
                        console.log('⚠️ Anúncio pendente/rejeitado, mas o dono está visualizando. Status:', statusAnuncio);
                    }
                }

                console.log('✅ Anúncio carregado com sucesso!');
                console.log('📋 ========== DADOS COMPLETOS DO ANÚNCIO ==========');
                console.log('📋 ID do documento:', anuncio.id);
                console.log('📋 Nome:', anuncio.nome || anuncio.name || 'NÃO ENCONTRADO');
                console.log('📋 Foto Banner:', anuncio.foto_banner || anuncio.foto_banner_url || 'NÃO ENCONTRADO');
                console.log('📋 Foto Capa:', anuncio.foto_capa || anuncio.foto_capa_url || 'NÃO ENCONTRADO');
                console.log('📋 Status:', anuncio.status);
                console.log('📋 Plano:', anuncio.plano);
                console.log('📋 Todas as chaves disponíveis:', Object.keys(anuncio));
                console.log('📋 Estrutura JSON completa:', JSON.stringify(anuncio, null, 2));

                // Verificar se os elementos do DOM existem antes de atualizar
                console.log('🔍 Verificando elementos do DOM...');
                const profileNameEl = document.getElementById('profile-name');
                const profileLevelEl = document.getElementById('profile-level');
                const profileDescEl = document.getElementById('profile-description');
                
                console.log('📝 Elementos encontrados:', {
                    profileName: !!profileNameEl,
                    profileLevel: !!profileLevelEl,
                    profileDescription: !!profileDescEl
                });
                
                if (!profileNameEl || !profileLevelEl || !profileDescEl) {
                    console.warn('⚠️ Alguns elementos do DOM não foram encontrados. Aguardando...');
                    await new Promise(resolve => setTimeout(resolve, 500));
                }

                // Atualizar dados do perfil
                console.log('🔄 Chamando updateProfileData...');
                await updateProfileData(anuncio);
                console.log('✅ updateProfileData concluído');
                
                // Carregar dados específicos de massagista
                console.log('💆 Chamando loadMassagistaData...');
                loadMassagistaData(anuncio);
                console.log('✅ loadMassagistaData concluído');
                
                // Carregar galeria
                console.log('🖼️ Chamando loadGallery...');
                loadGallery(anuncio);
                console.log('✅ loadGallery concluído');
                
            } catch (error) {
                console.error('❌ Erro ao carregar dados do perfil:', error);
                alert('Erro ao carregar dados do anúncio. Tente novamente.');
            }
        }

        // Função para atualizar dados do perfil
        async function updateProfileData(anuncio) {
            console.log('📝 ========== INICIANDO updateProfileData ==========');
            console.log('📝 Anúncio recebido:', {
                id: anuncio.id,
                nome: anuncio.nome,
                name: anuncio.name,
                descricao: anuncio.descricao || anuncio.description || '',
                descricao_original: anuncio.descricao,
                description_original: anuncio.description,
                plano: anuncio.plano,
                nivel: anuncio.nivel,
                status: anuncio.status,
                todas_chaves: Object.keys(anuncio)
            });
            
            // Verificar campos relacionados à descrição e frase de efeito
            const camposDescricao = Object.keys(anuncio).filter(k => 
                k.toLowerCase().includes('descricao') || 
                k.toLowerCase().includes('description') ||
                k.toLowerCase().includes('bio') ||
                k.toLowerCase().includes('sobre')
            );
            const camposFraseEfeito = Object.keys(anuncio).filter(k => 
                k.toLowerCase().includes('frase') || 
                k.toLowerCase().includes('efeito') ||
                k.toLowerCase().includes('tagline') ||
                k.toLowerCase().includes('slogan')
            );
            console.log('📋 Campos relacionados à descrição encontrados:', camposDescricao);
            console.log('📋 Campos relacionados à frase de efeito encontrados:', camposFraseEfeito);
            if (camposDescricao.length > 0) {
                camposDescricao.forEach(campo => {
                    console.log(`  - ${campo}:`, anuncio[campo]?.substring(0, 100) + (anuncio[campo]?.length > 100 ? '...' : ''));
                });
            }
            if (camposFraseEfeito.length > 0) {
                camposFraseEfeito.forEach(campo => {
                    console.log(`  - ${campo}:`, anuncio[campo]);
                });
            }
            
            // MODERAÇÃO: Anúncios não aprovados são bloqueados no check acima.
            // Apenas anúncios com status "approved" ou visualizados pelo dono são exibidos.
            
            // Atualizar banner
            const profileBanner = document.getElementById('profile-banner');
            console.log('🖼️ Buscando elemento profile-banner:', profileBanner);
            
            if (profileBanner) {
                // Tentar múltiplos campos possíveis para o banner
                // Verificar também em objetos aninhados (mediaFiles, etc)
                const bannerUrl = anuncio.foto_banner_url || 
                                  anuncio.foto_banner || 
                                  anuncio.banner_url || 
                                  anuncio.bannerImage ||
                                  anuncio.mediaFiles?.foto_banner ||
                                  anuncio.mediaFiles?.foto_banner_url ||
                                  anuncio.mediaFiles?.banner ||
                                  (anuncio.mediaFiles && typeof anuncio.mediaFiles === 'object' ? 
                                    Object.values(anuncio.mediaFiles).find(v => 
                                      typeof v === 'string' && v.includes('banner')
                                    ) : null) ||
                                  null;
                
                console.log('🔍 ========== VERIFICAÇÃO DE BANNER ==========');
                console.log('🔍 Campos de banner verificados:', {
                    foto_banner_url: anuncio.foto_banner_url,
                    foto_banner: anuncio.foto_banner,
                    banner_url: anuncio.banner_url,
                    bannerImage: anuncio.bannerImage,
                    mediaFiles_foto_banner: anuncio.mediaFiles?.foto_banner,
                    mediaFiles_foto_banner_url: anuncio.mediaFiles?.foto_banner_url,
                    mediaFiles_completo: anuncio.mediaFiles,
                    resultado_encontrado: bannerUrl
                });
                console.log('🔍 Tipo do bannerUrl:', typeof bannerUrl);
                console.log('🔍 Valor do bannerUrl:', bannerUrl);
                
                if (bannerUrl) {
                    let finalBannerUrl = bannerUrl;
                    
                    // Se é uma URL completa, usar diretamente
                    if (typeof bannerUrl === 'string' && (bannerUrl.startsWith('http://') || bannerUrl.startsWith('https://'))) {
                        finalBannerUrl = bannerUrl;
                    } 
                    // Se é um caminho do Firebase Storage (gs://), converter
                    else if (typeof bannerUrl === 'string' && bannerUrl.startsWith('gs://')) {
                        const path = bannerUrl.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
                        finalBannerUrl = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                    } 
                    // Se é um nome de arquivo simples (ex: "foto_banner_1761936697295_banner-1754069202781-935737209.jpg")
                    else if (typeof bannerUrl === 'string' && !bannerUrl.includes('://')) {
                        // Usar estrutura padronizada 'advertisements/ID_ANUNCIO/' (compatibilidade com anuncios/ mantida)
                        const anuncioId = anuncio.id;
                        const path = `advertisements/${anuncioId}/${bannerUrl}`;
                        finalBannerUrl = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                        
                        // Fallback para estrutura antiga (compatibilidade)
                        const pathAntigo = `anuncios/${anuncioId}/${bannerUrl}`;
                        const urlAntiga = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(pathAntigo)}?alt=media`;
                        
                        console.log('🖼️ Tentando URL com caminho completo:', finalBannerUrl);
                        console.log('🖼️ Tentando URL na raiz:', urlRaiz);
                    }
                    
                    console.log('📝 Valor ANTES da atualização:', profileBanner.src);
                    profileBanner.src = finalBannerUrl;
                    profileBanner.style.opacity = '1'; // Mostrar imagem quando carregada
                    console.log('📝 Valor DEPOIS da atualização:', profileBanner.src);
                    console.log('✅ Banner atualizado com sucesso!');
                    
                    // Garantir que a imagem apareça mesmo se já estiver em cache
                    profileBanner.onload = function() {
                        this.style.opacity = '1';
                    };
                    
                    // Tratamento de erro na imagem
                    profileBanner.onerror = function() {
                        console.error('❌ Erro ao carregar banner:', finalBannerUrl);
                        // Tentar URLs alternativas
                        const alternativas = [
                            `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(bannerUrl)}?alt=media`,
                            `https://storage.googleapis.com/copia-do-job.firebasestorage.app/${encodeURIComponent(bannerUrl)}`
                        ];
                        console.log('🔄 Tentando URLs alternativas:', alternativas);
                    };
                } else {
                    console.warn('⚠️ Nenhuma URL de banner encontrada no anúncio');
                }
            } else {
                console.error('❌ Elemento profile-banner não encontrado no DOM!');
            }
            
            // Atualizar foto de perfil
            const profileImage = document.getElementById('profile-image');
            if (profileImage) {
                const imageUrl = anuncio.foto_capa_url || anuncio.foto_capa || anuncio.fotoPerfil || anuncio.coverImage || anuncio.image;
                if (imageUrl) {
                    // Se é uma URL completa, usar diretamente
                    if (imageUrl.startsWith('http://') || imageUrl.startsWith('https://')) {
                        profileImage.src = imageUrl;
                    } else if (imageUrl.startsWith('gs://')) {
                        // Converter gs:// para URL HTTP
                        const path = imageUrl.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
                        profileImage.src = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                    } else {
                        // Assumir que é um caminho
                        const path = imageUrl.replace(/^\/+/, '');
                        profileImage.src = `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                    }
                    profileImage.style.opacity = '1'; // Mostrar imagem quando carregada
                    console.log('🖼️ Foto de perfil atualizada:', profileImage.src);
                    
                    // Garantir que a imagem apareça mesmo se já estiver em cache
                    profileImage.onload = function() {
                        this.style.opacity = '1';
                    };
                }
            }
            
            // Atualizar nome - com múltiplas tentativas
            // Verificar TODOS os campos possíveis de nome
            const nomeAnuncio = anuncio.nome || 
                                anuncio.name || 
                                anuncio.nomeAnuncio ||
                                anuncio.nomeCompleto ||
                                anuncio.nome_completo ||
                                anuncio.advertiserName ||
                                anuncio.title ||
                                'Nome não disponível';
            
            console.log('✏️ ========== VERIFICAÇÃO DE NOME ==========');
            console.log('✏️ Nome a ser atualizado:', nomeAnuncio);
            console.log('📋 Campos de nome verificados (em ordem de prioridade):', {
                '1. nome (PRIORIDADE)': anuncio.nome,
                '2. name': anuncio.name,
                '3. nomeAnuncio': anuncio.nomeAnuncio,
                '4. nomeCompleto': anuncio.nomeCompleto,
                '5. nome_completo': anuncio.nome_completo,
                '6. advertiserName': anuncio.advertiserName,
                '7. title': anuncio.title,
                '✅ RESULTADO FINAL': nomeAnuncio
            });
            const camposComNome = Object.keys(anuncio).filter(k => k.toLowerCase().includes('nome'));
            console.log('📋 Todos os campos do anúncio que contêm "nome":', camposComNome);
            
            let profileName = document.getElementById('profile-name');
            if (!profileName) {
                console.warn('⚠️ Elemento profile-name não encontrado. Tentando novamente em 200ms...');
                await new Promise(resolve => setTimeout(resolve, 200));
                profileName = document.getElementById('profile-name');
            }
            
            if (profileName) {
                console.log('✅ Elemento profile-name encontrado!');
                console.log('📝 Valor ANTES:', profileName.textContent);
                profileName.textContent = nomeAnuncio;
                console.log('📝 Valor DEPOIS:', profileName.textContent);
                
                // Verificar se realmente foi atualizado
                if (profileName.textContent === nomeAnuncio) {
                    console.log('✅ Nome atualizado com sucesso!');
                } else {
                    console.error('❌ ERRO: Nome não foi atualizado! Esperado:', nomeAnuncio, 'Atual:', profileName.textContent);
                    // Tentar forçar atualização
                    profileName.innerHTML = nomeAnuncio;
                    console.log('🔄 Tentativa de forçar atualização com innerHTML');
                }
            } else {
                console.error('❌ Elemento profile-name NÃO encontrado no DOM após 2 tentativas!');
                console.error('🔍 Tentando buscar todos os elementos com "profile":', 
                    Array.from(document.querySelectorAll('[id*="profile"]')).map(el => el.id)
                );
            }

            // Atualizar nível/plano
            const profileLevel = document.getElementById('profile-level');
            if (profileLevel) {
                let levelText = 'Plus';
                const plano = (anuncio.plano || anuncio.nivel || '').toLowerCase();
                if (plano === 'camarote' || plano.includes('n1')) {
                    levelText = 'Camarote - Premium VIP';
                } else if (plano === 'especial' || plano.includes('n3')) {
                    levelText = 'Especial - Destaque';
                } else if (plano === 'plus' || plano.includes('n7')) {
                    levelText = 'Plus - Padrão';
                } else if (plano === 'basico') {
                    levelText = 'Básico';
                }
                profileLevel.textContent = levelText;
            }

            // Atualizar FRASE DE EFEITO no profile-description (parágrafo pequeno)
            const profileDescription = document.getElementById('profile-description');
            if (profileDescription) {
                // Buscar frase de efeito em múltiplos campos possíveis
                const fraseEfeito = anuncio['frase-efeito'] || 
                                   anuncio.frase_efeito || 
                                   anuncio.fraseEfeito ||
                                   anuncio.frase_efeito_anuncio ||
                                   anuncio.tagline ||
                                   anuncio.slogan ||
                                   '';
                
                if (fraseEfeito) {
                    profileDescription.textContent = fraseEfeito;
                    console.log('✅ Frase de efeito atualizada no profile-description:', fraseEfeito);
                } else {
                    // Se não tiver frase de efeito, usar início da descrição (máximo 150 caracteres)
                    const descricao = anuncio.descricao || anuncio.description || '';
                    if (descricao) {
                        const preview = descricao.length > 150 ? descricao.substring(0, 150) + '...' : descricao;
                        profileDescription.textContent = preview;
                        console.log('⚠️ Frase de efeito não encontrada, usando início da descrição:', preview);
                    } else {
                        profileDescription.textContent = 'Descrição não disponível';
                        console.warn('⚠️ Nem frase de efeito nem descrição encontradas');
                    }
                }
            }
            
            // Atualizar DESCRIÇÃO COMPLETA na seção de descrição
            const descriptionText = document.getElementById('description-text');
            if (descriptionText) {
                // Buscar descrição completa em múltiplos campos
                const descricao = anuncio.descricao || 
                                anuncio.description || 
                                anuncio.descricao_completa ||
                                anuncio.bio ||
                                anuncio.sobre_mim ||
                                'Descrição não disponível';
                
                descriptionText.textContent = descricao;
                console.log('✅ Descrição completa atualizada no description-text:', {
                    tamanho: descricao.length,
                    preview: descricao.substring(0, 100) + (descricao.length > 100 ? '...' : '')
                });
            } else {
                console.warn('⚠️ Elemento description-text não encontrado. Tentando novamente em 200ms...');
                await new Promise(resolve => setTimeout(resolve, 200));
                const descriptionTextRetry = document.getElementById('description-text');
                if (descriptionTextRetry) {
                    const descricao = anuncio.descricao || 
                                    anuncio.description || 
                                    anuncio.descricao_completa ||
                                    'Descrição não disponível';
                    descriptionTextRetry.textContent = descricao;
                    console.log('✅ Descrição completa atualizada no description-text (tentativa 2):', descricao.substring(0, 100) + '...');
                } else {
                    console.error('❌ Elemento description-text NÃO encontrado após 2 tentativas!');
                }
            }

            // Preencher campos obrigatórios
            loadBasicInfo(anuncio);
            
            // Preencher campos opcionais (só mostrar se preenchidos)
            loadOptionalInfo(anuncio);
            
            // Atualizar serviços e preços
            updateServicesAndPrices(anuncio);
            
            
            // Controlar visibilidade de seções baseado no gênero
            controlSectionVisibility(anuncio);
            
            // Atualizar serviços oferecidos
            updateServicosOferecidos(anuncio);
            
            // Atualizar botões de contato
            updateContactButtons(anuncio);
            
            // Atualizar título da página
            document.title = `Perfil - ${nomeAnuncio} | Premium VIP`;
        }
        
        // Função para controlar visibilidade de seções baseado no gênero
        function controlSectionVisibility(anuncio) {
            const genero = (anuncio.genero || anuncio.gender || '').toLowerCase();
            const categoria = (anuncio.categoria || anuncio.category || '').toLowerCase();
            
            const isHomem = genero === 'homem' || categoria === 'homem';
            const isTrans = genero === 'trans' || categoria === 'trans';
            // Verificar se é mulher acompanhante (considerando variações possíveis)
            const isMulherAcompanhante = genero === 'mulher' && 
                (categoria === 'acompanhante' || 
                 categoria === 'acompanhantes' ||
                 categoria === 'mulher' ||
                 categoria === 'feminino' ||
                 categoria === 'female' ||
                 // Se categoria estiver vazia mas genero for mulher, considerar como acompanhante
                 (categoria === '' && genero === 'mulher'));
            
            const sectionHomemInfo = document.getElementById('section-homem-info');
            const sectionEuFaco = document.getElementById('section-eu-faco');
            
            // Mostrar apenas se for homem ou trans
            if (sectionHomemInfo) {
                sectionHomemInfo.style.display = (isHomem || isTrans) ? 'block' : 'none';
                console.log(`📋 Seção "Informações Específicas - Homem": ${(isHomem || isTrans) ? 'VISÍVEL' : 'OCULTA'}`);
            }
            
            if (sectionEuFaco) {
                sectionEuFaco.style.display = (isHomem || isTrans) ? 'block' : 'none';
                console.log(`📋 Seção "Eu Faço": ${(isHomem || isTrans) ? 'VISÍVEL' : 'OCULTA'}`);
            }
            
        }
        
        // Função para atualizar serviços oferecidos
        function updateServicosOferecidos(anuncio) {
            console.log('🛠️ Atualizando serviços oferecidos...');
            console.log('📋 ========== DIAGNÓSTICO COMPLETO DO ANÚNCIO ==========');
            console.log('📋 ID do anúncio:', anuncio.id);
            console.log('📋 Nome do anúncio:', anuncio.nome || anuncio.name);
            console.log('📋 TODOS os campos do anúncio:', Object.keys(anuncio));
            console.log('📋 Dados do anúncio para serviços:', {
                servicos: anuncio.servicos,
                servicos_oferecidos: anuncio.servicos_oferecidos,
                beija: anuncio.beija,
                anal: anuncio.anal,
                'oral-sem': anuncio['oral-sem'],
                'oral-com': anuncio['oral-com'],
                todas_chaves: Object.keys(anuncio).filter(k => k.toLowerCase().includes('servico') || k.toLowerCase().includes('beija') || k.toLowerCase().includes('anal') || k.toLowerCase().includes('oral'))
            });
            
            // Verificar TIPO dos campos de serviços
            if (anuncio.servicos) {
                console.log('📋 Tipo do campo "servicos":', typeof anuncio.servicos);
                console.log('📋 É array?', Array.isArray(anuncio.servicos));
                console.log('📋 Valor completo:', JSON.stringify(anuncio.servicos, null, 2));
            }
            if (anuncio.servicos_oferecidos) {
                console.log('📋 Tipo do campo "servicos_oferecidos":', typeof anuncio.servicos_oferecidos);
                console.log('📋 É array?', Array.isArray(anuncio.servicos_oferecidos));
                console.log('📋 Valor completo:', JSON.stringify(anuncio.servicos_oferecidos, null, 2));
            }
            
            // Mapeamento de valores do checkbox (como salvos no Firebase) para textos exibidos
            const checkboxToDisplayMap = {
                // MAPEAMENTO REVERSO: Nomes completos que vêm do Firebase também mapeiam para si mesmos
                // (para quando os serviços são salvos como texto completo em vez de slugs)
                'beijo branco': 'Beijo branco',
                'beijo negro': 'Beijo negro',
                'ejaculação facial': 'Ejaculação facial',
                'ejaculação corpo': 'Ejaculação corpo',
                'chuva dourada': 'Chuva dourada',
                'face fucking': 'Face fucking',
                'beijos na boca': 'Beijos na boca',
                'oral com camisinha': 'Oral com camisinha',
                'oral sem camisinha': 'Oral sem camisinha',
                'oral até o final': 'Oral até o final',
                'sexo anal': 'Sexo anal',
                'garganta profunda': 'Garganta profunda',
                'massagem erótica': 'Massagem erótica',
                // Serviços Básicos
                'beijos-boca': 'Beijos na boca',
                'beijos_na_boca': 'Beijos na boca',
                'beijo-na-boca': 'Beijos na boca',
                'oral-com-camisinha': 'Oral com camisinha',
                'oral_com_camisinha': 'Oral com camisinha',
                'oral-com': 'Oral com camisinha',
                'oral-sem-camisinha': 'Oral sem camisinha',
                'oral_sem_camisinha': 'Oral sem camisinha',
                'oral-sem': 'Oral sem camisinha',
                'oral-ate-final': 'Oral até o final',
                'oral_ate_final': 'Oral até o final',
                'sexo-anal': 'Sexo anal',
                'sexo_anal': 'Sexo anal',
                'garganta-profunda': 'Garganta profunda',
                'garganta_profunda': 'Garganta profunda',
                'massagem-erotica': 'Massagem erótica',
                'massagem_erotica': 'Massagem erótica',
                'namoradinha': 'Namoradinha',
                
                // Serviços Especiais
                'beijo-negro': 'Beijo negro',
                'beijo_negro': 'Beijo negro',
                'beijo-branco': 'Beijo branco',
                'beijo_branco': 'Beijo branco',
                'ejaculacao-facial': 'Ejaculação facial',
                'ejaculacao_facial': 'Ejaculação facial',
                'gozo-facial': 'Ejaculação facial',
                'ejaculacao-corpo': 'Ejaculação corpo',
                'ejaculacao_corpo': 'Ejaculação corpo',
                'chuva-dourada': 'Chuva dourada',
                'chuva_dourada': 'Chuva dourada',
                'cubana': 'Cubana',
                'pse': 'PSE',
                'face-fucking': 'Face fucking',
                'face_fucking': 'Face fucking',
                
                // Fetichismo e BDSM
                'fetichismo': 'Fetichismo',
                'sado-submissa': 'Sado submissa',
                'sado_submissa': 'Sado submissa',
                'sado-dominadora': 'Sado dominadora',
                'sado_dominadora': 'Sado dominadora',
                'sado-suave': 'Sado suave',
                'sado_suave': 'Sado suave',
                'sado-duro': 'Sado duro',
                'sado_duro': 'Sado duro',
                'fisting-anal': 'Fisting Anal',
                'fisting_anal': 'Fisting Anal',
                'brinquedos-sexuais': 'Brinquedos sexuais',
                'brinquedos_sexuais': 'Brinquedos sexuais',
                'lingerie': 'Lingerie',
                
                // Atendimento em Grupo
                'atencao-casais': 'Atenção à casais',
                'atencao_casais': 'Atenção à casais',
                'atende-casais': 'Atenção à casais',
                'casais': 'Atenção à casais',
                'duplas': 'Duplas',
                'trios': 'Trios',
                'orgia': 'Orgia',
                'festas-eventos': 'Festas e eventos',
                'festas_eventos': 'Festas e eventos',
                'despedida-solteiro': 'Despedida de solteiro',
                'despedida_solteiro': 'Despedida de solteiro',
                
                // Perfil e Estilo
                'ativo': 'Ativo',
                'ativa': 'Ativo', // Forma feminina no formulário
                'passivo': 'Passivo',
                'passiva': 'Passivo', // Forma feminina no formulário
                'versatil': 'Versátil',
                'versátil': 'Versátil', // Com acento
                'inversao-papeis': 'Inversão de papéis',
                'inversao_papeis': 'Inversão de papéis',
                'lesbica': 'Lésbica',
                'lésbica': 'Lésbica', // Com acento
                'atencao-mulheres': 'Atenção à mulheres',
                'atencao_mulheres': 'Atenção à mulheres',
                'atencao-mulher': 'Atenção à mulheres',
                'experto-principiantes': 'Experto principiantes',
                'experto_principiantes': 'Experto principiantes',
                'experta-principiantes': 'Experto principiantes', // Forma feminina
                'atencao-deficientes': 'Atenção à deficientes físicos',
                'atencao_deficientes': 'Atenção à deficientes físicos',
                
                // Serviços Extras
                'fantasias-figurinos': 'Fantasias e figurinos',
                'fantasias_figurinos': 'Fantasias e figurinos',
                'fantasias': 'Fantasias e figurinos',
                'sem-limite': 'Sem limite',
                'sem_limite': 'Sem limite',
                'sexcam': 'Sexcam',
                'atendimento-domicilio': 'Atendimento em domicílio',
                'atendimento_domicilio': 'Atendimento em domicílio',
                'vou-sua-casa': 'Atendimento em domicílio',
                'pacotes-promocionais': 'Pacotes promocionais',
                'pacotes_promocionais': 'Pacotes promocionais',
                'acompanhante-eventos': 'Acompanhante para eventos',
                'acompanhante_eventos': 'Acompanhante para eventos'
            };
            
            // Mapeamento de serviços do Firebase para os itens da lista
            // IMPORTANTE: USAR APENAS ARRAYS - Campos booleanos REMOVIDOS completamente
            const servicosMap = {
                // Serviços Básicos - PRIORIDADE: arrays categorizados (servicos_basicos)
                // Fallback: campos antigos apenas para compatibilidade
                'Beijos na boca': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Beijos na boca')) ||
                                 // Fallback para anúncios antigos (campos removidos mas ainda podem existir)
                                 (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Beijos na boca')) ||
                                 (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Beijos na boca')),
                'Oral com camisinha': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Oral com camisinha')) ||
                                      (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Oral com camisinha')) ||
                                      (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Oral com camisinha')),
                'Oral sem camisinha': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Oral sem camisinha')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Oral sem camisinha')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Oral sem camisinha')),
                'Oral até o final': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Oral até o final')) ||
                                   (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Oral até o final')) ||
                                   (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Oral até o final')),
                'Sexo anal': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Sexo anal')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sexo anal')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sexo anal')),
                'Garganta profunda': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Garganta profunda')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Garganta profunda')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Garganta profunda')),
                'Massagem erótica': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Massagem erótica')) ||
                                   (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Massagem erótica')) ||
                                   (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Massagem erótica')),
                'Namoradinha': (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.includes('Namoradinha')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Namoradinha')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Namoradinha')),
                
                // Serviços Especiais - APENAS arrays
                'Beijo negro': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Beijo negro')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Beijo negro')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Beijo negro')),
                'Beijo branco': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Beijo branco')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Beijo branco')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Beijo branco')),
                'Ejaculação facial': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Ejaculação facial')) ||
                                    (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Ejaculação facial')) ||
                                    (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Ejaculação facial')),
                'Ejaculação corpo': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Ejaculação corpo')) ||
                                  (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Ejaculação corpo')) ||
                                  (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Ejaculação corpo')),
                'Chuva dourada': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Chuva dourada')) ||
                                (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Chuva dourada')) ||
                                (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Chuva dourada')),
                'Cubana': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Cubana')) ||
                         (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Cubana')) ||
                         (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Cubana')),
                'PSE': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('PSE')) ||
                      (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('PSE')) ||
                      (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('PSE')),
                'Face fucking': (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.includes('Face fucking')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Face fucking')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Face fucking')),
                
                // Fetichismo e BDSM - APENAS arrays
                'Fetichismo': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Fetichismo')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Fetichismo')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Fetichismo')),
                'Sado submissa': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado submissa')) ||
                               (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado submissa')) ||
                               (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado submissa')),
                'Sado dominadora': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado dominadora')) ||
                                 (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado dominadora')) ||
                                 (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado dominadora')),
                'Sado suave': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado suave')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado suave')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado suave')),
                'Sado duro': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Sado duro')) ||
                           (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sado duro')) ||
                           (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sado duro')),
                'Fisting Anal': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Fisting Anal')) ||
                              (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Fisting Anal')) ||
                              (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Fisting Anal')),
                'Brinquedos sexuais': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Brinquedos sexuais')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Brinquedos sexuais')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Brinquedos sexuais')),
                'Lingerie': (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.includes('Lingerie')) ||
                          (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Lingerie')) ||
                          (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Lingerie')),
                
                // Atendimento em Grupo - APENAS arrays
                'Atenção à casais': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Atenção à casais')) ||
                                  (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atenção à casais')) ||
                                  (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atenção à casais')),
                'Duplas': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Duplas')) ||
                         (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Duplas')) ||
                         (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Duplas')),
                'Trios': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Trios')) ||
                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Trios')) ||
                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Trios')),
                'Orgia': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Orgia')) ||
                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Orgia')) ||
                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Orgia')),
                'Festas e eventos': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Festas e eventos')) ||
                                  (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Festas e eventos')) ||
                                  (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Festas e eventos')),
                'Despedida de solteiro': (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.includes('Despedida de solteiro')) ||
                                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Despedida de solteiro')) ||
                                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Despedida de solteiro')),
                
                // Perfil e Estilo - APENAS arrays
                'Ativo': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Ativo')) ||
                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Ativo')) ||
                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Ativo')),
                'Passivo': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Passivo')) ||
                          (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Passivo')) ||
                          (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Passivo')),
                'Versátil': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Versátil')) ||
                           (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Versátil')) ||
                           (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Versátil')),
                'Inversão de papéis': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Inversão de papéis')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Inversão de papéis')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Inversão de papéis')),
                'Lésbica': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Lésbica')) ||
                          (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Lésbica')) ||
                          (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Lésbica')),
                'Atenção à mulheres': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Atenção à mulheres')) ||
                                     (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atenção à mulheres')) ||
                                     (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atenção à mulheres')),
                'Experto principiantes': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Experto principiantes')) ||
                                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Experto principiantes')) ||
                                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Experto principiantes')),
                'Atenção à deficientes físicos': (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.includes('Atenção à deficientes físicos')) ||
                                                 (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atenção à deficientes físicos')) ||
                                                 (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atenção à deficientes físicos')),
                
                // Serviços Extras - APENAS arrays
                'Fantasias e figurinos': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Fantasias e figurinos')) ||
                                        (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Fantasias e figurinos')) ||
                                        (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Fantasias e figurinos')),
                'Sem limite': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Sem limite')) ||
                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sem limite')) ||
                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sem limite')),
                'Sexcam': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Sexcam')) ||
                         (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Sexcam')) ||
                         (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Sexcam')),
                'Atendimento em domicílio': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Atendimento em domicílio')) ||
                                           (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Atendimento em domicílio')) ||
                                           (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Atendimento em domicílio')),
                'Pacotes promocionais': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Pacotes promocionais')) ||
                                       (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Pacotes promocionais')) ||
                                       (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Pacotes promocionais')),
                'Acompanhante para eventos': (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.includes('Acompanhante para eventos')) ||
                                            (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.includes('Acompanhante para eventos')) ||
                                            (anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.includes('Acompanhante para eventos'))
            };
            
            // Verificar se há array de serviços no Firebase - buscar em múltiplos campos
            // PRIORIDADE: Campo "servicos" primeiro (formato novo do formulário), depois arrays categorizados
            let servicosArray = [];
            
            // MÉTODO 1: PRIORIDADE MÁXIMA - Campo "servicos" (formato novo do formulário que salva como array de slugs)
            // Este é o formato que está sendo usado no formulário de cadastro
            if (anuncio.servicos && Array.isArray(anuncio.servicos) && anuncio.servicos.length > 0) {
                servicosArray = anuncio.servicos;
                console.log('✅ Array de serviços encontrado em campo "servicos" (formato novo):', servicosArray);
                console.log(`📦 Total: ${servicosArray.length} serviços encontrados`);
            } 
            else if (anuncio.servicos && typeof anuncio.servicos === 'string') {
                // Se for string, tentar converter para array
                try {
                    servicosArray = JSON.parse(anuncio.servicos);
                    console.log('✅ Array de serviços convertido de string JSON:', servicosArray);
                } catch (e) {
                    servicosArray = anuncio.servicos.split(',').map(s => s.trim());
                    console.log('✅ Array de serviços convertido de string (vírgula):', servicosArray);
                }
            }
            // MÉTODO 2: Fallback - Combinar arrays categorizados (formato antigo)
            else {
                const categorias = [
                    anuncio.servicos_basicos,
                    anuncio.servicos_especiais,
                    anuncio.fetichismo_bdsm,
                    anuncio.atendimento_grupo,
                    anuncio.perfil_estilo,
                    anuncio.servicos_extras
                ];
                
                const servicosDeCategorias = [];
                const nomesCategorias = ['servicos_basicos', 'servicos_especiais', 'fetichismo_bdsm', 'atendimento_grupo', 'perfil_estilo', 'servicos_extras'];
                
                categorias.forEach((cat, index) => {
                    if (cat && Array.isArray(cat) && cat.length > 0) {
                        console.log(`📦 Categoria "${nomesCategorias[index]}" encontrada com ${cat.length} itens:`, cat);
                        servicosDeCategorias.push(...cat);
                    }
                });
                
                if (servicosDeCategorias.length > 0) {
                    servicosArray = servicosDeCategorias;
                    console.log('📦 Array de serviços combinado das categorias (MÉTODO 2 - fallback):', servicosArray);
                    console.log(`📦 Total: ${servicosArray.length} serviços encontrados nas categorias`);
                }
            }
            // MÉTODO 3: Fallback adicional - campo servicos_oferecidos (anúncios muito antigos)
            if (servicosArray.length === 0 && anuncio.servicos_oferecidos && Array.isArray(anuncio.servicos_oferecidos) && anuncio.servicos_oferecidos.length > 0) {
                servicosArray = anuncio.servicos_oferecidos;
                console.log('⚠️ Array de serviços encontrado em campo antigo (servicos_oferecidos - FALLBACK):', servicosArray);
            }
            
            // SEMPRE filtrar valores inválidos
            if (servicosArray.length > 0) {
                const servicosValidos = servicosArray.filter(s => {
                    const valor = String(s).toLowerCase().trim();
                    return valor && valor !== 'on' && valor !== 'null' && valor !== 'undefined' && valor !== '';
                });
                
                if (servicosValidos.length !== servicosArray.length) {
                    console.warn(`⚠️ Array contém ${servicosArray.length - servicosValidos.length} valores inválidos ("on", null, etc). Filtrando...`);
                    console.log('📦 Array original:', servicosArray);
                    console.log('📦 Array filtrado:', servicosValidos);
                }
                
                servicosArray = servicosValidos;
                console.log(`✅ Array final de serviços válidos: ${servicosArray.length} itens`, servicosArray);
            }
            
            // Se após filtrar não houver serviços válidos, avisar
            if (servicosArray.length === 0 && (anuncio.servicos || anuncio.servicos_oferecidos)) {
                console.warn('⚠️⚠️⚠️ ATENÇÃO: Array de serviços encontrado no Firebase, mas todos os valores são inválidos ("on", null, etc).');
                console.warn('⚠️ Isso indica que o anúncio foi criado com a versão antiga do formulário que salvava "on" em vez dos valores dos checkboxes.');
                console.warn('⚠️ Será necessário recriar o anúncio ou atualizar manualmente os valores no Firebase.');
            }
            
            // Log detalhado de todos os campos que podem conter serviços
            const camposComServicos = Object.keys(anuncio).filter(k => 
                k.toLowerCase().includes('servico') || 
                k.toLowerCase().includes('service')
            );
            console.log('📋 Todos os campos relacionados a serviços encontrados:', camposComServicos);
            camposComServicos.forEach(campo => {
                console.log(`  - ${campo}:`, anuncio[campo], `(tipo: ${typeof anuncio[campo]}, é array: ${Array.isArray(anuncio[campo])})`);
            });
            
            // Mapeamento de serviços para suas categorias
            const servicoParaCategoria = {
                // Serviços Básicos
                'Beijos na boca': 'Serviços Básicos',
                'Oral com camisinha': 'Serviços Básicos',
                'Oral sem camisinha': 'Serviços Básicos',
                'Oral até o final': 'Serviços Básicos',
                'Sexo anal': 'Serviços Básicos',
                'Garganta profunda': 'Serviços Básicos',
                'Massagem erótica': 'Serviços Básicos',
                'Namoradinha': 'Serviços Básicos',
                
                // Serviços Especiais
                'Beijo negro': 'Serviços Especiais',
                'Beijo branco': 'Serviços Especiais',
                'Ejaculação facial': 'Serviços Especiais',
                'Ejaculação corpo': 'Serviços Especiais',
                'Chuva dourada': 'Serviços Especiais',
                'Cubana': 'Serviços Especiais',
                'PSE': 'Serviços Especiais',
                'Face fucking': 'Serviços Especiais',
                
                // Fetichismo e BDSM
                'Fetichismo': 'Serviços de Fetichismo e BDSM',
                'Sado submissa': 'Serviços de Fetichismo e BDSM',
                'Sado dominadora': 'Serviços de Fetichismo e BDSM',
                'Sado suave': 'Serviços de Fetichismo e BDSM',
                'Sado duro': 'Serviços de Fetichismo e BDSM',
                'Fisting Anal': 'Serviços de Fetichismo e BDSM',
                'Brinquedos sexuais': 'Serviços de Fetichismo e BDSM',
                'Lingerie': 'Serviços de Fetichismo e BDSM',
                
                // Atendimento em Grupo
                'Atenção à casais': 'Serviços de Atendimento em Grupo',
                'Duplas': 'Serviços de Atendimento em Grupo',
                'Trios': 'Serviços de Atendimento em Grupo',
                'Orgia': 'Serviços de Atendimento em Grupo',
                'Festas e eventos': 'Serviços de Atendimento em Grupo',
                'Despedida de solteiro': 'Serviços de Atendimento em Grupo',
                
                // Perfil e Estilo
                'Ativo': 'Serviços do Perfil e Estilo',
                'Passivo': 'Serviços do Perfil e Estilo',
                'Versátil': 'Serviços do Perfil e Estilo',
                'Inversão de papéis': 'Serviços do Perfil e Estilo',
                'Lésbica': 'Serviços do Perfil e Estilo',
                'Atenção à mulheres': 'Serviços do Perfil e Estilo',
                'Experto principiantes': 'Serviços do Perfil e Estilo',
                'Atenção à deficientes físicos': 'Serviços do Perfil e Estilo',
                
                // Serviços Extras
                'Fantasias e figurinos': 'Serviços Extras',
                'Sem limite': 'Serviços Extras',
                'Sexcam': 'Serviços Extras',
                'Atendimento em domicílio': 'Serviços Extras',
                'Pacotes promocionais': 'Serviços Extras',
                'Acompanhante para eventos': 'Serviços Extras'
            };
            
            // Converter valores do array para textos de exibição
            // NOVO: Os serviços agora são salvos como nomes completos em português
            // Mas precisamos manter compatibilidade com dados antigos que usam slugs
            const servicosArrayNormalized = servicosArray.map(s => {
                const valorOriginal = String(s).trim();
                const checkboxValue = valorOriginal.toLowerCase().trim();
                console.log(`🔍 Processando serviço do Firebase: "${valorOriginal}" (normalizado: "${checkboxValue}")`);
                
                // PRIMEIRO: Verificar se já é um nome completo em português (novo formato)
                // Lista de todos os nomes esperados em português
                const nomesPortuguesEsperados = [
                    'Beijos na boca', 'Oral com camisinha', 'Oral sem camisinha', 'Oral até o final',
                    'Sexo anal', 'Garganta profunda', 'Massagem erótica', 'Namoradinha',
                    'Beijo negro', 'Beijo branco', 'Ejaculação facial', 'Ejaculação corpo',
                    'Chuva dourada', 'Cubana', 'PSE', 'Face fucking',
                    'Fetichismo', 'Sado submissa', 'Sado dominadora', 'Sado suave',
                    'Sado duro', 'Fisting Anal', 'Brinquedos sexuais', 'Lingerie',
                    'Atenção à casais', 'Duplas', 'Trios', 'Orgia',
                    'Festas e eventos', 'Despedida de solteiro',
                    'Ativo', 'Passivo', 'Versátil', 'Inversão de papéis',
                    'Lésbica', 'Atenção à mulheres', 'Experto principiantes', 'Atenção à deficientes físicos',
                    'Fantasias e figurinos', 'Sem limite', 'Sexcam',
                    'Atendimento em domicílio', 'Pacotes promocionais', 'Acompanhante para eventos'
                ];
                
                // Verificar se o valor já é um nome completo (comparação case-insensitive)
                const nomeCompletoEncontrado = nomesPortuguesEsperados.find(nome => 
                    nome.toLowerCase() === valorOriginal.toLowerCase()
                );
                
                if (nomeCompletoEncontrado) {
                    console.log(`  ✅ Já é nome completo: "${valorOriginal}" → "${nomeCompletoEncontrado}"`);
                    return nomeCompletoEncontrado; // Retornar o nome padronizado
                }
                
                // SEGUNDO: Se não for nome completo, tratar como slug antigo e converter
                const found = Object.keys(checkboxToDisplayMap).find(key => {
                    const keyNormalized = key.toLowerCase().trim();
                    const checkboxNormalized = checkboxValue;
                    
                    // Comparação exata
                    if (keyNormalized === checkboxNormalized) return true;
                    
                    // Comparação sem hífen/underscore
                    if (keyNormalized.replace(/[-_]/g, '') === checkboxNormalized.replace(/[-_]/g, '')) return true;
                    
                    // Comparação parcial
                    if (keyNormalized.includes(checkboxNormalized) || checkboxNormalized.includes(keyNormalized)) return true;
                    
                    return false;
                });
                
                if (found) {
                    console.log(`  ✅ Mapeado (slug antigo): "${valorOriginal}" → "${checkboxToDisplayMap[found]}"`);
                    return checkboxToDisplayMap[found];
                }
                
                // Se não encontrar, tentar buscar valores similares
                const similarKeys = Object.keys(checkboxToDisplayMap).filter(key => {
                    const keyNormalized = key.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '');
                    const checkboxNormalized = checkboxValue.normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '');
                    return keyNormalized.includes(checkboxNormalized) || checkboxNormalized.includes(keyNormalized);
                });
                
                if (similarKeys.length > 0) {
                    console.log(`  ✅ Mapeado (similar): "${valorOriginal}" → "${checkboxToDisplayMap[similarKeys[0]]}"`);
                    return checkboxToDisplayMap[similarKeys[0]];
                }
                
                // Se não encontrar, retornar o valor original (pode ser um nome já em português que não está na lista)
                console.log(`  ⚠️ Não mapeado, usando valor original: "${valorOriginal}"`);
                return valorOriginal;
            });
            
            // Agrupar serviços por categoria
            const servicosPorCategoria = {
                'Serviços Básicos': [],
                'Serviços Especiais': [],
                'Serviços de Fetichismo e BDSM': [],
                'Serviços de Atendimento em Grupo': [],
                'Serviços do Perfil e Estilo': [],
                'Serviços Extras': []
            };
            
            servicosArrayNormalized.forEach(servico => {
                const categoria = servicoParaCategoria[servico];
                if (categoria && servicosPorCategoria[categoria]) {
                    servicosPorCategoria[categoria].push(servico);
                }
            });
            
            console.log('📋 Serviços agrupados por categoria:', servicosPorCategoria);
            
            console.log('📦 Serviços normalizados do array:', servicosArrayNormalized);
            console.log(`📊 Total de serviços encontrados: ${servicosArray.length}`);
            
            // Mostrar TODOS os serviços do array com seus mapeamentos
            if (servicosArray.length > 0) {
                console.log('\n📋 ========== MAPEAMENTO DE TODOS OS SERVIÇOS ==========');
                servicosArray.forEach((servicoOriginal, idx) => {
                    const checkboxValue = String(servicoOriginal).toLowerCase().trim();
                    const mapeado = checkboxToDisplayMap[checkboxValue] || 
                                   Object.keys(checkboxToDisplayMap).find(k => {
                                       const kNorm = k.toLowerCase().trim();
                                       return kNorm === checkboxValue || 
                                              kNorm.replace(/[-_]/g, '') === checkboxValue.replace(/[-_]/g, '');
                                   });
                    const resultado = mapeado ? checkboxToDisplayMap[mapeado] : '❌ NÃO MAPEADO';
                    console.log(`  ${idx + 1}. "${servicoOriginal}" → "${resultado}"`);
                });
                console.log('=====================================================\n');
            }
            
            // Função para atualizar uma lista de serviços
            function updateServiceList(sectionTitle, serviceMap) {
                console.log(`\n🔍 Processando seção: "${sectionTitle}"`);
                const sections = document.querySelectorAll('.services-section-detailed');
                let sectionFound = false;
                sections.forEach(section => {
                    const title = section.querySelector('h5');
                    if (title && title.textContent.trim() === sectionTitle) {
                        sectionFound = true;
                        console.log(`  ✅ Seção encontrada: "${sectionTitle}"`);
                        const list = section.querySelector('.services-list-detailed');
                        if (list) {
                            const items = Array.from(list.querySelectorAll('li'));
                            console.log(`  📋 Total de itens na lista: ${items.length}`);
                            
                            // Array para armazenar itens a serem removidos
                            const itemsToRemove = [];
                            
                            items.forEach((li, index) => {
                                // Extrair texto do serviço (clonando e removendo ícone)
                                const clone = li.cloneNode(true);
                                const icons = clone.querySelectorAll('i');
                                icons.forEach(icon => icon.remove());
                                let text = clone.textContent.trim();
                                // Remover qualquer símbolo no início
                                text = text.replace(/^[✓✔×✕•]\s*/, '').trim();
                                const checkIcon = li.querySelector('i');
                                
                                // Debug: mostrar item sendo processado (apenas primeiros 3 para não poluir)
                                if (index < 3) {
                                    console.log(`    🔍 Item ${index + 1}: "${text}"`);
                                }
                                
                                // Verificar se o serviço está ativo
                                let isActive = false;
                                let activeSource = '';
                                
                                // PRIMEIRO: Verificar no array de serviços do Firebase (PRIORITÁRIO - funciona para TODOS os serviços)
                                // Isso é CRÍTICO porque TODOS os serviços (básicos e especiais) vêm do array quando marcados no formulário
                                if (servicosArray.length > 0) {
                                    const normalizedText = text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w\s]/g, '').replace(/\s+/g, '');
                                    
                                    const encontradoNoArray = servicosArray.some(s => {
                                        const servicoFirebase = String(s).trim();
                                        
                                        // PRIMEIRO: Comparação direta exata (case-insensitive)
                                        if (servicoFirebase.toLowerCase() === text.toLowerCase()) {
                                            console.log(`    ✅ Match DIRETO EXATO: "${servicoFirebase}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // SEGUNDO: Verificar se o valor do Firebase mapeia para este texto via checkboxToDisplayMap
                                        const servicoLower = servicoFirebase.toLowerCase();
                                        const mapeado = checkboxToDisplayMap[servicoLower];
                                        if (mapeado && mapeado.toLowerCase() === text.toLowerCase()) {
                                            console.log(`    ✅ Match por mapeamento: "${servicoFirebase}" → "${mapeado}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // TERCEIRO: Se o valor do Firebase é um slug (como "beijo-branco"), verificar mapeamento
                                        const mapeadoSlug = checkboxToDisplayMap[servicoLower];
                                        if (mapeadoSlug && mapeadoSlug.toLowerCase() === text.toLowerCase()) {
                                            console.log(`    ✅ Match por slug mapeado: "${servicoFirebase}" → "${mapeadoSlug}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // QUARTO: Verificar mapeamento reverso (texto → slug)
                                        const valoresMapeados = Object.keys(checkboxToDisplayMap).filter(key => 
                                            checkboxToDisplayMap[key] && checkboxToDisplayMap[key].toLowerCase() === text.toLowerCase()
                                        );
                                        
                                        if (valoresMapeados.length > 0 && valoresMapeados.some(slug => slug === servicoLower)) {
                                            console.log(`    ✅ Match por mapeamento reverso: "${servicoFirebase}" → "${text}"`);
                                            return true;
                                        }
                                        
                                        // QUINTO: Comparação normalizada (sem acentos e espaços)
                                        const normalizedS = servicoFirebase.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w\s]/g, '').replace(/\s+/g, '');
                                        const match = normalizedS === normalizedText || 
                                               normalizedS.includes(normalizedText) || 
                                               normalizedText.includes(normalizedS);
                                        if (match) {
                                            console.log(`    ✅ Match por normalização: "${servicoFirebase}" (${normalizedS}) === "${text}" (${normalizedText})`);
                                        }
                                        return match;
                                    });
                                    
                                    if (encontradoNoArray) {
                                        isActive = true;
                                        activeSource = 'servicosArray (original)';
                                        if (index < 5) {
                                            console.log(`  ✅ "${text}": ATIVO encontrado em servicosArray`);
                                        }
                                    }
                                }
                                
                                // SEGUNDO: Verificar no array de serviços normalizados do Firebase
                                if (!isActive && servicosArrayNormalized.length > 0) {
                                    const normalizedText = text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '').replace(/\s+/g, '');
                                    const encontradoNormalizado = servicosArrayNormalized.some(s => {
                                        const normalizedS = String(s).toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^\w]/g, '').replace(/\s+/g, '');
                                        
                                        // Comparação exata
                                        if (normalizedS === normalizedText) {
                                            console.log(`    ✅ Match EXATO: "${s}" === "${text}"`);
                                            return true;
                                        }
                                        
                                        // Comparação parcial (mais flexível)
                                        const match = normalizedS.includes(normalizedText) || normalizedText.includes(normalizedS);
                                        if (match) {
                                            console.log(`    ✅ Match PARCIAL: "${s}" (${normalizedS}) contém "${text}" (${normalizedText})`);
                                        }
                                        return match;
                                    });
                                    if (encontradoNormalizado) {
                                        isActive = true;
                                        activeSource = 'servicosArray (normalizado)';
                                    }
                                }
                                
                                // TERCEIRO: Verificar no mapeamento fornecido (APENAS ARRAYS - campos booleanos REMOVIDOS)
                                // IMPORTANTE: serviceMap retorna true/false/undefined baseado em arrays
                                // Só marcar como ativo se o valor for EXATAMENTE true
                                if (!isActive && serviceMap && text in serviceMap) {
                                    const value = serviceMap[text];
                                    // Verificar se é verdadeiramente true (não apenas truthy)
                                    if (value === true) {
                                        isActive = true;
                                        activeSource = 'servicosMap (array)';
                                        console.log(`    ✅ "${text}": Encontrado no serviceMap como true`);
                                    } else {
                                        console.log(`    ❌ "${text}": serviceMap retornou ${value} (não true)`);
                                    }
                                }
                                // QUARTO: Verificar no mapeamento global de serviços (APENAS ARRAYS)
                                if (!isActive && servicosMap && text in servicosMap) {
                                    const value = servicosMap[text];
                                    // Verificar se é verdadeiramente true (não apenas truthy)
                                    if (value === true) {
                                        isActive = true;
                                        activeSource = 'servicosMap (array)';
                                        console.log(`    ✅ "${text}": Encontrado no servicosMap como true`);
                                    } else {
                                        console.log(`    ❌ "${text}": servicosMap retornou ${value} (não true)`);
                                    }
                                }
                                
                                // Atualizar ícone e estilo
                                if (checkIcon) {
                                    // IMPORTANTE: Só marcar como ativo se isActive for verdadeiro
                                    if (isActive) {
                                        checkIcon.className = 'fas fa-check';
                                        checkIcon.style.color = '#28a745';
                                        li.style.opacity = '1';
                                        li.style.fontWeight = '500';
                                        checkIcon.style.display = 'inline-block'; // Garantir que está visível
                                        if (index < 5) {
                                            console.log(`  ✅ "${text}": ATIVO (${activeSource})`);
                                        }
                                    } else {
                                        // Se há dados no Firebase mas este serviço não está ativo, REMOVER completamente
                                        const temDadosFirebase = servicosArray.length > 0 || 
                                                               servicosArrayNormalized.length > 0 ||
                                                               (anuncio.servicos_basicos && Array.isArray(anuncio.servicos_basicos) && anuncio.servicos_basicos.length > 0) ||
                                                               (anuncio.servicos_especiais && Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.length > 0) ||
                                                               (anuncio.fetichismo_bdsm && Array.isArray(anuncio.fetichismo_bdsm) && anuncio.fetichismo_bdsm.length > 0) ||
                                                               (anuncio.atendimento_grupo && Array.isArray(anuncio.atendimento_grupo) && anuncio.atendimento_grupo.length > 0) ||
                                                               (anuncio.perfil_estilo && Array.isArray(anuncio.perfil_estilo) && anuncio.perfil_estilo.length > 0) ||
                                                               (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras) && anuncio.servicos_extras.length > 0);
                                        
                                        if (temDadosFirebase) {
                                            // Serviço inativo - adicionar à lista de remoção
                                            itemsToRemove.push(li);
                                            if (index < 5) {
                                                console.log(`  🗑️ "${text}": INATIVO - será REMOVIDO`);
                                            }
                                        } else {
                                            // Se não há dados no Firebase, manter mas sem ícone
                                            checkIcon.style.display = 'none';
                                            li.style.opacity = '0.6';
                                            if (index < 5) {
                                                console.log(`  ⚪ "${text}": SEM DADOS (ícone removido - arrays vazios)`);
                                            }
                                        }
                                    }
                                }
                            });
                            
                            // Remover todos os itens inativos
                            itemsToRemove.forEach(li => {
                                li.remove();
                                console.log(`  🗑️ Item removido: "${li.textContent.trim()}"`);
                            });
                            
                            // Se a lista ficou vazia após remover itens inativos, ocultar a seção inteira
                            if (list.querySelectorAll('li').length === 0) {
                                section.style.display = 'none';
                                console.log(`  👁️ Seção "${sectionTitle}" oculta (nenhum serviço ativo)`);
                            } else {
                                section.style.display = 'block';
                            }
                            
                            // Resumo da seção
                            const ativosSection = list.querySelectorAll('li').length;
                            const removidos = itemsToRemove.length;
                            console.log(`  📊 Seção "${sectionTitle}": ${ativosSection} ativos, ${removidos} removidos`);
                        }
                    }
                });
                
                if (!sectionFound) {
                    console.warn(`  ⚠️ Seção "${sectionTitle}" NÃO encontrada no DOM!`);
                }
            }
            
            // DEBUG: Verificar se servicos_especiais está sendo carregado corretamente
            console.log('\n🔍 DEBUG - Verificando servicos_especiais do Firebase:');
            console.log('  - anuncio.servicos_especiais:', anuncio.servicos_especiais);
            console.log('  - Tipo:', typeof anuncio.servicos_especiais, 'É Array?', Array.isArray(anuncio.servicos_especiais));
            if (Array.isArray(anuncio.servicos_especiais) && anuncio.servicos_especiais.length > 0) {
                console.log('  - Itens no array:', anuncio.servicos_especiais);
                console.log('  - "Beijo branco" está incluído?', anuncio.servicos_especiais.includes('Beijo branco'));
            }
            console.log('  - servicosArray final:', servicosArray);
            console.log('  - servicosArrayNormalized:', servicosArrayNormalized);
            console.log('  - servicosMap["Beijo branco"]:', servicosMap['Beijo branco']);
            
            // Atualizar todas as listas principais - agora usando servicosPorCategoria
            // Isso garante que apenas as categorias com serviços apareçam
            const categoriasParaAtualizar = [
                'Serviços Básicos',
                'Serviços Especiais',
                'Serviços de Fetichismo e BDSM',
                'Serviços de Atendimento em Grupo',
                'Serviços do Perfil e Estilo',
                'Serviços Extras'
            ];
            
            categoriasParaAtualizar.forEach(categoria => {
                // Se a categoria tem serviços no array, atualizar e mostrar
                if (servicosPorCategoria[categoria] && servicosPorCategoria[categoria].length > 0) {
                    updateServiceList(categoria, servicosMap);
                    // Mostrar a seção
                    const sections = document.querySelectorAll('.services-section-detailed');
                    sections.forEach(section => {
                        const title = section.querySelector('h5');
                        if (title && title.textContent.trim() === categoria) {
                            section.style.display = 'block';
                        }
                    });
                } else {
                    // Ocultar a seção se não tiver serviços
                    const sections = document.querySelectorAll('.services-section-detailed');
                    sections.forEach(section => {
                        const title = section.querySelector('h5');
                        if (title && title.textContent.trim() === categoria) {
                            section.style.display = 'none';
                        }
                    });
                }
            });
            
            // Atualizar seções específicas de Homem/Trans
            if (anuncio.genero === 'homem' || anuncio.genero === 'trans') {
                // Orientações Sexuais
                const orientacaoMap = {
                    'Heterossexual': anuncio.orientacao_sexual === 'heterossexual' || anuncio.orientacao === 'heterossexual',
                    'Gay': anuncio.orientacao_sexual === 'gay' || anuncio.orientacao === 'gay',
                    'Bissexual': anuncio.orientacao_sexual === 'bissexual' || anuncio.orientacao === 'bissexual',
                    'Pansexual': anuncio.orientacao_sexual === 'pansexual' || anuncio.orientacao === 'pansexual'
                };
                
                updateServiceList('Orientações Sexuais', orientacaoMap);
                
                // Preferências de Atendimento
                const preferenciasMap = {
                    'Atende Homens': anuncio.atende_homens || (anuncio.genero === 'homem'),
                    'Atende Mulheres': anuncio.atende_mulheres || (anuncio.genero === 'mulher'),
                    'Atende Trans': anuncio.atende_trans || (anuncio.genero === 'trans'),
                    'Atende Casais': anuncio.atende_casais || anuncio.casais
                };
                
                updateServiceList('Preferências de Atendimento', preferenciasMap);
                
                // Especialidades
                const especialidadesMap = {
                    'Massagem': anuncio.massagem || anuncio.especialidade_massagem,
                    'Acompanhante': anuncio.acompanhante || anuncio.especialidade_acompanhante,
                    'Dominação': anuncio.dominacao || anuncio.especialidade_dominacao,
                    'Submissão': anuncio.submissao || anuncio.especialidade_submissao
                };
                
                updateServiceList('Especialidades', especialidadesMap);
                
                // Eu Faço
                const euFacoMap = {
                    'Venda de conteúdo': anuncio.venda_conteudo || anuncio['venda-conteudo'],
                    '24 horas': anuncio['24h'] || anuncio.atende_24h || (anuncio.plano === 'camarote' || anuncio.plano === 'vip'),
                    'Viajo até você': anuncio.viajo_ate_voce || anuncio['viajo-ate-voce'],
                    'Massoterapia': anuncio.massoterapia,
                    'Aceito cartões': anuncio.aceita_cartoes || anuncio['aceita-cartoes'] || anuncio.pagamento_credito !== false,
                    'Vou à sua casa': anuncio.vou_sua_casa || anuncio['vou-sua-casa'] || anuncio.atendimento_domicilio,
                    'Beijo na boca': anuncio.beija || anuncio.beijo_boca,
                    'Gozo Facial': anuncio.gozo_facial || anuncio.ejaculacao_facial,
                    'Atendo em dupla': anuncio.atende_dupla || anuncio.duplas,
                    'Atendo Mulheres': anuncio.atende_mulheres,
                    'Casais': anuncio.atende_casais || anuncio.casais,
                    'Ator pornô': anuncio.ator_porno || anuncio['ator-porno'],
                    'Homem Trans': anuncio.genero === 'trans',
                    'BDSM': anuncio.bdsm || anuncio.fetichismo,
                    'Uso Fantasias': anuncio.fantasias || anuncio.usa_fantasias,
                    'Só brotheragem com masturbação': anuncio.brotheragem_com_masturbacao || anuncio['brotheragem-com-masturbacao'],
                    'Podo (trampling, footjob, dirty feet)': anuncio.podo || anuncio['podo-trampling'],
                    'Só brotheragem sem penetração': anuncio.brotheragem_sem_penetracao || anuncio['brotheragem-sem-penetracao']
                };
                
                updateServiceList('Eu Faço', euFacoMap);
                
                // Corpo
                const corpoMap = {
                    'Atlético': anuncio.corpo === 'atletico' || anuncio.tipo_corpo === 'atletico',
                    'Musculoso': anuncio.corpo === 'musculoso' || anuncio.tipo_corpo === 'musculoso',
                    'Magro': anuncio.corpo === 'magro' || anuncio.tipo_corpo === 'magro',
                    'Gordinho': anuncio.corpo === 'gordinho' || anuncio.tipo_corpo === 'gordinho'
                };
                
                updateServiceList('Corpo', corpoMap);
                
                // Pubis
                const pubisMap = {
                    'Peludos': anuncio.pubis === 'peludo' || anuncio.depilacao_pubis === false,
                    'Depilado': anuncio.pubis === 'depilado' || anuncio.depilacao_pubis === true
                };
                
                updateServiceList('Pubis', pubisMap);
                
                // Estatura
                const estaturaMap = {
                    'Alto': anuncio.estatura === 'alto' || (anuncio.altura && parseFloat(anuncio.altura) >= 1.75),
                    'Baixo': anuncio.estatura === 'baixo' || (anuncio.altura && parseFloat(anuncio.altura) < 1.65),
                    'Mediano': anuncio.estatura === 'mediano' || (anuncio.altura && parseFloat(anuncio.altura) >= 1.65 && parseFloat(anuncio.altura) < 1.75)
                };
                
                updateServiceList('Estatura', estaturaMap);
            }
            
            // Resumo final - contar quantos serviços foram ativados
            const totalServicos = document.querySelectorAll('.services-list-detailed li').length;
            const servicosAtivos = document.querySelectorAll('.services-list-detailed li .fa-check').length;
            const servicosInativos = document.querySelectorAll('.services-list-detailed li .fa-times').length;
            
            console.log('✅ Serviços oferecidos atualizados');
            console.log(`📊 Resumo: ${servicosAtivos} ativos, ${servicosInativos} inativos de ${totalServicos} total`);
            
            // Aviso se encontrar array mas não ativar nada
            if (servicosArray.length > 0 && servicosAtivos === 0) {
                console.error('❌ AVISO: Array de serviços encontrado mas nenhum serviço foi ativado!');
                console.error('   Array original:', servicosArray);
                console.error('   Array normalizado:', servicosArrayNormalized);
                console.error('   Verifique se os valores do array correspondem aos textos na página.');
                
                // Mostrar tentativas de match para debug
                console.log('🔍 Tentando encontrar matches manualmente...');
                servicosArray.forEach(valorOriginal => {
                    const checkboxValue = String(valorOriginal).toLowerCase().trim();
                    const mapeado = checkboxToDisplayMap[checkboxValue] || 
                                   Object.keys(checkboxToDisplayMap).find(k => 
                                       k.toLowerCase() === checkboxValue || 
                                       k.toLowerCase().replace(/[-_]/g, '') === checkboxValue.replace(/[-_]/g, '')
                                   );
                    console.log(`  - "${valorOriginal}" → "${mapeado || 'NÃO ENCONTRADO NO MAPEAMENTO'}"`);
                });
            }
            
            // Aviso se não encontrar array de serviços
            if (servicosArray.length === 0) {
                console.warn('⚠️ AVISO: Nenhum array de serviços encontrado no Firebase!');
                console.warn('   Isso pode significar que:');
                console.warn('   1. Os serviços não foram salvos no formulário de cadastro');
                console.warn('   2. Os serviços estão salvos em um campo com nome diferente');
                console.warn('   3. Este anúncio foi criado antes da implementação do campo de serviços');
                console.warn('   Campos verificados: servicos, servicos_oferecidos');
            }
        }
        
        // Função para atualizar botões de contato
        function updateContactButtons(anuncio) {
            console.log('📞 Atualizando botões de contato...');
            
            // Buscar telefones do anúncio
            const telefoneCelular = anuncio.telefone_celular || anuncio.telefone || anuncio.whatsapp || anuncio.phone;
            const telefoneFixo = anuncio.telefone_fixo || anuncio.telefone_fixo_numero;
            const whatsapp = anuncio.whatsapp || anuncio.telefone_celular || anuncio.telefone || anuncio.phone;
            
            console.log('📞 Telefones encontrados:', {
                celular: telefoneCelular,
                fixo: telefoneFixo,
                whatsapp: whatsapp
            });
            
            // Função para formatar telefone para link tel: ou wa.me:
            function formatPhoneForLink(phone) {
                if (!phone) return '';
                // Remover caracteres não numéricos
                let cleanPhone = String(phone).replace(/\D/g, '');
                // Se não começar com código do país, adicionar 55 (Brasil)
                if (cleanPhone.length === 10 || cleanPhone.length === 11) {
                    cleanPhone = '55' + cleanPhone;
                }
                return cleanPhone;
            }
            
            // Botão "Ligar Agora" - usar telefone celular
            const btnLigarAgora = document.getElementById('btn-ligar-agora');
            const btnPhoneNumber = document.getElementById('btn-ligar-phone-number');
            
            if (btnLigarAgora && telefoneCelular) {
                const phoneLink = formatPhoneForLink(telefoneCelular);
                btnLigarAgora.href = `tel:+${phoneLink}`;
                
                // Atualizar número de telefone visível no botão
                if (btnPhoneNumber) {
                    // Formatar telefone para exibição
                    function formatPhoneForDisplay(phone) {
                        if (!phone) return 'Não disponível';
                        
                        // Remover caracteres não numéricos
                        const cleanPhone = String(phone).replace(/\D/g, '');
                        
                        // Se já estiver formatado, tentar manter o formato
                        if (phone.includes('(') && phone.includes(')')) {
                            return phone; // Já está formatado
                        }
                        
                        // Formatar como (XX) XXXXX-XXXX ou (XX) XXXX-XXXX
                        if (cleanPhone.length === 11) {
                            // Celular: (XX) XXXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                        } else if (cleanPhone.length === 10) {
                            // Fixo: (XX) XXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
                        } else if (cleanPhone.length === 13) {
                            // Com código do país: +55 (XX) XXXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{2})(\d{5})(\d{4})/, '+$1 ($2) $3-$4');
                        }
                        
                        // Se não conseguir formatar, retornar original
                        return telefoneCelular;
                    }
                    
                    const phoneFormatted = formatPhoneForDisplay(telefoneCelular);
                    btnPhoneNumber.textContent = phoneFormatted;
                    console.log(`✅ Número de telefone exibido no botão: ${phoneFormatted}`);
                }
                
                console.log(`✅ Botão "Ligar Agora" atualizado: tel:+${phoneLink}`);
            } else if (btnLigarAgora) {
                console.warn('⚠️ Telefone celular não encontrado para botão "Ligar Agora"');
                if (btnPhoneNumber) {
                    btnPhoneNumber.textContent = 'Não disponível';
                }
            }
            
            // Botão "WhatsApp" - usar número do WhatsApp
            const btnWhatsapp = document.getElementById('btn-whatsapp');
            if (btnWhatsapp && whatsapp) {
                const whatsappLink = formatPhoneForLink(whatsapp);
                btnWhatsapp.href = `https://wa.me/${whatsappLink}`;
                console.log(`✅ Botão "WhatsApp" atualizado: wa.me/${whatsappLink}`);
            } else if (btnWhatsapp) {
                console.warn('⚠️ Número do WhatsApp não encontrado');
            }
            
            // Botão "Telefone Fixo" - habilitar se houver telefone fixo
            const btnTelefoneFixo = document.getElementById('btn-telefone-fixo');
            if (btnTelefoneFixo) {
                if (telefoneFixo) {
                    const fixoLink = formatPhoneForLink(telefoneFixo);
                    btnTelefoneFixo.href = `tel:+${fixoLink}`;
                    btnTelefoneFixo.style.opacity = '1';
                    btnTelefoneFixo.style.pointerEvents = 'auto';
                    btnTelefoneFixo.style.cursor = 'pointer';
                    
                    // Formatar telefone fixo para exibição
                    function formatPhoneForDisplay(phone) {
                        if (!phone) return 'Não disponível';
                        
                        // Remover caracteres não numéricos
                        const cleanPhone = String(phone).replace(/\D/g, '');
                        
                        // Se já estiver formatado, tentar manter o formato
                        if (phone.includes('(') && phone.includes(')')) {
                            return phone; // Já está formatado
                        }
                        
                        // Formatar como (XX) XXXX-XXXX para fixo
                        if (cleanPhone.length === 10) {
                            // Fixo: (XX) XXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
                        } else if (cleanPhone.length === 11) {
                            // Celular: (XX) XXXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                        } else if (cleanPhone.length === 13) {
                            // Com código do país: +55 (XX) XXXX-XXXX
                            return cleanPhone.replace(/(\d{2})(\d{2})(\d{4})(\d{4})/, '+$1 ($2) $3-$4');
                        }
                        
                        // Se não conseguir formatar, retornar original
                        return telefoneFixo;
                    }
                    
                    // Atualizar texto do botão com o número formatado
                    const fixoFormatted = formatPhoneForDisplay(telefoneFixo);
                    btnTelefoneFixo.innerHTML = `<i class="fas fa-phone-alt"></i> ${fixoFormatted}`;
                    
                    console.log(`✅ Botão "Telefone Fixo" habilitado: tel:+${fixoLink} - Número exibido: ${fixoFormatted}`);
                } else {
                    btnTelefoneFixo.href = '#';
                    btnTelefoneFixo.style.opacity = '0.5';
                    btnTelefoneFixo.style.pointerEvents = 'none';
                    btnTelefoneFixo.style.cursor = 'not-allowed';
                    btnTelefoneFixo.innerHTML = '<i class="fas fa-phone-alt"></i> Telefone Fixo';
                    console.log('⚠️ Telefone fixo não encontrado, botão desabilitado');
                }
            }
            
            console.log('✅ Botões de contato atualizados');
        }
        
        // Função para atualizar serviços e preços
        function updateServicesAndPrices(anuncio) {
            console.log('💰 Atualizando serviços e preços...');
            
            // Atualizar preço
            const priceValue = document.querySelector('.price-value');
            if (priceValue) {
                // Tentar múltiplos campos de preço
                const preco = anuncio.preco_1h || 
                             anuncio.preco_1hora || 
                             anuncio.preco1h || 
                             anuncio.valor_1h ||
                             anuncio.preco ||
                             '300'; // Valor padrão
                
                const precoFormatado = typeof preco === 'number' ? preco.toFixed(2) : preco.replace(/[^\d,]/g, '').replace(',', '.');
                priceValue.textContent = `R$ ${precoFormatado}`;
                console.log('✅ Preço atualizado:', priceValue.textContent);
            }
            
            // Atualizar campo "Local" na seção de informações básicas (Com Local / Sem Local)
            const infoLocal = document.getElementById('info-local');
            if (infoLocal) {
                let localText = 'Não informado';
                if (anuncio.local) {
                    const localValue = String(anuncio.local).toLowerCase().trim();
                    if (localValue === 'com local' || localValue === 'com-local' || localValue === 'temos-local' || localValue === 'sim') {
                        localText = 'Com Local';
                    } else if (localValue === 'sem local' || localValue === 'sem-local' || localValue === 'nao' || localValue === 'não') {
                        localText = 'Sem Local';
                    } else {
                        localText = String(anuncio.local);
                    }
                }
                infoLocal.textContent = localText;
                console.log(`✅ Campo "Local" (info-local) atualizado: ${localText}`);
            }
            
            // Atualizar localização (cidade/estado para outros campos)
            // Declarar variáveis fora dos blocos if para poder usar depois
            const cidade = anuncio.cidade || anuncio.city || 'Não informado';
            const estado = anuncio.estado || anuncio.state || 'SP';
            
            const locationCity = document.querySelector('.location-city');
            if (locationCity) {
                locationCity.textContent = cidade;
                console.log('✅ Cidade atualizada:', cidade);
            }
            
            const locationState = document.querySelector('.location-state');
            if (locationState) {
                const estadoCompleto = cidade && cidade !== 'Não informado' 
                    ? `${cidade} - ${estado}` 
                    : estado;
                locationState.textContent = estadoCompleto;
                console.log('✅ Estado atualizado:', estadoCompleto);
            }
            
            // Atualizar "Mora só"
            const locationText = document.querySelector('.location-text');
            if (locationText) {
                const moraSo = anuncio['mora-so'] || 
                              anuncio.mora_so || 
                              anuncio.moraSo ||
                              'Não informado';
                locationText.textContent = moraSo === 'sim' || moraSo === 'Sim' || moraSo === true 
                    ? 'Mora só' 
                    : moraSo;
                console.log('✅ Mora só atualizado:', locationText.textContent);
            }
            
            // Atualizar serviço (atende mulheres/homens)
            const serviceText = document.querySelector('.service-text');
            if (serviceText) {
                const genero = (anuncio.genero || anuncio.gender || '').toLowerCase();
                if (genero === 'mulher' || genero === 'mulher-luxo') {
                    serviceText.textContent = 'atende mulheres';
                } else if (genero === 'homem') {
                    serviceText.textContent = 'atende homens';
                } else if (genero === 'trans') {
                    serviceText.textContent = 'atende todos';
                } else {
                    serviceText.textContent = 'atende todos';
                }
                console.log('✅ Serviço atualizado:', serviceText.textContent);
            }
        }

        // Função comum para processar e retornar o texto do campo "Atende"
        function processarCampoAtende(anuncio) {
            console.log('\n🔍 ========== PROCESSAR CAMPO ATENDE ==========');
            console.log('📦 anuncio.atende:', anuncio.atende, `(tipo: ${typeof anuncio.atende}, é array: ${Array.isArray(anuncio.atende)})`);
            console.log('📦 Campos relacionados:');
            console.log('  - atende_homens:', anuncio.atende_homens);
            console.log('  - atende_mulheres:', anuncio.atende_mulheres);
            console.log('  - atende_trans:', anuncio.atende_trans);
            console.log('  - atende_casais:', anuncio.atende_casais);
            
            const genero = (anuncio.genero || anuncio.gender || '').toLowerCase();
            const categoria = (anuncio.categoria || anuncio.category || '').toLowerCase();
            
            let atende = 'Não informado';
            
            // Construir lista de "Atende" baseado em campos booleanos ou array
            const atendeList = [];
            if (anuncio.atende_homens || anuncio.atendeHomens || anuncio['atende-homens']) {
                console.log('  ✅ atende_homens encontrado');
                atendeList.push('Ele');
            }
            if (anuncio.atende_mulheres || anuncio.atendeMulheres || anuncio['atende-mulheres']) {
                console.log('  ✅ atende_mulheres encontrado');
                atendeList.push('Ela');
            }
            if (anuncio.atende_trans || anuncio.atendeTrans || anuncio['atende-trans']) {
                console.log('  ✅ atende_trans encontrado');
                atendeList.push('Trans');
            }
            if (anuncio.atende_casais || anuncio.atendeCasais || anuncio['atende-casais'] || anuncio.casais) {
                console.log('  ✅ atende_casais encontrado');
                atendeList.push('Casais');
            }
            
            console.log(`📊 Lista de campos booleanos: ${atendeList.length} itens`);
            
            // Se tiver campos booleanos, usar eles
            if (atendeList.length > 0) {
                atende = atendeList.join(', ');
                console.log(`✅ "Atende" dos campos booleanos: "${atende}"`);
            }
            // Se não tiver campos booleanos, tentar campo direto "atende" (pode ser array ou string)
            else if (anuncio.atende) {
                console.log('📦 Tentando processar campo direto "atende"');
                if (Array.isArray(anuncio.atende)) {
                    console.log(`📦 Array com ${anuncio.atende.length} elementos:`, anuncio.atende);
                    
                    // Filtrar valores inválidos ("on", null, undefined, "")
                    const atendeValido = anuncio.atende.filter(a => {
                        const valor = String(a).toLowerCase().trim();
                        const valido = valor && valor !== 'on' && valor !== 'null' && valor !== 'undefined' && valor !== '';
                        if (!valido) {
                            console.log(`  ❌ Filtrado: "${a}" (inválido)`);
                        }
                        return valido;
                    });
                    
                    console.log(`📦 Após filtro: ${atendeValido.length} valores válidos:`, atendeValido);
                    
                    if (atendeValido.length > 0) {
                        // Mapear valores para textos exibidos
                        atende = atendeValido.map(a => {
                            const val = String(a).toLowerCase().trim();
                            let resultado;
                            if (val === 'ele' || val === 'homem' || val === 'homens') {
                                resultado = 'Ele';
                            } else if (val === 'ela' || val === 'mulher' || val === 'mulheres') {
                                resultado = 'Ela';
                            } else if (val === 'trans') {
                                resultado = 'Trans';
                            } else if (val === 'casais' || val === 'casal') {
                                resultado = 'Casais';
                            } else {
                                resultado = String(a).charAt(0).toUpperCase() + String(a).slice(1).toLowerCase();
                            }
                            console.log(`  ✅ Mapeado: "${a}" → "${resultado}"`);
                            return resultado;
                        }).join(', ');
                        
                        console.log(`✅ "Atende" final do array: "${atende}"`);
                    } else {
                        console.warn('⚠️ Nenhum valor válido após filtro do array');
                    }
                } else {
                    console.log('📦 Campo "atende" é string:', anuncio.atende);
                    const val = String(anuncio.atende).toLowerCase().trim();
                    if (val !== 'on' && val !== 'null' && val !== 'undefined' && val !== '') {
                        if (val === 'todos' || val === 'all') {
                            atende = 'Todos';
                        } else {
                            atende = String(anuncio.atende);
                        }
                        console.log(`✅ "Atende" final da string: "${atende}"`);
                    } else {
                        console.warn('⚠️ Campo "atende" contém valor inválido:', anuncio.atende);
                    }
                }
            } else {
                console.warn('⚠️ Campo "atende" não existe no objeto anuncio');
            }
            
            // FALLBACK: Se ainda for "Não informado" mas o array existe com valores "on",
            // significa que foi criado com formulário antigo. Vamos INFERIR baseado na quantidade:
            if (atende === 'Não informado' && Array.isArray(anuncio.atende) && anuncio.atende.length > 0) {
                console.warn('⚠️⚠️⚠️ ANÚNCIO ANTIGO DETECTADO!');
                console.warn('   Campo "atende" contém apenas valores "on" (formulário antigo).');
                console.warn(`   Array encontrado: ${anuncio.atende.length} elementos`, anuncio.atende);
                
                // INFERÊNCIA: Se o array tem 3 elementos "on", provavelmente os 3 checkboxes foram marcados
                if (anuncio.atende.length === 3) {
                    console.warn('   ✅ INFERÊNCIA: Array com 3 elementos "on" → Todos os checkboxes marcados');
                    console.warn('   ✅ Aplicando inferência: "Ele, Ela, Casais"');
                    atende = 'Ele, Ela, Casais';
                }
                // Se tiver 2 elementos, pode ser diferentes combinações (mais complexo inferir)
                else if (anuncio.atende.length === 2) {
                    console.warn('   ⚠️ INFERÊNCIA PARCIAL: Array com 2 elementos "on"');
                    console.warn('   ⚠️ Não é possível determinar quais checkboxes foram marcados sem recriar o anúncio.');
                    console.warn('   ⚠️ Mantendo "Não informado" - RECOMENDADO RECRIAR o anúncio.');
                }
                // Se tiver 1 elemento
                else if (anuncio.atende.length === 1) {
                    console.warn('   ⚠️ INFERÊNCIA PARCIAL: Array com 1 elemento "on"');
                    console.warn('   ⚠️ Não é possível determinar qual checkbox foi marcado sem recriar o anúncio.');
                    console.warn('   ⚠️ Mantendo "Não informado" - RECOMENDADO RECRIAR o anúncio.');
                }
                else {
                    console.warn('   ⚠️ Quantidade inesperada de elementos:', anuncio.atende.length);
                    console.warn('   ⚠️ RECOMENDADO RECRIAR o anúncio com o formulário atualizado.');
                }
            }
            
            console.log(`📋 RESULTADO FINAL: "${atende}"`);
            console.log('==========================================\n');
            return atende;
        }
        
        // Função para carregar informações básicas (obrigatórias)
        function loadBasicInfo(anuncio) {
            console.log('📝 ========== INICIANDO loadBasicInfo ==========');
            console.log('📝 Dados recebidos:', {
                nome: anuncio.nome || anuncio.name,
                idade: anuncio.idade,
                peso: anuncio.peso,
                altura: anuncio.altura,
                oral_sem: anuncio.oral_sem || anuncio['oral-sem'],
                beija: anuncio.beija,
                anal: anuncio.anal,
                mora_so: anuncio.mora_so || anuncio['mora-so'],
                valor: anuncio.valor || anuncio.cache,
                horario_24h: anuncio.horario_24h,
                horario_inicio: anuncio.horario_inicio,
                horario_fim: anuncio.horario_fim,
                pagamento: anuncio.pagamento,
                telefone_celular: anuncio.telefone_celular,
                telefone: anuncio.telefone,
                cidade: anuncio.cidade,
                estado: anuncio.estado,
                categoria: anuncio.categoria || anuncio.category
            });
            
            const nomeEl = document.getElementById('info-nome');
            if (nomeEl) {
                nomeEl.textContent = anuncio.nome || anuncio.name || 'Não informado';
                console.log('✅ Nome atualizado:', nomeEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-nome não encontrado');
            }
            
            const idadeEl = document.getElementById('info-idade');
            if (idadeEl) {
                idadeEl.textContent = anuncio.idade || 'Não informado';
                console.log('✅ Idade atualizada:', idadeEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-idade não encontrado');
            }
            
            const pesoEl = document.getElementById('info-peso');
            if (pesoEl) {
                const pesoValue = anuncio.peso || 'Não informado';
                // Adicionar 'kg' se o valor não contiver unidade e não for 'Não informado'
                pesoEl.textContent = pesoValue === 'Não informado' ? pesoValue : (pesoValue.includes('kg') ? pesoValue : pesoValue + 'kg');
                console.log('✅ Peso atualizado:', pesoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-peso não encontrado');
            }
            
            const alturaEl = document.getElementById('info-altura');
            if (alturaEl) {
                const alturaValue = anuncio.altura || 'Não informado';
                // Adicionar 'm' se o valor não contiver unidade e não for 'Não informado'
                alturaEl.textContent = alturaValue === 'Não informado' ? alturaValue : (alturaValue.includes('m') || alturaValue.includes('cm') ? alturaValue : alturaValue + 'm');
                console.log('✅ Altura atualizada:', alturaEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-altura não encontrado');
            }
            
            const telefoneEl = document.getElementById('info-telefone');
            if (telefoneEl) {
                telefoneEl.textContent = anuncio.telefone_celular || anuncio.telefone || 'Não informado';
                console.log('✅ Telefone atualizado:', telefoneEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-telefone não encontrado');
            }
            
            const localizacaoEl = document.getElementById('info-localizacao');
            if (localizacaoEl) {
                localizacaoEl.textContent = `${anuncio.cidade || 'Não informado'}, ${anuncio.estado || 'Não informado'}`;
                console.log('✅ Localização atualizada:', localizacaoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-localizacao não encontrado');
            }
            
            const categoriaEl = document.getElementById('info-categoria');
            if (categoriaEl) {
                categoriaEl.textContent = anuncio.categoria || anuncio.category || 'Não informado';
                console.log('✅ Categoria atualizada:', categoriaEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-categoria não encontrado');
            }
            
            const tipoEl = document.getElementById('info-tipo');
            if (tipoEl) {
                tipoEl.textContent = anuncio.category || anuncio.categoria || 'Não informado';
                console.log('✅ Tipo atualizado:', tipoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-tipo não encontrado');
            }
            
            // Atualizar campo "Atende" na seção de informações básicas
            const atendeEl = document.getElementById('info-atende');
            if (atendeEl) {
                const atendeTexto = processarCampoAtende(anuncio);
                atendeEl.textContent = atendeTexto;
                console.log('✅ info-atende atualizado:', atendeTexto);
            }
            
            // Atualizar campo "Oral sem"
            const oralSemEl = document.getElementById('info-oral-sem');
            if (oralSemEl) {
                const oralSemValue = anuncio.oral_sem || anuncio['oral-sem'] || null;
                oralSemEl.textContent = oralSemValue === 'sim' ? 'Sim' : (oralSemValue || 'Não informado');
                console.log('✅ Oral sem atualizado:', oralSemEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-oral-sem não encontrado');
            }
            
            // Atualizar campo "Beija"
            const beijaEl = document.getElementById('info-beija');
            if (beijaEl) {
                const beijaValue = anuncio.beija || null;
                beijaEl.textContent = beijaValue === 'sim' ? 'Sim' : (beijaValue || 'Não informado');
                console.log('✅ Beija atualizado:', beijaEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-beija não encontrado');
            }
            
            // Atualizar campo "Anal"
            const analEl = document.getElementById('info-anal');
            if (analEl) {
                const analValue = anuncio.anal || null;
                analEl.textContent = analValue === 'sim' ? 'Sim' : (analValue || 'Não informado');
                console.log('✅ Anal atualizado:', analEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-anal não encontrado');
            }
            
            // Atualizar campo "Mora só"
            const moraSoEl = document.getElementById('info-mora-so');
            if (moraSoEl) {
                const moraSoValue = anuncio.mora_so || anuncio['mora-so'] || null;
                moraSoEl.textContent = moraSoValue === 'sim' ? 'Sim' : (moraSoValue || 'Não informado');
                console.log('✅ Mora só atualizado:', moraSoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-mora-so não encontrado');
            }
            
            // Atualizar campo "Valor"
            const valorEl = document.getElementById('info-valor');
            if (valorEl) {
                let valorTexto = 'Não informado';
                let valorNumerico = null;
                
                // Função auxiliar para validar e formatar valor
                const validarEFormatarValor = (valor) => {
                    if (!valor) return null;
                    
                    // Converter para string e remover caracteres não numéricos
                    let valorStr = String(valor).replace(/[^\d,.]/g, '').replace(',', '.');
                    
                    // Converter para número
                    let valorNum = parseFloat(valorStr);
                    
                    // Verificar se é um número válido
                    if (isNaN(valorNum) || !isFinite(valorNum)) {
                        console.warn('⚠️ Valor inválido:', valor);
                        return null;
                    }
                    
                    // Converter para inteiro (remover decimais)
                    valorNum = Math.floor(valorNum);
                    
                    // Validar limite máximo de 10.000
                    if (valorNum > 10000) {
                        console.warn('⚠️ Valor excede o limite de R$ 10.000:', valorNum);
                        valorNum = 10000; // Limitar ao máximo permitido
                    }
                    
                    // Validar que não seja negativo
                    if (valorNum < 0) {
                        console.warn('⚠️ Valor negativo não permitido:', valorNum);
                        return null;
                    }
                    
                    return valorNum;
                };
                
                // Tentar pegar de diferentes campos possíveis
                if (anuncio.valor) {
                    valorNumerico = validarEFormatarValor(anuncio.valor);
                } else if (anuncio.cache) {
                    valorNumerico = validarEFormatarValor(anuncio.cache);
                } else if (anuncio.preco_1h) {
                    valorNumerico = validarEFormatarValor(anuncio.preco_1h);
                } else if (anuncio.preco_30min) {
                    valorNumerico = validarEFormatarValor(anuncio.preco_30min);
                }
                
                // Formatar valor se válido
                if (valorNumerico !== null && valorNumerico !== undefined) {
                    // Formatar com separador de milhar
                    valorTexto = `R$ ${valorNumerico.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}`;
                }
                
                valorEl.textContent = valorTexto;
                console.log('✅ Valor atualizado:', valorEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-valor não encontrado');
            }
            
            // Atualizar campo "Horário de Atendimento"
            const horarioEl = document.getElementById('info-horario');
            if (horarioEl) {
                let horarioTexto = 'Não informado';
                if (anuncio.horario_24h === true || anuncio.horario_24h === 'sim' || anuncio.horario_24h === 'Sim') {
                    horarioTexto = '24h';
                } else if (anuncio.horario_inicio && anuncio.horario_fim) {
                    horarioTexto = `${anuncio.horario_inicio} às ${anuncio.horario_fim}`;
                } else if (anuncio.horario_inicio) {
                    horarioTexto = `A partir das ${anuncio.horario_inicio}`;
                }
                horarioEl.textContent = horarioTexto;
                console.log('✅ Horário atualizado:', horarioEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-horario não encontrado');
            }
            
            // Atualizar campo "Formas de Pagamento"
            const pagamentoEl = document.getElementById('info-pagamento');
            if (pagamentoEl) {
                let pagamentoTexto = 'Não informado';
                const pagamento = anuncio.pagamento || anuncio.formas_pagamento || [];
                
                if (Array.isArray(pagamento) && pagamento.length > 0) {
                    // Capitalizar primeira letra de cada forma de pagamento
                    pagamentoTexto = pagamento.map(p => {
                        const pStr = String(p).toLowerCase();
                        return pStr.charAt(0).toUpperCase() + pStr.slice(1);
                    }).join(' ');
                } else if (typeof pagamento === 'string' && pagamento.trim()) {
                    pagamentoTexto = pagamento;
                }
                
                pagamentoEl.textContent = pagamentoTexto;
                console.log('✅ Formas de pagamento atualizado:', pagamentoEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-pagamento não encontrado');
            }
            
            // Atualizar campo "Local"
            const localEl = document.getElementById('info-local');
            if (localEl) {
                let localText = 'Não informado';
                if (anuncio.local) {
                    const localValue = String(anuncio.local).toLowerCase().trim();
                    if (localValue === 'com local' || localValue === 'com-local' || localValue === 'temos-local' || localValue === 'sim') {
                        localText = 'Com Local';
                    } else if (localValue === 'sem local' || localValue === 'sem-local' || localValue === 'nao' || localValue === 'não') {
                        localText = 'Sem Local';
                    } else {
                        localText = String(anuncio.local);
                    }
                }
                localEl.textContent = localText;
                console.log('✅ Local atualizado:', localEl.textContent);
            } else {
                console.warn('⚠️ Elemento info-local não encontrado');
            }
        }

        // Função para carregar informações opcionais
        function loadOptionalInfo(anuncio) {
            // Seção "Características Físicas" removida - dados já aparecem em "Informações Básicas"
            // Seção "Preferências de Serviços" removida - dados já aparecem em "Informações Básicas"
            // Não precisa carregar nada aqui relacionado a essas seções

            // Horários de atendimento
            const scheduleSection = document.getElementById('schedule-section');
            let hasScheduleInfo = false;
            
            if (anuncio.horario_inicio) {
                const horarioInicioEl = document.getElementById('info-horario-inicio');
                if (horarioInicioEl) {
                    horarioInicioEl.textContent = anuncio.horario_inicio;
                    hasScheduleInfo = true;
                }
            }
            if (anuncio.horario_fim) {
                const horarioFimEl = document.getElementById('info-horario-fim');
                if (horarioFimEl) {
                    horarioFimEl.textContent = anuncio.horario_fim;
                    hasScheduleInfo = true;
                }
            }
            
            if (hasScheduleInfo && scheduleSection) {
                scheduleSection.style.display = 'block';
            }
            
            // Atualizar estatísticas (views e likes) após atualizar o perfil
            // Usar setTimeout para garantir que o elemento esteja no DOM
            setTimeout(() => {
                updateProfileStats(anuncio, 0); // totalFotos será atualizado quando loadGallery for chamado
            }, 100);
        }

        // Função para carregar dados específicos de massagista
        function loadMassagistaData(anuncio) {
            console.log('💆 ========== INICIANDO loadMassagistaData ==========');
            console.log('💆 Anúncio recebido:', {
                id: anuncio.id,
                nome: anuncio.nome,
                categoria: anuncio.categoria || anuncio.category
            });

            // Verificar se é um anúncio de massagista
            // Verificar múltiplas formas de identificar um massagista
            const categoria = (anuncio.categoria || anuncio.category || '').toLowerCase();
            const temDadosMassagista = anuncio['tipos-massagem'] || 
                                      anuncio.tipos_massagem || 
                                      anuncio.finalizacao ||
                                      anuncio['servicos-extras'] ||
                                      anuncio.servicos_extras_massagista ||
                                      anuncio['atendimento-massagem'] ||
                                      anuncio.atendimento_massagem ||
                                      anuncio.instalacoes;

            const isMassagista = categoria.includes('massag') || 
                                categoria === 'massagistas' ||
                                categoria === 'massagista' ||
                                !!temDadosMassagista;

            console.log('💆 Verificação de massagista:', {
                categoria: categoria,
                temDadosMassagista: !!temDadosMassagista,
                isMassagista: isMassagista
            });

            if (!isMassagista) {
                console.log('⚠️ Não é um anúncio de massagista, ocultando seção');
                const massagistaSection = document.querySelector('.services-form-section');
                if (massagistaSection) {
                    massagistaSection.style.display = 'none';
                }
                return;
            }

            // Mostrar a seção de massagista
            const massagistaSection = document.querySelector('.services-form-section');
            if (massagistaSection) {
                massagistaSection.style.display = 'block';
                console.log('✅ Seção de massagista exibida');
            }

            // Mapeamento de valores do Firebase para valores dos checkboxes
            const mapeamentoTiposMassagem = {
                'terapeutica': 'terapeutica',
                'relaxante': 'relaxante',
                'sensoriais': 'sensoriais',
                'corpo-corpo': 'corpo-corpo',
                'corpo a corpo': 'corpo-corpo',
                'tantrica': 'tantrica',
                'tântrica': 'tantrica',
                'prostatica': 'prostatica',
                'prostática': 'prostatica',
                'tailandesa': 'tailandesa',
                'tailandesa': 'tailandesa',
                'sensual': 'sensual',
                'nuru': 'nuru',
                'drenagem': 'drenagem',
                'drenagem linfática': 'drenagem',
                'esportiva': 'esportiva',
                'modeladora': 'modeladora',
                'shiatsu': 'shiatsu',
                'vivencia': 'vivencia',
                'vivência': 'vivencia',
                'reflexologia': 'reflexologia',
                '4-maos': '4-maos',
                '4 mãos': '4-maos'
            };

            const mapeamentoFinalizacao = {
                'masturbacao': 'masturbacao',
                'masturbação': 'masturbacao',
                'sexo-oral': 'sexo-oral',
                'sexo oral': 'sexo-oral',
                'penetracao': 'penetracao',
                'penetração': 'penetracao'
            };

            const mapeamentoServicosExtras = {
                'depilacao': 'depilacao',
                'depilação': 'depilacao',
                'estetica': 'estetica',
                'estética': 'estetica',
                'reflexologia-podal': 'reflexologia-podal',
                'reflexologia podal': 'reflexologia-podal',
                'liberacao-miofacial': 'liberacao-miofacial',
                'liberação miofacial': 'liberacao-miofacial',
                'pedras-quentes': 'pedras-quentes',
                'pedras quentes': 'pedras-quentes',
                'massagem-brinquedos': 'massagem-brinquedos',
                'massagens com brinquedos': 'massagem-brinquedos',
                'escalda-pes': 'escalda-pes',
                'escalda pés': 'escalda-pes'
            };

            const mapeamentoAtendimento = {
                'homens': 'homens',
                'mulheres': 'mulheres',
                'trans': 'trans',
                'casais': 'casais'
            };

            const mapeamentoInstalacoes = {
                'temos-local': 'temos-local',
                'temos local': 'temos-local',
                'a-domicilio': 'a-domicilio',
                'a domicílio': 'a-domicilio',
                'em-hotel': 'em-hotel',
                'em hotel': 'em-hotel',
                'em-motel': 'em-motel',
                'em motel': 'em-motel',
                'ducha': 'ducha',
                'banheira': 'banheira',
                'maca': 'maca',
                'tatami': 'tatami',
                'oleos-essenciais': 'oleos-essenciais',
                'óleos essenciais': 'oleos-essenciais',
                'velas-aromaticas': 'velas-aromaticas',
                'velas aromáticas': 'velas-aromaticas',
                'musica-relaxante': 'musica-relaxante',
                'música relaxante': 'musica-relaxante',
                'material-descartavel': 'material-descartavel',
                'material descartável': 'material-descartavel'
            };

            // Função auxiliar para normalizar valores
            function normalizarValor(valor) {
                if (!valor) return null;
                return String(valor).toLowerCase().trim();
            }

            // Função auxiliar para marcar checkboxes baseado em array
            function marcarCheckboxes(containerId, arrayData, mapeamento) {
                const container = document.getElementById(containerId);
                if (!container) {
                    console.warn(`⚠️ Container ${containerId} não encontrado`);
                    return;
                }

                // Obter array do Firebase (pode estar em diferentes campos)
                let array = [];
                if (Array.isArray(arrayData)) {
                    array = arrayData.filter(item => item !== null && item !== undefined && item !== '');
                } else if (arrayData) {
                    // Se for string, tentar converter
                    try {
                        const parsed = JSON.parse(arrayData);
                        if (Array.isArray(parsed)) {
                            array = parsed.filter(item => item !== null && item !== undefined && item !== '');
                        }
                    } catch (e) {
                        array = String(arrayData).split(',').map(s => s.trim()).filter(s => s !== '');
                    }
                }

                console.log(`📋 ${containerId}: Array recebido:`, array);

                if (array.length === 0) {
                    console.log(`⚠️ ${containerId}: Array vazio, nenhum checkbox será marcado`);
                    return;
                }

                // Marcar checkboxes
                const checkboxes = container.querySelectorAll('input[type="checkbox"]');
                let marcados = 0;

                checkboxes.forEach(checkbox => {
                    const valorCheckbox = checkbox.value;
                    const valorNormalizado = normalizarValor(valorCheckbox);

                    // Verificar se o valor está no array
                    const encontrado = array.some(item => {
                        const itemNormalizado = normalizarValor(item);
                        
                        // Comparação direta
                        if (itemNormalizado === valorNormalizado) {
                            return true;
                        }

                        // Verificar mapeamento
                        const mapeado = mapeamento[itemNormalizado];
                        if (mapeado && mapeado === valorNormalizado) {
                            return true;
                        }

                        // Verificar mapeamento reverso
                        const mapeadoReverso = Object.keys(mapeamento).find(key => 
                            mapeamento[key] === valorNormalizado
                        );
                        if (mapeadoReverso && normalizarValor(mapeadoReverso) === itemNormalizado) {
                            return true;
                        }

                        return false;
                    });

                    if (encontrado) {
                        checkbox.checked = true;
                        // Adicionar estilo visual quando marcado
                        const label = checkbox.closest('label');
                        if (label) {
                            label.style.borderColor = '#007bff';
                            label.style.background = '#e7f3ff';
                            label.style.fontWeight = '500';
                        }
                        marcados++;
                        console.log(`  ✅ Checkbox marcado: ${valorCheckbox}`);
                    } else {
                        checkbox.checked = false;
                        const label = checkbox.closest('label');
                        if (label) {
                            // Ocultar completamente os itens que NÃO foram selecionados
                            label.style.display = 'none';
                        }
                    }
                });

                console.log(`✅ ${containerId}: ${marcados} checkboxes marcados de ${checkboxes.length} total`);
                
                // Se nenhum checkbox foi marcado, ocultar o container inteiro
                if (marcados === 0 && container) {
                    // Ocultar o título h4 anterior também
                    const titulo = container.previousElementSibling;
                    if (titulo && titulo.tagName === 'H4') {
                        titulo.style.display = 'none';
                    }
                    container.style.display = 'none';
                }
            }

            // Carregar Tipos de Massagens
            const tiposMassagem = anuncio['tipos-massagem'] || 
                                 anuncio.tipos_massagem || 
                                 anuncio.tiposMassagem ||
                                 [];
            console.log('💆 Tipos de Massagens do Firebase:', tiposMassagem);
            marcarCheckboxes('tipos-massagem-container', tiposMassagem, mapeamentoTiposMassagem);

            // Carregar Finalização
            const finalizacao = anuncio.finalizacao || [];
            console.log('💆 Finalização do Firebase:', finalizacao);
            marcarCheckboxes('finalizacao-container', finalizacao, mapeamentoFinalizacao);

            // Carregar Serviços Extras (específicos de massagista)
            // NOTA: Este é diferente do campo servicos_extras genérico
            // Verificar múltiplos campos possíveis
            let servicosExtrasMassagista = anuncio['servicos-extras'] || 
                                           anuncio.servicos_extras_massagista ||
                                           anuncio.servicos_extras_massagem ||
                                           [];
            
            // Se servicos_extras genérico contém serviços específicos de massagista, usar ele também
            if (anuncio.servicos_extras && Array.isArray(anuncio.servicos_extras)) {
                const servicosMassagista = ['depilacao', 'depilação', 'estetica', 'estética', 
                                           'reflexologia-podal', 'reflexologia podal',
                                           'liberacao-miofacial', 'liberação miofacial',
                                           'pedras-quentes', 'pedras quentes',
                                           'massagem-brinquedos', 'massagens com brinquedos',
                                           'escalda-pes', 'escalda pés'];
                const filtrados = anuncio.servicos_extras.filter(s => {
                    const sLower = String(s).toLowerCase();
                    return servicosMassagista.some(sm => sLower.includes(sm.toLowerCase()));
                });
                if (filtrados.length > 0) {
                    servicosExtrasMassagista = Array.isArray(servicosExtrasMassagista) 
                        ? [...servicosExtrasMassagista, ...filtrados]
                        : filtrados;
                }
            }
            
            console.log('💆 Serviços Extras (Massagista) do Firebase:', servicosExtrasMassagista);
            marcarCheckboxes('servicos-extras-massagista-container', servicosExtrasMassagista, mapeamentoServicosExtras);

            // Carregar Atendimento das Massagens Para
            const atendimentoMassagem = anuncio['atendimento-massagem'] || 
                                       anuncio.atendimento_massagem || 
                                       anuncio.atendimento ||
                                       [];
            console.log('💆 Atendimento das Massagens do Firebase:', atendimentoMassagem);
            marcarCheckboxes('atendimento-massagem-container', atendimentoMassagem, mapeamentoAtendimento);

            // Carregar Instalações
            const instalacoes = anuncio.instalacoes || [];
            console.log('💆 Instalações do Firebase:', instalacoes);
            marcarCheckboxes('instalacoes-container', instalacoes, mapeamentoInstalacoes);

            console.log('✅ loadMassagistaData concluído');
        }

        // Função para gerenciar likes das fotos da galeria
        function handleGalleryLike(event, photoIndex, photoUrl) {
            event.preventDefault();
            event.stopPropagation();
            
            const likeBtn = event.currentTarget;
            const isLiked = likeBtn.classList.contains('liked');
            const icon = likeBtn.querySelector('i');
            
            // Alternar estado de like
            if (isLiked) {
                // Remover like
                likeBtn.classList.remove('liked');
                icon.className = 'far fa-thumbs-up';
                console.log(`💔 Like removido da foto ${photoIndex + 1}`);
            } else {
                // Adicionar like
                likeBtn.classList.add('liked');
                icon.className = 'fas fa-thumbs-up';
                console.log(`👍 Like adicionado à foto ${photoIndex + 1}`);
                
                // Rastrear like nas estatísticas
                if (typeof trackLike === 'function') {
                    trackLike(photoUrl || `photo_${photoIndex}`);
                }
            }
            
            // Aqui você pode adicionar lógica para salvar no Firebase
            // Por exemplo, salvar em uma coleção de likes ou atualizar contador
            // Exemplo:
            // if (window.db && window.currentAnuncioId) {
            //     const likesRef = window.db.collection('gallery_likes').doc(`${window.currentAnuncioId}_${photoIndex}`);
            //     if (!isLiked) {
            //         likesRef.set({
            //             anuncioId: window.currentAnuncioId,
            //             photoIndex: photoIndex,
            //             photoUrl: photoUrl,
            //             likedAt: firebase.firestore.FieldValue.serverTimestamp()
            //         });
            //     } else {
            //         likesRef.delete();
            //     }
            // }
        }

        // Função para carregar galeria
        function loadGallery(anuncio) {
            console.log('🖼️ Iniciando loadGallery...');
            const pubBook = document.querySelector('.pub-book');
            if (!pubBook) {
                console.warn('⚠️ Elemento .pub-book não encontrado');
                return;
            }

            // Limpar galeria de teste
            pubBook.innerHTML = '';

            // Função auxiliar para converter URL do Firebase
            function getFirebaseImageUrl(url, anuncioId) {
                if (!url) return null;
                
                // Se já é uma URL completa, usar diretamente
                if (url.startsWith('http://') || url.startsWith('https://')) {
                    return url;
                }
                
                // Se é gs://, converter
                if (url.startsWith('gs://')) {
                    const path = url.replace('gs://copia-do-job.firebasestorage.app/', '').replace(/^\/+/, '');
                    return `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                }
                
                // Se é um nome de arquivo, construir URL (estrutura padronizada)
                if (!url.includes('://')) {
                    const path = `advertisements/${anuncioId}/${url}`;
                    return `https://firebasestorage.googleapis.com/v0/b/copia-do-job.firebasestorage.app/o/${encodeURIComponent(path)}?alt=media`;
                }
                
                return url;
            }

            // Coletar todas as fotos da galeria
            const fotos = [];

            // Helper: verificar se uma URL é de imagem (NÃO vídeo/áudio/documento)
            function isImageUrl(url) {
                if (!url || typeof url !== 'string') return false;
                const urlLower = url.toLowerCase();
                if (/\.(mp4|avi|mov|wmv|webm|mkv|flv|3gp)(\?|$)/i.test(urlLower)) return false;
                if (/\.(mp3|wav|ogg|m4a|aac|flac)(\?|$)/i.test(urlLower)) return false;
                if (urlLower.includes('upload_doc') || urlLower.includes('upload%2fdoc') || urlLower.includes('upload_doc%2f')) return false;
                return true;
            }

            // Helper: verificar se um campo é de documento/verificação (EXCLUIR da galeria)
            function isCampoDocumento(chave) {
                const cl = chave.toLowerCase();
                return cl.includes('documento') || cl.includes('selfie') || cl.includes('verification') ||
                       cl.includes('upload_doc') || cl.includes('doc_') || cl.includes('_doc');
            }

            // Helper para adicionar URL sem duplicatas (só imagens válidas)
            function addFoto(rawUrl) {
                if (!rawUrl || typeof rawUrl !== 'string') return;
                if (!isImageUrl(rawUrl)) return;
                const url = getFirebaseImageUrl(rawUrl, anuncio.id);
                if (url && !fotos.includes(url) && isImageUrl(url)) {
                    fotos.push(url);
                }
            }

            // ========== 1) foto_banner ==========
            const bannerCampos = ['foto_banner_url', 'foto_banner', 'banner_url', 'banner'];
            for (const campo of bannerCampos) {
                if (anuncio[campo]) { addFoto(anuncio[campo]); break; }
            }

            // ========== 2) foto_capa ==========
            const capaCampos = ['foto_capa_url', 'foto_capa', 'coverImage', 'profileImage', 'capa_url', 'capa'];
            for (const campo of capaCampos) {
                if (anuncio[campo]) { addFoto(anuncio[campo]); break; }
            }

            // ========== 3) foto_stories / galeria_9 ==========
            const storiesCampos = ['foto_stories_url', 'foto_stories', 'stories_photo_url', 'stories_photo'];
            for (const campo of storiesCampos) {
                if (anuncio[campo]) { addFoto(anuncio[campo]); break; }
            }

            // ========== 4) Campos individuais galeria_N (N de 1 até 20) ==========
            for (let i = 1; i <= 20; i++) {
                const variantes = [
                    `galeria_${i}_url`, `foto_galeria_${i}_url`, `galeria_${i}`, `foto_galeria_${i}`,
                    `gallery_${i}_url`, `gallery_${i}`, `photo_${i}_url`, `photo_${i}`,
                    `foto_${i}_url`, `foto_${i}`,
                ];
                for (const campo of variantes) {
                    if (anuncio[campo]) { addFoto(anuncio[campo]); break; }
                }
            }

            // ========== 5) Arrays conhecidos ==========
            const arraysConhecidos = ['images', 'fotos', 'photos', 'galeria', 'gallery'];
            arraysConhecidos.forEach(campo => {
                const arr = anuncio[campo];
                if (arr && Array.isArray(arr)) {
                    arr.forEach(item => {
                        if (typeof item === 'string') addFoto(item);
                        else if (item && typeof item === 'object') addFoto(item.url || item.src || item.downloadURL || item.photo_url || item.imageUrl);
                    });
                }
            });

            // ========== 6) Objeto mediaFiles ==========
            if (anuncio.mediaFiles && typeof anuncio.mediaFiles === 'object') {
                const mf = anuncio.mediaFiles;
                ['galeria', 'photos', 'images', 'gallery', 'fotos'].forEach(campo => {
                    const arr = mf[campo];
                    if (arr && Array.isArray(arr)) {
                        arr.forEach(item => {
                            if (typeof item === 'string') addFoto(item);
                            else if (item && typeof item === 'object') addFoto(item.url || item.src || item.downloadURL || item.photo_url || item.imageUrl);
                        });
                    }
                });
            }

            // ========== 7) Varredura genérica SEGURA ==========
            const camposExcluidos = new Set([
                'id', 'nome', 'name', 'descricao', 'description',
                'email', 'userEmail', 'telefone', 'telefone_celular', 'telefone_fixo',
                'status', 'plano', 'categoria', 'category', 'genero', 'gender',
                'cidade', 'city', 'estado', 'state', 'bairro',
                'createdAt', 'updatedAt', 'syncedAt', 'created_at', 'updated_at',
                'advertiserId', 'firebaseId', 'userId', 'anuncioId',
                'views', 'visualizacoes', 'likes', 'mediaFiles',
                'video_capa_url', 'videoUrl', 'audioUrl', 'video_url', 'audio_url',
                'documento-frente', 'documento-verso', 'selfie-documento', 'verification-video',
                'documento-frente_url', 'documento-verso_url', 'selfie-documento_url', 'verification-video_url',
                'documento-frente_name', 'documento-verso_name', 'selfie-documento_name', 'verification-video_name',
                ...arraysConhecidos,
            ]);
            bannerCampos.forEach(c => camposExcluidos.add(c));
            capaCampos.forEach(c => camposExcluidos.add(c));
            storiesCampos.forEach(c => camposExcluidos.add(c));
            for (let i = 1; i <= 20; i++) {
                [`galeria_${i}_url`, `foto_galeria_${i}_url`, `galeria_${i}`, `foto_galeria_${i}`,
                 `gallery_${i}_url`, `gallery_${i}`, `photo_${i}_url`, `photo_${i}`,
                 `foto_${i}_url`, `foto_${i}`, `galeria_${i}_name`, `gallery_${i}_name`
                ].forEach(c => camposExcluidos.add(c));
            }

            Object.keys(anuncio).forEach(chave => {
                if (camposExcluidos.has(chave)) return;
                if (chave.endsWith('_name')) return;
                if (isCampoDocumento(chave)) return;
                const valor = anuncio[chave];
                if (typeof valor === 'string' && valor.length > 10) {
                    const urlValida = (valor.startsWith('http://') || valor.startsWith('https://') || valor.startsWith('gs://')) && isImageUrl(valor);
                    if (urlValida) addFoto(valor);
                }
                if (Array.isArray(valor)) {
                    valor.forEach(item => {
                        if (typeof item === 'string' && (item.startsWith('http') || item.startsWith('gs://')) && isImageUrl(item)) addFoto(item);
                    });
                }
            });

            console.log(`📸 ${fotos.length} fotos encontradas na galeria:`, fotos);
            console.log('🔑 Todas as chaves do anúncio:', Object.keys(anuncio));
            console.log('🖼️ Chaves com fotos/galeria/imagem:', Object.keys(anuncio).filter(k => {
                const kl = k.toLowerCase();
                return kl.includes('foto') || kl.includes('galeria') || kl.includes('image') || 
                       kl.includes('photo') || kl.includes('gallery') || kl.includes('media');
            }));

            // Se não há fotos, mostrar mensagem
            if (fotos.length === 0) {
                pubBook.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Nenhuma foto disponível na galeria</p>';
                console.warn('⚠️ Nenhuma foto encontrada na galeria');
                // Atualizar estatísticas mesmo sem fotos
                updateProfileStats(anuncio, 0);
                return;
            }

            // Obter nome e localização do anúncio
            const nomeAnuncio = anuncio.nome || anuncio.name || 'Anúncio';
            const cidade = anuncio.cidade || anuncio.city || '';
            const estado = anuncio.estado || anuncio.state || '';
            const estadoUF = estado ? (estado.length <= 2 ? estado.toUpperCase() : estado.substring(0, 2).toUpperCase()) : '';
            const localizacao = cidade && estadoUF ? `${cidade}/${estadoUF}` : (estadoUF || cidade || 'Localização não informada');
            
            console.log('📋 Informações do card:', { nomeAnuncio, cidade, estado, estadoUF, localizacao });

            // Criar elementos da galeria no formato pub-book
            fotos.forEach((foto, index) => {
                const mediaId = index + 1;
                const pubBookItem = document.createElement('div');
                pubBookItem.className = 'pub-book-item';
                pubBookItem.setAttribute('data-media_id', mediaId);
                pubBookItem.setAttribute('data-media_type', 'photo');
                pubBookItem.setAttribute('data-media_message', '');
                pubBookItem.setAttribute('data-media_verified', '0');
                
                // Usar carrossel customizado - adicionar evento de clique e informações
                pubBookItem.innerHTML = `
                    <div class="gallery-item" data-photo-index="${index}" style="cursor: pointer; position: relative;">
                        <img loading="lazy" src="${foto}" 
                             data-fallback="${foto}" 
                             class="pub-book-img lazyload" 
                             alt="Galeria ${mediaId}"
                             onerror="this.src='${foto}';">
                        <button class="gallery-like-btn" data-photo-index="${index}" data-photo-url="${encodeURIComponent(foto)}" aria-label="Curtir foto">
                            <i class="far fa-thumbs-up"></i>
                        </button>
                    </div>
                    <div class="card_title" style="display: block !important; visibility: visible !important;">${nomeAnuncio}</div>
                    <div class="card_resume" style="display: block !important; visibility: visible !important;">${localizacao}</div>
                `;
                
                // Debug: verificar se os elementos foram criados
                const cardTitle = pubBookItem.querySelector('.card_title');
                const cardResume = pubBookItem.querySelector('.card_resume');
                if (!cardTitle || !cardResume) {
                    console.error('❌ Elementos card_title ou card_resume não foram criados!');
                } else {
                    console.log('✅ Elementos criados:', { 
                        title: cardTitle.textContent, 
                        resume: cardResume.textContent,
                        titleDisplay: window.getComputedStyle(cardTitle).display,
                        resumeDisplay: window.getComputedStyle(cardResume).display
                    });
                }
                
                // Adicionar evento de clique para abrir o modal (apenas na imagem)
                const galleryItem = pubBookItem.querySelector('.gallery-item');
                galleryItem.addEventListener('click', (e) => {
                    if (!e.target.closest('.gallery-like-btn')) {
                        openGalleryModal(index);
                    }
                });
                
                // Adicionar evento de clique no botão de like
                const likeBtn = pubBookItem.querySelector('.gallery-like-btn');
                if (likeBtn) {
                    likeBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        const photoUrl = decodeURIComponent(likeBtn.getAttribute('data-photo-url'));
                        handleGalleryLike(e, index, photoUrl);
                    });
                }
                
                pubBook.appendChild(pubBookItem);
                
                // Rastrear visualização de fotos usando Intersection Observer
                if (typeof trackPhotoView === 'function') {
                    const photoImg = pubBookItem.querySelector('img');
                    if (photoImg) {
                        const photoId = foto || `photo_${index}`;
                        const observer = new IntersectionObserver((entries) => {
                            entries.forEach(entry => {
                                if (entry.isIntersecting) {
                                    // Foto está visível
                                    trackPhotoView(photoId);
                                } else {
                                    // Foto saiu da tela
                                    if (typeof stopPhotoTracking === 'function') {
                                        stopPhotoTracking(photoId);
                                    }
                                }
                            });
                        }, { threshold: 0.5 });
                        
                        observer.observe(photoImg);
                    }
                }
            });

            console.log(`✅ Galeria atualizada com ${fotos.length} fotos`);
            
            // Armazenar fotos globalmente para o modal
            window.galleryPhotos = fotos;
            
            // Atualizar estatísticas (views e likes)
            updateProfileStats(anuncio, fotos.length);
        }
        
        // Função para atualizar estatísticas (views e likes)
        function updateProfileStats(anuncio, totalFotos) {
            console.log('📊 Atualizando estatísticas...', { anuncioId: anuncio?.id, totalFotos });
            
            // Atualizar Views
            const statViews = document.getElementById('stat-views');
            console.log('🔍 Elemento stat-views encontrado:', !!statViews);
            if (statViews) {
                // Pegar views do anuncio ou usar um valor padrão/simulado
                const views = anuncio?.views || anuncio?.visualizacoes || anuncio?.visualizations || 0;
                // Se não houver views, usar um valor simulado baseado no ID ou data
                const finalViews = views || Math.floor(Math.random() * 1000) + 100;
                statViews.textContent = finalViews.toLocaleString('pt-BR');
                console.log(`📊 Views atualizadas: ${finalViews}`, 'Elemento:', statViews);
            } else {
                console.warn('⚠️ Elemento stat-views não encontrado no DOM');
            }
            
            // Atualizar Likes - soma dos likes de todas as fotos
            const statLikes = document.getElementById('stat-likes');
            if (statLikes) {
                let totalLikes = 0;
                
                // Tentar pegar likes das fotos individuais
                for (let i = 1; i <= 9; i++) {
                    const campoLikes = `galeria_${i}_likes`;
                    const likes = anuncio[campoLikes] || 0;
                    totalLikes += parseInt(likes) || 0;
                }
                
                // Se não houver likes individuais, pegar total geral
                if (totalLikes === 0) {
                    totalLikes = anuncio.likes || anuncio.total_likes || anuncio.likes_total || 0;
                }
                
                // Se ainda não houver, usar valor simulado baseado no número de fotos
                if (totalLikes === 0 && totalFotos > 0) {
                    totalLikes = Math.floor(Math.random() * 500) + (totalFotos * 10);
                }
                
                statLikes.textContent = totalLikes.toLocaleString('pt-BR');
                console.log(`❤️ Likes atualizados: ${totalLikes}`);
            }
        }
        
        // Variáveis globais para o carrossel customizado
        let currentGalleryIndex = 0;
        let galleryPhotos = [];
        let galleryPhotosBackup = null;
        let isCustomGalleryActive = false;

        // Função para abrir o modal de galeria
        function openGalleryModal(index = 0, options = {}) {
            const customPhotos = Array.isArray(options.photos)
                ? options.photos.filter(Boolean)
                : null;

            if (customPhotos && customPhotos.length === 0) {
                console.warn('⚠️ Nenhuma foto válida fornecida para o carrossel personalizado');
                return;
            }

            if (customPhotos) {
                if (!isCustomGalleryActive) {
                    galleryPhotosBackup = window.galleryPhotos || [];
                }
                window.galleryPhotos = customPhotos;
                isCustomGalleryActive = true;
            } else if (!window.galleryPhotos || window.galleryPhotos.length === 0) {
                console.warn('⚠️ Nenhuma foto na galeria');
                return;
            }

            const maxIndex = window.galleryPhotos.length - 1;
            currentGalleryIndex = Math.min(Math.max(index, 0), maxIndex);

            const modal = document.getElementById('gallery-modal');
            const modalImage = document.getElementById('gallery-modal-image');
            const currentIndexSpan = document.getElementById('gallery-current-index');
            const totalCountSpan = document.getElementById('gallery-total-count');
            const prevBtn = document.getElementById('gallery-prev-btn');
            const nextBtn = document.getElementById('gallery-next-btn');

            if (!modal || !modalImage) {
                console.error('❌ Elementos do modal não encontrados');
                return;
            }

            // Atualizar imagem
            modalImage.src = window.galleryPhotos[currentGalleryIndex];
            modalImage.alt = `Foto ${currentGalleryIndex + 1}`;

            // Atualizar contador
            currentIndexSpan.textContent = currentGalleryIndex + 1;
            totalCountSpan.textContent = window.galleryPhotos.length;

            // Mostrar/ocultar botões de navegação conforme necessário
            const shouldShowNav = window.galleryPhotos.length > 1;
            if (prevBtn) {
                prevBtn.style.display = shouldShowNav ? 'flex' : 'none';
            }
            if (nextBtn) {
                nextBtn.style.display = shouldShowNav ? 'flex' : 'none';
            }

            // Mostrar modal
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';

            console.log(`📸 Abrindo foto ${currentGalleryIndex + 1} de ${window.galleryPhotos.length}`);
        }

        // Função para fechar o modal
        function closeGalleryModal() {
            const modal = document.getElementById('gallery-modal');
            const prevBtn = document.getElementById('gallery-prev-btn');
            const nextBtn = document.getElementById('gallery-next-btn');
            
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            
            // Restaurar botões de navegação (caso tenham sido escondidos)
            if (prevBtn) {
                prevBtn.style.display = 'flex';
            }
            if (nextBtn) {
                nextBtn.style.display = 'flex';
            }

            if (isCustomGalleryActive) {
                window.galleryPhotos = galleryPhotosBackup || [];
                galleryPhotosBackup = null;
                isCustomGalleryActive = false;
            }
        }

        // Função para navegar para a foto anterior
        function prevGalleryPhoto() {
            if (!window.galleryPhotos || window.galleryPhotos.length === 0) return;
            
            currentGalleryIndex = (currentGalleryIndex - 1 + window.galleryPhotos.length) % window.galleryPhotos.length;
            updateGalleryModal();
        }

        // Função para navegar para a próxima foto
        function nextGalleryPhoto() {
            if (!window.galleryPhotos || window.galleryPhotos.length === 0) return;
            
            currentGalleryIndex = (currentGalleryIndex + 1) % window.galleryPhotos.length;
            updateGalleryModal();
        }

        // Função para atualizar o modal com a foto atual
        function updateGalleryModal() {
            const modalImage = document.getElementById('gallery-modal-image');
            const currentIndexSpan = document.getElementById('gallery-current-index');

            if (modalImage && window.galleryPhotos[currentGalleryIndex]) {
                modalImage.src = window.galleryPhotos[currentGalleryIndex];
                modalImage.alt = `Foto ${currentGalleryIndex + 1}`;
                currentIndexSpan.textContent = currentGalleryIndex + 1;
            }
        }

        // Inicializar eventos do modal após o DOM estar carregado
        document.addEventListener('DOMContentLoaded', function() {
            // Botão fechar
            const closeBtn = document.getElementById('gallery-close-btn');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeGalleryModal);
            }

            // Botão anterior
            const prevBtn = document.getElementById('gallery-prev-btn');
            if (prevBtn) {
                prevBtn.addEventListener('click', prevGalleryPhoto);
            }

            // Botão próximo
            const nextBtn = document.getElementById('gallery-next-btn');
            if (nextBtn) {
                nextBtn.addEventListener('click', nextGalleryPhoto);
            }

            // Fechar ao clicar no backdrop
            const backdrop = document.querySelector('.gallery-modal-backdrop');
            if (backdrop) {
                backdrop.addEventListener('click', closeGalleryModal);
            }

            // Navegação por teclado
            document.addEventListener('keydown', function(e) {
                const modal = document.getElementById('gallery-modal');
                if (!modal || modal.style.display === 'none') return;

                switch(e.key) {
                    case 'Escape':
                        closeGalleryModal();
                        break;
                    case 'ArrowLeft':
                        prevGalleryPhoto();
                        break;
                    case 'ArrowRight':
                        nextGalleryPhoto();
                        break;
                }
            });

            console.log('✅ Eventos do carrossel de galeria inicializados');

            // Função para verificar se está no modo mobile/tablet
            function isMobileDevice() {
                return window.innerWidth <= 1024;
            }

            function openPhotoInCarousel(imageUrl, contextLabel = 'Foto') {
                if (!imageUrl || typeof imageUrl !== 'string') {
                    console.warn('⚠️ URL inválida para exibição no carrossel:', imageUrl);
                    return;
                }

                const normalizedUrl = imageUrl.trim();
                if (!normalizedUrl) {
                    console.warn('⚠️ URL vazia após normalização');
                    return;
                }

                const basePhotos = Array.isArray(window.galleryPhotos) ? window.galleryPhotos : [];
                const existingIndex = basePhotos.indexOf(normalizedUrl);

                if (existingIndex !== -1) {
                    openGalleryModal(existingIndex);
                    console.log(`📸 ${contextLabel} já está na galeria. Abrindo índice ${existingIndex + 1}.`);
                    return;
                }

                const customPhotos = [normalizedUrl, ...basePhotos.filter(photo => photo && photo !== normalizedUrl)];
                openGalleryModal(0, { photos: customPhotos });
                console.log(`📸 ${contextLabel} aberto no carrossel com ${customPhotos.length} foto(s).`);
            }
            
            // Handlers para banner e foto de perfil
            function handleBannerClick(e) {
                if (isMobileDevice()) {
                    e.preventDefault();
                    e.stopPropagation();
                    const bannerUrl = this.src || this.getAttribute('src');
                    if (bannerUrl && bannerUrl !== '' && !bannerUrl.includes('data:image')) {
                        openPhotoInCarousel(bannerUrl, 'Banner do Perfil');
                    }
                }
            }
            
            function handleProfileImageClick(e) {
                if (isMobileDevice()) {
                    e.preventDefault();
                    e.stopPropagation();
                    const imageUrl = this.src || this.getAttribute('src');
                    if (imageUrl && imageUrl !== '' && !imageUrl.includes('data:image')) {
                        openPhotoInCarousel(imageUrl, 'Foto do Perfil');
                    }
                }
            }
            
            // Adicionar event listeners para banner e foto de perfil no modo mobile
            function setupMobilePhotoClickListeners() {
                // Listener para o banner
                const profileBanner = document.getElementById('profile-banner');
                if (profileBanner) {
                    // Remover listener anterior se existir
                    profileBanner.removeEventListener('click', handleBannerClick);
                    // Adicionar novo listener
                    profileBanner.addEventListener('click', handleBannerClick);
                    // Adicionar cursor pointer no mobile
                    if (isMobileDevice()) {
                        profileBanner.style.cursor = 'pointer';
                    } else {
                        profileBanner.style.cursor = 'default';
                    }
                }
                
                // Listener para a foto de perfil
                const profileImage = document.getElementById('profile-image');
                if (profileImage) {
                    // Remover listener anterior se existir
                    profileImage.removeEventListener('click', handleProfileImageClick);
                    // Adicionar novo listener
                    profileImage.addEventListener('click', handleProfileImageClick);
                    // Adicionar cursor pointer no mobile
                    if (isMobileDevice()) {
                        profileImage.style.cursor = 'pointer';
                    } else {
                        profileImage.style.cursor = 'default';
                    }
                }
            }
            
            // Configurar listeners inicialmente
            setupMobilePhotoClickListeners();
            
            // Reconfigurar listeners quando a tela for redimensionada
            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(function() {
                    setupMobilePhotoClickListeners();
                }, 250);
            });
        });


        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // loadProfileData() já é chamado no outro DOMContentLoaded que inicializa o Firebase
            // Não chamar aqui para evitar duplicação
            
            // Eventos do modal de galeria já foram configurados acima
        });
        
        // ==========================================
        // FUNÇÃO DE SIMULAÇÃO PARA TESTE COM JSON
        // ==========================================
        // Esta função permite testar a página com dados JSON sem precisar do Firebase
        // Para usar, chame no console: simularCarregamentoDados(jsonData)
        window.simularCarregamentoDados = async function(jsonData) {
            console.log('🧪 ========== SIMULANDO CARREGAMENTO DE DADOS ==========');
            console.log('📋 JSON recebido:', jsonData);
            
            // Converter o JSON para o formato esperado pela página
            const anuncio = {
                id: 'test-id-' + Date.now(),
                ...jsonData,
                
                // Simular URLs de imagens baseadas nos nomes dos arquivos
                foto_banner_url: jsonData.files?.foto_banner?.arquivo 
                    ? `https://via.placeholder.com/1200x450?text=Banner+${encodeURIComponent(jsonData.files.foto_banner.arquivo)}`
                    : null,
                
                foto_capa_url: jsonData.files?.foto_capa?.arquivo 
                    ? `https://via.placeholder.com/400x400?text=Capa+${encodeURIComponent(jsonData.files.foto_capa.arquivo)}`
                    : null,
            };
            
            // Mapear arquivos da galeria para os campos corretos
            if (jsonData.files?.galeria && Array.isArray(jsonData.files.galeria)) {
                jsonData.files.galeria.forEach(item => {
                    const campoNum = item.campo.replace('galeria_', '');
                    const urlKey = `galeria_${campoNum}_url`;
                    
                    // Simular URL da imagem (usando placeholder ou nome do arquivo)
                    if (item.isVideo) {
                        anuncio[urlKey] = `https://via.placeholder.com/800x600?text=Video+${encodeURIComponent(item.arquivo)}`;
                        anuncio.video_capa_url = anuncio[urlKey];
                    } else {
                        // Simular URL de imagem real
                        anuncio[urlKey] = `https://via.placeholder.com/800x600?text=Galeria+${campoNum}+${encodeURIComponent(item.arquivo)}`;
                        
                        // Se for stories (galeria_9), também salvar
                        if (item.isStories) {
                            anuncio.stories_photo_url = anuncio[urlKey];
                        }
                    }
                });
            }
            
            // Processar vídeo separado se existir
            if (jsonData.files?.video) {
                anuncio.galeria_8_url = `https://via.placeholder.com/800x600?text=Video+${encodeURIComponent(jsonData.files.video.arquivo)}`;
                anuncio.video_capa_url = anuncio.galeria_8_url;
            }
            
            // Converter estado e cidade para formato legível
            if (anuncio.estado) {
                const estadosMap = {
                    'DF': 'Distrito Federal',
                    'SP': 'São Paulo',
                    'RJ': 'Rio de Janeiro',
                    'MG': 'Minas Gerais',
                };
                anuncio.estado_nome = estadosMap[anuncio.estado] || anuncio.estado;
            }
            
            if (anuncio.cidade) {
                anuncio.cidade_nome = anuncio.cidade
                    .split('-')
                    .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
                    .join(' ');
            }
            
            // Processar horário
            if (anuncio.horario_24h === 'sim') {
                anuncio.horario_display = '24 horas';
            } else if (anuncio.horario_inicio && anuncio.horario_fim) {
                anuncio.horario_display = `${anuncio.horario_inicio} às ${anuncio.horario_fim}`;
            } else {
                anuncio.horario_display = 'Não informado';
            }
            
            // Processar formas de pagamento
            if (anuncio.pagamento && Array.isArray(anuncio.pagamento)) {
                anuncio.pagamento_display = anuncio.pagamento
                    .map(p => {
                        const pagamentosMap = {
                            'dinheiro': 'Dinheiro',
                            'pix': 'PIX',
                            'debito': 'Débito',
                            'credito': 'Crédito'
                        };
                        return pagamentosMap[p] || p;
                    })
                    .join(', ');
            }
            
            // Processar "atende"
            if (anuncio.atende && Array.isArray(anuncio.atende)) {
                anuncio.atende_display = anuncio.atende
                    .map(a => {
                        const atendeMap = {
                            'ele': 'Ele',
                            'ela': 'Ela',
                            'casais': 'Casais'
                        };
                        return atendeMap[a] || a;
                    })
                    .join(', ');
            }
            
            console.log('✅ Anúncio formatado:', anuncio);
            console.log('📸 URLs de imagens simuladas:', {
                banner: anuncio.foto_banner_url,
                capa: anuncio.foto_capa_url,
                galeria: {
                    galeria_1: anuncio.galeria_1_url,
                    galeria_2: anuncio.galeria_2_url,
                    galeria_3: anuncio.galeria_3_url,
                    galeria_4: anuncio.galeria_4_url,
                    galeria_5: anuncio.galeria_5_url,
                    galeria_6: anuncio.galeria_6_url,
                    galeria_7: anuncio.galeria_7_url,
                    galeria_8: anuncio.galeria_8_url,
                    galeria_9: anuncio.galeria_9_url
                }
            });
            
            // Chamar a função de atualização da página
            console.log('🔄 Chamando updateProfileData com dados simulados...');
            await updateProfileData(anuncio);
            console.log('✅ Simulação concluída!');
            
            return anuncio;
        };
        
        // ==========================================
        // MODO DE TESTE AUTOMÁTICO (já movido para o DOMContentLoaded principal acima)
        // ==========================================

        // Fechar modal com ESC já está implementado no DOMContentLoaded acima para a galeria
        // Aqui apenas para o modal de mensagem
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeMessageModal();
            }
        });

        // Funções do Modal de Mensagem
        function openMessageModal() {
            const modal = document.getElementById('message-modal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeMessageModal() {
            const modal = document.getElementById('message-modal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // Limpar formulário
            document.getElementById('message-form').reset();
        }

        // Event listener para o formulário de mensagem
        document.addEventListener('DOMContentLoaded', function() {
            const messageForm = document.getElementById('message-form');
            if (messageForm) {
                messageForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Coletar dados do formulário
                    const formData = new FormData(messageForm);
                    const messageData = {
                        name: formData.get('name'),
                        email: formData.get('email'),
                        phone: formData.get('phone'),
                        message: formData.get('message'),
                        timestamp: new Date().toISOString()
                    };
                    
                    // Simular envio da mensagem
                    console.log('Mensagem enviada:', messageData);
                    
                    // Mostrar mensagem de sucesso
                    alert('Mensagem enviada com sucesso! Entraremos em contato em breve.');
                    
                    // Fechar modal
                    closeMessageModal();
                });
            }

            // Fechar modal ao clicar fora
            const messageModal = document.getElementById('message-modal');
            if (messageModal) {
                messageModal.addEventListener('click', function(event) {
                    if (event.target === messageModal) {
                        closeMessageModal();
                    }
                });
            }
        });

        // Lightbox functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Handle gallery clicks
            const galleryLinks = document.querySelectorAll('.pub-book-link');
            
            galleryLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const lightbox = document.querySelector(targetId);
                    
                    if (lightbox) {
                        lightbox.style.display = 'flex';
                        document.body.style.overflow = 'hidden';
                    }
                });
            });

            // Handle close button clicks
            const closeButtons = document.querySelectorAll('.mfp-close');
            
            closeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const lightbox = this.closest('.lightbox-block');
                    if (lightbox) {
                        lightbox.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                });
            });

            // Handle background clicks to close
            const lightboxes = document.querySelectorAll('.lightbox-block');
            
            lightboxes.forEach(lightbox => {
                lightbox.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                });
            });

            // Handle ESC key to close
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const openLightbox = document.querySelector('.lightbox-block[style*="flex"]');
                    if (openLightbox) {
                        openLightbox.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        });
    </script>
    
    <!-- Botão Painel de Controle no final da página -->
    <!-- Section de Estatísticas (visível apenas para admin/anunciante) -->
    <section class="stats-section" id="stats-section" style="display: none;">
        <h2 class="section-title">
            <i class="fas fa-chart-line"></i>
            Estatísticas deste anúncio
        </h2>
        <div class="stats-grid">
            <div class="stat-card stat-likes">
                <div class="stat-icon"><i class="fas fa-heart"></i></div>
                <div class="stat-value" id="stat-likes-total">0</div>
                <div class="stat-label">Likes Totais</div>
            </div>
            <div class="stat-card stat-comentarios">
                <div class="stat-icon"><i class="fas fa-comments"></i></div>
                <div class="stat-value" id="stat-comentarios-total">0</div>
                <div class="stat-label">Comentários</div>
            </div>
            <div class="stat-card stat-tempo">
                <div class="stat-icon"><i class="fas fa-clock"></i></div>
                <div class="stat-value" id="stat-tempo-total">0</div>
                <div class="stat-label">Tempo Total de Visitação</div>
            </div>
            <div class="stat-card stat-visualizacoes">
                <div class="stat-icon"><i class="fas fa-eye"></i></div>
                <div class="stat-value" id="stat-visualizacoes-lista">0</div>
                <div class="stat-label">Visualizações na Lista</div>
            </div>
            <div class="stat-card stat-entradas">
                <div class="stat-icon"><i class="fas fa-door-open"></i></div>
                <div class="stat-value" id="stat-entradas">0</div>
                <div class="stat-label">Entradas</div>
            </div>
            <div class="stat-card stat-prints">
                <div class="stat-icon"><i class="fas fa-print"></i></div>
                <div class="stat-value" id="stat-prints-total">0</div>
                <div class="stat-label">Prints</div>
            </div>
            <div class="stat-card stat-dispositivos">
                <div class="stat-icon"><i class="fas fa-mobile-alt"></i></div>
                <div class="stat-value" id="stat-dispositivos-unicos">0</div>
                <div class="stat-label">Dispositivos Únicos</div>
            </div>
        </div>
        <div class="top-visitantes" id="top-visitantes-section" style="display: none;">
            <h3><i class="fas fa-users"></i> Top 50 Visitantes</h3>
            <div class="visitantes-list" id="visitantes-list">
                <!-- Lista será preenchida via JavaScript -->
            </div>
        </div>
    </section>

    <!-- Botões de Controle no final da página -->
    
    <!-- Script para Sistema de Rastreamento de Estatísticas -->
    <script>
      // Variáveis globais para rastreamento
      let visitStartTime = null;
      let currentVisitId = null;
      let photoViewTimes = {}; // {fotoId: {startTime, totalSeconds}}
      let commentStartCount = 0;
      let printCount = 0;
      let deviceId = null;
      let visitInterval = null;
      let isAnunciante = false;
      let isAdmin = false;
      let currentUser = null;
      let anuncioId = null;
      let db = null;
      let auth = null;

      // Verificar permissões e mostrar estatísticas
      async function verificarPermissoesEstatisticas() {
        try {
          anuncioId = new URLSearchParams(window.location.search).get('id');
          if (!anuncioId || !db || !auth) return;

          if (auth.currentUser) {
            currentUser = auth.currentUser;
            const userEmail = currentUser.email;

            // Buscar dados do anúncio
            let anuncioEmail = null;
            try {
              const anuncioDoc = await db.collection('anuncios').doc(anuncioId).get();
              if (!anuncioDoc.exists) {
                const adDoc = await db.collection('advertisements').doc(anuncioId).get();
                if (adDoc.exists) {
                  anuncioEmail = adDoc.data().email || adDoc.data().userEmail;
                }
              } else {
                anuncioEmail = anuncioDoc.data().email || anuncioDoc.data().userEmail;
              }

              // Verificar se é anunciante
              if (anuncioEmail && userEmail && anuncioEmail.toLowerCase() === userEmail.toLowerCase()) {
                isAnunciante = true;
              }

              // Verificar se é admin
              try {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                if (userDoc.exists) {
                  const userData = userDoc.data();
                  if (userData.role === 'admin' || userData.admin === true) {
                    isAdmin = true;
                  }
                }
              } catch (e) {
                console.warn('⚠️ Erro ao verificar role de admin:', e);
              }

              // Mostrar section de estatísticas se for admin ou anunciante
              if (isAnunciante || isAdmin) {
                const statsSection = document.getElementById('stats-section');
                if (statsSection) {
                  statsSection.style.display = 'block';
                  await carregarEstatisticas();
                }
              }
            } catch (error) {
              console.error('❌ Erro ao verificar permissões:', error);
            }
          }
        } catch (error) {
          console.error('❌ Erro ao verificar permissões de estatísticas:', error);
        }
      }

      // Obter ID do dispositivo (IP ou userId)
      async function getDeviceId() {
        if (deviceId) return deviceId;
        
        if (currentUser && currentUser.uid) {
          deviceId = `user_${currentUser.uid}`;
        } else {
          try {
            const response = await fetch('https://api.ipify.org?format=json');
            const data = await response.json();
            deviceId = `ip_${data.ip}`;
          } catch (e) {
            deviceId = sessionStorage.getItem('deviceId') || `ip_${Date.now()}_${Math.random()}`;
            sessionStorage.setItem('deviceId', deviceId);
          }
        }
        return deviceId;
      }

      // Rastrear entrada na página
      async function trackPageView() {
        if (!anuncioId || !db) return;
        
        try {
          visitStartTime = Date.now();
          deviceId = await getDeviceId();
          
          const visitaRef = db.collection('anuncio_stats').doc(anuncioId).collection('visitas').doc();
          currentVisitId = visitaRef.id;
          
          await visitaRef.set({
            visitanteId: deviceId,
            tipo: currentUser ? 'user' : 'ip',
            timestamp_inicio: firebase.firestore.FieldValue.serverTimestamp(),
            tempo_visita: 0,
            fotos_vistas: [],
            prints: 0,
            comentarios_iniciados: 0
          });

          const statsRef = db.collection('anuncio_stats').doc(anuncioId);
          await statsRef.set({
            entradas: firebase.firestore.FieldValue.increment(1),
            ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
          }, { merge: true });

          const statsDoc = await statsRef.get();
          const visitantes = statsDoc.data()?.visitantes || [];
          const visitanteExistente = visitantes.find(v => v.visitanteId === deviceId);
          
          if (!visitanteExistente) {
            await statsRef.update({
              dispositivos_unicos: firebase.firestore.FieldValue.increment(1),
              visitantes: firebase.firestore.FieldValue.arrayUnion({
                visitanteId: deviceId,
                email: currentUser?.email || 'Anônimo',
                visitas: 1,
                ultima_visita: firebase.firestore.FieldValue.serverTimestamp()
              })
            });
          } else {
            const updatedVisitantes = visitantes.map(v => {
              if (v.visitanteId === deviceId) {
                return {
                  ...v,
                  visitas: (v.visitas || 0) + 1,
                  ultima_visita: firebase.firestore.FieldValue.serverTimestamp()
                };
              }
              return v;
            });
            await statsRef.update({ visitantes: updatedVisitantes });
          }

          visitInterval = setInterval(async () => {
            if (visitStartTime && currentVisitId) {
              const tempoDecorrido = Math.floor((Date.now() - visitStartTime) / 1000);
              const visitaRef = db.collection('anuncio_stats').doc(anuncioId).collection('visitas').doc(currentVisitId);
              await visitaRef.update({
                tempo_visita: tempoDecorrido
              });
              
              const statsRef = db.collection('anuncio_stats').doc(anuncioId);
              await statsRef.set({
                tempo_total_visita: firebase.firestore.FieldValue.increment(10),
                ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
              }, { merge: true });
            }
          }, 10000);

          console.log('✅ Rastreamento de página iniciado');
        } catch (error) {
          console.error('❌ Erro ao rastrear entrada na página:', error);
        }
      }

      // Rastrear quando passa pelo anúncio na lista
      function trackListScroll() {
        if (!anuncioId || !db) return;
        
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
              db.collection('anuncio_stats').doc(anuncioId).set({
                visualizacoes_lista: firebase.firestore.FieldValue.increment(1),
                ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
              }, { merge: true });
              observer.disconnect();
            }
          });
        }, { threshold: 0.5 });

        const mainContent = document.querySelector('.main-content') || document.body;
        if (mainContent) {
          observer.observe(mainContent);
        }
      }

      // Rastrear tempo em cada foto
      function trackPhotoView(fotoId) {
        if (!fotoId || !anuncioId || !db) return;
        
        if (!photoViewTimes[fotoId]) {
          photoViewTimes[fotoId] = {
            startTime: Date.now(),
            totalSeconds: 0
          };
        } else {
          photoViewTimes[fotoId].startTime = Date.now();
        }
      }

      // Parar rastreamento de foto
      function stopPhotoTracking(fotoId) {
        if (!fotoId || !photoViewTimes[fotoId] || !anuncioId || !db) return;
        
        const tempoDecorrido = Math.floor((Date.now() - photoViewTimes[fotoId].startTime) / 1000);
        photoViewTimes[fotoId].totalSeconds += tempoDecorrido;
        
        const statsRef = db.collection('anuncio_stats').doc(anuncioId);
        statsRef.get().then(doc => {
          const minutosPorFoto = doc.data()?.minutos_por_foto || {};
          const minutosAtuais = minutosPorFoto[fotoId] || 0;
          minutosPorFoto[fotoId] = minutosAtuais + (tempoDecorrido / 60);
          
          statsRef.set({
            minutos_por_foto: minutosPorFoto,
            ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
          }, { merge: true });
        });
      }

      // Rastrear quando inicia comentário
      function trackCommentStart() {
        if (!anuncioId || !db) return;
        
        commentStartCount++;
        db.collection('anuncio_stats').doc(anuncioId).set({
          comentarios_iniciados: firebase.firestore.FieldValue.increment(1),
          ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true });
        
        if (currentVisitId) {
          db.collection('anuncio_stats').doc(anuncioId).collection('visitas').doc(currentVisitId).update({
            comentarios_iniciados: firebase.firestore.FieldValue.increment(1)
          });
        }
      }

      // Rastrear prints
      function trackPrint() {
        if (!anuncioId || !db) return;
        
        printCount++;
        db.collection('anuncio_stats').doc(anuncioId).set({
          prints_total: firebase.firestore.FieldValue.increment(1),
          ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true });
        
        if (currentVisitId) {
          db.collection('anuncio_stats').doc(anuncioId).collection('visitas').doc(currentVisitId).update({
            prints: firebase.firestore.FieldValue.increment(1)
          });
        }
      }

      // Rastrear like em foto
      function trackLike(fotoId) {
        if (!fotoId || !anuncioId || !db) return;
        
        db.collection('anuncio_stats').doc(anuncioId).set({
          likes_total: firebase.firestore.FieldValue.increment(1),
          ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true });
      }

      // Carregar e exibir estatísticas
      async function carregarEstatisticas() {
        if (!anuncioId || !db) return;
        
        try {
          const statsRef = db.collection('anuncio_stats').doc(anuncioId);
          const statsDoc = await statsRef.get();
          
          if (statsDoc.exists) {
            const stats = statsDoc.data();
            
            document.getElementById('stat-likes-total').textContent = formatNumber(stats.likes_total || 0);
            document.getElementById('stat-comentarios-total').textContent = formatNumber(stats.comentarios_total || 0);
            document.getElementById('stat-tempo-total').textContent = formatTime(stats.tempo_total_visita || 0);
            document.getElementById('stat-visualizacoes-lista').textContent = formatNumber(stats.visualizacoes_lista || 0);
            document.getElementById('stat-entradas').textContent = formatNumber(stats.entradas || 0);
            document.getElementById('stat-prints-total').textContent = formatNumber(stats.prints_total || 0);
            document.getElementById('stat-dispositivos-unicos').textContent = formatNumber(stats.dispositivos_unicos || 0);
            
            if (currentUser && stats.visitantes && stats.visitantes.length > 0) {
              const topVisitantes = stats.visitantes
                .sort((a, b) => (b.visitas || 0) - (a.visitas || 0))
                .slice(0, 50);
              
              const visitantesList = document.getElementById('visitantes-list');
              const topVisitantesSection = document.getElementById('top-visitantes-section');
              
              if (topVisitantes.length > 0 && visitantesList && topVisitantesSection) {
                topVisitantesSection.style.display = 'block';
                visitantesList.innerHTML = topVisitantes.map(v => `
                  <div class="visitante-item">
                    <div class="visitante-info">
                      <span class="visitante-email">${escapeHtml(v.email || v.visitanteId)}</span>
                    </div>
                    <div class="visitante-visitas">${v.visitas || 0} visitas</div>
                  </div>
                `).join('');
              }
            }
          } else {
            await statsRef.set({
              likes_total: 0,
              comentarios_total: 0,
              comentarios_iniciados: 0,
              tempo_total_visita: 0,
              visualizacoes_lista: 0,
              entradas: 0,
              prints_total: 0,
              dispositivos_unicos: 0,
              visitantes: [],
              minutos_por_foto: {},
              ultima_atualizacao: firebase.firestore.FieldValue.serverTimestamp()
            });
          }
        } catch (error) {
          console.error('❌ Erro ao carregar estatísticas:', error);
        }
      }

      // Funções auxiliares
      function formatNumber(num) {
        return num.toLocaleString('pt-BR');
      }

      function formatTime(seconds) {
        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = seconds % 60;
        
        if (hours > 0) {
          return `${hours}h ${minutes}m`;
        } else if (minutes > 0) {
          return `${minutes}m ${secs}s`;
        } else {
          return `${secs}s`;
        }
      }

      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // Inicializar quando Firebase estiver pronto
      if (typeof firebase !== 'undefined') {
        auth = firebase.auth();
        db = firebase.firestore();
        
        if (auth) {
          auth.onAuthStateChanged(async (user) => {
            currentUser = user;
            anuncioId = new URLSearchParams(window.location.search).get('id');
            if (anuncioId) {
              await verificarPermissoesEstatisticas();
              trackPageView();
              trackListScroll();
              
              window.addEventListener('beforeprint', trackPrint);
              
              const comentarioTextarea = document.getElementById('comentario-texto');
              if (comentarioTextarea) {
                comentarioTextarea.addEventListener('focus', trackCommentStart);
              }
              
              window.addEventListener('beforeunload', () => {
                if (visitInterval) clearInterval(visitInterval);
                if (currentVisitId && visitStartTime && db) {
                  const tempoDecorrido = Math.floor((Date.now() - visitStartTime) / 1000);
                  db.collection('anuncio_stats').doc(anuncioId).collection('visitas').doc(currentVisitId).update({
                    timestamp_fim: firebase.firestore.FieldValue.serverTimestamp(),
                    tempo_visita: tempoDecorrido,
                    fotos_vistas: Object.keys(photoViewTimes).map(fotoId => ({
                      fotoId: fotoId,
                      tempo_segundos: photoViewTimes[fotoId].totalSeconds
                    }))
                  });
                }
              });
            }
          });
        }
      }
    </script>

    <!-- Script para ocultar Painel de Controle nas páginas principais -->
    <script>
      (function() {
        // Lista de páginas principais onde o elemento não deve ser mostrado
        const paginasPrincipais = [
          'A_01__index.html',
          'A_02__premium.html',
          'A_02__premium_copy.html',
          'A_03__massagistas.html',
          'A_04__trans.html',
          'A_05__homens.html',
          'luxo.html'
        ];
        
        // Obter o nome do arquivo atual
        const nomeArquivoAtual = window.location.pathname.split('/').pop() || window.location.href.split('/').pop();
        
        // Verificar se é uma página principal
        const ehPaginaPrincipal = paginasPrincipais.some(pagina => nomeArquivoAtual.includes(pagina));
        
        // Ocultar o elemento se for página principal (mostrar apenas em páginas de anúncio)
        if (ehPaginaPrincipal) {
          const sectionPainel = document.querySelector('.control-section');
          if (sectionPainel) {
            sectionPainel.style.display = 'none';
          }
          const statsSection = document.getElementById('stats-section');
          if (statsSection) {
            statsSection.style.display = 'none';
          }
        }
      })();
    </script>
</body>
</html>
